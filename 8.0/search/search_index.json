{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"index.html","title":"Percona Server for MySQL 8.0 - Documentation","text":"<p>This documentation is for the latest release: Percona Server for MySQL 8.0.34-26 (Release Notes).</p> <p>Percona Server for MySQL is a freely available, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior and optimized performance, greater scalability, and availability, enhanced backups, increased visibility and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads.</p>"},{"location":"index.html#for-monitoring-and-management","title":"For Monitoring and Management","text":"<p>Percona Monitoring and Management (PMM )monitors and provides actionable performance data for MySQL variants, including Percona Server for MySQL, Percona XtraDB Cluster, Oracle MySQL Community Edition, Oracle MySQL Enterprise Edition, and MariaDB. PMM captures metrics and data for the InnoDB, XtraDB, and MyRocks storage engines, and has specialized dashboards for specific engine details.</p> <p>Install PMM and connect your MySQL instances to it.</p>"},{"location":"adaptive-network-buffers.html","title":"Adaptive network buffers","text":"<p>To find the buffer size of the current connection, use the <code>network_buffer_length</code> status variable. Add <code>SHOW GLOBAL</code> to review the cumulative buffer sizes for all connections. This variable can help to estimate the maximum size of the network buffer\u2019s overhead.</p> <p>Network buffers grow towards the max_allowed_packet size and do not shrink until the connection is terminated. For example, if the connections are selected at random from the pool, an occasional big query eventually increases the buffers of all connections. The combination of max_allowed packet set to a value between 64MB to 128MB and the connection number between 256 to 1024 can create a large memory overhead.</p> <p>Percona Server for MySQL version 8.0.23-14 introduces the net_buffer_shrink_interval variable to solve this issue. The default value is 0 (zero). If you set the value higher than 0, Percona Server records the network buffer\u2019s maximum use size for the number of seconds set by net_buffer_shrink_interval. When the next interval starts, the network buffer is set to the recorded size. This action removes spikes in the buffer size.</p> <p>You can achieve similar results by disconnecting and reconnecting the TCP connections, but this solution is a heavier process. This process disconnects and reconnects connections with small buffers.</p>"},{"location":"adaptive-network-buffers.html#net_buffer_shrink_interval","title":"<code>net_buffer_shrink_interval</code>","text":"Option Description Command-line: \u2013net-buffer-shrink-interval=# Scope: Global Dynamic: Yes Data type: integer Default value: 0 <p>The interval is measured in seconds. The default value is 0, which disables the functionality. The minimum value is 0, and the maximum value is 31536000.</p>"},{"location":"added-features.html","title":"Updated supported features","text":"<p>The following is a list of the latest supported features:</p> <ul> <li> <p>Percona Server for MySQL 8.0.27-18 adds support for <code>SELECT FOR UPDATE SKIP LOCKED/NOWAIT</code>. The transaction isolation level must be <code>READ COMMITTED</code>.</p> </li> <li> <p>Percona Server for MySQL 8.0.27-18 adds the ability to cancel ongoing manual compactions. The cancel methods are the following:</p> <ul> <li> <p>Using either Control+C (from a session) or KILL (from another session) for client sessions running manual compactions by <code>SET GLOBAL rocksdb_compact_cf (variable)</code>.</p> </li> <li> <p>Using a global variable <code>rocksdb_cancel_manual_compactions</code> to cancel all ongoing manual compactions.</p> </li> </ul> </li> <li> <p>Percona Server for MySQL 8.0.23-14 adds supported for Generated Columns and index are supported. Generated columns are not supported in versions earlier than 8.0.23-14.</p> </li> <li> <p>Percona Server for MySQL 8.0.23-14 adds support for explicit DEFAULT value expressions. From version 8.0.13-3 to version 8.0.22-13, MyRocks did not support these expressions.</p> </li> </ul>"},{"location":"advisors.html","title":"Use Percona Monitoring and Management (PMM) Advisors","text":"<p>Percona Monitoring and Management (PMM) provides several categories of Advisors. Each Advisor contains a set of automated checks. These checks investigate your database settings for a specific range of possible issues.</p> <p>The Percona Platform hosts the Advisors. </p> <p>The PMM Server automatically downloads the Advisors if the <code>Advisors</code> and <code>Telemetry</code> options are enabled in <code>Configuration &gt; Settings &gt; Advanced Settings</code>. Both options are enabled by default.</p> <p>See also</p> <p>PMM documentation - Advisor checks</p>"},{"location":"aio-page-requests.html","title":"Multiple page asynchronous I/O requests","text":"<p>The I/O unit size in InnoDB is only one page, even if the server doing read ahead. A 16KB I/O unit size is too small for sequential reads, and less efficient than a larger I/O unit size. InnoDB uses Linux asynchronous I/O (<code>aio</code>) by default. By submitting multiple, consecutive 16KB read requests at the same time, Linux internally merges the requests and reads more efficiently. </p> <p>This feature is able to submit multiple page I/O requests and works in the background. You can manage the feature with the linear read-ahead technique. This technique adds pages to the buffer pool based on the buffer pool pages being accessed sequentially. The <code>innodb_read_ahead_threshold</code> configuration parameter controls this operation.</p> <p>On a HDD RAID 1+0 environment, more than 1000MB/s disk reads can be achieved by submitting 64 consecutive pages requests at once, while only 160MB/s disk reads is shown by submitting single page request.</p>"},{"location":"aio-page-requests.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1 - The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"aio-page-requests.html#status-variables","title":"Status variables","text":""},{"location":"aio-page-requests.html#innodb_buffered_aio_submitted","title":"<code>Innodb_buffered_aio_submitted</code>","text":"Option Description Scope: Global Data type: Numeric <p>This variable shows the number of submitted buffered asynchronous I/O requests.</p>"},{"location":"aio-page-requests.html#other-reading","title":"Other reading","text":"<ul> <li> <p>Making full table scan 10x faster in InnoDB</p> </li> <li> <p>Bug #68659  InnoDB Linux native aio should submit more i/o requests at once</p> </li> </ul>"},{"location":"apparmor.html","title":"Working with AppArmor","text":"<p>The operating system has a Discretionary Access Controls (DAC) system. AppArmor supplements the DAC with a Mandatory Access Control (MAC) system. AppArmor is the default security module for Ubuntu or Debian systems and uses profiles to define how programs access resources.</p> <p>AppArmor is path-based and restricts processes by using profiles. Each profile contains a set of policy rules. Some applications may install their profile along with the application. If an installation does not also install a profile, then that application is not part of the AppArmor subsystem. You can also create profiles since they are simple text files stored in the <code>/etc/apparmor.d</code> directory.</p> <p>A profile is in one of the following modes:</p> <ul> <li> <p>Enforce - the default setting, applications are prevented from taking actions restricted by the profile rules.</p> </li> <li> <p>Complain - applications are allowed to take restricted actions, and the actions are logged.</p> </li> <li> <p>Disabled - applications are allowed to take restricted actions, and the actions are not logged.</p> </li> </ul> <p>You can mix enforce profiles and complain profiles in your server.</p>"},{"location":"apparmor.html#install-the-utilities-used-to-control-apparmor","title":"Install the utilities used to control AppArmor","text":"<p>Install the <code>apparmor-utils</code> package to work with profiles. Use these utilities to create, update, enforce, switch to complain mode, and disable profiles, as needed:</p> <pre><code>$ sudo apt install apparmor-utils\n</code></pre> Expected output <pre><code>Reading package lists... Done\nBuilding dependency tree\n...\nThe following additional packages will be installed:\n    python3-apparmor python3-libapparmor\n...\n</code></pre>"},{"location":"apparmor.html#check-the-current-status","title":"Check the current status","text":"<p>As root or using <code>sudo</code>, you can check the AppArmor status:</p> <pre><code>$ sudo aa-status\n</code></pre> Expected output <pre><code>apparmor module is loaded.\n34 profiles are loaded.\n32 profiles in enforce mode.\n...\n    /usr/sbin/mysqld\n...\n2 profiles in complain mode.\n...\n3 profiles have profiles defined.\n...\n0 processes are in complain mode.\n0 processes are unconfined but have a profile defined.\n</code></pre>"},{"location":"apparmor.html#switch-a-profile-to-complain-mode","title":"Switch a profile to complain mode","text":"<p>Switch a profile to complain mode when the program is in your path with this command:</p> <pre><code>$ sudo aa-complain &lt;program&gt;\n</code></pre> <p>If needed, specify the program\u2019s path in the command:</p> <pre><code>$ sudo aa-complain /sbin/&lt;program&gt;\n</code></pre> <p>If the profile is not stored in <code>/etc/apparmor.d/</code>, use the following command:</p> <pre><code>$ sudo aa-complain /path/to/profiles/&lt;program&gt;\n</code></pre>"},{"location":"apparmor.html#switch-a-profile-to-enforce-mode","title":"Switch a profile to enforce mode","text":"<p>Switch a profile to the enforce mode when the program is in your path with this command:</p> <pre><code>$ sudo aa-enforce &lt;program&gt;\n</code></pre> <p>If needed, specify the program\u2019s path in the command:</p> <pre><code>$ sudo aa-enforce /sbin/&lt;program&gt;\n</code></pre> <p>If the profile is not stored in <code>/etc/apparmor.d/</code>, use the following command:</p> <pre><code>$ sudo aa-enforce /path/to/profile\n</code></pre>"},{"location":"apparmor.html#disable-one-profile","title":"Disable one profile","text":"<p>You can disable a profile but it is recommended to Switch a Profile to Complain mode.</p> <p>Use either of the following methods to disable a profile:</p> <pre><code>$ sudo ln -s /etc/apparmor.d/usr.sbin.mysqld /etc/apparmor.d/disable/\n$ sudo apparmor_parser -R /etc/apparmor.d/usr.sbin.mysqld\n</code></pre> <p>or</p> <pre><code>$ aa-disable /etc/apparmor.d/usr.sbin.mysqld\n</code></pre>"},{"location":"apparmor.html#reload-all-profiles","title":"Reload all profiles","text":"<p>Run either of the following commands to reload all profiles:</p> <pre><code>$ sudo service apparmor reload\n</code></pre> <p>or</p> <pre><code>$ sudo systemctl reload apparmor.service\n</code></pre>"},{"location":"apparmor.html#reload-one-profile","title":"Reload one profile","text":"<p>To reload one profile, run the following:</p> <pre><code>$ sudo apparmor_parser -r /etc/apparmor.d/&lt;profile&gt;\n</code></pre> <p>For some changes to take effect, you may need to restart the program.</p>"},{"location":"apparmor.html#disable-apparmor","title":"Disable AppArmor","text":"<p>AppArmor provides security and disabling the system is not recommened. If AppArmor must be disabled, run the following commands:</p> <ol> <li> <p>Check the status.</p> <pre><code>$ sudo apparmor_status\n</code></pre> </li> <li> <p>Stop and disable AppArmor.</p> <pre><code>$ sudo systemctl stop apparmor\n$ sudo systemctl disable apparmor\n</code></pre> </li> </ol>"},{"location":"apparmor.html#add-the-mysqld-profile","title":"Add the mysqld profile","text":"<p>Add the mysqld profile with the following procedure:</p> <ol> <li> <p>Download the current version of the AppArmor:</p> <pre><code>$ wget https://raw.githubusercontent.com/mysql/mysql-server/8.0/packaging/deb-in/extra/apparmor-profile\n</code></pre> <p>The expected output:</p> <pre><code>...\nSaving to 'apparamor-profile`\n...\n</code></pre> </li> <li> <p>Move the file to /etc/apparmor.d/usr.sbin.mysqld</p> <pre><code>$ sudo mv apparmor-profile /etc/apparmor.d/usr.sbin.mysqld\n</code></pre> </li> <li> <p>Create an empty file for editing:</p> <pre><code>$ sudo touch /etc/apparmor.d/local/usr.sbin.mysqld\n</code></pre> </li> <li> <p>Load the profile:</p> <pre><code>$ sudo apparmor_parser -r -T -W /etc/apparmor.d/usr.sbin.mysqld\n</code></pre> </li> <li> <p>Restart Percona Server for MySQL:</p> <pre><code>$ sudo systemctl restart mysql\n</code></pre> </li> <li> <p>Verify the profile status:</p> <pre><code>$ sudo aa-status\n</code></pre> Expected output <pre><code>...\nprocesses are in enforce mode\n...\n/usr/sbin/mysqld (100840)\n...\n</code></pre> </li> </ol>"},{"location":"apparmor.html#edit-the-mysqld-profile","title":"Edit the mysqld profile","text":"<p>Only edit <code>/etc/apparmor.d/local/usr.sbin.mysql</code>. We recommend that you Switch a Profile to Complain mode before editing the file. Edit the file in any text editor. When your work is done, Reload one profile and Switch a Profile to Enforce mode.</p>"},{"location":"apparmor.html#configure-a-custom-data-directory-location","title":"Configure a custom data directory location","text":"<p>You can change the data directory to a non-default location, like /var/lib/mysqlcustom. You should enable audit mode, to capture all of the actions, and edit the profile to allow access for the custom location.</p> <pre><code>$ cat /etc/mysql/mysql.conf.d/mysqld.cnf\n</code></pre> Expected output <pre><code>The Percona Server 8.0 configuration file.\n\nFor explanations see\nhttps://dev.mysql.com/doc/mysql/en/server-system-variables.html\n\n[mysqld]\npid-file    = /var/run/mysqld/mysqld.pid\nsocket        = /var/run/mysqld/mysqld.sock\n*datadir    = /var/lib/mysqlcustom*\nlog-error    = /var/log/mysql/error.log\n</code></pre> <p>Enable audit mode for mysqld. In this mode, the security policy is enforced and all access is logged.</p> <pre><code>$ aa-audit mysqld\n</code></pre> <p>Restart Percona Server for MySQL.</p> <pre><code>$ sudo systemctl mysql restart\n</code></pre> <p>The restart fails because AppArmor has blocked access to the custom data directory location. To diagnose the issue, check the logs for the following:</p> <ul> <li> <p>ALLOWED - A log event when the profile is in complain mode and the action violates a policy.</p> </li> <li> <p>DENIED - A log event when the profile is in enforce mode and the action is blocked.</p> </li> </ul> <p>For example, the following log entries show <code>DENIED</code>:</p> Expected output <pre><code>...\nDec 07 12:17:08 ubuntu-s-4vcpu-8gb-nyc1-01-aa-ps audit[16013]: AVC apparmor=\"DENIED\" operation=\"mknod\" profile=\"/usr/sbin/mysqld\" name=\"/var/lib/mysqlcustom/binlog.index\" pid=16013 comm=\"mysqld\" requested_mask=\"c\" denied_mask=\"c\" fsuid=111 ouid=111\nDec 07 12:17:08 ubuntu-s-4vcpu-8gb-nyc1-01-aa-ps kernel: audit: type=1400 audit(1607343428.022:36): apparmor=\"DENIED\" operation=\"mknod\" profile=\"/usr/sbin/mysqld\" name=\"/var/lib/mysqlcustom/mysqld_tmp_file_case_insensitive_test.lower-test\" pid=16013 comm=\"mysqld\" requested_mask=\"c\" denied_mask=\"c\" fsuid=111 ouid=111\n...\n</code></pre> <p>Open <code>/etc/apparmor.d/local/usr.sbin.mysqld</code> in a text editor and edit the following entries in the <code>Allow data dir access</code> section.</p> <pre><code>Allow data dir access\n/var/lib/mysqlcustom/ r,\n/var/lib/mysqlcustom/** rwk,\n</code></pre> <p>In <code>etc/apparmor.d/local/usr.sbin.mysqld</code>, comment out, using the # symbol, the current entries in the Allow data dir access section. This step is optional. If you skip this step, mysqld continues to access the default data directory location.</p> <p>Note</p> <p>Edit the local version of the file instead of the main profile. Separating the changes makes maintenance easier.</p> <p>Reload the profile:</p> <pre><code>$ apparmor_parser -r -T /etc/apparmor.d/usr.sbin.mysqld\n</code></pre> <p>Restart mysql:</p> <pre><code>$ systemctl restart mysqld\n</code></pre>"},{"location":"apparmor.html#set-up-a-custom-log-location","title":"Set up a custom log location","text":"<p>To move your logs to a custom location, you must edit the my.cnf configuration file and then edit the local profile to allow access:</p> <pre><code>cat /etc/mysql/mysql.conf.d/mysqld.cnf\n</code></pre> Expected output <pre><code>The Percona Server 8.0 configuration file.\n\nFor explanations see\nhttps://dev.mysql.com/doc/mysql/en/server-system-variables.html\n\n[mysqld]\npid-file    = /var/run/mysqld/mysqld.pid\nsocket        = /var/run/mysqld/mysqld.sock\ndatadir    = /var/lib/mysql\nlog-error    = /*custom-log-dir*/mysql/error.log\n</code></pre> <p>Verify the custom directory exists.</p> <pre><code>$ ls -la /custom-log-dir/\n</code></pre> Expected output <pre><code>total 12\ndrwxrwxrwx  3 root root 4096 Dec  7 13:09 .\ndrwxr-xr-x 24 root root 4096 Dec  7 13:07 ..\ndrwxrwxrwx  2 root root 4096 Dec  7 13:09 mysql\n</code></pre> <p>Restart Percona Server.</p> <pre><code>$ service mysql start\n</code></pre> Expected output <pre><code>Job for mysql.service failed because the control process exited with error code.\nSee \"systemctl status mysql.service\" and \"journalctl -xe\" for details.\n</code></pre> <pre><code>$ journalctl -xe\n</code></pre> Expected output <pre><code>...\nAVC apparmor=\"DENIED\" operation=\"mknod\" profile=\"/usr/sbin/mysqld\" name=\"/custom-log-dir/mysql/error.log\"\n...\n</code></pre> <p>The access has been denied by AppArmor. Edit the local profile in the <code>Allow log file access</code> section to allow access to the custom log location.</p> <pre><code>$ cat /etc/apparmor.d/local/usr.sbin.mysqld\n</code></pre> Expected output <pre><code> Site-specific additions and overrides for usr.sbin.mysqld..\n For more details, please see /etc/apparmor.d/local/README.\n\n Allow log file access\n /custom-log-dir/mysql/ r,\n /custom-log-dir/mysql/** rw,\n</code></pre> <p>Reload the profile:</p> <pre><code>$ apparmor_parser -r -T /etc/apparmor.d/usr.sbin.mysqld\n</code></pre> <p>Restart Percona Server:</p> <pre><code>$ systemctl restart mysqld\n</code></pre>"},{"location":"apparmor.html#set-secure_file_priv-directory-location","title":"Set <code>secure_file_priv</code> directory location","text":"<p>By default, secure_file_priv points to the following location:</p> <pre><code>mysql&gt; mysqlshow variables like 'secure_file_priv';\n</code></pre> Expected output <pre><code>+------------------+-----------------------+\n| Variable_name    | Value                 |\n+------------------+-----------------------+\n| secure_file_priv | /var/lib/mysql-files/ |\n+------------------+-----------------------+\n</code></pre> <p>To allow access to another location, in a text editor, open the local profile. Review the settings in the <code>Allow data dir access</code> section:</p> <pre><code>Allow data dir access\n/var/lib/mysql/ r,\n/var/lib/mysql/** rwk,\n</code></pre> <p>Edit the local profile in a text editor to allow access to the custom location.</p> <pre><code>$ cat /etc/apparmor.d/local/usr.sbin.mysqld\n</code></pre> Expected output <pre><code>Site-specific additions and overrides for usr.sbin.mysqld..\nFor more details, please see /etc/apparmor.d/local/README.\n\nAllow data dir access\n/var/lib/mysqlcustom/ r,\n/var/lib/mysqlcustom/** rwk,\n</code></pre> <p>Reload the profile:</p> <pre><code>$ apparmor_parser -r -T /etc/apparmor.d/usr.sbin.mysqld\n</code></pre> <p>Restart Percona Server for MySQL:</p> <pre><code>$ systemctl restart mysqld\n</code></pre>"},{"location":"apt-download-deb.html","title":"Install Percona Server for MySQL 8.0 using downloaded DEB packages","text":"<p>Download the packages from Percona Product Downloads. If needed, Instructions for the Percona Product Download are available.</p> <p>The following example downloads Percona Server for MySQL 8.0.31-23 release packages for Debian 10:</p> <pre><code>$ wget https://downloads.percona.com/downloads/Percona-Server-8.0/Percona-Server-8.0.31-23/binary/debian/buster/x86_64/Percona-Server-8.0.31-23-r71449379-buster-x86_64-bundle.tar\n</code></pre> <p>Unpack the download to get the packages:</p> <pre><code>$ tar xvf Percona-Server-8.0.31-23-r71449379-buster-x86_64-bundle.tar\n</code></pre> Expected output <pre><code>libperconaserverclient21_8.0.31-23-1.buster_amd64.deb\nlibperconaserverclient21-dev_8.0.31-23-1.buster_amd64.deb\npercona-mysql-router_8.0.31-23-1.buster_amd64.deb\npercona-server-client_8.0.31-23-1.buster_amd64.deb\npercona-server-common_8.0.31-23-1.buster_amd64.deb\npercona-server-dbg_8.0.31-23-1.buster_amd64.deb\npercona-server-rocksdb_8.0.31-23-1.buster_amd64.deb\npercona-server-server_8.0.31-23-1.buster_amd64.deb\npercona-server-source_8.0.31-23-1.buster_amd64.deb\npercona-server-test_8.0.31-23-1.buster_amd64.deb\n</code></pre> <p>Install Percona Server for MySQL using <code>dpkg</code>. Run this command as root or use the sudo command:</p> <pre><code>$ sudo dpkg -i *.deb\n</code></pre> <p>Note</p> <p>Percona Server for MySQL 8.0 comes with the TokuDB storage engine. You can find more information on how to install and enable the TokuDB storage in the TokuDB Installation guide.</p> <p>Starting with Percona Server for MySQL 8.0.28-19 (2022-05-12), the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds. For more information, see the TokuDB Introduction.</p> <p>Warning</p> <p>When installing packages manually like this, you\u2019ll need to resolve all the dependencies and install missing packages yourself. The following packages will need to be installed before you can manually install Percona Server: <code>mysql-common</code>, <code>libjemalloc1</code>, <code>libaio1</code>, and <code>libmecab2</code>.</p>"},{"location":"apt-files.html","title":"Files in the DEB package built for Percona Server for MySQL 8.0","text":"Package Contains percona-server-server The database server itself, the mysqld binary and associated files. percona-server-common The files common to the server and client. percona-server-client The command line client. percona-server-dbg Debug symbols for the server. percona-server-test The database test suite. percona-server-source The server source. libperconaserverclient21-dev Header files needed to compile software to use the client library. libperconaserverclient21 The client-shared library. The version is incremented when there is an ABI change that requires software using the client library to be recompiled or its source code modified."},{"location":"apt-pinning.html","title":"Apt pinning the Percona Server for MySQL 8.0 packages","text":"<p>Pinning allows you to stay on a release and get packages from a different version. In some cases, you can pin selected packages and avoid accidentally upgrading all the packages. </p> <p>The pinning takes place in the <code>preference</code> file. To pin a package, set the <code>Pin-Priority</code> to higher numbers. </p> <p>Make a new file <code>/etc/apt/preferences.d/00percona.pref</code>. For example, add the following to the <code>preference</code> file:</p> <pre><code>Package: \nPin: release o=Percona Development Team\nPin-Priority: 1001\n</code></pre> <p>For more information about the pinning, you can check the official debian wiki.</p>"},{"location":"apt-repo.html","title":"Use an APT repository to install Percona Server for MySQL 8.0","text":"<p>Ready-to-use packages are available from the Percona Server for MySQL software repositories and the Percona downloads page.</p> <p>Specific information on the supported platforms, products, and versions is described in Percona Software and Platform Lifecycle.</p>"},{"location":"apt-repo.html#install-percona-server-for-mysql-using-apt","title":"Install Percona Server for MySQL using APT","text":"<ol> <li> <p>Update the package repositories:</p> <pre><code>$ sudo apt update\n</code></pre> </li> <li> <p>Install the <code>curl</code> download utility if needed:</p> <pre><code>$ sudo apt install curl\n</code></pre> </li> <li> <p>Download the <code>percona-release</code> repository package:</p> <pre><code>$ curl -O https://repo.percona.com/apt/percona-release_latest.generic_all.deb\n</code></pre> </li> <li> <p>Install the downloaded package with <code>apt</code> as root or with sudo:</p> <pre><code>$ sudo apt install gnupg2 lsb-release ./percona-release_latest.generic_all.deb\n</code></pre> </li> <li> <p>Refresh the local cache to update the package information:</p> <pre><code>$ sudo apt update\n</code></pre> </li> <li> <p>Use <code>percona-release</code> to set up the repository for the Percona Server for MySQL 8.0 version:</p> <pre><code>$ sudo percona-release setup ps80\n</code></pre> </li> <li> <p>You can check the repository setup for the Percona original release list in <code>/etc/apt/sources.list.d/percona-original-release.list</code>. </p> </li> <li> <p>Install the server package with the <code>percona-release</code> command:</p> <pre><code>$ sudo apt install percona-server-server\n</code></pre> </li> </ol> <p>See Configuring Percona repositories with <code>percona-release</code> for more information.</p> <p>Percona Server for MySQL 8.0 comes with the TokuDB and MyRocks storage engine and can be installed as a plugin. For information on installing and configuring MyRocks, refer to the Percona MyRocks Installation Guide.</p> <p>For information on installing and configuring TokuDB, refer to the TokuDB Installation Guide.</p> <p>From Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>From Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>Percona Server for MySQL contains user-defined functions from Percona Toolkit. These user-defined functions provide faster checksums. For more details on the user-defined functions, see Percona Toolkit UDF functions.</p> <p>After the installation completes, run the following commands to create these functions:</p> <pre><code>mysql -e \"CREATE FUNCTION fnv1a_64 RETURNS INTEGER SONAME 'libfnv1a_udf.so'\"\nmysql -e \"CREATE FUNCTION fnv_64 RETURNS INTEGER SONAME 'libfnv_udf.so'\"\nmysql -e \"CREATE FUNCTION murmur_hash RETURNS INTEGER SONAME 'libmurmur_udf.so'\"\n</code></pre>"},{"location":"apt-repo.html#install-the-percona-testing-repository-using-apt","title":"Install the Percona Testing repository using APT","text":"<p>Percona offers pre-release builds from the testing repository. To enable it, run percona-release with the <code>testing</code> argument. Run the following command as root or use the sudo command:</p> <pre><code>$ sudo percona-release enable ps80 testing\n</code></pre> <p>These builds should not be run in production. This build may not contain all of the features available in the final release. The features may change without notice.</p>"},{"location":"apt-run.html","title":"Run Percona Server for MySQL 8.0 after APT repository installation","text":"<p>Percona Server for MySQL stores the data files in <code>/var/lib/mysql/</code> by default. You can find the configuration file that is used to manage Percona Server for MySQL in <code>/etc/mysql/my.cnf</code>.</p> <p>Note</p> <p>Debian and Ubuntu installation doesn\u2019t automatically create a special <code>debian-sys-maint</code> user which can be used by the control scripts to control the Percona Server for MySQL <code>mysqld</code> and <code>mysqld_safe</code> services which was the case with previous Percona Server for MySQL versions. If you still require this user you\u2019ll need to create it manually.</p> <p>Run the following commands as root or by using the sudo command</p> <ol> <li> <p>Starting the service</p> <p>Percona Server for MySQL is started automatically after it gets installed unless it encounters errors during the installation process. You can also manually start it by running: <code>service mysql start</code></p> </li> <li> <p>Confirming that service is running. You can check the service status by     running: <code>service mysql status</code></p> </li> <li> <p>Stopping the service</p> <p>You can stop the service by running: <code>service mysql stop</code></p> </li> <li> <p>Restarting the service. <code>service mysql restart</code></p> </li> </ol> <p>Note</p> <p>Debian 9.0 (stretch) and Ubuntu 18.04 LTS (bionic) come with systemd as the default system and service manager. You can invoke all the above commands with <code>systemctl</code> instead of <code>service</code>. Currently, both are supported.</p>"},{"location":"apt-run.html#working-with-apparmor","title":"Working with AppArmor","text":"<p>For information on AppArmor, see Working with AppArmor.</p>"},{"location":"apt-uninstall-server.html","title":"Uninstall Percona Server for MySQL 8.0 using the APT package manager","text":"<p>To uninstall Percona Server for MySQL you\u2019ll need to remove all the installed packages. Removing packages with apt remove does not remove the configuration and data files. Removing the packages with apt purge does remove the packages with configuration files and data files (all the databases). Depending on your needs you can choose which command better suits you.</p> <ol> <li> <p>Stop the Percona Server for MySQL service: <code>service mysql stop</code></p> </li> <li> <p>Remove the packages</p> <ol> <li> <p>Remove the packages. This will leave the data files (databases, tables, logs, configuration, etc.) behind. In case you don\u2019t need them you\u2019ll need to remove them manually: <code>apt remove percona-server\\</code></p> </li> <li> <p>Purge the packages. This command removes all the packages and deletes all the data files (databases, tables, logs, and so on.): <code>apt purge percona-server\\</code></p> </li> </ol> </li> </ol>"},{"location":"audit-log-filter-compression-encryption.html","title":"Audit Log Filter compression and encryption","text":"<p>The feature is in tech preview.</p>"},{"location":"audit-log-filter-compression-encryption.html#compression","title":"Compression","text":"<p>You can enable compression for any format by setting the <code>audit_log_filter_compression</code> system variable when the server starts.</p> <p>The <code>audit_log_filter_compression</code> variable can be either of the following:</p> <ul> <li>NONE (no compression) - the default value</li> <li>GZIP - uses the GNU Zip compression</li> </ul> <p>If compression and encryption are enabled, the plugin applies compression before encryption. If you must manually recover a file with both settings, first decrypt the file and then uncompress the file.</p>"},{"location":"audit-log-filter-compression-encryption.html#encryption","title":"Encryption","text":"<p>You can encrypt any audit log filter file in any format. The audit log filter plugin generates the initial password, but you can use user-defined passwords after that. The plugin stores the passwords in the keyring, so that feature must be enabled.</p> <p>Set the <code>audit_log_filter_encryption</code> system variable with the server starts. The allowed values are the following:</p> <ul> <li>NONE - no encryption, the default value</li> <li>AES - AES-256-CBC (Cipher Block Chaining) encryption</li> </ul> <p>The AES uses the 256-bit key size.</p> <p>The following audit log filter functions are used with encryption:</p> HTML Table Generator Function name Description audit_log_encryption_password_set() Stores the password in the keyring. If encryption is enabled, the function also rotates the log file by renaming the current log file and creating a log file encrypted with the password. audit_log_encryption_password_get() Invoking this function without an argument returns the current encryption password. An argument that specifies the keyring ID of an archived password or current password returns that password by ID. <p>The <code>audit_log_filter_password_history_keep_days</code> variable is used with encryption. If the variable is not zero (0) , invoking <code>audit_log_encryption_password_set()</code> causes the expiration of archived audit log passwords.</p> <p>When the plugin starts with encryption enabled, the plugin checks if the keyring has an audit log filter encryption password. If no password is found, the plugin generates a random password and stores this password in the keyring. Use <code>audit_log_encryption_password_get()</code> to review this password.</p> <p>If compression and encryption are enabled, the plugin applies compression before encryption. If you must manually recover a file with both settings, first decrypt the file and then uncompress the file.</p>"},{"location":"audit-log-filter-compression-encryption.html#manually-uncompressing-and-decrypting-audit-log-filter-files","title":"Manually uncompressing and decrypting audit log filter files","text":"<p>To decrypt an encrypted log file, use the openssl command. For example:</p> <pre><code>openssl enc -d -aes-256-cbc -pass pass:password\n    -iter iterations -md sha256\n    -in audit.timestamp.log.pwd_id.enc\n    -out audit.timestamp.log\n</code></pre> <p>To execute that command, you must obtain a password and iterations. To do this, use <code>audit_log_encryption_password_get()</code>. </p> <p>This function gets the encryption password, and the iterations count and returns this data as a JSON-encoded string. For example, if the audit log file name is <code>audit.20190415T151322.log.20190414T223342-2.enc</code>, the password ID is <code>20190414T223342-2</code> and the keyring ID is <code>audit-log-20190414T223342-2</code>. </p> <p>Get the keyring password:</p> <pre><code>mysql&gt; SELECT audit_log_encryption_password_get('audit-log-20190414T223342-2');\n</code></pre> <p>The return value of this function may look like the following:</p> Expected output <pre><code>{\"password\":\"6i1Nx35CKMIaQaFzBrDzLpCq6gC\",\"iterations\":568977}\n</code></pre>"},{"location":"audit-log-filter-formats.html","title":"Audit Log Filter file format overview","text":"<p>The feature is in tech preview.</p> <p>When an auditable event occurs, the plugin writes a record to the log file.</p> <p>After the plugin starts, the first record lists the description of the server and the options at startup. After the first record, the auditable events are connections, disconnections, SQL statements executed, and so on. Statements within stored procedures or triggers are not logged, only the top-level statements.</p> <p>If files are referenced by <code>LOAD_DATA</code>, the contents are not logged.</p> <p>Set with the <code>audit_log_filter_format</code> system variable at startup. The available format types are the following;</p> Format Type Command Description XML (new style) <code>audit_log_filter_format=NEW</code> The default format XML (old style) <code>audit_log_filter_format=OLD</code> The original version of the XML format JSON <code>audit_log_filter_format=JSON</code> Files written as a JSON array <p>By default, the file contents in the new-style XML format are not compressed or encrypted.</p> <p>Changing the <code>audit_log_filter_format</code>, you should also change  the <code>audit_log_filter_file</code> name. For example, changing the <code>audit_log_filter_format</code>  to JSON, change the <code>audit_log_filter_file</code> to <code>audit.json</code>. If you don\u2019t change  the <code>audit_log_filter_file</code> name, then all audit log filter files have the same  base name and you won\u2019t be able to easily find when the format changed.</p>"},{"location":"audit-log-filter-json.html","title":"Audit Log Filter format - JSON","text":"<p>The feature is in tech preview.</p> <p>The JSON format has one top-level JSON array, which contain JSON objects with key-value pairs. These objects represent an event in the audit. Some pairs are listed in every audit record. The audit record type determines if other key-value pairs are listed. The order of the pairs within an audit record is not guaranteed. The value description may be truncated.</p> <p>Certain statistics, such as query time and size, are only available in the JSON format and help detect activity outliers when analyzed. </p> <p><pre><code>[\n  {\n    \"timestamp\": \"2023-03-29 11:17:03\",\n    \"id\": 0,\n    \"class\": \"audit\",\n    \"server_id\": 1\n  },\n  {\n    \"timestamp\": \"2023-03-29 11:17:05\",\n    \"id\": 1,\n    \"class\": \"command\",\n    \"event\": \"command_start\",\n    \"connection_id\": 1,\n    \"command_data\": {\n      \"name\": \"command_start\",\n      \"status\": 0,\n      \"command\": \"query\"}\n  },\n  {\n    \"timestamp\": \"2023-03-29 11:17:05\",\n    \"id\": 2,\n    \"class\": \"general\",\n    \"event\": \"log\",\n    \"connection_id\": 11,\n    \"account\": { \"user\": \"root[root] @ localhost []\", \"host\": \"localhost\" },\n    \"login\": { \"user\": \"root[root] @ localhost []\", \"os\": \"\", \"ip\": \"\", \"proxy\": \"\" },\n    \"general_data\": {\n      \"command\": \"Query\",\n      \"sql_command\": \"create_table\",\n      \"query\": \"CREATE TABLE t1 (c1 INT)\",\n      \"status\": 0}\n  },\n  {\n    \"timestamp\": \"2023-03-29 11:17:05\",\n    \"id\": 3,\n    \"class\": \"query\",\n    \"event\": \"query_start\",\n    \"connection_id\": 11,\n    \"query_data\": {\n      \"query\": \"CREATE TABLE t1 (c1 INT)\",\n      \"status\": 0,\n      \"sql_command\": \"create_table\"}\n  },\n  {\n    \"timestamp\": \"2023-03-29 11:17:05\",\n    \"id\": 4,\n    \"class\": \"query\",\n    \"event\": \"query_status_end\",\n    \"connection_id\": 11,\n    \"query_data\": {\n      \"query\": \"CREATE TABLE t1 (c1 INT)\",\n      \"status\": 0,\n      \"sql_command\": \"create_table\"}\n  },\n  {\n    \"timestamp\": \"2023-03-29 11:17:05\",\n    \"id\": 5,\n    \"class\": \"general\",\n    \"event\": \"status\",\n    \"connection_id\": 11,\n    \"account\": { \"user\": \"root[root] @ localhost []\", \"host\": \"localhost\" },\n    \"login\": { \"user\": \"root[root] @ localhost []\", \"os\": \"\", \"ip\": \"\", \"proxy\": \"\" },\n    \"general_data\": {\n      \"command\": \"Query\",\n      \"sql_command\": \"create_table\",\n      \"query\": \"CREATE TABLE t1 (c1 INT)\",\n      \"status\": 0}\n  },\n  {\n    \"timestamp\": \"2023-03-29 11:17:05\",\n    \"id\": 6,\n    \"class\": \"command\",\n    \"event\": \"command_end\",\n    \"connection_id\": 1,\n    \"command_data\": {\n      \"name\": \"command_end\",\n      \"status\": 0,\n      \"command\": \"query\"}\n  }\n]\n</code></pre> The order of the attributes within the JSON object can vary. Certain attributes are in every element. Other attributes are optional and depend on the type of event and the filter settings or plugin settings.</p> <p>The following fields are contained in each object:</p> <ul> <li><code>timestamp</code></li> <li><code>id</code></li> <li><code>class</code></li> <li><code>event</code></li> </ul> <p>The possible attributes in a JSON object are the following:</p> Name Description <code>class</code> Defines the type of event <code>account</code> Defines the MySQL account associated with the event. <code>connection_data</code> Defines the client connection. <code>connection_id</code> Defines the client connection identifier <code>event</code> Defines a subclass of the <code>event</code> class <code>general_data</code> Defines the executed statement or command when the audit record has a class value of <code>general</code>. <code>id</code> Defines the event ID <code>login</code> Defines how the client connected to the server <code>query_statistics</code> Defines optional query statistics and is used for outlier detection <code>shutdown_data</code> Defines the audit log filter termination <code>startup_data</code> Defines the initialization of the audit log filter plugin <code>table_access_data</code> Defines access to a table <code>time</code> Defines an integer that represents a UNIX timestamp <code>timestamp</code> Defines a UTC value in the <code>YYYY-MM_DD hh:mm:ss</code> format"},{"location":"audit-log-filter-naming.html","title":"Audit Log Filter file naming conventions","text":"<p>The feature is in tech preview.</p>"},{"location":"audit-log-filter-naming.html#name-qualities","title":"Name qualities","text":"<p>The audit log filter file name has the following qualities:</p> <ul> <li>Optional directory name</li> <li>Base name</li> <li>Optional suffix</li> </ul> <p>Using either compression or encryption adds the following suffixes:</p> <ul> <li>Compression adds the <code>.gz</code> suffix</li> <li>Encryption adds the <code>pwd_id.enc</code> suffix</li> </ul> <p>The <code>pwd_id</code> represents the password used for encrypting the log files. The audit log filter plugin stores passwords in the keyring.</p> <p>You can combine compression and encryption, which adds both suffixes to the <code>audit_filter.log</code> name.</p> <p>The following table displays the possible ways a file can be named:</p> HTML Table Generator Default name Enabled feature audit.log\u00a0 No compression or encryption\u00a0 \u00a0audit.log.gz Compression\u00a0 \u00a0audit.log.pwd_id.enc \u00a0Encryption audit.log.gz.pwd_id.enc\u00a0 Compression, encryption"},{"location":"audit-log-filter-naming.html#encryption-id-format","title":"Encryption ID format","text":"<p>The format for <code>pwd_id</code> is the following:</p> <ul> <li>A UTC value in <code>YYYYMMDDThhmmss</code> format that represents when the password was created</li> <li>A sequence number that starts at <code>1</code> and increases if passwords have the same timestamp value</li> </ul> <p>The following are examples of pwd_id values:</p> <pre><code>20230417T082215-1\n20230301T061400-1\n20230301T061400-2\n</code></pre> <p>The following example is a list of the audit log filter files with the <code>pwd_id</code>:</p> <pre><code>audit_filter.log.20230417T082215-1.enc\naudit_filter.log.20230301T061400-1.enc\naudit_filter.log.20230301T061400-2.enc\n</code></pre> <p>The current password has the largest sequence number.</p>"},{"location":"audit-log-filter-naming.html#renaming-operations","title":"Renaming operations","text":"<p>During initialization, the plugin checks if a file with that name exists.  If it does, the plugin renames the file. The plugin writes to an empty file.</p> <p>During termination, the plugin renames the file.</p>"},{"location":"audit-log-filter-new.html","title":"Audit Log Filter format - XML (new style)","text":"<p>The feature is in tech preview.</p> <p>The filter writes the audit log filter file in XML. The XML file uses  UTF-8.</p> <p>The  is the root element and this element contains   elements. Each  element contains specific  information about an event that is audited.  <p>For each new file, the Audit Log Filter plugin writes the XML  declaration and the root element tag. The plugin writes the closing   root element when closing the file. If the file is open, this  closing element is not available.</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;AUDIT&gt;\n    &lt;AUDIT_RECORD&gt;\n        &lt;NAME&gt;Audit&lt;/NAME&gt;\n        &lt;RECORD_ID&gt;0_2023-03-29T11:11:43&lt;/RECORD_ID&gt;\n        &lt;TIMESTAMP&gt;2023-03-29T11:11:43&lt;/TIMESTAMP&gt;\n        &lt;SERVER_ID&gt;1&lt;/SERVER_ID&gt;\n    &lt;/AUDIT_RECORD&gt;\n    &lt;AUDIT_RECORD&gt;\n        &lt;NAME&gt;Command Start&lt;/NAME&gt;\n        &lt;RECORD_ID&gt;1_2023-03-29T11:11:45&lt;/RECORD_ID&gt;\n        &lt;TIMESTAMP&gt;2023-03-29T11:11:45&lt;/TIMESTAMP&gt;\n        &lt;STATUS&gt;0&lt;/STATUS&gt;\n        &lt;CONNECTION_ID&gt;1&lt;/CONNECTION_ID&gt;\n        &lt;COMMAND_CLASS&gt;query&lt;/COMMAND_CLASS&gt;\n    &lt;/AUDIT_RECORD&gt;\n    &lt;AUDIT_RECORD&gt;\n        &lt;NAME&gt;Query&lt;/NAME&gt;\n        &lt;RECORD_ID&gt;2_2023-03-29T11:11:45&lt;/RECORD_ID&gt;\n        &lt;TIMESTAMP&gt;2023-03-29T11:11:45&lt;/TIMESTAMP&gt;\n        &lt;COMMAND_CLASS&gt;create_table&lt;/COMMAND_CLASS&gt;\n        &lt;CONNECTION_ID&gt;11&lt;/CONNECTION_ID&gt;\n        &lt;HOST&gt;localhost&lt;/HOST&gt;\n        &lt;IP&gt;&lt;/IP&gt;\n        &lt;USER&gt;root[root] @ localhost []&lt;/USER&gt;\n        &lt;OS_LOGIN&gt;&lt;/OS_LOGIN&gt;\n        &lt;SQLTEXT&gt;CREATE TABLE t1 (c1 INT)&lt;/SQLTEXT&gt;\n        &lt;STATUS&gt;0&lt;/STATUS&gt;\n    &lt;/AUDIT_RECORD&gt;\n    &lt;AUDIT_RECORD&gt;\n        &lt;NAME&gt;Query Start&lt;/NAME&gt;\n        &lt;RECORD_ID&gt;3_2023-03-29T11:11:45&lt;/RECORD_ID&gt;\n        &lt;TIMESTAMP&gt;2023-03-29T11:11:45&lt;/TIMESTAMP&gt;\n        &lt;STATUS&gt;0&lt;/STATUS&gt;\n        &lt;CONNECTION_ID&gt;11&lt;/CONNECTION_ID&gt;\n        &lt;COMMAND_CLASS&gt;create_table&lt;/COMMAND_CLASS&gt;\n        &lt;SQLTEXT&gt;CREATE TABLE t1 (c1 INT)&lt;/SQLTEXT&gt;\n    &lt;/AUDIT_RECORD&gt;\n    &lt;AUDIT_RECORD&gt;\n        &lt;NAME&gt;Query&lt;/NAME&gt;\n        &lt;RECORD_ID&gt;4_2023-03-29T11:11:45&lt;/RECORD_ID&gt;\n        &lt;TIMESTAMP&gt;2023-03-29T11:11:45&lt;/TIMESTAMP&gt;\n        &lt;COMMAND_CLASS&gt;create_table&lt;/COMMAND_CLASS&gt;\n        &lt;CONNECTION_ID&gt;11&lt;/CONNECTION_ID&gt;\n        &lt;HOST&gt;localhost&lt;/HOST&gt;\n        &lt;IP&gt;&lt;/IP&gt;\n        &lt;USER&gt;root[root] @ localhost []&lt;/USER&gt;\n        &lt;OS_LOGIN&gt;&lt;/OS_LOGIN&gt;\n        &lt;SQLTEXT&gt;CREATE TABLE t1 (c1 INT)&lt;/SQLTEXT&gt;\n        &lt;STATUS&gt;0&lt;/STATUS&gt;\n    &lt;/AUDIT_RECORD&gt;\n    &lt;AUDIT_RECORD&gt;\n        &lt;NAME&gt;Command End&lt;/NAME&gt;\n        &lt;RECORD_ID&gt;5_2023-03-29T11:11:45&lt;/RECORD_ID&gt;\n        &lt;TIMESTAMP&gt;2023-03-29T11:11:45&lt;/TIMESTAMP&gt;\n        &lt;STATUS&gt;0&lt;/STATUS&gt;\n        &lt;CONNECTION_ID&gt;1&lt;/CONNECTION_ID&gt;\n        &lt;COMMAND_CLASS&gt;query&lt;/COMMAND_CLASS&gt;\n    &lt;/AUDIT_RECORD&gt;\n&lt;/AUDIT&gt;\n</code></pre> <p>The order of the attributes within an  can vary. Certain attributes are in every element. Other attributes are optional and depend on the type of audit record. <p>The attributes in every element are the following:</p> HTML Table Generator Attribute Name Description \u00a0&lt;NAME&gt; The action that generated the audit record. \u00a0&lt;RECORD_ID&gt; The &lt;RECORD_ID&gt; consists of a sequence number and a timestamp value. The sequence number is initialized when the plugin opens the audit log filter file. \u00a0&lt;TIMESTAMP&gt; Displays the date and time when the audit event happened. <p>The optional attributes are the following:</p> HTML Table Generator Attribute Name Description \u00a0&lt;COMMAND_CLASS&gt; Contains the type of performed action.\u00a0 \u00a0&lt;CONNECTION_ID&gt; Contains the client connection identifier. \u00a0&lt;CONNECTION_ATTRIBUTES&gt; Contains the client connection attributes. Each attribute has a &lt;NAME&gt; and &lt;VALUE&gt; pair. \u00a0&lt;CONNECTION_TYPE&gt; Contains the type of connection security.\u00a0 \u00a0&lt;DB&gt; Contains the database name. \u00a0&lt;HOST&gt; Contains the client's hostname. \u00a0&lt;IP&gt; Contains the client's IP address. \u00a0&lt;MYSQL_VERSION&gt; Contains the MySQL server version. \u00a0&lt;OS_LOGIN&gt; Contains the user name used during an external authentication, for example, if the user is authenticated through an LDAP plugin. If the authentication plugin does not set a value or the user is authenticated using MySQL authentication, this value is empty. \u00a0&lt;OS_VERSION&gt; Contains the server's operating system. \u00a0&lt;PRIV_USER&gt; Contains the user name used by the server when checking privileges. This name may be different than &lt;USER&gt;. \u00a0&lt;PROXY_USER&gt; Contains the proxy user. If a proxy is not used, the value is empty. \u00a0&lt;SERVER_ID&gt; Contains the server ID. \u00a0&lt;SQLTEXT&gt; Contains the text of the SQL statement. \u00a0&lt;STARTUP_OPTIONS&gt; Contains the startup options. These options may be provided by the command line or files. \u00a0&lt;STATUS&gt; Contains the status of a command. A 0 (zero) is a success. A nonzero value is an error. \u00a0&lt;STATUS_CODE&gt; Contains the status of a command, which either succeeds (0) or an error occurred (1). \u00a0&lt;TABLE&gt; Contains the table name. \u00a0&lt;USER&gt; Contains the user name from the client. This name may be different than &lt;PRIV_USER&gt;. \u00a0&lt;VERSION&gt; Contains the audit log filter format."},{"location":"audit-log-filter-old.html","title":"Audit Log Filter format - XML (old style)","text":"<p>The feature is in tech preview.</p> <p>The old style XML format uses <code>&lt;AUDIT&gt;</code> tag as the root element and adds the <code>&lt;/AUDIT&gt;</code> tag when the file closes. Each audited event is contained in an  element.  <p>The order of the attributes within an  can vary. Certain attributes are in every element. Other attributes are optional and depend on the type of audit record. <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;AUDIT&gt;\n  &lt;AUDIT_RECORD\n    NAME=\"Audit\"\n    RECORD_ID=\"0_2023-03-29T11:15:52\"\n    TIMESTAMP=\"2023-03-29T11:15:52\"\n    SERVER_ID=\"1\"/&gt;\n  &lt;AUDIT_RECORD\n    NAME=\"Command Start\"\n    RECORD_ID=\"1_2023-03-29T11:15:53\"\n    TIMESTAMP=\"2023-03-29T11:15:53\"\n    STATUS=\"0\"\n    CONNECTION_ID=\"1\"\n    COMMAND_CLASS=\"query\"/&gt;\n  &lt;AUDIT_RECORD\n    NAME=\"Query\"\n    RECORD_ID=\"2_2023-03-29T11:15:53\"\n    TIMESTAMP=\"2023-03-29T11:15:53\"\n    COMMAND_CLASS=\"create_table\"\n    CONNECTION_ID=\"11\"\n    HOST=\"localhost\"\n    IP=\"\"\n    USER=\"root[root] @ localhost []\"\n    OS_LOGIN=\"\"\n    SQLTEXT=\"CREATE TABLE t1 (c1 INT)\"\n    STATUS=\"0\"/&gt;\n  &lt;AUDIT_RECORD\n    NAME=\"Query Start\"\n    RECORD_ID=\"3_2023-03-29T11:15:53\"\n    TIMESTAMP=\"2023-03-29T11:15:53\"\n    STATUS=\"0\"\n    CONNECTION_ID=\"11\"\n    COMMAND_CLASS=\"create_table\"\n    SQLTEXT=\"CREATE TABLE t1 (c1 INT)\"/&gt;\n  &lt;AUDIT_RECORD\n    NAME=\"Query Status End\"\n    RECORD_ID=\"4_2023-03-29T11:15:53\"\n    TIMESTAMP=\"2023-03-29T11:15:53\"\n    STATUS=\"0\"\n    CONNECTION_ID=\"11\"\n    COMMAND_CLASS=\"create_table\"\n    SQLTEXT=\"CREATE TABLE t1 (c1 INT)\"/&gt;\n  &lt;AUDIT_RECORD\n    NAME=\"Query\"\n    RECORD_ID=\"5_2023-03-29T11:15:53\"\n    TIMESTAMP=\"2023-03-29T11:15:53\"\n    COMMAND_CLASS=\"create_table\"\n    CONNECTION_ID=\"11\"\n    HOST=\"localhost\"\n    IP=\"\"\n    USER=\"root[root] @ localhost []\"\n    OS_LOGIN=\"\"\n    SQLTEXT=\"CREATE TABLE t1 (c1 INT)\"\n    STATUS=\"0\"/&gt;\n  &lt;AUDIT_RECORD\n    NAME=\"Command End\"\n    RECORD_ID=\"6_2023-03-29T11:15:53\"\n    TIMESTAMP=\"2023-03-29T11:15:53\"\n    STATUS=\"0\"\n    CONNECTION_ID=\"1\"\n    COMMAND_CLASS=\"query\"/&gt;\n&lt;/AUDIT&gt;\n</code></pre> <p>The required attributes are the following:</p> HTML Table Generator Attribute Name Description \u00a0NAME \u00a0The action that generated the audit record. \u00a0RECORD_ID \u00a0The RECORD_ID consists of a sequence number and a timestamp value. The sequence number is initialized when the plugin opens the audit log filter file. \u00a0TIMESTAMP \u00a0Displays the date and time when the audit event happened. <p>The optional attributes are the following:</p> HTML Table Generator Attribute Name Description COMMAND_CLASS Type of action performed CONNECTION_ID Client connection identifier CONNECTION_TYPE Connection security type DB Database name HOST Client's hostname IP Client's IP address MYSQL_VERSION Server version OS_LOGIN The user name used during an external authentication, for example, if the user is authenticated through an LDAP plugin. If the authentication plugin does not set a value or the user is authenticated using MySQL authentication, this value is empty. OS_VERSION Server's operating system PRIV_USER The user name used by the server when checking privileges. This name may be different than USER. PROXY_USER The proxy user. If a proxy is not used, the value is empty. SERVER_ID Server Identifier SQLTEXT SQL statement text STARTUP_OPTIONS Server startup options, either command line or config files STATUS Command's status - a 0 (zero) is a success, a non-zero is an error STATUS_CODE A 0 (zero) is a success, a non-zero is an error TABLE Table name USER \u00a0Client's user name - this name may be different than PRIV_USER. VERSION Format of audit log filter"},{"location":"audit-log-filter-overview.html","title":"Audit Log Filter overview","text":"<p>The feature is in tech preview.</p> <p>The Audit Log Filter plugin allows you to monitor, log, and block a connection or query actively executed on the selected server. </p> <p>Enabling the plugin produces a log file that contains a record of server activity. The log file has information on connections and databases accessed by that connection. </p> <p>The plugin uses the <code>mysql</code> system database to store filter and user account data. Set the <code>audit_log_filter_database</code> variable at server startup to select a different database.</p> <p>The <code>AUDIT_ADMIN</code> privilege is required to enable users to manage the Audit Log Filter plugin.</p>"},{"location":"audit-log-filter-overview.html#privileges","title":"Privileges","text":"<p>Define the privilege at runtime at the startup of the server. The associated Audit Log Filter privilege can be unavailable if the plugin is not enabled.</p>"},{"location":"audit-log-filter-overview.html#audit_admin","title":"<code>AUDIT_ADMIN</code>","text":"<p>This privilege is defined by the server and enables the user to configure the plugin.</p>"},{"location":"audit-log-filter-overview.html#audit_abort_exempt","title":"<code>AUDIT_ABORT_EXEMPT</code>","text":"<p>This privilege allows queries from a user account to always be executed. An <code>abort</code> item does not block them. This ability lets the user account regain access to a system if an audit is misconfigured. The query is logged due to the privilege. User accounts with the <code>SYSTEM_USER</code> privilege have the <code>AUDIT_ABORT_EXEMPT</code> privilege.</p>"},{"location":"audit-log-filter-overview.html#audit-log-filter-tables","title":"Audit Log Filter tables","text":"<p>The Audit Log Filter plugin uses <code>mysql</code> system database tables in the <code>InnoDB</code> storage engine. These tables store user account data and filter data. When you start the server, change the plugin\u2019s database with the <code>audit_log_filter_database</code> variable.</p> <p>The <code>audit_log_filter</code> table stores the definitions of the filters and has the following column definitions:</p> HTML Table Generator Column name Description \u00a0NAME \u00a0Name of the filter \u00a0FILTER \u00a0Definition of the filter linked to the name as a JSON value <p>The <code>audit_log_user</code> table stores account data and has the following column definitions:</p> HTML Table Generator Column name Description \u00a0USER \u00a0The account name of the user \u00a0HOST \u00a0The account name of the host \u00a0FILTERNAME \u00a0The account filter name"},{"location":"audit-log-filter-restrictions.html","title":"Audit Log Filter restrictions","text":"<p>The feature is in tech preview.</p>"},{"location":"audit-log-filter-restrictions.html#general-restrictions","title":"General restrictions","text":"<p>The Audit Log Filter has the following general restrictions:</p> <ul> <li> <p>Logs only SQL statements. Statements made by NoSQL APIs, such as the Memcached API, are not logged.</p> </li> <li> <p>Logs only the top-level statement. Statements within a stored procedure or a trigger are not logged. Does not log the file contents for statements like <code>LOAD_DATA</code>.</p> </li> <li> <p>If used with a cluster, the plugin must be installed on each server used to execute SQL on the cluster.</p> </li> <li> <p>If used with a cluster, the application or user is responsible for aggregating all the data of each server used in the cluster.</p> </li> </ul>"},{"location":"audit-log-filter-security.html","title":"Audit Log Filter security","text":"<p>The feature is in tech preview.</p> <p>The Audit Log Filter plugin generates audit log filter files. The directory  that contains these files should be accessible only to the following:</p> <ul> <li> <p>Users who must be able to view the log</p> </li> <li> <p>Server must be able to write to the directory</p> </li> </ul> <p>The files are not encrypted by default and may contain sensitive information.</p> <p>The default name for the file in the data directory is <code>audit_filter.log</code>. If needed, use the <code>audit_log_filter_file</code> system variable at server startup to change the location. Due to the log rotation, multiple audit log files may exist.</p>"},{"location":"audit-log-filter-variables.html","title":"Audit log filter functions, options and variables","text":"<p>This feature is in technical preview.</p> <p>The following sections describe the functions, options, and variables available in the audit log filter plugin.</p>"},{"location":"audit-log-filter-variables.html#audit-log-filter-functions","title":"Audit log filter functions","text":"<p>The following audit log filter functions are available.</p> Function name audit_log_encryption_password_get(keyring_id) audit_log_encryption_password_set(new_password) audit_log_filter_flush() audit_log_read() audit_log_read_bookmark() audit_log_filter_remove_filter(filter_name) audit_log_filter_remove_user(user_name) audit_log_rotate() audit_log_filter_set_filter(filter_name, definition) audit_log_filter_set_user(user_name, filter_name)"},{"location":"audit-log-filter-variables.html#audit_log_encryption_password_getkeyring_id","title":"audit_log_encryption_password_get(keyring_id)","text":"<p>This function returns the encryption password. Any keyring plugin or keyring component can be used, but the plugin or component must be enabled. If the plugin or component is not enabled, an error occurs.</p>"},{"location":"audit-log-filter-variables.html#parameters","title":"Parameters","text":"<p><code>keyring_id</code> - If the function does not contain a keyring_id, the function returns the current encryption password. You can also request a specific encryption password with the keyring ID of either the current password or an archived password.</p>"},{"location":"audit-log-filter-variables.html#returns","title":"Returns","text":"<p>This function returns a JSON object containing the password, iterations count used by the password.</p>"},{"location":"audit-log-filter-variables.html#example","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_encryption_password_get();\n</code></pre> Expected output <pre><code>+---------------------------------------------+\n| audit_log_encryption_password_get()         |\n+---------------------------------------------+\n| {\"password\":\"passw0rd\",\"iterations\":5689}   |\n+---------------------------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_encryption_password_setnew_password","title":"audit_log_encryption_password_set(new_password)","text":"<p>This function sets the encryption password and stores the new password in the keyring. </p>"},{"location":"audit-log-filter-variables.html#parameters_1","title":"Parameters","text":"<p><code>password</code> - the password as a string. The maximum length is 766 bytes.</p>"},{"location":"audit-log-filter-variables.html#returns_1","title":"Returns","text":"<p>This function returns a string. An <code>OK</code> indicates a success. <code>ERROR</code> indicates a failure.</p>"},{"location":"audit-log-filter-variables.html#example_1","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_encryption_password_set(passw0rd);\n</code></pre> Expected output <pre><code>+-----------------------------------------------------+\n| audit_log_encryption_password_set(passw0rd)         |\n+-----------------------------------------------------+\n| OK                                                  |\n+-----------------------------------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_filter_flush","title":"audit_log_filter_flush()","text":"<p>This function updates the audit log filter tables and makes any changes operational. </p> <p>Modifying the audit log filter tables directly with <code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code> does not implement the modifications immediately. The tables must be flushed to have those changes take effect. </p> <p>This function forces reloading all filters and should only be used if someone has modified the tables directly. </p> <p>Important</p> <p>Avoid using this function. This function performs an operation that is similar to uninstalling and reinstalling the plugin. Filters are detached from all current sessions. To restart logging, the current sessions must either disconnect and reconnect or do a change-user operation. </p>"},{"location":"audit-log-filter-variables.html#parameters_2","title":"Parameters","text":"<p>None.</p>"},{"location":"audit-log-filter-variables.html#returns_2","title":"Returns","text":"<p>This function returns either an <code>OK</code> for success or an error message for failure.</p>"},{"location":"audit-log-filter-variables.html#example_2","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_filter_flush();\n</code></pre> Expected output <pre><code>+--------------------------+\n| audit_log_filter_flush() |\n+--------------------------+\n| OK                       |\n+--------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_read","title":"audit_log_read()","text":"<p>If the audit log filter format is JSON, this function reads the audit log and returns an array of the audit events as a JSON string. Generates an error if the format is not JSON.</p>"},{"location":"audit-log-filter-variables.html#parameters_3","title":"Parameters","text":"<p>None. If the start position is not provided, the read continues from the current position. </p> <p>Optional: You can specify a starting position for the read with <code>start</code> or a <code>timestamp</code> and an <code>id</code>, both items are considered a bookmark and can be used to identify an event. You must include both (<code>timestamp</code> and <code>id</code>) or an error is generated. If the <code>timestamp</code> does not include a <code>time</code> section, the function assumes  the time is <code>00:00</code>.</p> <p>You can also provide a <code>max_array_length</code> to limit the number of log events.</p> <p>Call<code>audit_log_read_bookmark()</code> to return the most recently written event.</p>"},{"location":"audit-log-filter-variables.html#returns_3","title":"Returns","text":"<p>This function returns a string of a JSON array of the audit events, or a JSON NULL value. Returns <code>NULL</code> and generates an error if the call fails.</p>"},{"location":"audit-log-filter-variables.html#example_3","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_read(audit_log_read_bookmark());\n</code></pre> Expected output <pre><code>+------------------------------------------------------------------------------+\n| audit_log_read(audit_log_read_bookmark())                                   |\n+------------------------------------------------------------------------------+\n| [{\"timestamp\" : \"2023-06-02 09:43:25\", \"id\": 10,\"class\":\"connection\",]       |\n+------------------------------------------------------------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_read_bookmark","title":"audit_log_read_bookmark()","text":"<p>This function provides a bookmark for the most recently written audit log event as a JSON string. Generates an error if the format is not JSON.</p> <p>If this function is used with [<code>audit_log_read()](#audit_log_read), the</code>audit_log_read()` function starts reading at that position.</p>"},{"location":"audit-log-filter-variables.html#parameters_4","title":"Parameters","text":"<p>None.</p>"},{"location":"audit-log-filter-variables.html#returns_4","title":"Returns","text":"<p>This function returns a <code>JSON</code> string containing a bookmark for success or  <code>NULL</code> and an error for failure.</p>"},{"location":"audit-log-filter-variables.html#example_4","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_read_bookmark();\n</code></pre> Expected output <pre><code>+----------------------------------------------------+\n| audit_log_read_bookmark()                          |\n+----------------------------------------------------+\n| {\"timestamp\" : \"2023-06-02 09:43:25\", \"id\": 10 }   |\n+----------------------------------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_filter_remove_filterfilter_name","title":"audit_log_filter_remove_filter(filter_name)","text":"<p>This function removes the selected filter from the current set of filters.</p> <p>If user accounts are assigned the selected filter, the user accounts are no longer filtered. The user accounts are removed from <code>audit_log_filter_user</code>. If the user accounts are in a current session, they are detached from the selected filter and no longer logged.</p>"},{"location":"audit-log-filter-variables.html#parameters_5","title":"Parameters","text":"<p><code>filter_name</code> - a selected filter name as a string.</p>"},{"location":"audit-log-filter-variables.html#returns_5","title":"Returns","text":"<p>This function returns either an <code>OK</code> for success or an error message for failure.</p> <p>If the filter name does not exist, no error is generated. </p>"},{"location":"audit-log-filter-variables.html#example_5","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_filter_remove_filter('filter-name');\n</code></pre> Expected output <pre><code>+------------------------------------------------+\n| audit_log_filter_remove_filter('filter-name')  |\n+------------------------------------------------+\n| OK                                             |\n+------------------------------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_filter_remove_useruser_name","title":"audit_log_filter_remove_user(user_name)","text":"<p>This function removes the assignment of a filter from the selected user account.</p> <p>If the user account is in a current session, they are not affected. New sessions for this user account use the default account filter or are not logged.</p> <p>If the user-name is <code>%</code>, the default account filter is removed.</p>"},{"location":"audit-log-filter-variables.html#parameters_6","title":"Parameters","text":"<p><code>user_name</code> - a selected user name in either the <code>user_name</code>@<code>host_name</code> format or <code>%</code>.</p>"},{"location":"audit-log-filter-variables.html#returns_6","title":"Returns","text":"<p>This function returns either an <code>OK</code> for success or an error message for failure.</p> <p>If the user_name has no filter assigned, no error is generated. </p>"},{"location":"audit-log-filter-variables.html#example_6","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_filter_remove_user('user-name@localhost');\n</code></pre> Expected output <pre><code>+------------------------------------------------------+\n| audit_log_filter_remove_user('user-name@localhost')  |\n+------------------------------------------------------+\n| OK                                                   |\n+------------------------------------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_rotate","title":"audit_log_rotate()","text":""},{"location":"audit-log-filter-variables.html#parameters_7","title":"Parameters","text":"<p>None.</p>"},{"location":"audit-log-filter-variables.html#returns_7","title":"Returns","text":"<p>This function returns renamed file name.</p>"},{"location":"audit-log-filter-variables.html#example_7","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_filter_rotate();\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_filter_set_filterfilter_name-definition","title":"audit_log_filter_set_filter(filter_name, definition)","text":"<p>This function, when provided with a filter name and definition, adds the filter. </p> <p>The new filter has a different filter ID. Generates an error if the filter name exists.</p>"},{"location":"audit-log-filter-variables.html#parameters_8","title":"Parameters","text":"<ul> <li> <p><code>filter_name</code> - a selected filter name as a string.</p> </li> <li> <p><code>definition</code> - Defines the definition as a JSON value.</p> </li> </ul>"},{"location":"audit-log-filter-variables.html#returns_8","title":"Returns","text":"<p>This function returns either an <code>OK</code> for success or an error message for failure.</p>"},{"location":"audit-log-filter-variables.html#example_8","title":"Example","text":"<pre><code>mysql&gt; SET @filter = '{ \"filter_name\": { \"log\": true }}'\nmysql&gt; SET audit_log_filter_set_filter('filter-name', @filter);\n</code></pre> Expected output <pre><code>+-------------------------------------------------------------+\n| audit_log_filter_set_filter('filter-name', @filter)  |\n+-------------------------------------------------------------+\n| OK                                                          |\n+-------------------------------------------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit_log_filter_set_useruser_name-filter_name","title":"audit_log_filter_set_user(user_name, filter_name)","text":"<p>This function assigns the filter to the selected user account.</p> <p>A user account can only have one filter. If the user account already has a filter, this function replaces the current filter. If the user account is in a current session, nothing happens. When the user account connects again the new filter is used.</p> <p>The user name, <code>%</code>, is the default account. The filter assigned to <code>%</code> is used by any user account without a defined filter.</p>"},{"location":"audit-log-filter-variables.html#parameters_9","title":"Parameters","text":"<ul> <li> <p><code>user_name</code> - a selected user name in either the <code>user_name</code>@<code>host_name</code> format or <code>%</code>.</p> </li> <li> <p><code>filter_name</code> - a selected filter name as a string.</p> </li> </ul>"},{"location":"audit-log-filter-variables.html#returns_9","title":"Returns","text":"<p>This function returns either an <code>OK</code> for success or an error message for failure.</p>"},{"location":"audit-log-filter-variables.html#example_9","title":"Example","text":"<pre><code>mysql&gt; SELECT audit_log_filter_set_user('user-name@localhost', 'filter-name');\n</code></pre> Expected output <pre><code>+-------------------------------------------------------------------+\n| audit_log_filter_set_user('user-name@localhost', 'filter-name')  |\n+-------------------------------------------------------------------+\n| OK                                                                |\n+-------------------------------------------------------------------+\n</code></pre>"},{"location":"audit-log-filter-variables.html#audit-log-filter-options-and-variables","title":"Audit log filter options and variables","text":"Name <code>audit-log-filter</code> <code>audit_log_buffer_size</code> <code>audit_log_filter_compression</code> <code>audit_log_filter_database</code> <code>audit_log_filter_disable</code> <code>audit_log_filter_encryption</code> <code>audit_log_filter_file</code> <code>audit_log_filter_filter_id</code> <code>audit_log_filter_format</code> <code>audit_log_filter_format_unix_timestamp</code> <code>audit_log_filter_handler</code> <code>audit_log_filter_key_derivation_iterations_count_mean</code> <code>audit_log_filter_max_size</code> <code>audit_log_filter_keep_password_history_keep_days</code> <code>audit_log_filter_prune_seconds</code> <code>audit_log_filter_read_buffer_size</code> <code>audit_log_filter_rotate_on_size</code> <code>audit_log_filter_strategy</code> <code>audit_log_filter_syslog_tag</code> <code>audit_log_filter_syslog_priority</code>"},{"location":"audit-log-filter-variables.html#audit-log-filter","title":"<code>audit-log-filter</code>","text":"Option Description Command-line \u2013audit-log-filter[=value] Dynamic No Scope Data type Enumeration Default ON <p>This option determines how, at startup, the server loads the <code>audit_log_filter</code> plugin. The plugin must be registered. </p> <p>The valid values are the following:</p> <ul> <li>ON</li> <li>OFF</li> <li>FORCE</li> <li>FORCE_PLUS_PERMANENT</li> </ul>"},{"location":"audit-log-filter-variables.html#audit_log_filter_buffer_size","title":"<code>audit_log_filter_buffer_size</code>","text":"Option name Description Command-line \u2013audit-log-filter-buffer-size Dynamic No Scope Global Data type Integer Default 1048576 Minimum value 4096 Maximum value 18446744073709547520 Units byes Block size 4096 <p>This variable defines the buffer size in multiples of 4096 when logging is asynchronous. The contents for events are stored in a buffer. The contents are stored until the contents are written.</p> <p>The plugin initializes a single buffer and removes the buffer when the plugin terminates.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_compression","title":"<code>audit_log_filter_compression</code>","text":"Option name Description Command-line \u2013audit-log-filter-compression Dynamic Yes Scope Global Data type Enumeration Default NONE Valid values NONE or GZIP <p>This variable defines the compression type for the audit log filter file. The values can be either <code>NONE</code>, the default value and file has no compression, or <code>GZIP</code>.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_database","title":"<code>audit_log_filter_database</code>","text":"Option name Description Command-line \u2013audit-log-filter-database Dynamic No Scope Global Data type String Default mysql <p>This variable defines the audit_log_filter database. This read-only variable stores the necessary tables. Set this option at system startup. The database name cannot exceed 64 characters or be <code>NULL</code>.</p> <p>An invalid database name prevents the use of audit log filter plugin.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_disable","title":"<code>audit_log_filter_disable</code>","text":"Option name Description Command-line \u2013audit-log-filter-disable Dynamic Yes Scope Global Data type Boolean Default OFF <p>This variable disables the plugin logging for all connections and any sessions. </p> <p>This variable requires the user account to have <code>SYSTEM_VARIABLES_ADMIN</code> and <code>AUDIT_ADMIN</code> privileges.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_encryption","title":"<code>audit_log_filter_encryption</code>","text":"Option name Description Command-line \u2013audit-log-filter-encryption Dynamic No Scope Global Data type Enumeration Default NONE Valid values NONE or AES <p>This variable defines the encryption type for the audit log filter file. The values can be either of the following:</p> <ul> <li><code>NONE</code> - the default value, no encryption</li> <li><code>AES</code> </li> </ul>"},{"location":"audit-log-filter-variables.html#audit_log_filter_file","title":"<code>audit_log_filter_file</code>","text":"Option name Description Command-line \u2013audit-log-filter-file Dynamic No Scope Global Data type String Default audit_filter.log <p>This variable defines the name and suffix of the audit log filter file. The plugin writes events to this file.</p> <p>The file name and suffix can be either of the following:</p> <ul> <li>a relative path name - the plugin looks for this file in the data directory</li> <li>a full path name - the plugin uses the given value</li> </ul> <p>If you use a full path name, ensure the directory is accessible only to users who need to view the log and the server.</p> <p>For more information, see Naming conventions</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_filter_id","title":"<code>audit_log_filter_filter_id</code>","text":"Option name Description Command-line \u2013audit-log-filter-file-id Dynamic No Scope Session Data type Integer Default 0 Minimum value 0 Maximum value 4292967295 <p>This variable defines the internal ID of the audit log filter in the current session.</p> <p>The default value is 0 (zero) - the session has no assigned filter.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_format","title":"<code>audit_log_filter_format</code>","text":"Option name Description Command-line \u2013audit-log-filter-format Dynamic No Scope Global Data type Enumeration Default NEW Available values OLD, NEW, JSON <p>This variable defines the audit log filter file format. </p> <p>The available values are the following: </p> <ul> <li>OLD (old-style XML)</li> <li>NEW (new-style XML) and </li> <li>JSON.</li> </ul>"},{"location":"audit-log-filter-variables.html#audit_log_filter_format_unix_timestamp","title":"<code>audit_log_filter_format_unix_timestamp</code>","text":"Option name Description Command-line \u2013audit-log-filter-format-unix-timestamp Dynamic Yes Scope Global Data type Boolean Default OFF <p>This option is only supported for JSON-format files.</p> <p>Enabling this option adds a <code>time</code> field to JSON-format files. The integer represents the UNIX timestamp value and indicates the date and time when the audit event was generated. Changing the value causes a file rotation because all records must either have or do not have the <code>time</code> field. This option requires the <code>AUDIT_ADMIN</code> and <code>SYSTEM_VARIABLES_ADMIN</code> privileges.</p> <p>This option does nothing when used with other format types.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_handler","title":"<code>audit_log_filter_handler</code>","text":"Option name Description Command-line \u2013audit-log-filter-handler Dynamic No Scope Global Data type String Default FILE <p>Defines where the plugin writes the audit log filter file. The following values are available:</p> <ul> <li><code>FILE</code> - plugin writes the log to a location specified in <code>audit_log_filter_file</code></li> <li><code>SYSLOG</code> - plugin writes to the syslog</li> </ul>"},{"location":"audit-log-filter-variables.html#audit_log_filter_key_derivation_iterations_count_mean","title":"<code>audit_log_filter_key_derivation_iterations_count_mean</code>","text":"Option name Description Command-line \u2013audit-log-filter-key-derivation-iterations-count-mean Dynamic Yes Scope Global Data type Integer Default 60000 Minimum value 1000 Maximum value 1000000 <p>Defines the mean value of iterations used by the password-based derivation routine while calculating the encryption key and iv values. A random number represents the actual iteration count and deviates no more than 10% from this value.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_max_size","title":"<code>audit_log_filter_max_size</code>","text":"Option name Description Command-line \u2013audit-log-filter-max-size Dynamic Yes Scope Global Data type Integer Default 1GB Minimum value 0 Maximum value 18446744073709551615 Unit bytes Block size 4096 <p>Defines pruning based on the combined size of the files:</p> <p>The default value is 1GB. </p> <p>A value of 0 (zero) disables pruning based on size.</p> <p>A value greater than 0 (zero) enables pruning based on size and defines the combined size limit. When the files exceed this limit, they can be pruned.</p> <p>The value is based on 4096 (block size). A value is truncated to the nearest multiple of the block size. If the value is less than 4096, the value is treated as 0 (zero).</p> <p>If the values for <code>audit_log_filter_rotate_on_size</code> and <code>audit_log_filter_max_size</code> are greater than 0, we recommend that <code>audit_log_filter_max_size</code> value should be at least seven times the <code>audit_log_filter_rotate_on_size</code> value.</p> <p>Pruning requires the following options:</p> <ul> <li><code>audit_log_filter_max_size</code></li> <li><code>audit_log_filter_rotate_on_size</code></li> <li><code>audit_log_filter_prune_seconds</code></li> </ul>"},{"location":"audit-log-filter-variables.html#audit_log_filter_password_history_keep_days","title":"<code>audit_log_filter_password_history_keep_days</code>","text":"Option name Description Command-line \u2013audit-log-filter-password-history-keep-days Dynamic Yes Scope Global Data type Integer Default 0 <p>Defines when passwords may be removed and measured in days.</p> <p>Encrypted log files have passwords stored in the keyring. The plugin also stores a password history. A password does not expire, despite being past the value, in case the password is used for rotated audit logs. The operation of creating a password also archives the previous password.</p> <p>The default value is 0 (zero). This value disables the expiration of passwords. Passwords are retained forever. </p> <p>If the plugin starts and encryption is enabled, the plugin checks for an audit log filter encryption password. If a password is not found, the plugin generates a random password.</p> <p>Call `audit_log_filter_encryption_set() to set a specific password.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_prune_seconds","title":"<code>audit_log_filter_prune_seconds</code>","text":"Option name Description Command-line \u2013audit-log-filter-prune-seconds Dynamic Yes Scope Global Data type Integer Default 0 Minimum value 0 Maximum value 1844674073709551615 Unit seconds <p>Defines when the audit log filter file is pruned. This pruning is based on the age of the file. The value is measured in seconds. </p> <p>A value of 0 (zero) is the default and disables pruning. The maximum value is 18446744073709551615.</p> <p>A value greater than 0 enables pruning. An audit log filter file can be pruned after this value.</p> <p>To enable log pruning, you must set one of the following:</p> <ul> <li>Enable log rotation by setting `audit_log_filter_rotate_on_size</li> <li>Add a value greater than 0 (zero) for either <code>audit_log_filter_max_size</code> or <code>audit_log_filter_prune_seconds</code></li> </ul>"},{"location":"audit-log-filter-variables.html#audit_log_filter_read_buffer_size","title":"<code>audit_log_filter_read_buffer_size</code>","text":"Option name Description Command-line \u2013audit-log-filter-read-buffer-size Dynamic Yes Scope Global Data type Integer Unit Bytes Default 32768 <p>This option is only supported for JSON-format files.</p> <p>The size of the buffer for reading from the audit log filter file. The <code>audit_log_filter_read()</code> reads only from this buffer size.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_rotate_on_size","title":"<code>audit_log_filter_rotate_on_size</code>","text":"Option name Description Command-line \u2013audit-log-filter-rotate-on-size Dynamic Yes Scope Global Data type Integer Default 1GB <p>Performs an automatic log file rotation based on the size. The default value is 1GB. If the value is greater than 0, when the log file size exceeds the value, the plugin renames the current file and opens a new log file using the original name.</p> <p>If you set the value to less than 4096, the plugin does not automatically rotate the log files. You can rotate the log files manually using <code>audit_log_rotate()</code>. If the value is not a multiple of 4096, the plugin truncates the value to the nearest multiple.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_strategy","title":"<code>audit_log_filter_strategy</code>","text":"Option name Description Command-line \u2013audit-log-filter-strategy Dynamic No Scope Global Data type Enumeration Default ASYNCHRONOUS <p>Defines the Audit Log filter plugin\u2019s logging method. The valid values are the following:</p> Values Description ASYNCHRONOUS Waits until there is outer buffer space PERFORMANCE If the outer buffer does not have enough space, drops requests SEMISYNCHRONOUS Operating system permits caching SYNCHRONOUS Each request calls <code>sync()</code>"},{"location":"audit-log-filter-variables.html#audit_log_filter_syslog_tag","title":"<code>audit_log_filter_syslog_tag</code>","text":"Option Description Command-line \u2013audit-log-filter-syslog-tag= Dynamic No Scope Global Data type String Default audit-filter"},{"location":"audit-log-filter-variables.html#audit_log_filter_syslog_facility","title":"<code>audit_log_filter_syslog_facility</code>","text":"Option name Description Command-line \u2013audit-log-filter-syslog-facility Dynamic No Scope Global Data type String Default LOG_USER <p>Specifies the syslog <code>facility</code> value. The option has the same meaning as the appropriate parameter described in the syslog(3) manual.</p>"},{"location":"audit-log-filter-variables.html#audit_log_filter_syslog_priority","title":"<code>audit_log_filter_syslog_priority</code>","text":"Option name Description Command-line \u2013audit-log-filter-syslog-priority Dynamic No Scope Global Data type String Default LOG_INFO <p>Defines the <code>priority</code> value for the syslog. The option has the same meaning as the appropriate parameter described in the syslog(3) manual.</p>"},{"location":"audit-log-filter-variables.html#audit-log-filter-status-variables","title":"Audit log filter status variables","text":"<p>The audit log filter plugin exposes status variables. These variables provide information on the operations.</p> Name Description <code>audit_log_filter_current_size</code> The current size of the audit log filter file. If the log is rotated, the size is reset to 0. <code>audit_log_filter_direct_writes</code> Identifies when the <code>log_strategy_type</code> = ASYNCHRONOUS and messages bypass the write buffer and are written directly to the log file <code>audit_log_filter_max_drop_size</code> In the performance logging mode, the size of the largest dropped event. <code>audit_log_filter_events</code> The number of audit log filter events <code>audit_log_filter_events_filtered</code> The number of filtered audit log filter plugin events <code>audit_log_filter_events_lost</code> If the event is larger than the available audit log filter buffer space, the event is lost <code>audit_log_filter_events_written</code> The number of audit log filter events written <code>audit_log_filter_total_size</code> The total size of the events written to all audit log filter files. The number increases even when a log is rotated <code>audit_log_filter_write_waits</code> In the asynchronous logging mode, the number of times an event waited for space in the audit log filter buffer"},{"location":"audit-log-plugin.html","title":"Audit log plugin","text":"<p>Percona Audit Log Plugin provides monitoring and logging of connection and query activity that were performed on specific server. Information about the activity is stored in a log file. This implementation is alternative to the MySQL Enterprise Audit Log Plugin</p>"},{"location":"audit-log-plugin.html#version-specific-information","title":"Version specific information","text":"<ul> <li> <p>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</p> </li> <li> <p>Percona Server for MySQL 8.0.15-6: The Audit_log_buffer_size_overflow variable was implemented.</p> </li> </ul>"},{"location":"audit-log-plugin.html#install-the-plugin","title":"Install the plugin","text":"<p>The audit Log plugin is installed, but, by default, is not enabled when you install Percona Server for MySQL. To check if the plugin is enabled run the following commands:</p> <pre><code>mysql&gt; SELECT * FROM information_schema.PLUGINS WHERE PLUGIN_NAME LIKE '%audit%';\n</code></pre> Expected output <pre><code>Empty set (0.00 sec)\n</code></pre> <pre><code>mysql&gt; SHOW variables LIKE 'audit%';\n</code></pre> Expected output <pre><code>Empty set (0.01 sec)\n</code></pre> <pre><code>mysql&gt; SHOW variables LIKE 'plugin%';\n</code></pre> Expected output <pre><code>+---------------+------------------------+\n| Variable_name | Value                  |\n+---------------+------------------------+\n| plugin_dir    | /usr/lib/mysql/plugin/ |\n+---------------+------------------------+\n1 row in set (0.00 sec)\n</code></pre> <p>Note</p> <p>The location of the MySQL plugin directory depends on the operating system and may be different on your system.</p> <p>The following command enables the plugin:</p> <pre><code>mysql&gt; INSTALL PLUGIN audit_log SONAME 'audit_log.so';\n</code></pre> <p>Run the following command to verify if the plugin was installed correctly:</p> <pre><code>mysql&gt; SELECT * FROM information_schema.PLUGINS WHERE PLUGIN_NAME LIKE '%audit%'\\G\n</code></pre> Expected output <pre><code>*************************** 1. row ***************************\n        PLUGIN_NAME: audit_log\n        PLUGIN_VERSION: 0.2\n        PLUGIN_STATUS: ACTIVE\n        PLUGIN_TYPE: AUDIT\nPLUGIN_TYPE_VERSION: 4.1\n        PLUGIN_LIBRARY: audit_log.so\nPLUGIN_LIBRARY_VERSION: 1.7\n        PLUGIN_AUTHOR: Percona LLC and/or its affiliates.\n    PLUGIN_DESCRIPTION: Audit log\n        PLUGIN_LICENSE: GPL\n        LOAD_OPTION: ON\n1 row in set (0.00 sec)\n</code></pre> <p>You can review the audit log variables with the following command:</p> <pre><code>mysql&gt; SHOW variables LIKE 'audit%';\n</code></pre> Expected output <pre><code>+-----------------------------+---------------+\n| Variable_name               | Value         |\n+-----------------------------+---------------+\n| audit_log_buffer_size       | 1048576       |\n| audit_log_exclude_accounts  |               |\n| audit_log_exclude_commands  |               |\n| audit_log_exclude_databases |               |\n| audit_log_file              | audit.log     |\n| audit_log_flush             | OFF           |\n| audit_log_format            | OLD           |\n| audit_log_handler           | FILE          |\n| audit_log_include_accounts  |               |\n| audit_log_include_commands  |               |\n| audit_log_include_databases |               |\n| audit_log_policy            | ALL           |\n| audit_log_rotate_on_size    | 0             |\n| audit_log_rotations         | 0             |\n| audit_log_strategy          | ASYNCHRONOUS  |\n| audit_log_syslog_facility   | LOG_USER      |\n| audit_log_syslog_ident      | percona-audit |\n| audit_log_syslog_priority   | LOG_INFO      |\n+-----------------------------+---------------+\n18 rows in set (0.00 sec)\n</code></pre>"},{"location":"audit-log-plugin.html#log-format","title":"Log format","text":"<p>The plugin supports the following log formats: <code>OLD</code>, <code>NEW</code>, <code>JSON</code>, and <code>CSV</code>. The <code>OLD\\</code>`format and the``NEW<code>format are based on XML. The</code>OLD<code>format defines each log record with XML attributes. The</code>NEW` format defines each log record with XML tags. The information logged is the same for all four formats. The audit_log_format variable controls the log format choice.</p>"},{"location":"audit-log-plugin.html#format-examples","title":"Format examples","text":"<p>The following formats are available:</p> Old log formatNew log formatJSON formatCSV format <pre><code>&lt;AUDIT_RECORD\nNAME=\"Query\"\nRECORD=\"3_2021-06-30T11:56:53\"\nTIMESTAMP=\"2021-06-30T11:57:14 UTC\"\nCOMMAND_CLASS=\"select\"\nCONNECTION_ID=\"3\"\nSTATUS=\"0\"\nSQLTEXT=\"select * from information_schema.PLUGINS where PLUGIN_NAME like '%audit%'\"\nUSER=\"root[root] @ localhost []\"\nHOST=\"localhost\"\nOS_USER=\"\"\nIP=\"\"\nDB=\"\"\n/&gt;\n</code></pre> <pre><code>&lt;AUDIT_RECORD&gt;\n&lt;NAME&gt;Query&lt;/NAME&gt;\n&lt;RECORD&gt;16684_2021-06-30T16:07:41&lt;/RECORD&gt;\n&lt;TIMESTAMP&gt;2021-06-30T16:08:06 UTC&lt;/TIMESTAMP&gt;\n&lt;COMMAND_CLASS&gt;select&lt;/COMMAND_CLASS&gt;\n&lt;CONNECTION_ID&gt;2&lt;/CONNECTION_ID&gt;\n&lt;STATUS&gt;0&lt;/STATUS&gt;\n&lt;SQLTEXT&gt;select id, holder from one&lt;/SQLTEXT&gt;\n&lt;USER&gt;root[root] @ localhost []&lt;/USER&gt;\n&lt;HOST&gt;localhost&lt;/HOST&gt;\n&lt;OS_USER&gt;&lt;/OS_USER&gt;\n&lt;IP&gt;&lt;/IP&gt;\n&lt;DB&gt;&lt;/DB&gt;\n</code></pre> <pre><code>{\"audit_record\":{\"name\":\"Query\",\"record\":\"13149_2021-06-30T15:03:11\",\"timestamp\":\"2021-06-30T15:07:58 UTC\",\"command_class\":\"show_databases\",\"connection_id\":\"2\",\"status\":0,\"sqltext\":\"show databases\",\"user\":\"root[root] @ localhost []\",\"host\":\"localhost\",\"os_user\":\"\",\"ip\":\"\",\"db\":\"\"}}\n</code></pre> <pre><code>\"Query\",\"22567_2021-06-30T16:10:09\",\"2021-06-30T16:19:00 UTC\",\"select\",\"2\",0,\"select count(*) from one\",\"root[root] @ localhost []\",\"localhost\",\"\",\"\",\"\"\n</code></pre>"},{"location":"audit-log-plugin.html#audit-log-events","title":"Audit log events","text":"<p>The audit Log plugin generates a log of following events.</p> AuditConnect or DisconnectQuery <p>Audit event indicates that audit logging started or finished. <code>NAME</code> field will be <code>Audit</code> when logging started and <code>NoAudit</code> when logging finished. Audit record also includes server version and command-line arguments.</p> <pre><code>??? example \"Audit event\"\n\n    ```text\n    &lt;AUDIT_RECORD\n    NAME=\"Audit\"\n    RECORD=\"1_2021-06-30T11:56:53\"\n    TIMESTAMP=\"2021-06-30T11:56:53 UTC\"\n    MYSQL_VERSION=\"5.7.34-37\"\n    STARTUP_OPTIONS=\"--daemonize --pid-file=/var/run/mysqld/mysqld.pid\"\n    OS_VERSION=\"x86_64-debian-linux-gnu\"\n    /&gt;\n    ```\n</code></pre> <p>Connect record event will have <code>NAME</code> field <code>Connect</code> when user logged in or login failed, or <code>Quit</code> when connection is closed.</p> <p>The additional fields for this event are the following:</p> <pre><code>* `CONNECTION_ID`\n\n* `STATUS`\n\n* `USER`\n\n* `PRIV_USER`\n\n* `OS_LOGIN`\n\n* `PROXY_USER`\n\n* `HOST`\n\n* `IP`\n</code></pre> <p>The value for <code>STATUS</code> is <code>0</code> for successful logins and non-zero for failed logins.</p> Disconnect event <pre><code>&lt;AUDIT_RECORD\nNAME=\"Quit\"\nRECORD=\"5_2021-06-29T19:33:03\"\nTIMESTAMP=\"2021-06-29T19:34:38Z\"\nCONNECTION_ID=\"14\"\nSTATUS=\"0\"\nUSER=\"root\"\nPRIV_USER=\"root\"\nOS_LOGIN=\"\"\nPROXY_USER=\"\"\nHOST=\"localhost\"\nIP=\"\"\nDB=\"\"\n/&gt;\n</code></pre> <p>Additional fields for this event are: <code>COMMAND_CLASS</code> (values come from the <code>com_status_vars</code> array in the `sql/mysqld.cc`` file in a MySQL source distribution.</p> <p>Examples are <code>select</code>, <code>alter_table</code>, <code>create_table</code>, etc.), <code>CONNECTION_ID</code>, <code>STATUS</code> (indicates an error when the vaule is non-zero), <code>SQLTEXT</code> (text of SQL-statement), <code>USER</code>, <code>HOST</code>, <code>OS_USER</code>, <code>IP</code>.</p> <p>The possible values for the <code>NAME</code> name field for this event are <code>Query</code>, <code>Prepare</code>, <code>Execute</code>, <code>Change user</code>, etc.</p> Query event <pre><code>&lt;AUDIT_RECORD\nNAME=\"Query\"\nRECORD=\"4_2021-06-29T19:33:03\"\nTIMESTAMP=\"2021-06-29T19:33:34Z\"\nCOMMAND_CLASS=\"show_variables\"\nCONNECTION_ID=\"14\"\nSTATUS=\"0\"\nSQLTEXT=\"show variables like 'audit%'\"\nUSER=\"root[root] @ localhost []\"\nHOST=\"localhost\"\nOS_USER=\"\"\nIP=\"\"\nDB=\"\"\n/&gt;\n</code></pre>"},{"location":"audit-log-plugin.html#stream-the-audit-log-to-syslog","title":"Stream the audit log to syslog","text":"<p>To stream the audit log to syslog you\u2019ll need to set audit_log_handler variable to <code>SYSLOG</code>. To control the syslog file handler, the following variables can be used: audit_log_syslog_ident, audit_log_syslog_facility, and audit_log_syslog_priority These variables have the same meaning as appropriate parameters described in the syslog(3) manual.</p> <p>Note</p> <p>The actions for the variables: audit_log_strategy, audit_log_buffer_size, audit_log_rotate_on_size, audit_log_rotations are captured only with <code>FILE</code> handler.</p>"},{"location":"audit-log-plugin.html#filter-methods","title":"Filter methods","text":"<p>You can filter the results by the following methods.</p> Filter by userFilter by SQL command typeFiltering by database <p>The filtering by user feature adds two new global variables: audit_log_include_accounts and audit_log_exclude_accounts to specify which user accounts should be included or excluded from audit logging.</p> <p>Only one of these variables can contain a list of users to be either included or excluded, while the other must be <code>NULL</code>. If one of the variables is set to be not <code>NULL</code> (contains a list of users), the attempt to set another one fails. An empty string means an empty list.</p> <p>Changes of audit_log_include_accounts and audit_log_exclude_accounts do not apply to existing server connections.</p> <p>The filtering by SQL command type adds two new global variables: audit_log_include_commands and audit_log_exclude_commands to specify which command types should be included or excluded from audit logging.</p> <p>Only one of these variables can contain a list of command types to be either included or excluded, while the other needs to be <code>NULL</code>. If one of the variables is set to be not <code>NULL</code> (contains a list of command types), the attempt to set another one will fail. An empty string is defined as an empty list.</p> <p>If both the audit_log_exclude_commands variable and the audit_log_include_commands variable are <code>NULL</code>, all commands are logged.</p> <p>The filtering by an SQL database is implemented by two global variables: audit_log_include_databases and audit_log_exclude_databases to specify which databases should be included or excluded from audit logging.</p> <p>Only one of these variables can contain a list of databases to be either included or excluded, while the other needs to be <code>NULL</code>. If one of the variables is set to be not <code>NULL</code> (contains a list of databases), the attempt to set another one will fail. Empty string means an empty list.</p> <p>If query is accessing any of databases listed in audit_log_include_databases, the query will be logged. If query is accessing only databases listed in audit_log_exclude_databases, the query will not be logged. <code>CREATE TABLE</code> statements are logged unconditionally.</p> <p>Changes of audit_log_include_databases and audit_log_exclude_databases do not apply to existing server connections.</p>"},{"location":"audit-log-plugin.html#filter-examples","title":"Filter examples","text":"<p>The following are examples of the different filters.</p> Filter by userFilter by SQL command typeFilter by database <p>The following example adds users who will be monitored:</p> <pre><code>mysql&gt; SET GLOBAL audit_log_include_accounts = 'user1@localhost,root@localhost';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <p>If you try to add users to both the include list and the exclude list, the server returns the following error:</p> <pre><code>mysql&gt; SET GLOBAL audit_log_exclude_accounts = 'user1@localhost,root@localhost';\n</code></pre> Expected output <pre><code>ERROR 1231 (42000): Variable 'audit_log_exclude_accounts' can't be set to the value of 'user1@localhost,root@localhost'\n</code></pre> <p>To switch from filtering by included user list to the excluded user list or back, first set the currently active filtering variable to <code>NULL</code>:</p> <pre><code>mysql&gt; SET GLOBAL audit_log_include_accounts = NULL;\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <pre><code>mysql&gt; SET GLOBAL audit_log_exclude_accounts = 'user1@localhost,root@localhost';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <pre><code>mysql&gt; SET GLOBAL audit_log_exclude_accounts = \"'user'@'host'\";\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <pre><code>mysql&gt; SET GLOBAL audit_log_exclude_accounts = '''user''@''host''';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <pre><code>mysql&gt; SET GLOBAL audit_log_exclude_accounts = '\\'user\\'@\\'host\\'';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <p>To see which user accounts have been added to the exclude list, run the following command:</p> <pre><code>mysql&gt; SELECT @@audit_log_exclude_accounts;\n</code></pre> Expected output <pre><code>+------------------------------+\n| @@audit_log_exclude_accounts |\n+------------------------------+\n| 'user'@'host'                |\n+------------------------------+\n1 row in set (0.00 sec)\n</code></pre> <p>Account names from mysql.user table are logged in the audit log. For example when you create a user:</p> <pre><code>mysql&gt; CREATE USER 'user1'@'%' IDENTIFIED BY '111';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <p>When <code>user1</code> connects from <code>localhost</code>, the user is listed:</p> <pre><code>&lt;AUDIT_RECORD\nNAME=\"Connect\"\nRECORD=\"2_2021-06-30T11:56:53\"\nTIMESTAMP=\"2021-06-30T11:56:53 UTC\"\nCONNECTION_ID=\"6\"\nSTATUS=\"0\"\nUSER=\"user1\" ;; this is a 'user' part of account in 8.0\nPRIV_USER=\"user1\"\nOS_LOGIN=\"\"\nPROXY_USER=\"\"\nHOST=\"localhost\" ;; this is a 'host' part of account in 8.0\nIP=\"\"\nDB=\"\"\n/&gt;\n</code></pre> <p>To exclude <code>user1</code> from logging in Percona Server for MySQL 8.0, set:</p> <pre><code>SET GLOBAL audit_log_exclude_accounts = 'user1@%';\n</code></pre> <p>The value can be <code>NULL</code> or comma separated list of accounts in form <code>user@host</code> or <code>'user'@'host'</code> (if user or host contains comma).</p> <p>The available command types can be listed by running:</p> <pre><code>mysql&gt; SELECT name FROM performance_schema.setup_instruments WHERE name LIKE \"statement/sql/%\" ORDER BY name;\n</code></pre> Expected output <pre><code>+------------------------------------------+\n| name                                     |\n+------------------------------------------+\n| statement/sql/alter_db                   |\n| statement/sql/alter_db_upgrade           |\n| statement/sql/alter_event                |\n| statement/sql/alter_function             |\n| statement/sql/alter_procedure            |\n| statement/sql/alter_server               |\n| statement/sql/alter_table                |\n| statement/sql/alter_tablespace           |\n| statement/sql/alter_user                 |\n| statement/sql/analyze                    |\n| statement/sql/assign_to_keycache         |\n| statement/sql/begin                      |\n| statement/sql/binlog                     |\n| statement/sql/call_procedure             |\n| statement/sql/change_db                  |\n| statement/sql/change_master              |\n...\n| statement/sql/xa_rollback                |\n| statement/sql/xa_start                   |\n+------------------------------------------+\n145 rows in set (0.00 sec)\n</code></pre> <p>You can add commands to the <code>include</code> filter by running:</p> <pre><code>mysql&gt; SET GLOBAL audit_log_include_commands= 'set_option,create_db';\n</code></pre> <p>Create a database with the following command:</p> <pre><code>mysql&gt; CREATE DATABASE sample;\n</code></pre> Expected output <pre><code>&lt;AUDIT_RECORD&gt;\n&lt;NAME&gt;Query&lt;/NAME&gt;\n&lt;RECORD&gt;24320_2021-06-30T17:44:46&lt;/RECORD&gt;\n&lt;TIMESTAMP&gt;2021-06-30T17:45:16 UTC&lt;/TIMESTAMP&gt;\n&lt;COMMAND_CLASS&gt;create_db&lt;/COMMAND_CLASS&gt;\n&lt;CONNECTION_ID&gt;2&lt;/CONNECTION_ID&gt;\n&lt;STATUS&gt;0&lt;/STATUS&gt;\n&lt;SQLTEXT&gt;CREATE DATABASE sample&lt;/SQLTEXT&gt;\n&lt;USER&gt;root[root] @ localhost []&lt;/USER&gt;\n&lt;HOST&gt;localhost&lt;/HOST&gt;\n&lt;OS_USER&gt;&lt;/OS_USER&gt;\n&lt;IP&gt;&lt;/IP&gt;\n&lt;DB&gt;&lt;/DB&gt;\n&lt;/AUDIT_RECORD&gt;\n</code></pre> <p>To switch the command type filtering type from included type list to the excluded list or back, first reset the currently-active list to <code>NULL</code>:</p> <pre><code>mysql&gt; SET GLOBAL audit_log_include_commands = NULL;\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <pre><code>mysql&gt; SET GLOBAL audit_log_exclude_commands= 'set_option,create_db';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <p>A stored procedure has the <code>call_procedure</code> command type. All the statements executed within the procedure have the same type <code>call_procedure</code> as well.</p> <p>To add databases to be monitored, run:</p> <pre><code>mysql&gt; SET GLOBAL audit_log_include_databases = 'test,mysql,db1';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <pre><code>mysql&gt; SET GLOBAL audit_log_include_databases= 'db1','db3';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <p>If you you try to add databases to both include and exclude lists server will show you the following error:</p> <pre><code>mysql&gt; SET GLOBAL audit_log_exclude_databases = 'test,mysql,db1';\n</code></pre> Error message <pre><code>ERROR 1231 (42000): Variable 'audit_log_exclude_databases can't be set to the value of 'test,mysql,db1'\n</code></pre> <p>To switch from filtering by included database list to the excluded one or back, first set the currently active filtering variable to <code>NULL</code>:</p> <pre><code>mysql&gt; SET GLOBAL audit_log_include_databases = NULL;\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <pre><code>mysql&gt; SET GLOBAL audit_log_exclude_databases = 'test,mysql,db1';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre>"},{"location":"audit-log-plugin.html#system-variables","title":"System variables","text":""},{"location":"audit-log-plugin.html#audit_log_strategy","title":"<code>audit_log_strategy</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type String Default value ASYNCHRONOUS Allowed values <code>ASYNCHRONOUS</code>, <code>PERFORMANCE</code>, <code>SEMISYNCHRONOUS</code>, <code>SYNCHRONOUS</code> <p>This variable is used to specify the audit log strategy, possible values are:</p> <ul> <li> <p><code>ASYNCHRONOUS</code> - (default) log using memory buffer, do not drop messages if buffer is full</p> </li> <li> <p><code>PERFORMANCE</code> - log using memory buffer, drop messages if buffer is full</p> </li> <li> <p><code>SEMISYNCHRONOUS</code> - log directly to file, do not flush and sync every event</p> </li> <li> <p><code>SYNCHRONOUS</code> - log directly to file, flush and sync every event</p> </li> </ul> <p>This variable has effect only when audit_log_handler is set to <code>FILE</code>.</p>"},{"location":"audit-log-plugin.html#audit_log_file","title":"<code>audit_log_file</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type String Default value audit.log <p>This variable is used to specify the filename that\u2019s going to store the audit log. It can contain the path relative to the datadir or absolute path.</p>"},{"location":"audit-log-plugin.html#audit_log_flush","title":"<code>audit_log_flush</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: Yes Data type String Default value OFF <p>When this variable is set to <code>ON</code> log file will be closed and reopened. This can be used for manual log rotation.</p>"},{"location":"audit-log-plugin.html#audit_log_buffer_size","title":"<code>audit_log_buffer_size</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type Numeric Default value 1 Mb <p>This variable can be used to specify the size of memory buffer used for logging, used when audit_log_strategy variable is set to <code>ASYNCHRONOUS</code> or <code>PERFORMANCE</code> values. This variable has effect only when audit_log_handler is set to <code>FILE</code>.</p>"},{"location":"audit-log-plugin.html#audit_log_exclude_accounts","title":"<code>audit_log_exclude_accounts</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: Yes Data type String <p>This variable is used to specify the list of users for which Filtering by user is applied. The value can be <code>NULL</code> or comma separated list of accounts in form <code>user@host</code> or <code>'user'@'host'</code> (if user or host contains comma). If this variable is set, then audit_log_include_accounts must be unset, and vice versa.</p>"},{"location":"audit-log-plugin.html#audit_log_exclude_commands","title":"<code>audit_log_exclude_commands</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: Yes Data type String <p>This variable is used to specify the list of commands for which Filtering by SQL command type is applied. The value can be <code>NULL</code> or comma separated list of commands. If this variable is set, then audit_log_include_commands must be unset, and vice versa.</p>"},{"location":"audit-log-plugin.html#audit_log_exclude_databases","title":"<code>audit_log_exclude_databases</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: Yes Data type String <p>This variable is used to specify the list of commands for which Filtering by database is applied. The value can be <code>NULL</code> or comma separated list of commands. If this variable is set, then audit_log_include_databases must be unset, and vice versa.</p>"},{"location":"audit-log-plugin.html#audit_log_format","title":"<code>audit_log_format</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type String Default value OLD Allowed values <code>OLD</code>, <code>NEW</code>, <code>CSV</code>, <code>JSON</code> <p>This variable is used to specify the audit log format. The audit log plugin supports four log formats: <code>OLD</code>, <code>NEW</code>, <code>JSON</code>, and <code>CSV</code>. <code>OLD</code> and <code>NEW</code> formats are based on XML, where the former outputs log record properties as XML attributes and the latter as XML tags. Information logged is the same in all four formats.</p>"},{"location":"audit-log-plugin.html#audit_log_include_accounts","title":"<code>audit_log_include_accounts</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: Yes Data type String <p>This variable is used to specify the list of users for which Filtering by user is applied. The value can be <code>NULL</code> or comma separated list of accounts in form <code>user@host</code> or <code>'user'@'host'</code> (if user or host contains comma). If this variable is set, then audit_log_exclude_accounts must be unset, and vice versa.</p>"},{"location":"audit-log-plugin.html#audit_log_include_commands","title":"<code>audit_log_include_commands</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: Yes Data type String <p>This variable is used to specify the list of commands for which Filtering by SQL command type is applied. The value can be <code>NULL</code> or comma separated list of commands. If this variable is set, then audit_log_exclude_commands must be unset, and vice versa.</p>"},{"location":"audit-log-plugin.html#audit_log_include_databases","title":"<code>audit_log_include_databases</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: Yes Data type String <p>This variable is used to specify the list of commands for which Filtering by database is applied. The value can be <code>NULL</code> or comma separated list of commands. If this variable is set, then audit_log_exclude_databases must be unset, and vice versa.</p>"},{"location":"audit-log-plugin.html#audit_log_policy","title":"<code>audit_log_policy</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: Yes Data type String Default ALL Allowed values <code>ALL</code>, <code>LOGINS</code>, <code>QUERIES</code>, <code>NONE</code> <p>This variable is used to specify which events should be logged. Possible values are:</p> <ul> <li> <p><code>ALL</code> - all events will be logged</p> </li> <li> <p><code>LOGINS</code> - only logins will be logged</p> </li> <li> <p><code>QUERIES</code> - only queries will be logged</p> </li> <li> <p><code>NONE</code> - no events will be logged</p> </li> </ul>"},{"location":"audit-log-plugin.html#audit_log_rotate_on_size","title":"<code>audit_log_rotate_on_size</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type Numeric Default value 0 (don\u2019t rotate the log file) <p>This variable is measured in bytes and specifies the maximum size of the audit log file. Upon reaching this size, the audit log will be rotated. The rotated log files are present in the same directory as the current log file. The sequence number is appended to the log file name upon rotation. For this variable to take effect, set the audit_log_handler variable to <code>FILE</code>.</p>"},{"location":"audit-log-plugin.html#audit_log_rotations","title":"<code>audit_log_rotations</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type Numeric Default value 0 <p>This variable is used to specify how many log files should be kept when audit_log_rotate_on_size variable is set to non-zero value. This variable has effect only when audit_log_handler is set to <code>FILE</code>.</p>"},{"location":"audit-log-plugin.html#audit_log_handler","title":"<code>audit_log_handler</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type String Default value FILE Allowed values <code>FILE</code>, <code>SYSLOG</code> <p>This variable is used to configure where the audit log will be written. If it is set to <code>FILE</code>, the log will be written into a file specified by audit_log_file variable. If it is set to <code>SYSLOG</code>, the audit log will be written to syslog.</p>"},{"location":"audit-log-plugin.html#audit_log_syslog_ident","title":"<code>audit_log_syslog_ident</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type String Default value percona-audit <p>This variable is used to specify the <code>ident</code> value for syslog. This variable has the same meaning as the appropriate parameter described in the syslog(3) manual.</p>"},{"location":"audit-log-plugin.html#audit_log_syslog_facility","title":"<code>audit_log_syslog_facility</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type String Default value LOG_USER <p>This variable is used to specify the <code>facility</code> value for syslog. This variable has the same meaning as the appropriate parameter described in the syslog(3) manual.</p>"},{"location":"audit-log-plugin.html#audit_log_syslog_priority","title":"<code>audit_log_syslog_priority</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type String Default value LOG_INFO <p>This variable is used to specify the <code>priority</code> value for syslog. This variable has the same meaning as the appropriate parameter described in the syslog(3) manual.</p>"},{"location":"audit-log-plugin.html#status-variables","title":"Status Variables","text":""},{"location":"audit-log-plugin.html#audit_log_buffer_size_overflow","title":"<code>Audit_log_buffer_size_overflow</code>","text":"Option Description Scope: Global Data type Numeric <p>The number of times an audit log entry was either dropped or written directly to the file due to its size being bigger than audit_log_buffer_size variable.</p>"},{"location":"backup-locks.html","title":"Backup locks","text":"<p>Percona Server for MySQL offers the <code>LOCK TABLES FOR BACKUP</code> statement as a lightweight alternative to <code>FLUSH TABLES WITH READ LOCK</code> for both physical and logical backups.</p> <p>Note</p> <p>As of Percona Server for MySQL 8.0.13-4, <code>LOCK TABLES FOR BACKUP</code> requires the <code>BACKUP_ADMIN</code> privilege.</p>"},{"location":"backup-locks.html#lock-tables-for-backup","title":"LOCK TABLES FOR BACKUP","text":"<p><code>LOCK TABLES FOR BACKUP</code> uses a new MDL lock type to block updates to non-transactional tables and DDL statements for all tables. If there is an active <code>LOCK TABLES FOR BACKUP</code> lock then all DDL statements and all updates to MyISAM, CSV, MEMORY, ARCHIVE, TokuDB, and MyRocks tables will be blocked in the <code>Waiting for backup lock</code> status, visible in <code>PERFORMANCE_SCHEMA</code> or <code>PROCESSLIST</code>.</p> <p><code>LOCK TABLES FOR BACKUP</code> has no effect on <code>SELECT</code> queries for all mentioned storage engines. Against InnoDB, MyRocks, Blackhole and Federated tables, the <code>LOCK TABLES FOR BACKUP</code> is not applicable to the <code>INSERT</code>, <code>REPLACE</code>, <code>UPDATE</code>, <code>DELETE</code> statements: Blackhole tables obviously have no relevance to backups, and Federated tables are ignored by both logical and physical backup tools.</p> <p>Unlike <code>FLUSH TABLES WITH READ LOCK</code>, <code>LOCK TABLES FOR BACKUP</code> does not flush tables, i.e. storage engines are not forced to close tables and tables are not expelled from the table cache. As a result, <code>LOCK TABLES FOR BACKUP</code> only waits for conflicting statements to complete (i.e. DDL and updates to non-transactional tables). It never waits for SELECTs, or UPDATEs to InnoDB or MyRocks tables to complete, for example.</p> <p>If an \u201cunsafe\u201d statement is executed in the same connection that is holding a <code>LOCK TABLES FOR BACKUP</code> lock, it fails with the following error:</p> Expected output <pre><code>ERROR 1880 (HY000): Can't execute the query because you have a conflicting backup lock\n\nUNLOCK TABLES releases the lock acquired by LOCK TABLES FOR BACKUP.\n</code></pre> <p>The intended use case for Percona XtraBackup is:</p> <pre><code>LOCK TABLES FOR BACKUP\n... copy .frm, MyISAM, CSV, etc. ...\nUNLOCK TABLES\n... get binlog coordinates ...\n... wait for redo log copying to finish ...\n</code></pre>"},{"location":"backup-locks.html#privileges","title":"Privileges","text":"<p>The <code>LOCK TABLES FOR BACKUP</code> requires the <code>BACKUP_ADMIN</code> privilege.</p>"},{"location":"backup-locks.html#interaction-with-other-global-locks","title":"Interaction with other global locks","text":"<p>The <code>LOCK TABLES FOR BACKUP</code> has no effect if the current connection already owns a <code>FLUSH TABLES WITH READ LOCK</code> lock, as it is a more restrictive lock. If <code>FLUSH TABLES WITH READ LOCK</code> is executed in a connection that has acquired <code>LOCK TABLES FOR BACKUP</code>, <code>FLUSH TABLES WITH READ LOCK</code> fails with an error.</p> <p>If the server is operating in the read-only mode (i.e. read_only set to <code>1</code>), statements that are unsafe for backups will be either blocked or fail with an error, depending on whether they are executed in the same connection that owns <code>LOCK TABLES FOR BACKUP</code> lock, or other connections.</p>"},{"location":"backup-locks.html#myisam-index-and-data-buffering","title":"MyISAM index and data buffering","text":"<p>MyISAM key buffering is normally write-through, i.e. by the time each update to a MyISAM table is completed, all index updates are written to disk. The only exception is delayed key writing feature which is disabled by default.</p> <p>When the global system variable delay_key_write is set to <code>ALL</code>, key buffers for all MyISAM tables are not flushed between updates, so a physical backup of those tables may result in broken MyISAM indexes. To prevent this, <code>LOCK TABLES FOR BACKUP</code> will fail with an error if delay_key_write is set to <code>ALL</code>. An attempt to set delay_key_write to <code>ALL</code> when there\u2019s an active backup lock will also fail with an error.</p> <p>Another option to involve delayed key writing is to create MyISAM tables with the DELAY_KEY_WRITE option and set the delay_key_write variable to <code>ON</code> (which is the default). In this case, <code>LOCK TABLES FOR BACKUP</code> will not be able to prevent stale index files from appearing in the backup. Users are encouraged to set delay_key_writes to <code>OFF</code> in the configuration file, <code>my.cnf</code>, or repair MyISAM indexes after restoring from a physical backup created with backup locks.</p> <p>MyISAM may also cache data for bulk inserts, e.g. when executing multi-row INSERTs or <code>LOAD DATA</code> statements. Those caches, however, are flushed between statements, so have no effect on physical backups as long as all statements updating MyISAM tables are blocked.</p>"},{"location":"backup-locks.html#the-mysqldump-command","title":"The mysqldump Command","text":"<p><code>mysqldump</code> has also been extended with a new option, lock-for-backup (disabled by default). When used together with the <code>--single-transaction</code> option, the option makes <code>mysqldump</code> issue <code>LOCK TABLES FOR BACKUP</code> before starting the dump operation to prevent unsafe statements that would normally result in an inconsistent backup.</p> <p>When used without the <code>--single-transaction</code> option, lock-for-backup is automatically converted to lock-all-tables.</p> <p>The option lock-for-backup is mutually exclusive with lock-all-tables, i.e. specifying both on the command line will lead to an error.</p> <p>If the backup locks feature is not supported by the target server, but lock-for-backup is specified on the command line, <code>mysqldump</code> aborts with an error.</p>"},{"location":"backup-locks.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"backup-locks.html#system-variables","title":"System Variables","text":""},{"location":"backup-locks.html#have_backup_locks","title":"<code>have_backup_locks</code>","text":"Option Description Command Line: Yes Config file No Scope: Global Dynamic: No Data type Boolean Default value YES <p>This is a server variable implemented to help other utilities decide what locking strategy can be implemented for a server. When available, the backup locks feature is supported by the server and the variable value is always <code>YES</code>.</p>"},{"location":"backup-locks.html#status-variables","title":"Status variables","text":""},{"location":"backup-locks.html#com_lock_tables_for_backup","title":"<code>Com_lock_tables_for_backup</code>","text":"Option Description Scope: Global/Session Data type Numeric <p>This status variable indicates the number of times the corresponding statements have been executed.</p>"},{"location":"backup-locks.html#client-command-line-parameter","title":"Client command line parameter","text":""},{"location":"backup-locks.html#lock-for-backup","title":"<code>lock-for-backup</code>","text":"Option Description Command Line: Yes Scope: Global Dynamic: No Data type String Default value Off <p>When used together with the \u2013-single-transaction option, the option makes <code>mysqldump</code> issue <code>LOCK TABLES FOR BACKUP</code> before starting the dump operation to prevent unsafe statements that would normally result in an inconsistent backup.</p>"},{"location":"backup-restore-overview.html","title":"Backup and restore overview","text":"<p>Backups are data snapshots that are taken at a specific time and are stored in a common location in a common  format. A backup is only useful for a defined time. </p> <p>The following scenarios require a backup to recover:</p> Reason Description Hardware or host failure Issues with disks, such as stalls or broken disks. With cloud services, the instance can be unaccessible or broken. Corrupted data This issue can be caused by power outages, the database failed to write correctly and close the file. User mistake Deleting data or an update overwriting good data with bad data Natural disaster or data center failure Power outage, flooding, or internet issues Compliance Required to comply with regulations and standards"},{"location":"backup-restore-overview.html#strategies","title":"Strategies","text":"<p>Define a backup and restore strategy for each of your databases. The strategies should have the following practices:</p> Practice Description Retention How long should you keep the backups. This decision should be based on the organization\u2019s data governance policies and the expense of storing the backups. The schedule for backups should match the retention schedule. Document Document the strategy and any related policies. The documents should include information about the process and any tools used during backup or restore. Encrypt Encrypt the backup and secure the storage locations Test Test the backups on a timely basis. <p>The backup strategy defines type and the backup frequency, the hardware required, how the backups are verified, and storing the backups, which also  includes the backup security. The strategy uses the following metrics:</p> Metric Description Recovery Time Objective (RTO) How long can the system be down? Recovery Point Objective (RPO) How much data can the organization lose? <p>The restore strategy defines which user account has the restore responsibility and how and frequency  of testing the restore process.</p> <p>These strategies require planning, implementation, and rigorous testing. You must test your restore process with each type of backup used to validate the backup and measure the recovery time. Automate this testing as much as possible. You should also document the process. In case of disaster, you can follow the procedures in the document without wasting time.</p> <p>If you are using replication, consider using a dedicated replica for backups because the operation can cause a high CPU load.</p>"},{"location":"backup-restore-overview.html#physical-backup-or-logical-backup","title":"Physical backup or logical backup","text":"<p>A backup can be either a physical backup or a logical backup.</p>"},{"location":"backup-restore-overview.html#physical-backups","title":"Physical backups","text":"<p>A physical backup copies the files needed to store and recover the database. They can be data files, configuration files, logs, and other types of files. The physical database can be stored in the cloud, in offline storage, on disc, or tape.</p> <p>Percona XtraBackup takes a physical backup. You can also  use RDS/LVM Snapshots or the MySQL Enterprise Backup. </p> <p>If the server is stopped or down, you can copy the datadir with the <code>cp</code> command or the <code>rsync</code> command.</p>"},{"location":"backup-restore-overview.html#logical-backups","title":"Logical backups","text":"<p>A logical backup contains the structural details. This type of backup contains tables, views, procedures, and functions. </p> <p>Tools like <code>mysqldump</code> ,  <code>mydumper</code>,  <code>mysqlpump</code>, and  <code>mysql shell</code>  take a logical backup.</p>"},{"location":"backup-restore-overview.html#comparison","title":"Comparison","text":"Comparison Physical backup Logical backup Content The physical database files The tables, users, procedures, and functions Restore speed Restore can be quick Restore can be slower and does not include file information. Storage Can take more space Based on what is selected, the backup can be smaller"},{"location":"binary-tarball-install.html","title":"Install Percona Server for MySQL 8.0 from a binary tarball","text":"<p>A binary tarball contains a group of files, including the source code, bundled together into one file using the <code>tar</code> command and compressed using <code>gzip</code>. </p> <p>See the list of the binary tarball available based on the Percona Server for MySQL version to select the right tarball for your environment.</p> <p>You can download the binary tarballs from the <code>Linux - Generic</code> section on the download page.</p> <p>Fetch and extract the correct binary tarball. For example for Debian 10:</p> <pre><code>$ wget https://downloads.percona.com/downloads/Percona-Server-8.0/Percona-Server-8.0.26-16/binary/tarball/Percona-Server-8.0.26-16-Linux.x86_64.glibc2.12.tar.gz\n</code></pre>"},{"location":"binary-tarball-names.html","title":"Binary tarball file names available based on the Percona Server for MySQL version","text":"<p>For later version of Percona Server for MySQL, the tar files are organized by the <code>glibc2</code> version. You can find this version on your operating system with the following command:</p> <pre><code>$ ldd --version\n</code></pre> Expected output <pre><code>ldd (Ubuntu GLIBC 2.35-0ubuntu3.1) 2.35\nCopyright (C) 2022 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\nWritten by Roland McGrath and Ulrich Drepper.\n</code></pre> <p>If the <code>glibc2</code> version from your operating system is not listed, then this Percona Server for MySQL version does not support that operating system.</p>"},{"location":"binary-tarball-names.html#binary-tarball-file-name-organization","title":"Binary tarball file name organization","text":"8.0.26-16 and laterZenfs8.0.20-11 to 8.0.25-178.0.19-10 and earlier <p>The following lists the platform and the associated full binary file name used by Percona Server for MySQL tar files from version 8.0.26-16 and later.</p> Platform Percona Server for MySQL tarball name glibc2 version Ubuntu 22.04 Percona-Server-8.0.30-22-Linux.x86_64.glibc2.35-zenfs.tar.gz glibc2.35 Ubuntu 20.04 Percona-Server-8.0.30-22-Linux.x86_64.glibc2.31.tar.gz glibc2.31 Ubuntu 18.04 Percona-Server-8.0.30-22-Linux.x86_64.glibc2.27.tar.gz glibc2.27 Red Hat Enterprise 9 Percona-Server-8.0.30-22-Linux.x86_64.glibc2.34.tar.gz glibc2.34 Red Hat Enterprise 8 Percona-Server-8.0.30-22-Linux.x86_64.glibc2.28.tar.gz glibc2.28 Red Hat Enterprise 7 Percona-Server-8.0.30-22-Linux.x86_64.glibc2.17.tar.gz glibc2.17 Red Hat Enterprise 6 Percona-Server-8.0.20-11-Linux.x86_64.glibc2.12.tar.gz glibc2.12 <p>The types of files are as follows:</p> Type Name Description Full Percona-Server--Linux.x86_64..tar.gz Contains all files available Minimal Percona-Server-&lt;version-number&gt;-Linux.x86_64.&lt;glibc2-version&gt;.minimal.tar.gz Contains binaries and libraries Debug Percona-Server-&lt;version-number&gt;-Linux.x86_64.&lt;glibc2-version&gt;.debug.tar.gz Contains the minimal build files and test files, and debug symbols Zenfs Percona-Server-&lt;version-number&gt;-Linux.x86_64.&lt;glibc2-version&gt;-zenfs.tar.gz Contains the zenfs files and can be either a full or minimal installation <p>Implemented in Percona for MySQL 8.0.26-16, the following binary tarballs are available for the MyRocks ZenFS installation. See Installing and configuring Percona Server for MySQL with ZenFS support for more information and the installation procedure.</p> Type Name Description Full Percona-Server-&lt;version number&gt;-Linux.x86_64.&lt;glibc-version&gt;-zenfs.tar.gz Contains the binaries, libraries, test files, and debug symbols Minimal Percona-Server-&lt;version number&gt;-Linux.x86_64.&lt;glibc-version&gt;-zenfs-minimal.tar.gz Contains the binaries and libraries but does not include test files or debug symbols <p>At this time, you can enable the ZenFS plugin in the following distributions:</p> Distribution Name Notes Debian 11.1 Able to run the ZenFS plugin Ubuntu 20.04.3 Requires the 5.11 HWE kernel patched with the allow blk-zoned ioctls without CAPT_SYS_ADMIN patch <p>If you do not enable the ZenFS functionality on Ubuntu 20.04, the binaries with ZenFS support can run on the standard 5.4 kernel. Other Linux distributions are adding support for ZenFS, but Percona does not provide installation packages for those distributions.</p> <p>The multiple binary tarballs from earlier versions are replaced with the following:</p> Type Name Operating systems Description Full Percona-Server-&lt;version number&gt;-Linux.x86_64.glibc2.12.tar.gz Built for CentOS 6 Contains binaries, libraries, test files, and debug symbols Minimal Percona-Server-&lt;version number&gt;-Linux.x86_64.glibc2.12-minimal.tar.gz Built for CentOS 6 Contains binaries and libraries but does not include test files, or debug symbols Full Percona-Server-&lt;version number&gt;-Linux.x86_64.glibc2.17.tar.gz Compatible with any supported operating system except for CentOS 6 Contains binaries, libraries, test files, and debug symbols Minimal Percona-Server-&lt;version number&gt;-Linux.x86_64.glibc2.17-minimal.tar.gz Compatible with any supported operating system except for CentOS 6 Contains binaries and libraries but does not include test files or debug symbols <p>The tarball file has the following characteristics:</p> Type Name Description Full Percona-Server--Linux.x86_64..tar.gz Contains all files available Minimal Percona-Server-&lt;version-number&gt;-Linux.x86_64.&lt;glibc2-version&gt;.minimal.tar.gz Contains binaries and libraries Debug Percona-Server-&lt;version-number&gt;-Linux.x86_64.&lt;glibc2-version&gt;.debug.tar.gz Contains the minimal build files and test files, and debug symbols <p>For Percona Server for MySQL 8.0.19-10 and earlier, multiple tarballs are provided based on the OpenSSL library available in the distribution:</p> <ul> <li> <p>ssl100 - for Debian prior to 9 and Ubuntu prior to 14.04 versions (<code>libssl.so.1.0.0 =&gt; /usr/lib/x86_64-linux-gnu/libssl.so.1.0.0</code>);</p> </li> <li> <p>ssl102 - for Debian 9 and Ubuntu versions starting from 14.04 (<code>libssl.so.1.1 =&gt; /usr/lib/libssl.sl.1.1</code>)</p> </li> <li> <p>ssl101 - for CentOS 6 and CentOS 7 (<code>libssl.so.10 =&gt; /usr/lib64/libssl.so.10</code>);</p> </li> <li> <p>ssl102 - for CentOS 8 and RedHat 8  (<code>libssl.so.1.1 =&gt; /usr/lib/libssl.so.1.1.1b</code>);</p> </li> </ul>"},{"location":"binlog-space.html","title":"Limiting the disk space used by binary log files","text":"<p>It is a challenge to control how much disk space is used by the binary logs. The size of a binary log can vary because a single transaction must be written to a single binary log and cannot be split between multiple binary log files.</p>"},{"location":"binlog-space.html#binlog_space_limit","title":"binlog_space_limit","text":"Attribute Description Uses the command line Yes Uses the configuration file Yes Scope Global Dynamic No Variable type ULONG_MAX Default value 0 (unlimited) Maximum value - 64-bit platform 18446744073709547520 <p>This variable places an upper limit on the total size in bytes of all binary logs. When the limit is reached, the oldest binary logs are purged until the total size is under the limit or only the active log remains.</p> <p>The default value of <code>0</code> disables the feature. No limit is set on the log space. The binary logs accumulate indefinitely until the disk space is full.</p>"},{"location":"binlog-space.html#example","title":"Example","text":"<p>Set the <code>binlog_space_limit</code> to 50 GB in the <code>my.cnf</code> file:</p> <pre><code>[mysqld]\n...\nbinlog_space_limit = 50G\n...\n</code></pre>"},{"location":"binlogging-replication-improvements.html","title":"Binary logs and replication improvements","text":"<p>Due to continuous development, Percona Server for MySQL incorporated a number of improvements related to replication and binary logs handling. This resulted in replication specifics, which distinguishes it from MySQL.</p>"},{"location":"binlogging-replication-improvements.html#safety-of-statements-with-a-limit-clause","title":"Safety of statements with a <code>LIMIT</code> clause","text":""},{"location":"binlogging-replication-improvements.html#summary-of-the-fix","title":"Summary of the fix","text":"<p>MySQL considers all <code>UPDATE/DELETE/INSERT ... SELECT</code> statements with <code>LIMIT</code> clause to be unsafe, no matter wether they are really producing non-deterministic result or not, and switches from statement-based logging to row-based one. Percona Server for MySQL is more accurate, it acknowledges such instructions as safe when they include <code>ORDER BY PK</code> or <code>WHERE</code> condition. This fix has been ported from the upstream bug report #42415 (#44).</p>"},{"location":"binlogging-replication-improvements.html#performance-improvement-on-relay-log-position-update","title":"Performance improvement on relay log position update","text":""},{"location":"binlogging-replication-improvements.html#relay-log-position-fix","title":"Relay log position fix","text":"<p>MySQL always updated relay log position in multi-source replications setups regardless of whether the committed transaction has already been executed or not. Percona Server omits relay log position updates for the already logged GTIDs.</p>"},{"location":"binlogging-replication-improvements.html#relay-log-position-details","title":"Relay log position details","text":"<p>Particularly, such unconditional relay log position updates caused additional fsync operations in case of <code>relay-log-info-repository=TABLE</code>, and with the higher number of channels transmitting such duplicate (already executed) transactions the situation became proportionally worse. Bug fixed #1786 (upstream #85141).</p>"},{"location":"binlogging-replication-improvements.html#performance-improvement-on-source-and-connection-status-updates","title":"Performance improvement on source and connection status updates","text":""},{"location":"binlogging-replication-improvements.html#source-and-connection-status-update-fix","title":"Source and connection status update fix","text":"<p>Replica nodes configured to update source status and connection information only on log file rotation did not experience the expected reduction in load. MySQL was additionally updating this information in case of multi-source replication when replica had to skip the already executed GTID event.</p>"},{"location":"binlogging-replication-improvements.html#source-and-connection-status-details","title":"Source and connection status details","text":"<p>The configuration with <code>master_info_repository=TABLE</code> and <code>sync_master_info=0</code> makes replica to update source status and connection information in this table on log file rotation and not after each sync_master_info event, but it didn\u2019t work on multi-source replication setups. Heartbeats sent to the replica to skip GTID events which it had already executed previously, were evaluated as relay log rotation events and reacted with <code>mysql.slave_master_info</code> table sync. This inaccuracy could produce huge (up to 5 times on some setups) increase in write load on the replica, before this problem was fixed in Percona Server for MySQL. Bug fixed #1812 (upstream #85158).</p>"},{"location":"binlogging-replication-improvements.html#write-flush-commands-to-the-binary-log","title":"Write <code>FLUSH</code> commands to the binary log","text":"<p><code>FLUSH</code> commands, such as <code>FLUSH SLOW LOGS</code>, are not written to the binary log if the system variable binlog_skip_flush_commands is set to ON.</p> <p>In addition, the following changes were implemented in the behavior of <code>read_only</code> and super_read_only modes:</p> <ul> <li> <p>When <code>read_only</code> is set to ON, any <code>FLUSH ...</code> command executed by a normal user (without the <code>SUPER</code> privilege) are not written to the binary log regardless of the value of the binlog_skip_flush_command variable.</p> </li> <li> <p>When super_read_only is set to ON, any <code>FLUSH ...</code> command executed by any user (even by those with the <code>SUPER</code> privilege) are not written to the binary log regardless of the value of the binlog_skip_flush_commands variable.</p> </li> </ul> <p>An attempt to run a <code>FLUSH</code> command without either <code>SUPER</code> or <code>RELOAD</code> privileges results in the <code>ER_SPECIFIC_ACCESS_DENIED_ERROR</code> exception regardless of the value of the binlog_skip_flush_commands variable.</p>"},{"location":"binlogging-replication-improvements.html#binlog_skip_flush_commands","title":"binlog_skip_flush_commands","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Default OFF <p>This variable was introduced in Percona Server for MySQL 8.0.15-5.</p> <p>When binlog_skip_flush_commands is set to ON, <code>FLUSH ...</code> commands are not written to the binary log. See Writing FLUSH Commands to the Binary Log for more information about what else affects the writing of <code>FLUSH</code> commands to the binary log.</p> <p>Note</p> <p><code>FLUSH LOGS</code>, <code>FLUSH BINARY LOGS</code>, <code>FLUSH TABLES WITH READ LOCK</code>, and <code>FLUSH TABLES ... FOR EXPORT</code> are not written to the binary log no matter what value the binlog_skip_flush_commands variable contains. The <code>FLUSH</code> command is not recorded to the binary log and the value of binlog_skip_flush_commands is ignored if the <code>FLUSH</code> command is run with the <code>NO_WRITE_TO_BINLOG</code> keyword (or its alias <code>LOCAL</code>).</p>"},{"location":"binlogging-replication-improvements.html#maintaining-comments-with-drop-table","title":"Maintaining comments with DROP TABLE","text":"<p>When you issue a <code>DROP TABLE</code> command, the binary log stores the command but removes comments and encloses the table name in quotation marks. If you require the binary log to maintain the comments and not add quotation marks, enable <code>binlog_ddl_skip_rewrite</code>.</p>"},{"location":"binlogging-replication-improvements.html#binlog_ddl_skip_rewrite","title":"binlog_ddl_skip_rewrite","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Default OFF <p>This variable was introduced in Percona Server for MySQL 8.0.26-16.</p> <p>If the variable is enabled, single table <code>DROP TABLE</code> DDL statements are logged in the binary log with comments. Multi-table <code>DROP TABLE</code> DDL statements are not supported and return an error.</p> <pre><code>SET binlog_ddl_skip_rewrite = ON;\n/*comment at start*/DROP TABLE t /*comment at end*/;\n</code></pre>"},{"location":"binlogging-replication-improvements.html#binary-log-user-defined-functions","title":"Binary log user defined functions","text":"<p>To implement Point in Time recovery, we have added the <code>binlog_utils_udf</code>. The following user-defined functions are included:</p> Name Returns Description get_binlog_by_gtid() Binlog file name as STRING Returns the binlog file name that contains the specified GTID get_last_gtid_from_binlog() GTID as STRING Returns the last GTID found in the specified binlog get_gtid_set_by_binlog() GTID set as STRING Returns all GTIDs found in the specified binlog get_binlog_by_gtid_set() Binlog file name as STRING Returns the file name of the binlog which contains at least one GTID from the specified set. get_first_record_timestamp_by_binlog() Timestamp as INTEGER Returns the timestamp of the first event in the specified binlog get_last_record_timestamp_by_binlog() Timestamp as INTEGER Returns the timestamp of the last event in the specified binlog <p>Note</p> <p>All functions returning timestamps return their values as microsecond precision UNIX time. In other words, they represent the number of microseconds since 1-JAN-1970.</p> <p>All functions accepting a binlog name as the parameter accepts only short names, without a path component. If the path separator (\u2018/\u2019) is found in the input, an error is returned. This serves the purpose of restricting the locations from where binlogs can be read. They are always read from the current binlog directory (@@log_bin_basename system variable).</p> <p>All functions returning binlog file names return the name in short form, without a path component.</p> <p>The basic syntax for <code>get_binlog_by_gtid()</code> is the following:</p> <pre><code>* get_binlog_by_gtid(string) [AS] alias\n</code></pre> <p>Usage: SELECT get_binlog_by_gtid(string) [AS] alias</p> <p>Example:</p> <pre><code>CREATE FUNCTION get_binlog_by_gtid RETURNS STRING SONAME 'binlog_utils_udf.so';\nSELECT get_binlog_by_gtid(\"F6F54186-8495-47B3-8D9F-011DDB1B65B3:1\") AS result;\n</code></pre> Expected output <pre><code>+--------------+\n| result       |\n+==============+\n| binlog.00001 |\n+--------------+\n</code></pre> <pre><code>DROP FUNCTION get_binlog_by_gtid;\n</code></pre> <p>The basic syntax for <code>get_last_gtid_from_binlog()</code> is the following:</p> <pre><code>* get_last_gtid_from_binlog(string) [AS] alias\n</code></pre> <p>Usage: SELECT get_last_gtid_from_binlog(string) [AS] alias</p> <p>For example:</p> <pre><code>CREATE FUNCTION get_last_gtid_from_binlog RETURNS STRING SONAME 'binlog_utils_udf.so';\nSELECT get_last_gtid_from_binlog(\"binlog.00001\") AS result;\n</code></pre> Expected output <pre><code>+-----------------------------------------+\n| result                                  |\n+=========================================+\n| F6F54186-8495-47B3-8D9F-011DDB1B65B3:10 |\n+-----------------------------------------+\n</code></pre> <pre><code>DROP FUNCTION get_last_gtid_from_binlog;\n</code></pre> <p>The basic syntax for <code>get_gtid_set_by_binlog()</code> is the following:</p> <pre><code>* get_gtid_set_by_binlog(string) [AS] alias\n</code></pre> <p>Usage: SELECT get_gtid_set_by_binlog(string) [AS] alias</p> <p>For example:</p> <pre><code>CREATE FUNCTION get_gtid_set_by_binlog RETURNS STRING SONAME 'binlog_utils_udf.so';\nSELECT get_gtid_set_by_binlog(\"binlog.00001\") AS result;\n</code></pre> Expected output <pre><code>+-------------------------+\n| result                  |\n+=========================+\n| 11ea-b9a7:7,11ea-b9a7:8 |\n+-------------------------+\n</code></pre> <pre><code>DROP FUNCTION get_gtid_set_by_binlog;\n</code></pre> <p>The basic syntax for <code>get_binlog_by_gtid_set()</code> is the following:</p> <ul> <li>get_binlog_by_gtid_set(string) [AS] alias</li> </ul> <p>Usage: SELECT get_binlog_by_gtid_set(string) [AS] alias</p> <p>Example:</p> <pre><code>CREATE FUNCTION get_binlog_by_gtid_set RETURNS STRING SONAME 'binlog_utils_udf.so';\nSELECT get_binlog_by_gtid_set(\"11ea-b9a7:7,11ea-b9a7:8\") AS result;\n</code></pre> Expected output <pre><code>+---------------------------------------------------------------+\n| result                                                        |\n+===============================================================+\n| bin.000003                                                    |\n+---------------------------------------------------------------+\n</code></pre> <pre><code>DROP FUNCTION get_binlog_by_gtid_set;\n</code></pre> <p>The basic syntax for <code>get_first_record_timestamp_by_binlog()</code> is the following:</p> <pre><code>* get_first_record_timestamp_by_binlog(TIMESTAMP) [AS] alias\n</code></pre> <p>Usage: SELECT get_first_record_timestamp_by_binlog(TIMESTAMP) [AS] alias</p> <p>For example:</p> <pre><code>CREATE FUNCTION get_first_record_timestamp_by_binlog RETURNS INTEGER SONAME 'binlog_utils_udf.so';\nSELECT FROM_UNIXTIME(get_first_record_timestamp_by_binlog(\"bin.00003\") DIV 1000000) AS result;\n</code></pre> Expected output <pre><code>+---------------------+\n| result              |\n+=====================+\n| 2020-12-03 09:10:40 |\n+---------------------+\n</code></pre> <pre><code>DROP FUNCTION get_first_record_timestamp_by_binlog;\n</code></pre> <p>The basic syntax for <code>get_last_record_timestamp_by_binlog()</code> is the following:</p> <pre><code>* get_last_record_timestamp_by_binlog(TIMESTAMP) [AS] alias\n</code></pre> <p>Usage: SELECT get_last_record_timestamp_by_binlog(TIMESTAMP) [AS] alias</p> <p>For example:</p> <pre><code>CREATE FUNCTION get_last_record_timestamp_by_binlog RETURNS INTEGER SONAME 'binlog_utils_udf.so';\nSELECT FROM_UNIXTIME(get_last_record_timestamp_by_binlog(\"bin.00003\") DIV 1000000) AS result;\n</code></pre> Expected output <pre><code>+---------------------+\n| result              |\n+=====================+\n| 2020-12-04 04:18:56 |\n+---------------------+\n</code></pre> <pre><code>DROP FUNCTION get_last_record_timestamp_by_binlog;\n</code></pre>"},{"location":"binlogging-replication-improvements.html#limitations","title":"Limitations","text":"<p>For the following variables, do not define values with one or more dot (.) characters:</p> <ul> <li> <p>log_bin</p> </li> <li> <p>log_bin_index</p> </li> </ul> <p>A value defined with these characters is handled differently in MySQL and Percona XtraBackup and can cause unpredictable behavior.</p>"},{"location":"build-apt-packages.html","title":"Build APT packages","text":"<p>If you wish to build your own Debian/Ubuntu (dpkg) packages of Percona Server for MySQL, you first need to start with a source tarball, either from the Percona website or by generating your own by following the instructions above (Installing Percona Server for MySQL from the Git Source Tree).</p> <p>Extract the source tarball:</p> <pre><code>$ tar xfz Percona-Server-8.0.13-3-Linux.x86_64.ssl102.tar.gz\n$ cd Percona-Server-8.0.13-3\n</code></pre> <p>Copy the Debian packaging in the directory that Debian expects it to be in:</p> <pre><code>$ cp -ap build-ps/debian debian\n</code></pre> <p>Update the changelog for your distribution (here we update for the unstable distribution - sid), setting the version number appropriately. The trailing one in the version number is the revision of the Debian packaging.</p> <pre><code>$ dch -D unstable --force-distribution -v \"8.0.13-3-1\" \"Update to 8.0.13-3\"\n</code></pre> <p>Build the Debian source package:</p> <pre><code>$ dpkg-buildpackage -S\n</code></pre> <p>Use sbuild to build the binary package in a chroot:</p> <pre><code>$ sbuild -d sid percona-server-8.0_8.0.13-3-1.dsc\n</code></pre> <p>You can give different distribution options to <code>dch</code> and <code>sbuild</code> to build binary packages for all Debian and Ubuntu releases.</p> <p>Note</p> <p>PAM Authentication Plugin is not built with the server by default. In order to build the Percona Server for MySQL with PAM plugin, an additional option <code>-DWITH_PAM=ON</code> should be used.</p>"},{"location":"changed-page-tracking.html","title":"XtraDB changed page tracking","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.30, the changed page tracking feature is removed and no longer supported.</p> <p>Starting with Percona Server for MySQL 8.0.27, the page tracking feature is deprecated and may be removed in future versions.</p> <p>We recommend using the MySQL page tracking feature. For more information, see MySQL InnoDB Clone and page tracking.</p> <p>XtraDB now tracks the pages that have changes written to them according to the redo log. This information is written out in special changed page bitmap files. This information can be used to speed up incremental backups using Percona XtraBackup by removing the need to scan whole data files to find the changed pages. Changed page tracking is done by a new XtraDB worker thread that reads and parses log records between checkpoints. The tracking is controlled by a new read-only server variable innodb_track_changed_pages.</p> <p>Bitmap filename format used for changed page tracking is <code>ib_modified_log_&lt;seq&gt;_&lt;startlsn&gt;.xdb</code>. The first number is the sequence number of the bitmap log file and the startlsn number is the starting LSN number of data tracked in that file. Example of the bitmap log files should look like this:</p> Expected output <pre><code>ib_modified_log_1_0.xdb\nib_modified_log_2_1603391.xdb\n</code></pre> <p>Sequence number can be used to easily check if all the required bitmap files are present. Start LSN number will be used in XtraBackup and <code>INFORMATION_SCHEMA</code> queries to determine which files have to be opened and read for the required LSN interval data. The bitmap file is rotated on each server restart and whenever the current file size reaches the predefined maximum. This maximum is controlled by a new innodb_max_bitmap_file_size variable.</p> <p>Old bitmap files may be safely removed after a corresponding incremental backup is taken. For that there are server User statements for handling the XtraDB changed page bitmaps. Removing the bitmap files from the filesystem directly is safe too, as long as care is taken not to delete data for not-yet-backuped LSN range.</p> <p>This feature will be used for implementing faster incremental backups that use this information to avoid full data scans in Percona XtraBackup.</p>"},{"location":"changed-page-tracking.html#user-statements-for-handling-the-xtradb-changed-page-bitmaps","title":"User statements for handling the XtraDB changed page bitmaps","text":"<p>New statements have been introduced for handling the changed page bitmap tracking. All of these statements require <code>SUPER</code> privilege.</p> <ul> <li> <p><code>FLUSH CHANGED_PAGE_BITMAPS</code> - this statement can be used for synchronous bitmap write for immediate catch-up with the log checkpoint. This is used by innobackupex to make sure that XtraBackup indeed has all the required data it needs.</p> </li> <li> <p><code>RESET CHANGED_PAGE_BITMAPS</code> - this statement will delete all the bitmap log files and restart the bitmap log file sequence.</p> </li> <li> <p><code>PURGE CHANGED_PAGE_BITMAPS BEFORE &lt;lsn&gt;</code> - this statement will delete all the change page bitmap files up to the specified log sequence number.</p> </li> </ul>"},{"location":"changed-page-tracking.html#additional-information-in-show-engine-innodb-status","title":"Additional information in SHOW ENGINE INNODB STATUS","text":"<p>When log tracking is enabled, the following additional fields are displayed in the LOG section of the <code>SHOW ENGINE INNODB STATUS</code> output:</p> <ul> <li> <p>\u201cLog tracked up to:\u201d displays the LSN up to which all the changes have been parsed and stored as a bitmap on disk by the log tracking thread</p> </li> <li> <p>\u201cMax tracked LSN age:\u201d displays the maximum limit on how far behind the log tracking thread may be.</p> </li> </ul> <p>Note</p> <p>Implemented in Percona Server for MySQL 8.0.13-4, a new InnoDB monitor, log_writer_on_tracker_waits, records log writer waits due to changed page tracking lag. This log writer works in parallel with other log_writer_on_[*]_ waits monitors.</p>"},{"location":"changed-page-tracking.html#information_schema-tables","title":"INFORMATION_SCHEMA tables","text":"<p>This table contains a list of modified pages from the bitmap file data. As these files are generated by the log tracking thread parsing the log whenever the checkpoint is made, it is not real-time data.</p>"},{"location":"changed-page-tracking.html#information_schemainnodb_changed_pages","title":"<code>INFORMATION_SCHEMA.INNODB_CHANGED_PAGES</code>","text":"Column Name Description \u2018INT(11) space_id\u2019 \u2018space id of modified page\u2019 \u2018INT(11) page_id\u2019 \u2018id of modified page\u2019 \u2018BIGINT(21) start_lsn\u2019 \u2018start of the interval\u2019 \u2018BIGINT(21) end_lsn\u2019 \u2018end of the interval \u2018 <p>The <code>start_lsn</code> and the <code>end_lsn</code> columns denote between which two checkpoints this page was changed at least once. They are also equal to checkpoint LSNs.</p> <p>Number of records in this table can be limited by using the variable innodb_max_changed_pages.</p>"},{"location":"changed-page-tracking.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"changed-page-tracking.html#system-variables","title":"System variables","text":""},{"location":"changed-page-tracking.html#innodb_max_changed_pages","title":"<code>innodb_max_changed_pages</code>","text":"Option Description Command Line: Yes Config file Yes Scope: Global Dynamic: Yes Data type Numeric Default value 1000000 Range 1 - 0 (unlimited) <p>This variable is used to limit the result row count for the queries from INFORMATION_SCHEMA.INNODB_CHANGED_PAGES table.</p>"},{"location":"changed-page-tracking.html#innodb_track_changed_pages","title":"<code>innodb_track_changed_pages</code>","text":"Option Description Command Line: Yes Config file Yes Scope: Global Dynamic: No Data type Boolean Default value 0 - False Range 0-1 <p>This variable is used to enable/disable XtraDB changed page tracking feature.</p>"},{"location":"changed-page-tracking.html#innodb_max_bitmap_file_size","title":"<code>innodb_max_bitmap_file_size</code>","text":"Option Description Command Line: Yes Config file Yes Scope: Global Dynamic: Yes Data type Numeric Default value 104857600 (100 MB) Range 4096 (4KB) - 18446744073709551615 (16EB) <p>This variable is used to control maximum bitmap size after which the file will be rotated.</p>"},{"location":"compile-percona-server.html","title":"Compile Percona Server for MySQL 8.0 from source","text":"<p>The following instructions install Percona Server for MySQL 8.0.</p>"},{"location":"compile-percona-server.html#install-percona-server-for-mysql-from-the-git-source-tree","title":"Install Percona Server for MySQL from the Git Source Tree","text":"<p>Percona uses the Github revision control system for development. To build the latest Percona Server for MySQL from the source tree, you will need <code>git</code> installed on your system.</p> <p>You can now fetch the latest Percona Server for MySQL 8.0 sources.</p> <pre><code>$ git clone https://github.com/percona/percona-server.git\n$ cd percona-server\n$ git checkout 8.0\n$ git submodule init\n$ git submodule update\n</code></pre> <p>If you are going to be making changes to Percona Server for MySQL 8.0 and wanting to distribute the resulting work, you can generate a new source tarball (exactly the same way as we do for release):</p> <pre><code>$ cmake .\n$ make dist\n</code></pre> <p>After either fetching the source repository or extracting a source tarball (from Percona or one you generated yourself), you will now need to configure and build Percona Server for MySQL.</p> <p>First, run CMake to configure the build. Here you can specify all the normal build options as you do for a normal MySQL build. Depending on what options you wish to compile Percona Server for MySQL with, you may need other libraries installed on your system. Here is an example using a configure line similar to the options that Percona uses to produce binaries:</p> <pre><code>$ cmake . -DCMAKE_BUILD_TYPE=RelWithDebInfo -DBUILD_CONFIG=mysql_release -DFEATURE_SET=community\n</code></pre>"},{"location":"compile-percona-server.html#compile-from-source","title":"Compile from source","text":"<p>Now, compile using make:</p> <pre><code>$ make\n</code></pre> <p>Install:</p> <pre><code>$ make install\n</code></pre> <p>Percona Server for MySQL 8.0 is installed on your system.</p>"},{"location":"compressed-columns.html","title":"Compressed columns with dictionaries","text":"<p>The <code>per-column compression</code> feature is a data type modifier, independent from user-level SQL and InnoDB data compression, that causes the data stored in the column to be compressed on writing to storage and decompressed on reading. For all other purposes, the data type is identical to the one without the modifier, i.e. no new data types are created. Compression is done by using the <code>zlib</code> library.</p> <p>Additionally, it is possible to pre-define a set of strings for each compressed column to achieve a better compression ratio on relatively small individual data items.</p> <p>This feature provides:</p> <ul> <li> <p>a better compression ratio for text data which consists of a large number of predefined words (e.g. JSON or XML) using compression methods with static dictionaries</p> </li> <li> <p>a way to select columns in the table to compress (in contrast to the InnoDB row compression method). This feature is based on a patch provided by Weixiang Zhai.</p> </li> </ul>"},{"location":"compressed-columns.html#specifications","title":"Specifications","text":"<p>The feature is limited to InnoDB/XtraDB storage engine and to columns of the following data types:</p> <ul> <li> <p><code>BLOB</code> (including <code>TINYBLOB</code>, <code>MEDIUMBLOB</code>, <code>LONGBLOG</code>)</p> </li> <li> <p><code>TEXT</code> (including <code>TINYTEXT</code>, <code>MEDUUMTEXT</code>, <code>LONGTEXT</code>)</p> </li> <li> <p><code>VARCHAR</code> (including <code>NATIONAL VARCHAR</code>)</p> </li> <li> <p><code>VARBINARY</code></p> </li> <li> <p><code>JSON</code></p> </li> </ul> <p>A compressed column is declared by using the syntax that extends the existing <code>COLUMN_FORMAT</code> modifier: <code>COLUMN_FORMAT COMPRESSED</code>. If this modifier is applied to an unsupported column type or storage engine, an error is returned.</p> <p>The compression can be specified:</p> <ul> <li> <p>when creating a table: <code>CREATE TABLE ... (..., foo BLOB COLUMN_FORMAT COMPRESSED, ...);</code></p> </li> <li> <p>when altering a table and modifying a column to the compressed format: <code>ALTER TABLE ... MODIFY [COLUMN] ... COLUMN_FORMAT COMPRESSED</code>, or <code>ALTER TABLE ... CHANGE [COLUMN] ... COLUMN_FORMAT COMPRESSED</code>.</p> </li> </ul> <p>Unlike Oracle MySQL, compression is applicable to generated stored columns. Use this syntax extension as follows:</p> <pre><code>mysql&gt; CREATE TABLE t1(\n       id INT,\n       a BLOB,\n       b JSON COLUMN_FORMAT COMPRESSED,\n       g BLOB GENERATED ALWAYS AS (a) STORED COLUMN_FORMAT COMPRESSED WITH COMPRESSION_DICTIONARY numbers\n     ) ENGINE=InnoDB;\n</code></pre> <p>To decompress a column, specify a value other than <code>COMPRESSED</code> to <code>COLUMN_FORMAT</code>: <code>FIXED</code>, <code>DYNAMIC</code>, or <code>DEFAULT</code>. If there is a column compression/decompression request in an <code>ALTER TABLE</code>, it is forced to the <code>COPY</code> algorithm.</p> <p>Two new variables: innodb_compressed_columns_zip_level and innodb_compressed_columns_threshold have been implemented.</p>"},{"location":"compressed-columns.html#compression-dictionary-support","title":"Compression dictionary support","text":"<p>To achieve a better compression ratio on relatively small individual data items, it is possible to predefine a compression dictionary, which is a set of strings for each compressed column.</p> <p>Compression dictionaries can be represented as a list of words in the form of a string (a comma or any other character can be used as a delimiter although not required). In other words, <code>a, bb, ccc</code>, <code>a bb ccc</code>, and <code>abbccc</code> will have the same effect. However, the latter is more compact. The Quote symbol quoting is handled by regular SQL quoting. The maximum supported dictionary length is 32506 bytes (<code>zlib</code> limitation).</p> <p>The compression dictionary is stored in a new system InnoDB table.  As this table is of the data dictionary kind, concurrent reads are allowed, but writes are serialized, and reads are blocked by writes. Table read through old read views are not supported, similar to InnoDB internal DDL transactions.</p>"},{"location":"compressed-columns.html#interaction-with-innodb_force_recovery-variable","title":"Interaction with innodb_force_recovery variable","text":"<p>Compression dictionary operations are treated like DDL operations with the exception when innodb_force_value is set to <code>3</code>: with values less than <code>3</code>, compression dictionary operations are allowed, and with values &gt;= <code>3</code>, they are forbidden.</p> <p>Note</p> <p>Prior to Percona Server for MySQL 8.0.15-6 using Compression dictionary operations with innodb_force_recovery variable set to value &gt; 0 would result in an error.</p>"},{"location":"compressed-columns.html#example","title":"Example","text":"<p>In order to use the compression dictionary, you need to create it. This can be done by running:</p> <pre><code>mysql&gt; SET @dictionary_data = 'one' 'two' 'three' 'four';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <pre><code>mysql&gt; CREATE COMPRESSION_DICTIONARY numbers (@dictionary_data);\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.00 sec)\n</code></pre> <p>To create a table that has both compression and compressed dictionary support you should run:</p> <pre><code>mysql&gt; CREATE TABLE t1(\n        id INT,\n        a BLOB COLUMN_FORMAT COMPRESSED,\n        b BLOB COLUMN_FORMAT COMPRESSED WITH COMPRESSION_DICTIONARY numbers\n      ) ENGINE=InnoDB;\n</code></pre> <p>The following example shows how to insert a sample of JSON data into the table:</p> <pre><code>SET @json_value =\n'[\\n'\n' {\\n'\n' \"one\" = 0,\\n'\n' \"two\" = 0,\\n'\n' \"three\" = 0,\\n'\n' \"four\" = 0\\n'\n' },\\n'\n' {\\n'\n' \"one\" = 0,\\n'\n' \"two\" = 0,\\n'\n' \"three\" = 0,\\n'\n' \"four\" = 0\\n'\n' },\\n'\n' {\\n'\n' \"one\" = 0,\\n'\n' \"two\" = 0,\\n'\n' \"three\" = 0,\\n'\n' \"four\" = 0\\n'\n' },\\n'\n' {\\n'\n' \"one\" = 0,\\n'\n' \"two\" = 0,\\n'\n' \"three\" = 0,\\n'\n' \"four\" = 0\\n'\n' }\\n'\n']\\n'\n;\n</code></pre> <pre><code>mysql&gt; INSERT INTO t1 VALUES(0, @json_value, @json_value);\nQuery OK, 1 row affected (0.01 sec)\n</code></pre>"},{"location":"compressed-columns.html#information_schema-tables","title":"INFORMATION_SCHEMA Tables","text":"<p>This feature implements two new <code>INFORMATION_SCHEMA</code> tables.</p>"},{"location":"compressed-columns.html#information_schemacompression_dictionary","title":"<code>INFORMATION_SCHEMA.COMPRESSION_DICTIONARY</code>","text":"Column Name Description \u2018BIGINT(21)_UNSIGNED dict_version\u2019 \u2018dictionary version\u2019 \u2018VARCHAR(64) dict_name\u2019 \u2018dictionary name\u2019 \u2018BLOB dict_data\u2019 \u2018compression dictionary string\u2019 <p>This table provides a view of the internal compression dictionary. The <code>SUPER</code> privilege is required to query it.</p>"},{"location":"compressed-columns.html#information_schemacompression_dictionary_tables","title":"<code>INFORMATION_SCHEMA.COMPRESSION_DICTIONARY_TABLES</code>","text":"Column Name Description \u2018BIGINT(21)_UNSIGNED table_schema\u2019 \u2018table schema\u2019 \u2018BIGINT(21)_UNSIGNED table_name\u2019 \u2018table ID from INFORMATION_SCHEMA.INNODB_SYS_TABLES\u2019 \u2018BIGINT(21)_UNSIGNED column_name\u2019 \u2018column position (starts from 0 as in INFORMATION_SCHEMA.INNODB_SYS_COLUMNS)\u2019 \u2018BIGINT(21)_UNSIGNED dict_name\u2019 \u2018dictionary ID\u2019 <p>This table provides a view over the internal table that stores the mapping between the compression dictionaries and the columns using them. The <code>SUPER</code> privilege is require to query it.</p>"},{"location":"compressed-columns.html#limitations","title":"Limitations","text":"<p>Compressed columns cannot be used in indices (neither on their own nor as parts of composite keys).</p> <p>Note</p> <p><code>CREATE TABLE t2 AS SELECT \\* FROM t1</code> will create a new table with a compressed column, whereas <code>CREATE TABLE t2 AS SELECT CONCAT(a,'') AS a FROM t1</code> will not create compressed columns.</p> <p>At the same time, after executing the <code>CREATE TABLE t2 LIKE t1</code> statement, <code>t2.a</code> will have the <code>COMPRESSED</code> attribute.</p> <p><code>ALTER TABLE ... DISCARD/IMPORT TABLESPACE</code> is not supported for tables with compressed columns. To export and import tablespaces with compressed columns, you uncompress them first with: <code>ALTER TABLE ... MODIFY ... COLUMN_FORMAT DEFAULT</code>.</p>"},{"location":"compressed-columns.html#mysqldump-command-line-parameters","title":"mysqldump command line parameters","text":"<p>By default, with no additional options, <code>mysqldump</code> will generate a MySQL compatible SQL output.</p> <p>All <code>/\\*!50633 COLUMN_FORMAT COMPRESSED \\*/</code> and <code>/\\*!50633 COLUMN_FORMAT COMPRESSED WITH COMPRESSION_DICTIONARY &lt;dictionary&gt; \\*/</code> won\u2019t be in the dump.</p> <p>When a new option enable-compressed-columns is specified, all <code>/\\*!50633 COLUMN_FORMAT COMPRESSED \\*/</code> will be left intact and all <code>/\\*!50633 COLUMN_FORMAT COMPRESSED WITH COMPRESSION_DICTIONARY &lt;dictionary&gt; \\*/</code> will be transformed into <code>/\\*!50633 COLUMN_FORMAT COMPRESSED \\*/</code>. In this mode, the dump will contain the necessary SQL statements to create compressed columns, but without dictionaries.</p> <p>When a new enable-compressed-columns-with-dictionaries option is specified, dump will contain all compressed column attributes and compression dictionary.</p> <p>Moreover, the following dictionary creation fragments will be added before <code>CREATE TABLE</code> statements which are going to use these dictionaries for the first time.</p> <pre><code>/*!50633 DROP COMPRESSION_DICTIONARY IF EXISTS &lt;dictionary&gt;; */\n/*!50633 CREATE COMPRESSION_DICTIONARY &lt;dictionary&gt;(...); */\n</code></pre> <p>Two new options add-drop-compression-dictionary and skip-add-drop-compression-dictionary will control if <code>/\\*!50633 DROP COMPRESSION_DICTIONARY IF EXISTS &lt;dictionary&gt; \\*/</code> part from previous paragraph will be skipped or not. By default, add-drop-compression-dictionary the mode will be used.</p> <p>When both enable-compressed-columns-with-dictionaries and <code>--tab=&lt;dir&gt;</code> (separate file for each table) options are specified, necessary compression dictionaries will be created in each output file using the following fragment (regardless of the values of add-drop-compression-dictionary and skip-add-drop-compression-dictionary options).</p> <pre><code>/*!50633 CREATE COMPRESSION_DICTIONARY IF NOT EXISTS &lt;dictionary&gt;(...); */\n</code></pre>"},{"location":"compressed-columns.html#version-specific-information","title":"Version specific information","text":"<ul> <li>Percona Server for MySQL 8.0.13-3: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"compressed-columns.html#system-variables","title":"System variables","text":""},{"location":"compressed-columns.html#innodb_compressed_columns_zip_level","title":"<code>innodb_compressed_columns_zip_level</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 6 Range 0-9 <p>This variable is used to specify the compression level used for compressed columns. Specifying <code>0</code> will use no compression, <code>1</code> the fastest, and <code>9</code> the best compression. The default value is <code>6</code>.</p>"},{"location":"compressed-columns.html#innodb_compressed_columns_threshold","title":"<code>innodb_compressed_columns_threshold</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 96 Range 1 - 2^64-1 (or 2^32-1 for 32-bit release) <p>By default, a value being inserted will be compressed if its length exceeds innodb_compressed_columns_threshold bytes. Otherwise, it will be stored in the raw (uncompressed) form.</p> <p>Please also note that because of the nature of some data, the compressed representation can be longer than the original value. In this case, it does not make sense to store such values in compressed form as Percona Server for MySQL would have to waste both memory space and CPU resources for unnecessary decompression. Therefore, even if the length of such non-compressible values exceeds innodb_compressed_columns_threshold, they will be stored in an uncompressed form (however, an attempt to compress them will still be made).</p> <p>This parameter can be tuned to skip unnecessary attempts of data compression for values that are known in advance by the user to have a bad compression ratio of their first N bytes.</p>"},{"location":"copyright-and-licensing-information.html","title":"Copyright and licensing information","text":""},{"location":"copyright-and-licensing-information.html#documentation-licensing","title":"Documentation licensing","text":"<p>Percona Server for MySQL documentation is (C)2009-2023 Percona LLC and/or its affiliates and is distributed under the Creative Commons Attribution 4.0 International License.</p>"},{"location":"copyright-and-licensing-information.html#software-license","title":"Software license","text":"<p>Percona Server for MySQL is built upon MySQL from Oracle. Along with making our own modifications, we merge in changes from other sources such as community contributions and changes from MariaDB.</p> <p>The original SHOW USER/TABLE/INDEX statistics code came from Google.</p> <p>Percona does not require copyright assignment.</p> <p>See the COPYING files accompanying the software distribution.</p>"},{"location":"data-at-rest-encryption.html","title":"Data at Rest Encryption","text":"<p>The following system variables, status variables, and options have been removed in Percona Server for MySQL 8.0.31-23.</p> Variable name <code>innodb_encryption_rotation_pages_read_from_cache</code> <code>innodb_encryption_rotation_pages_read_from_disk</code> <code>innodb_encryption_rotation_pages_modified</code> <code>innodb_encryption_rotation_pages_flushed</code> <code>innodb_encryption_rotation_estimated_iops</code> <code>innodb_encryption_rotation_list_length</code> <code>innodb_num_pages_encrypted</code> <code>innodb_num_pages_decrypted</code> <code>innodb_encryption_threads</code> <code>innodb_encryption_rotate_key_age</code> <code>innodb_encryption_rotation_loops</code> <code>innodb_default_encryption_key_id</code> <code>rotate_system_key and any dependencies</code> <p>The following system variable options have been changed in Percona Server for MySQL 8.0.31-23.</p> Variable name Changed <code>default_table_encryption</code> Changed to two options: ON or OFF <code>innodb_sys_tablespace_encrypt</code> Changed to Boolean <p>Data security is a concern for institutions and organizations. <code>Transparent Data Encryption (TDE)</code> or <code>Data at Rest Encryption</code> encrypts data files. Data at rest is any data that is not accessed or changed frequently, stored on different types of storage devices. Encryption ensures that if an unauthorized user accesses the data files from the file system, the user cannot read the contents.</p> <p>If the user uses master key encryption, the MySQL keyring plugin stores the InnoDB master key, used for the master key encryption implemented by MySQL. The master key is also used to encrypt redo logs, and undo logs, along with the tablespaces.</p> <p>The InnoDB tablespace encryption has the following components:</p> <ul> <li> <p>The database instance has a master key for tablespaces and a master key for binary log encryption.</p> </li> <li> <p>Each tablespace has a tablespace key. The key is used to encrypt the Tablespace data pages. Encrypted tablespace keys are written on the tablespace header. In the master key implementation, the tablespace key cannot be changed unless you rebuild the table.</p> </li> </ul> <p>Two separate keys allow the master key to be rotated in a minimal operation. When the master key is rotated, each tablespace key is decrypted and re-encrypted with the new master key. The key rotation only reads and writes to the first page of each tablespace file (.ibd).</p> <p>An InnoDB tablespace file is comprised of multiple logical and physical pages. Page 0 is the tablespace header page and keeps the metadata for the tablespace. The encryption information is stored on page 0 and the tablespace key is encrypted.</p> <p>An encrypted page is decrypted at the I/O layer, added to the buffer pool, and used to access the data. A buffer pool page is not encrypted. The page is encrypted by the I/O layer before the page is flushed to disk.</p>"},{"location":"data-at-rest-encryption.html#percona-xtrabackup-support","title":"Percona XtraBackup support","text":"<p>Percona XtraBackup version 8 supports the backup of encrypted general tablespaces. </p> <p>Percona XtraBackup only supports features that are Generally Available (GA) in Percona Server for MySQL. Due to time constraints, GA features may be supported in a later Percona XtraBackup release. Review the Percona XtraBackup release notes for more information.</p>"},{"location":"data-loading.html","title":"MyRocks data loading","text":"<p>By default, MyRocks configurations are optimized for short transactions, and not for data loading. MyRocks has a couple of special session variables to speed up data loading dramatically.</p>"},{"location":"data-loading.html#sorted-bulk-loading","title":"Sorted bulk loading","text":"<p>If your data is guaranteed to be loaded in primary key order, then this method is recommended. This method works by dropping any secondary keys first, loading data into your table in primary key order, and then restoring the secondary keys via Fast Secondary Index Creation.</p>"},{"location":"data-loading.html#creating-secondary-indexes","title":"Creating secondary indexes","text":"<p>When loading data into empty tables, it is highly recommended to drop all secondary indexes first, then loading data, and adding all secondary indexes after finishing loading data. MyRocks has a feature called <code>Fast Secondary Index Creation</code>. Fast Secondary Index Creation is automatically used when executing <code>CREATE INDEX</code> or <code>ALTER TABLE ... ADD INDEX</code>. With Fast Secondary Index Creation, the secondary index entries are directly written to bottommost RocksDB levels and bypassing compaction. This significantly reduces total write volume and CPU time for decompressing and compressing data on higher levels.</p>"},{"location":"data-loading.html#loading-data","title":"Loading data","text":"<p>As described above, loading data is highly recommended for tables with primary key only (no secondary keys), with all secondary indexes added after loading data.</p> <p>When loading data into MyRocks tables, there are two recommended session variables:</p> <pre><code>SET session sql_log_bin=0;\nSET session rocksdb_bulk_load=1;\n</code></pre> <p>When converting from large MyISAM/InnoDB tables, either by using the <code>ALTER</code> or <code>INSERT INTO SELECT</code> statements it\u2019s recommended that you create MyRocks tables as below (in case the table is sufficiently big it will cause the server to consume all the memory and then be terminated by the OOM killer):</p> <pre><code>SET session sql_log_bin=0;\nSET session rocksdb_bulk_load=1;\nALTER TABLE large_myisam_table ENGINE=RocksDB;\nSET session rocksdb_bulk_load=0;\n</code></pre> <p>Using <code>sql_log_bin=0</code> avoids writing to binary logs.</p> <p>With rocksdb_bulk_load set to <code>1</code>, MyRocks enters special mode to write all inserts into bottommost RocksDB levels, and skips writing data into MemTable and the following compactions. This is very efficient way to load data.</p> <p>The rocksdb_bulk_load mode operates with a few conditions:</p> <ul> <li> <p>None of the data being bulk loaded can overlap with existing data in the table. The easiest way to ensure this is to always bulk load into an empty table, but the mode will allow loading some data into the table, doing other operations, and then returning and bulk loading addition data if there is no overlap between what is being loaded and what already exists.</p> </li> <li> <p>The data may not be visible until bulk load mode is ended (i.e. the rocksdb_bulk_load is set to zero again). The method that is used is building up SST files which will later be added as-is to the database. Until a particular SST has been added the data will not be visible to the rest of the system, thus issuing a <code>SELECT</code> on the table currently being bulk loaded will only show older data and will likely not show the most recently added rows. Ending the bulk load mode will cause the most recent SST file to be added. When bulk loading multiple tables, starting a new table will trigger the code to add the most recent SST file to the system \u2013 as a result, it is inadvisable to interleave <code>INSERT</code> statements to two or more tables during bulk load mode.</p> </li> </ul> <p>By default, the rocksdb_bulk_load mode expects all data be inserted in primary key order (or reversed order). If the data is in the reverse order (i.e. the data is descending on a normally ordered primary key or is ascending on a reverse ordered primary key), the rows are cached in chunks to switch the order to match the expected order.</p> <p>Inserting one or more rows out of order will result in an error and may result in some of the data being inserted in the table and some not. To resolve the problem, one can either fix the data order of the insert, truncate the table, and restart.</p>"},{"location":"data-loading.html#unsorted-bulk-loading","title":"Unsorted bulk loading","text":"<p>If your data is not ordered in primary key order, then this method is recommended. With this method, secondary keys do not need to be dropped and restored. However, writing to the primary key no longer goes directly to SST files, and are written to temporary files for sorted first, so there is extra cost to this method.</p> <p>To allow for loading unsorted data:</p> <pre><code>SET session sql_log_bin=0;\nSET session rocksdb_bulk_load_allow_unsorted=1;\nSET session rocksdb_bulk_load=1;\n...\nSET session rocksdb_bulk_load=0;\nSET session rocksdb_bulk_load_allow_unsorted=0;\n</code></pre> <p>Note that rocksdb_bulk_load_allow_unsorted can only be changed when rocksdb_bulk_load is disabled (set to <code>0</code>). In this case, all input data will go through an intermediate step that writes the rows to temporary SST files, sorts them rows in the primary key order, and then writes to final SST files in the correct order.</p>"},{"location":"data-loading.html#other-approaches","title":"Other approaches","text":"<p>If rocksdb_commit_in_the_middle is enabled, MyRocks implicitly commits every rocksdb_bulk_load_size records (default is <code>1,000</code>) in the middle of your transaction. If your data loading fails in the middle of the statement (<code>LOAD DATA</code> or bulk <code>INSERT</code>), rows are not entirely rolled back, but some of rows are stored in the table. To restart data loading, you\u2019ll need to truncate the table and loading data again.</p> <p>Warning</p> <p>If you are loading large data without enabling rocksdb_bulk_load or rocksdb_commit_in_the_middle, please make sure transaction size is small enough. All modifications of the ongoing transactions are kept in memory.</p>"},{"location":"data-loading.html#other-reading","title":"Other reading","text":"<ul> <li> <p>Data Loading - this document has been used as a source for writing this documentation</p> </li> <li> <p>ALTER TABLE \u2026 ENGINE=ROCKSDB uses too much memory</p> </li> </ul>"},{"location":"data-masking-comparison.html","title":"Compare the data masking component to the data masking plugin","text":"<p>The Data Masking component feature is in tech preview.</p> <p>Percona Server for MySQL 8.0.34 adds the data masking component. Either the component or the plugin extends the server\u2019s functionality, but the architecture of the plugin is different than the architecture of the component.</p> <p>The main differences between the component and plugin are the following:</p> Component Plugin Allows multi-byte character sets for the general-purpose masking functions Does not allow multi-byte character sets Supports masking PAN, SSN, IBAN, UUID, Canada SIN, and UK NIN Supports masking PAN and SSN Generates random email, US phone, PAN, SSN, IBAN, UUID, Canada SIN, and UK NIN data Generates random email, US phone, PAN, and SSN Supports persisting substitution dictionaries in the database Supports persisting substitution dictionaries in a file Supports a dedicated privilege MASKING_DICTIONARIES_ADMIN to manage the dictionaries Requires FILE privilege Automates the loadable-function registration or unregistration during either component installation or uninstallation Does not automate the loadable-function registration or unregistration during either the plugin installation or uninstallation"},{"location":"data-masking-function-list.html","title":"Data masking component functions","text":"<p>The feature is in tech preview.</p> Name Usage <code>gen_blocklist(str, from_dictionary_name, to_dictionary_name)</code> Replace a term from a dictionary <code>gen_dictionary(dictionary_name)</code> Returns a random term from a dictionary <code>gen_range(lower, upper)</code> Returns a number from a range <code>gen_rnd_canada_sin()</code> Generates a Canadian Social Insurance number <code>gen_rnd_email([name_size, surname_size, domain])</code> Generates an email address <code>gen_rnd_iban([country, size])</code> Generates an International Bank Account number <code>gen_rnd_pan()</code> Generates a Primary account number for a payment card <code>gen_rnd_ssn()</code> Generates a US Social Security number <code>gen_rnd_uk_nin()</code> Generates a United Kingdom National Insurance number <code>gen_rnd_us_phone()</code> Generates a US phone number <code>gen_rnd_uuid()</code> Generates a Universally Unique Identifier <code>mask_canada_sin(str [,mask_char])</code> Masks the Canadian Social Insurance number <code>mask_iban(str [,mask_char])</code> Masks the International Bank Account number <code>mask_inner(str, margin1, margin2 [,mask_char])</code> Masks the inner part of a string <code>mask_outer(str, margin1, margin2 [,mask_char])</code> Masks the outer part of the string <code>mask_pan(str [,mask_char])</code> Masks the Primary Account number for a payment card <code>mask_pan_relaxed(str [,mask_char])</code> Partially masks the Primary Account number for a payment card <code>mask_ssn(str [,mask_char])</code> Masks the US Social Security number <code>mask_uk_nin(str [,mask_char])</code> Masks the United Kingdom National Insurance number <code>mask_uuid(str [,mask_char])</code> Masks the Universally Unique Identifier <code>masking_dictionary_remove(dictionary_name)</code> Removes the dictionary <code>masking_dictionary_term_add(dictionary_name, term_name)</code> Adds a term to the masking dictionary <code>masking_dictionary_term_remove(dictionary_name, term_name)</code> Removes a term from the masking dictionary"},{"location":"data-masking-function-list.html#gen_blockliststr-from_dictionary_name-to_dictionary_name","title":"gen_blocklist(str, from_dictionary_name, to_dictionary_name)","text":"<p>Replaces one term in a dictionary with a term, selected at random, in another dictionary.</p>"},{"location":"data-masking-function-list.html#parameters","title":"Parameters","text":"Parameter Optional Description Type <code>term</code> No The term to replace String <code>from_dictionary_name</code> No The dictionary that stores the term. String <code>to_dictionary_name</code> No The dictionary that stores the replacement term String"},{"location":"data-masking-function-list.html#returns","title":"Returns","text":"<p>A term, selected at random, from the dictionary listed in <code>to_dictionary_name</code> that replaces the selected term. If the selected <code>term</code> is not listed in the <code>from_dictionary_name</code> or a dictionary is missing, then the <code>term</code> is returned. If the <code>to_dictionary_name</code> does not exist, then returns NULL. The character set of the returned string is the same character set of the <code>term</code> parameter.</p> <p>Returns NULL if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_blocklist('apple', 'fruit', 'nut');\n</code></pre> Expected output <pre><code>+-----------------------------------------+\n| gen_blocklist('apple', 'fruit', 'nut')  |\n+-----------------------------------------+\n| walnut                                  |\n+-----------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_dictionarydictionary_name","title":"gen_dictionary(dictionary_name)","text":"<p>Returns a term from a dictionary selected at random.</p>"},{"location":"data-masking-function-list.html#parameters_1","title":"Parameters","text":"Parameter Optional Description Type <code>dictionary_name</code> No Select the random term from this dictionary String"},{"location":"data-masking-function-list.html#returns_1","title":"Returns","text":"<p>A random term from the dictionary listed in <code>dictionary_name</code> in the <code>utf8mb4</code> character set. Returns NULL if the <code>dictionary_name</code> does not exist.</p>"},{"location":"data-masking-function-list.html#example_1","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_dictionary('trees');\n</code></pre> Expected output <pre><code>+--------------------------------------------------+\n| gen_dictionary('trees')                          |\n+--------------------------------------------------+\n| Norway spruce                                    |\n+--------------------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rangelower-upper","title":"gen_range(lower, upper)","text":"<p>Returns a number from a defined range.</p>"},{"location":"data-masking-function-list.html#parameters_2","title":"Parameters","text":"Parameter Optional Description Type <code>lower</code> No The lower boundary of the range Integer <code>upper</code> No The upper boundary of the range Integer <p>The <code>upper</code> parameter value must be an integer either greater than or equal to the <code>lower</code> parameter value.</p>"},{"location":"data-masking-function-list.html#returns_2","title":"Returns","text":"<p>An integer, selected at random, from an inclusive range defined by the <code>lower</code> parameter value and the <code>upper</code> parameter value, or NULL if the <code>upper</code> boundary is less than the <code>lower</code> boundary.</p>"},{"location":"data-masking-function-list.html#example_2","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_range(10, 100);\n</code></pre> Expected output <pre><code>+--------------------------------------+\n| gen_range(10,100)                    |\n+--------------------------------------+\n| 56                                   |\n+--------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rnd_canada_sin","title":"gen_rnd_canada_sin()","text":"<p>Generates a Canada Social Insurance Number (SIN).</p> <p>Important</p> <p>Only use this function for testing because the result could be a legitimate SIN. Use <code>mask_canada_sin</code> to disguise the result if you must publish the result.</p>"},{"location":"data-masking-function-list.html#parameters_3","title":"Parameters","text":"<p>None.</p>"},{"location":"data-masking-function-list.html#returns_3","title":"Returns","text":"<p>Returns a Canada SIN formatted in three groups of three digits (for example, 123-456-789) in the <code>utf8mb4</code> character set. To ensure the number is consistent, the number is verified with the Luhn algorithm.</p>"},{"location":"data-masking-function-list.html#example_3","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_rnd_canada_sin();\n</code></pre> Expected output <pre><code>+-------------------------+\n| gen_rnd_canada_sin()    |\n+-------------------------+\n| 506-948-819             |\n+-------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rnd_emailname_size-surname_size-domain","title":"gen_rnd_email([name_size, surname_size, domain])","text":"<p>Generates a random email address in the <code>name.surname@domain</code> format.</p>"},{"location":"data-masking-function-list.html#parameters_4","title":"Parameters","text":"Parameter Optional Description Type <code>name_size</code> Yes Specifies the number of characters in the name part. The default number is five. The minimum number is one. The maximum number is 1024. Integer <code>surname_size</code> Yes Specifies the number of characters in the surname part. The default number is seven. The minimum number is one. The maximum number is 1024. Integer <code>domain</code> Yes Specifies the domain name used. The default value is <code>example.com</code>. Integer"},{"location":"data-masking-function-list.html#returns_4","title":"Returns","text":"<p>A generated email address as a string in the same character set as <code>domain</code>. If the <code>domain</code> value is not specified, then the string is in the <code>utf8mb4</code> character set. The <code>name</code> and <code>surname</code> are random lower-case letters (a - z).</p>"},{"location":"data-masking-function-list.html#example_4","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_rnd_email(name_size=4, surname_size=5, domain='mydomain.edu');\n</code></pre> Expected output <pre><code>+-------------------------------------+\n| gen_rnd_email(4, 5, 'mydomain.edu') |\n+-------------------------------------+\n| qwer.asdfg@mydomain.edu             |\n+-------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rnd_ibancountry-size","title":"gen_rnd_iban([country, size])","text":"<p>Generates an Internal Bank Account Number (IBAN).</p> <p>Important</p> <p>Generating an IBAN with a valid country code should only be used for testing. The function does not check if the generated value is a legitimate bank account. If you must publish the result, consider using <code>mask_iban</code> to disguise the result. The function does not perform a checksum on the bank account number.</p>"},{"location":"data-masking-function-list.html#parameters_5","title":"Parameters","text":"Parameter Optional Description Type <code>country</code> Yes A two-character country code String <code>size</code> Yes Number of characters Integer <p>If the <code>country</code> is not specified, the default value is <code>ZZ</code>. The value must be two upper-case characters (A-Z) or an error is returned.</p> <p>The default value for <code>size</code> is 16. The minimum value is 15. The maximum value is 34.</p>"},{"location":"data-masking-function-list.html#returns_5","title":"Returns","text":"<p>The function returns a string that is the length of the <code>size</code> value. The string consists of <code>country</code> (two characters) followed by the (size - 2) random digits.</p> <p>The character set is the same as the <code>country</code> parameter or if that parameter is not specified, the character set is <code>utf8mb4</code>.</p>"},{"location":"data-masking-function-list.html#example_5","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_rnd_iban();\n</code></pre> Expected output <pre><code>+-------------------+\n| gen_rnd_iban()    |\n+-------------------+\n|ZZ78959120078536   |\n+-------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rnd_pan","title":"gen_rnd_pan()","text":"<p>Generates a Primary Account Number (PAN) for a payment card that passes basic checksum validation.</p> <p>The generated PAN can be one of the following:</p> <ul> <li> <p>American Express</p> </li> <li> <p>Visa</p> </li> <li> <p>Mastercard</p> </li> <li> <p>Discover</p> </li> </ul> <p>Important</p> <p>Generating the PAN should only be used for testing. The function does not check if the generated value is a legitimate primary account number. If you must publish the result, consider using <code>mask_pan</code> or <code>mask_pan_relaxed()</code> to disguise the result.</p>"},{"location":"data-masking-function-list.html#parameters_6","title":"Parameters","text":"<p>None</p>"},{"location":"data-masking-function-list.html#returns_6","title":"Returns","text":"<p>A random PAN string in <code>utf8mb4</code> character set.</p>"},{"location":"data-masking-function-list.html#example_6","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_rnd_pan();\n</code></pre> Expected output <pre><code>+-------------------+\n| gen_rnd_pan()     |\n+-------------------+\n| 1234567898765432  |\n+-------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rnd_ssn","title":"gen_rnd_ssn()","text":"<p>Generates a United States Social Security Account Number (SSN).</p>"},{"location":"data-masking-function-list.html#parameters_7","title":"Parameters","text":"<p>None</p>"},{"location":"data-masking-function-list.html#returns_7","title":"Returns","text":"<p>A SSN string in a nine-digit number format \u201cAAA-GG-SSSS\u201d in the <code>utf8mb4</code> character set. The number has three parts, the first three digits are the area number, the group number, and the serial number. The generated SSN uses \u2018900\u2019 or greater numbers for the area number. These numbers are not legitimate because they are outside the approved range.</p>"},{"location":"data-masking-function-list.html#example_7","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_rnd_ssn();\n</code></pre> Expected output <pre><code>+----------------+\n| gen_rnd_ssn()  |\n+----------------+\n| 970-03-0370    |\n-----------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rnd_uk_nin","title":"gen_rnd_uk_nin()","text":"<p>Generates a United Kingdom National Insurance Number (NIN).</p> <p>Important</p> <p>This function should only be used for testing. The function does not check if the generated value is a legitimate United Kingdom National Insurance number. If you must publish the result, consider masking the result with <code>mask_uk_nin</code>.</p>"},{"location":"data-masking-function-list.html#parameters_8","title":"Parameters","text":"<p>None.</p>"},{"location":"data-masking-function-list.html#returns_8","title":"Returns","text":"<p>A NIN string in the <code>utf8mb4</code> character set. The string is nine (9) characters in length, always starts with \u2018AA\u2019 and ends with \u2018C\u2019.</p>"},{"location":"data-masking-function-list.html#example_8","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_rnd_uk_nin();\n</code></pre> Expected output <pre><code>+----------------------+\n| gen_rnd_uk_nin()     |\n+----------------------+\n| AA123456C            |\n+----------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rnd_us_phone","title":"gen_rnd_us_phone()","text":"<p>Generates a United States phone number with the <code>555</code> area code. The \u2018555\u2019 area code represents fictional numbers.</p>"},{"location":"data-masking-function-list.html#parameters_9","title":"Parameters","text":"<p>None</p>"},{"location":"data-masking-function-list.html#returns_9","title":"Returns","text":"<p>Returns a United States phone number in the <code>utf8mb4</code> character set.</p>"},{"location":"data-masking-function-list.html#example_9","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_rnd_us_phone();\n</code></pre> Expected output <pre><code>+--------------------+\n| gen_rnd_us_phone() |\n+--------------------+\n| 1-555-249-2029     |\n+--------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#gen_rnd_uuid","title":"gen_rnd_uuid()","text":"<p>Generates a version 4 Universally Unique Identifier (UUID).</p>"},{"location":"data-masking-function-list.html#parameters_10","title":"Parameters","text":"<p>None.</p>"},{"location":"data-masking-function-list.html#returns_10","title":"Returns","text":"<p>Returns a UUID as a string in the <code>utf8mb4</code> character set.</p>"},{"location":"data-masking-function-list.html#example_10","title":"Example","text":"<pre><code>mysql&gt; SELECT gen_rnd_uuid();\n</code></pre> Expected output <pre><code>+------------------------------------+\n| gen_rnd_uuid()                     |\n+------------------------------------+\n|9a3b642c-06c6-11ee-be56-0242ac120002|\n+------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_canada_sinstr-mask_char","title":"mask_canada_sin(str [,mask_char])","text":"<p>Masks a Canada Social Insurance Number (SIN).</p>"},{"location":"data-masking-function-list.html#parameters_11","title":"Parameters","text":"Parameter Optional Description Type <code>str</code> No The string to be masked String <code>mask_char</code> Yes The masking character String <p>The <code>str</code> accepts an alphanumeric string.</p> <p>If you do not specify a <code>mask_char</code>, the default character is <code>X</code>. The <code>mask_char</code> value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p>"},{"location":"data-masking-function-list.html#returns_11","title":"Returns","text":"<p>A string with the selected characters masked by a specified <code>mask_char</code> or the default value for that parameter. The function supports multibyte characters in any character set. The character set of the return value is the same as <code>str</code>.</p> <p>An error is reported if  <code>str</code> length is an incorrect length.</p> <p>Returns a NULL if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_11","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_canada_sin('555-555-555');\n</code></pre> Expected output <pre><code>+--------------------------------+\n| mask_canada_sin('555-555-555') |\n+--------------------------------+\n| XXX-XXX-XXX                    |\n+--------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_ibanstr-mask_char","title":"mask_iban(str [,mask_char])","text":"<p>Masks an Internal Bank Account Number (IBAN).</p>"},{"location":"data-masking-function-list.html#parameters_12","title":"Parameters","text":"Parameter Optional Description Type <code>str</code> No The string to be masked String <code>mask_char</code> Yes Character used for masking String <p>The <code>str</code> accepts either of the following:</p> <ul> <li> <p>No separator symbol</p> </li> <li> <p>Groups of four characters. These groups can be separated by a space or any separator character.</p> </li> </ul> <p>The default value for <code>mask_char</code> is <code>*</code>. The value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p>"},{"location":"data-masking-function-list.html#returns_12","title":"Returns","text":"<p>Returns the masked string. The character set of the result is the same as the character set of <code>str</code>.</p> <p>An error is reported if the <code>str</code> length is incorrect.</p> <p>Returns NULL if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_12","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_iban('DE27 1002 02003 77495 4156');\n</code></pre> Expected output <pre><code>+---------------------------------------------+\n| mask_iban('DE27 1002 02003 77495 4156')     |\n+---------------------------------------------+\n| DE** **** **** **** ****                    |\n+---------------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_innerstr-margin1-margin2-mask_char","title":"mask_inner(str, margin1, margin2 [,mask_char])","text":"<p>Returns the string where a selected inner portion is masked with a substitute character.</p>"},{"location":"data-masking-function-list.html#parameters_13","title":"Parameters","text":"Parameter Optional Description Type <code>string</code> No The string to be masked String <code>margin1</code> No The number of characters on the left end of the string to remain unmasked Integer <code>margin2</code> No The number of characters on the right end of the string to remain unmasked Integer <code>mask_char</code> Yes The masking character String <p>The <code>margin1</code> value cannot be a negative number. A value of <code>0</code> (zero) masks all characters.</p> <p>The <code>margin2</code> value cannot be a negative number. A value of <code>0</code> (zero) masks all characters.</p> <p>If the sum of <code>margin1</code> and <code>margin2</code> is greater than or equal to the string length, no masking occurs.</p> <p>If the <code>mask_char</code> is not specified, the default is \u2018X\u2019. The <code>mask_char</code> value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p>"},{"location":"data-masking-function-list.html#returns_13","title":"Returns","text":"<p>A string with the selected characters masked by a specified <code>mask_char</code> or that parameter\u2019s default value in the character set of the <code>string</code> parameter.</p> <p>Returns NULL if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_13","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_inner('123456789', 1, 2);\n</code></pre> Expected output <pre><code>+-----------------------------------+\n| mask_inner('123456789', 1, 2)     |\n+-----------------------------------+\n| 1XXXXXX89                          |\n+-----------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_outerstr-margin1-margin2-mask_char","title":"mask_outer(str, margin1, margin2 [,mask_char])","text":"<p>Returns the string where a selected outer portion is masked with a substitute character.</p>"},{"location":"data-masking-function-list.html#parameters_14","title":"Parameters","text":"Parameter Optional Description Type <code>string</code> No The string to be masked String <code>margin1</code> No On the left end of the string, mask this designated number of characters Integer <code>margin2</code> No On the right end of the string, mask this designated number of characters Integer <code>mask_char</code> Yes The masking character String <p>The <code>margin1</code> cannot be a negative number. A value of <code>0</code> (zero) does not mask any characters.</p> <p>The <code>margin2</code> cannot be a negative number. A value of <code>0</code> (zero) does not mask any characters.</p> <p>If the sum of <code>margin1</code> and <code>margin2</code> is greater than or equal to the string length, the string is masked.</p> <p>If the <code>mask_char</code> is not specified, the default is \u2018X\u2019. The <code>mask_char</code> value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p>"},{"location":"data-masking-function-list.html#returns_14","title":"Returns","text":"<p>A string with the selected characters masked by a specified <code>mask_char</code> or that parameter\u2019s default value in the same character set as <code>string</code>.</p> <p>Returns NULL if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_14","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_outer('123456789', 2, 2); \n</code></pre> Expected output <pre><code>+------------------------------------+\n| mask_outer('123456789', 2, 2).     |\n+------------------------------------+\n| XX34567XX                          |\n+------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_panstr-mask_char","title":"mask_pan(str [,mask_char])","text":"<p>Returns a masked payment card Primary Account Number (PAN). The mask replaces the PAN number with the specified character except for the last four digits.</p>"},{"location":"data-masking-function-list.html#parameters_15","title":"Parameters","text":"Parameter Optional Description Type <code>str</code> No The string to be masked String <code>mask_char</code> Yes The masking character String <p>The <code>str</code> contains a minimum of 14 or a maximum of 19 alphanumeric characters. </p> <p>If the <code>mask_char</code> is not specified, the default value is \u2018X\u2019. The <code>mask_char</code> value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p>"},{"location":"data-masking-function-list.html#returns_15","title":"Returns","text":"<p>A string with the selected characters masked by a specified <code>mask_char</code> or that parameter\u2019s default value. The character set of the result is the same character set as <code>str</code>.</p> <p>An error occurs if the <code>str</code> parameter is not the correct length.</p> <p>Returns NULL if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_15","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_pan (gen_rnd_pan());\n</code></pre> Expected output <pre><code>+------------------------------------+\n| mask_pan(gen_rnd_pan())            |\n+------------------------------------+\n| XXXXXXXXXXX2345                    |\n+------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_pan_relaxedstr-mask_char","title":"mask_pan_relaxed(str [,mask_char])","text":"<p>Returns a masked payment card Primary Account Number (PAN). The first six numbers and the last four numbers and the rest of the string masked by specified character or <code>X</code>.</p>"},{"location":"data-masking-function-list.html#parameters_16","title":"Parameters","text":"Parameter Optional Description Type <code>str</code> No The string to be masked String <code>mask_char</code> Yes The specified character for masking String <p>The <code>str</code> must contain a minimum of 14 or a maximum of 19 alphanumeric characters. </p> <p>If the <code>mask_char</code> is not specified, the default value is \u2018X\u2019.</p>"},{"location":"data-masking-function-list.html#returns_16","title":"Returns","text":"<p>A string with the first six numbers and the last four numbers and the rest of the string masked by a specified <code>mask_char</code> or that parameter\u2019s default value (<code>X</code>). The character set of the result is the same character set as <code>str</code>.</p> <p>The <code>mask_char</code> value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p> <p>Reports an error is the <code>str</code> parameter is not the correct length.</p> <p>Returns NULL if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_16","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_pan_relaxed(gen_rnd_pan());\n</code></pre> Expected output <pre><code>+------------------------------------------+\n| mask_pan_relaxed(gen_rnd_pan())          |\n+------------------------------------------+\n| 520754XXXXXX4848                         |\n+------------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_ssnstr-mask_char","title":"mask_ssn(str [,mask_char])","text":"<p>Returns a masked United States Social Security Number(SSN). The mask replaces the SSN number with the specified character except for the last four digits.</p>"},{"location":"data-masking-function-list.html#parameters_17","title":"Parameters","text":"Parameter Optional Description Type <code>str</code> No The string to be masked String <code>mask_char</code> Yes The masking character String <p>The <code>str</code> accepts either of the following:</p> <ul> <li>Nine integers, no separator symbol</li> <li>Nine integers in the <code>AAA-GG-SSS</code> pattern. The <code>-</code> (dash symbol) is the separator character.</li> </ul> <p>If the <code>mask_char</code> is not specified, the default value is <code>*</code>. The <code>mask_char</code> value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p>"},{"location":"data-masking-function-list.html#returns_17","title":"Returns","text":"<p>A string with the selected characters masked by a specified <code>mask_char</code> or that parameter\u2019s default value in the same character set of <code>str</code>. </p> <p>Reports an error if the value of the <code>str</code> is an incorrect length.</p> <p>Returns a NULL value if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_17","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_ssn('555-55-5555', 'X');\n</code></pre> Expected output <pre><code>+-----------------------------+\n| mask_ssn('555-55-5555','X') |\n+-----------------------------+\n| XXX-XX-5555                 |\n+-----------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_uk_ninstr-mask_char","title":"mask_uk_nin(str [,mask_char])","text":"<p>Returns a masked a United Kingdom National Insurance Number (NIN). The mask replaces the NIN number with the specified character except for the first two digits.</p>"},{"location":"data-masking-function-list.html#parameters_18","title":"Parameters","text":"Parameter Optional Description Type <code>str</code> No The string to be masked String <code>mask_char</code> Yes The masking character String <p>The <code>str</code> accepts an alpha-numeric string and does not check format and the <code>str</code> can use any separator character.</p> <p>If the <code>mask_char</code> is not specified, the default value is <code>*</code>. The <code>mask_char</code> value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p>"},{"location":"data-masking-function-list.html#returns_18","title":"Returns","text":"<p>Returns a string with the selected characters masked by a specified <code>mask_char</code> or that parameter\u2019s default value in the same character set as <code>str</code>.</p> <p>An error occurs if the <code>str</code> parameter is not the correct length. </p> <p>Returns a NULL value if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_18","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_uk_nin ('CT 26 46 83 D');\n</code></pre> Expected output <pre><code>+------------------------------------+\n| mask_uk_nin('CT 26 46 83 D')       |\n+------------------------------------+\n| CT ** ** ** *                      |\n+------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#mask_uuidstr-mask_char","title":"mask_uuid(str [,mask_char])","text":"<p>Masks a Universally Unique Identifier (UUID).</p>"},{"location":"data-masking-function-list.html#parameters_19","title":"Parameters","text":"Parameter Optional Description Type <code>str</code> No The string to be masked String <code>mask_char</code> Yes The masking character String <p>The <code>str</code> format is <code>********-****-****-****-************</code>.</p> <p>If the <code>mask_char</code> is not specified, the default value is \u2018*\u2019. The <code>mask_char</code> value can be a multibyte character in any character set and may not be same character set as <code>str</code>.</p>"},{"location":"data-masking-function-list.html#returns_19","title":"Returns","text":"<p>A string with the characters masked by a specified <code>mask_char</code> or that parameter\u2019s default value in the same character set as <code>str</code>.</p> <p>Returns an error if the length of <code>str</code> is incorrect.</p> <p>Returns <code>NULL</code> if you invoke this function with NULL as the primary argument.</p>"},{"location":"data-masking-function-list.html#example_19","title":"Example","text":"<pre><code>mysql&gt; SELECT mask_uuid('9a3b642c-06c6-11ee-be56-0242ac120002');\n</code></pre> Expected output <pre><code>+-------------------------------------------------------+\n| mask_uuid('9a3b642c-06c6-11ee-be56-0242ac120002')     |\n+-------------------------------------------------------+\n|********_****_****_****_************                   |\n+-------------------------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#masking_dictionary_removedictionary_name","title":"masking_dictionary_remove(dictionary_name)","text":"<p>Removes all of the terms and then removes the dictionary. </p> <p>Requires the <code>MASKING_DICTIONARIES_ADMIN</code> privilege.</p>"},{"location":"data-masking-function-list.html#parameters_20","title":"Parameters","text":"Parameter Optional Description Type <code>dictionary_name</code> No The dictionary to be removed String"},{"location":"data-masking-function-list.html#returns_20","title":"Returns","text":"<p>Returns a string value of <code>1</code> (one) in the <code>utf8mb4</code> character set if the operation is successful or <code>NULL</code> if the operation could not find the <code>dictionary_name</code>.</p>"},{"location":"data-masking-function-list.html#example_20","title":"Example","text":"<pre><code>mysql&gt; SELECT masking_dictionary_remove('trees');\n</code></pre> Expected output <pre><code>+------------------------------------------+\n| masking_dictionary_remove('trees')       |\n+------------------------------------------+\n|                                        1 |\n+------------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#masking_dictionary_term_adddictionary_name-term_name","title":"masking_dictionary_term_add(dictionary_name, term_name)","text":"<p>Adds a term to the dictionary and requires the <code>MASKING_DICTIONARIES_ADMIN</code> privilege.</p>"},{"location":"data-masking-function-list.html#parameters_21","title":"Parameters","text":"Parameter Optional Description Type <code>dictionary_name</code> No The dictionary where the term is added String <code>term_name</code> No The term added to the selected dictionary String"},{"location":"data-masking-function-list.html#returns_21","title":"Returns","text":"<p>Returns a string value of <code>1</code> (one) in the <code>utf8mb4</code> character set if the operation is successful. If the <code>dictionary_name</code> does not exist, the operation creates the dictionary.</p> <p>Returns <code>NULL</code> if the operation fails. An operation can fail if the <code>term_name</code> is already available in the dictionary specified by <code>dictionary_name</code>.</p> <p>The operation uses <code>INSERT IGNORE</code> and can have the following outcomes:</p> <ul> <li> <p>The <code>term_name</code> is truncated if the <code>term_name</code> length is greater than maximum length of the <code>Term</code> field in the <code>mysql.masking_dictionaries</code> table.</p> </li> <li> <p>The character of the <code>dictionary_name</code> is not supported by the <code>Dictionary</code> field in <code>mysql.masking_dictionaries</code> table, the character is implicitly  converted to \u2018?\u2019. </p> </li> <li> <p>If the character of the <code>term_name</code> is not supported by the <code>Term</code> field in the <code>mysql.masking_dictionaries</code> table, the character is implicitly converted to \u2018?\u2019.</p> </li> </ul> <p>The following command returns the table information:</p> <pre><code>mysql&gt; DESCRIBE mysql.masking_dictionaries;\n</code></pre> <p>The result returns the table structure.</p> Expected output <pre><code>+------------+--------------+------+-----+---------+-------+\n| Field      | Type         | Null | Key | Default | Extra |\n+------------+--------------+------+-----+---------+-------+\n| Dictionary | varchar(256) | NO   | PRI | NULL    |       |\n| Term       | varchar(256) | NO   | PRI | NULL    |       |\n+------------+--------------+------+-----+---------+-------+\n2 rows in set (0.02 sec)\n</code></pre> <p>Modify the table with an <code>ALTER TABLE</code> statement, if needed.</p>"},{"location":"data-masking-function-list.html#example_21","title":"Example","text":"<pre><code>mysql&gt; SELECT masking_dictionary_term_add('trees','pine');\n</code></pre> Expected output <pre><code>+-----------------------------------------------+\n| masking_dictionary_term_add('trees', 'pine')  |\n+-----------------------------------------------+\n|                                             1 |\n+-----------------------------------------------+\n</code></pre>"},{"location":"data-masking-function-list.html#masking_dictionary_term_removedictionary_name-term_name","title":"masking_dictionary_term_remove(dictionary_name, term_name)","text":"<p>Removes the selected term from the dictionary. </p> <p>Requires the <code>MASKING_DICTIONARIES_ADMIN</code> privilege.</p>"},{"location":"data-masking-function-list.html#parameters_22","title":"Parameters","text":"Parameter Optional Description Type <code>dictionary_name</code> No The dictionary that contains the <code>term_name</code> String <code>term_name</code> No The term to be removed String"},{"location":"data-masking-function-list.html#returns_22","title":"Returns","text":"<p>Returns a string value of <code>1</code> (one) in the <code>utf8mb4</code> character set if the operation is successful.</p> <p>Returns <code>NULL</code> if the operation fails. An operation can fail if the following occurs:</p> <ul> <li>The <code>term_name</code> is not available in the dictionary specified by <code>dictionary_name</code></li> <li>The <code>dictionary_name</code> could not be found</li> </ul>"},{"location":"data-masking-function-list.html#parameters_23","title":"Parameters","text":"Parameter Optional Description Type <code>dictionary_name</code> No The dictionary for the term String <code>term_name</code> No The term to be added String"},{"location":"data-masking-function-list.html#example_22","title":"Example","text":"<pre><code>mysql&gt; SELECT masking_dictionary_term_remove('trees','pine');\n</code></pre> Expected output <pre><code>+-------------------------------------------------------+\n| masking_dictionary_term_remove('trees', 'pine')       |\n+-------------------------------------------------------+\n|                                                     1 |\n+-------------------------------------------------------+\n</code></pre>"},{"location":"data-masking-overview.html","title":"Data masking overview","text":"<p>Data masking helps to limit the exposure of sensitive data by preventing access to non-authorized users. Masking provides a way to create a version of the data in situations, such as a presentation, sales demo, or software testing, when the real data should not be used. Data masking changes the data values while using the same format and cannot be reverse engineered. Masking reduces an organization\u2019s risk by making the data useless to an outside party.</p>"},{"location":"data-masking-overview.html#data-masking-techniques","title":"Data masking techniques","text":"<p>The common data masking techniques are the following:</p> Technique Description Custom string Replaces sensitive data with a specific string, such as a phone number with XXX-XXX-XXXX Data substitution Replaces sensitive data with realistic alternative values, such as city name with another name from a dictionary"},{"location":"data-masking-plugin-functions.html","title":"Data masking plugin functions","text":"<p>This feature was implemented in Percona Server for MySQL version Percona Server for MySQL 8.0.17-8.</p> <p>The Percona Data Masking plugin is a free and Open Source implementation of the MySQL\u2019s data masking plugin. Data Masking provides a set of functions to hide sensitive data with modified content.</p> <p>Data masking can have either of the characteristics:</p> <ul> <li> <p>Generation of random data, such as an email address</p> </li> <li> <p>De-identify data by transforming the data to hide content</p> </li> </ul> <p>The data masking functions have the following categories:</p> <ul> <li> <p>General purpose</p> </li> <li> <p>Special purpose</p> </li> <li> <p>Generating Random Data with Defined characteristics</p> </li> <li> <p>Using Dictionaries to Generate Random Data</p> </li> </ul>"},{"location":"data-masking-plugin-functions.html#general-purpose","title":"General purpose","text":"<p>The general purpose data masking functions are the following:</p> Function Description  mask_inner(string, margin1, margin2 [, character]) Returns a result where only the inner part of a string is masked. A different masking character can be specified. .       mask_outer(string, margin1, margin2 [, character]) Masks the outer part of the string. The inner section is not masked. A different masking character can be specified."},{"location":"data-masking-plugin-functions.html#examples","title":"Examples","text":"<p>An example of <code>mask_inner</code>:</p> <pre><code>mysql&gt; SELECT mask_inner('123456789', 1, 2);\n</code></pre> Expected output <pre><code>+-----------------------------------+\n| mask_inner('123456789', 1, 2)     |\n+-----------------------------------+\n|1XXXXXX89                          |\n+-----------------------------------+\n</code></pre> <p>An example of <code>mask_outer</code>:</p> <pre><code>mysql&gt; SELECT mask_outer('123456789', 2, 2); \n</code></pre> Expected output <pre><code>+------------------------------------+\n| mask_outer('123456789', 2, 2).     |\n+------------------------------------+\n| XX34567XX                          |\n+------------------------------------+\n</code></pre>"},{"location":"data-masking-plugin-functions.html#special-purpose","title":"Special Purpose","text":"<p>The special purpose data masking functions are as follows:</p> Parameter Description mask_pan(string) Masks the Primary Account Number (PAN) by replacing the string with an \u201cX\u201d except for the last four characters. The PAN string must be 15 characters or 16 characters in length. mask_pan_relaxed(string) Returns the first six numbers and the last four numbers. The rest of the string is replaced by \u201cX\u201d. mask_ssn(string) Returns a string with only the last four numbers visible. The rest of the string is replaced by \u201cX\u201d."},{"location":"data-masking-plugin-functions.html#examples_1","title":"Examples","text":"<p>An example of <code>mask_pan</code>.</p> <pre><code>mysql&gt; SELECT mask_pan (gen_rnd_pan());\n</code></pre> Expected output <pre><code>+------------------------------------+\n| mask_pan(gen_rnd_pan())            |\n+------------------------------------+\n| XXXXXXXXXXX2345                    |\n+------------------------------------+\n</code></pre> <p>An example of <code>mask_pan_relaxed</code>:</p> <pre><code>mysql&gt; SELECT mask_pan_relaxed(gen_rnd_pan());\n</code></pre> Expected output <pre><code>+------------------------------------------+\n| mask_pan_relaxed(gen_rnd_pan())          |\n+------------------------------------------+\n| 520754XXXXXX4848                         |\n+------------------------------------------+\n</code></pre> <p>An example of <code>mask_ssn</code>:</p> <pre><code>mysql&gt; SELECT mask_ssn('555-55-5555');\n</code></pre> Expected output <pre><code>+-------------------------+\n| mask_ssn('555-55-5555') |\n+-------------------------+\n| XXX-XX-5555             |\n+-------------------------+\n</code></pre>"},{"location":"data-masking-plugin-functions.html#generate-random-data-for-specific-requirements","title":"Generate random data for specific requirements","text":"<p>These functions generate random values for specific requirements.</p> Parameter Description gen_range(lower, upper) Generates a random number based on a selected range and supports negative numbers. gen_rnd_email() Generates a random email address. The domain is example.com. gen_rnd_pan([size in integer]) Generates a random primary account number. This function should only be used for test purposes. gen_rnd_us_phone() Generates a random U.S. phone number. The generated number adds the 1 dialing code and is in the 555 area code. The 555 area code is not valid for any U.S. phone number. gen_rnd_ssn() Generates a random, non-legitimate US Social Security Number in an AAA-BBB-CCCC format. This function should only be used for test purposes."},{"location":"data-masking-plugin-functions.html#examples_2","title":"Examples","text":"<p>An example of <code>gen_range(lower, upper)</code>:</p> <pre><code>mysql&gt; SELECT gen_range(10, 100);\n</code></pre> Expected output <pre><code>+--------------------------------------+\n| gen_range(10,100)                    |\n+--------------------------------------+\n| 56                                   |\n+--------------------------------------+\n</code></pre> <p>An example of <code>gen_range(lower, upper)</code> with negative numbers:</p> <pre><code>mysql&gt; SELECT gen_range(-100,-80);\n</code></pre> Expected output <pre><code>+--------------------------------------+\n| gen_range(-100,-80)                  |\n+--------------------------------------+\n| -91                                  |\n+--------------------------------------+\n</code></pre> <p>An example of <code>gen_rnd_email()</code>:</p> <pre><code>mysql&gt; SELECT gen_rnd_email();\n</code></pre> Expected output <pre><code>+---------------------------------------+\n| gen_rnd_email()                       |\n+---------------------------------------+\n| sma.jrts@example.com                  |\n+---------------------------------------+\n</code></pre> <p>An example of <code>mask_pan(gen_rnd_pan())</code>:</p> <pre><code>mysql&gt; SELECT mask_pan(gen_rnd_pan());\n</code></pre> Expected output <pre><code>+-------------------------------------+\n| mask_pan(gen_rnd_pan())             |\n+-------------------------------------+\n| XXXXXXXXXXXX4444                    |\n+-------------------------------------+\n</code></pre> <p>An example of <code>gen_rnd_us_phone()</code>:</p> <pre><code>mysql&gt; SELECT gen_rnd_us_phone();\n</code></pre> Expected output <pre><code>+-------------------------------+\n| gen_rnd_us_phone()            |\n+-------------------------------+\n| 1-555-635-5709                |\n+-------------------------------+\n</code></pre> <p>An example of <code>gen_rnd_ssn()</code>:</p> <pre><code>mysql&gt; SELECT gen_rnd_ssn()\n</code></pre> Expected output <pre><code>+-----------------------------+\n| gen_rnd_ssn()               |\n+-----------------------------+\n| 995-33-5656                 |\n+-----------------------------+\n</code></pre>"},{"location":"data-masking-plugin-functions.html#use-dictionaries-to-generate-random-terms","title":"Use dictionaries to generate random terms","text":"<p>Use a selected dictionary to generate random terms. The dictionary must be loaded from a file with the following characteristics:</p> <ul> <li> <p>Plain text</p> </li> <li> <p>One term per line</p> </li> <li> <p>Must contain at least one entry</p> </li> </ul> <p>Copy the dictionary files to a directory accessible to MySQL. Percona Server for MySQL* 8.0.21-12 enabled using the <code>secure-file-priv</code> option for gen_dictionary_load(). The secure-file-priv option defines the directories where gen_dictionary_load() loads the dictionary files.</p> <p>Note</p> <p>Percona Server for MySQL 8.0.34 deprecates the <code>gen_blacklist()</code> function. Use <code>gen_blocklist()</code> instead.</p> Parameter Description Returns gen_blacklist(str, dictionary_name, replacement_dictionary_name) Replaces a term with a term from a second dictionary. Deprecated in Percona Server for MySQL 8.0.34. A dictionary term gen_blocklist(str, dictionary_name, replacement_dictionary_name) Replaces a term with a term from a second dictionary. A dictionary term gen_dictionary(dictionary_name) Randomizes the dictionary terms A random term from the selected dictionary. gen_dictionary_drop(dictionary_name) Removes the selected dictionary from the dictionary registry. Either success or failure gen_dictionary_load(dictionary path, dictionary name) Loads a file into the dictionary registry and configures the dictionary name. The name can be used with any function. If the dictionary is edited, you must drop and then reload the dictionary to view the changes. Either success or failure"},{"location":"data-masking-plugin-functions.html#example","title":"Example","text":"<p>An example of <code>gen_blocklist()</code>:</p> <pre><code>mysql&gt; SELECT gen_blocklist('apple', 'fruit', 'nut');\n</code></pre> Expected output <pre><code>+-----------------------------------------+\n| gen_blocklist('apple', 'fruit', 'nut')  |\n+-----------------------------------------+\n| walnut                                  |\n+-----------------------------------------+\n</code></pre> <p>An example of <code>gen_dictionary()</code>:</p> <pre><code>mysql&gt; SELECT gen_dictionary('trees');\n</code></pre> Expected output <pre><code>+--------------------------------------------------+\n| gen_dictionary('trees')                          |\n+--------------------------------------------------+\n| Norway spruce                                    |\n+--------------------------------------------------+\n</code></pre> <p>An example of <code>gen_dictionary_drop()</code>:</p> <pre><code>mysql&gt; SELECT gen_dictionary_drop('mytestdict')\n</code></pre> Expected output <pre><code>+-------------------------------------+\n| gen_dictionary_drop('mytestdict')   |\n+-------------------------------------+\n| Dictionary removed                  |\n+-------------------------------------+\n</code></pre> <p>An example of <code>gen_dictionary_load(path, name)</code>:</p> <pre><code>mysql&gt; SELECT gen_dictionary_load('/usr/local/mysql/dict-files/testdict', 'testdict');\n</code></pre> Expected output <pre><code>+-------------------------------------------------------------------------------+\n| gen_dictionary_load('/usr/local/mysql/mysql/dict-files/testdict', 'testdict') |\n+-------------------------------------------------------------------------------+\n| Dictionary load successfully                                                  |\n+-------------------------------------------------------------------------------+\n</code></pre>"},{"location":"development.html","title":"Development of Percona Server for MySQL","text":"<p>Percona Server for MySQL is an open source project to produce a distribution of the MySQL Server with improved performance, scalability and diagnostics.</p>"},{"location":"development.html#submit-changes","title":"Submit changes","text":"<p>We keep the trunk in a constant state of stability to allow for a release at any time and to minimize wasted time by developers due to broken code.</p>"},{"location":"development.html#overview","title":"Overview","text":"<p>At Percona we use Git for source control, GitHub for code hosting, and Jira for release management.</p> <p>We change our software to implement new features and/or to fix bugs. Refactoring could be classed either as a new feature or a bug depending on the scope of work.</p> <p>New features and bugs are targeted to specific releases. A release is part of a series. For example, 2.4 is a series in Percona XtraBackup and 2.4.15, 2.4.16, and 2.4.17 are releases in this series.</p> <p>Code is proposed for merging in the form of pull requests on GitHub.</p> <p>For Percona Server for MySQL, we have several Git branches on which development occurs: 5.5, 5.6, 5.7, and 8.0. As Percona Server for MySQL is not a traditional project, instead of being a set of patches against an existing product, these branches are not related. In other words, we do not merge from one release branch to another. To have your changes in several branches, you must propose branches to each release branch.</p>"},{"location":"development.html#making-a-change-to-a-project","title":"Making a change to a project","text":"<p>In this case, we are going to use <code>percona-xtrabackup</code> as an example. The workflow is similar for Percona Server for MySQL, but the patch will need to be modified in all release branches of Percona Server for MySQL.</p> <ul> <li> <p><code>git branch https://github.com/percona/percona-xtrabackup/featureX</code> (where \u2018featureX\u2019 is a sensible name for the task at hand)</p> </li> <li> <p>(developer makes changes in featureX, testing locally)</p> </li> <li> <p>The Developer pushes to <code>https://github.com/percona/username/percona-xtrabackup/featureX</code></p> </li> <li> <p>The developer can submit a pull request to https://github.com/percona/percona-xtrabackup,</p> </li> <li> <p>Code undergoes a review</p> </li> <li> <p>Once code is accepted, it can be merged</p> </li> </ul> <p>If the change also applies to a stable release (e.g. 2.4) then changes should be made on a branch of 2.4 and merged to a branch of the trunk. In this case, there should be two branches run through the param build and two merge proposals (one for the stable release and one with the changes merged to the trunk). This prevents somebody else from having to guess how to merge your changes.</p>"},{"location":"development.html#percona-server-for-mysql","title":"Percona Server for MySQL","text":"<p>The same process for Percona Server for MySQL, but we have several different branches (and merge requests).</p>"},{"location":"differences.html","title":"Differences between Percona MyRocks and Facebook MyRocks","text":"<p>The original MyRocks was developed by Facebook and works with their implementation of MySQL. Percona MyRocks is a branch of MyRocks for Percona Server for MySQL and includes the following differences from the original implementation:</p> <ul> <li>The behavior of the <code>START TRANSACTION WITH CONSISTENT SNAPSHOT</code> statement depends on the transaction isolation level.</li> </ul> Storage Engine Transaction isolation level <code>READ COMMITTED</code> <code>REPEATABLE READ</code> InnoDB Success Success Facebook MyRocks Fail Success (MyRocks engine only; read-only, as all MyRocks engine snapshots) Percona MyRocks Fail with any DML which would violate the read-only snapshot constraint Success (read-only snapshots independent of the engines in use) <ul> <li>Percona MyRocks includes the <code>lz4</code> and <code>zstd</code> statically linked libraries.</li> </ul>"},{"location":"disable-audit-log-filter.html","title":"Disable Audit Log Filter logging","text":"<p>The feature is in tech preview.</p> <p>The <code>audit_log_filter_disable</code> system variable lets you disable or enable logging for all connections.</p> <p>You can set the variable in the following ways:</p> <ul> <li>Option file</li> <li>Command-line startup string</li> <li>SET statement during runtime</li> </ul> <pre><code>mysql&gt; SET GLOBAL audit_log_filter_disable = true;\n</code></pre> <p>Setting audit_log_filter_disable has the following effect:</p> Value Actions true Generates a warning. Audit log function calls and changes in variables generate session warnings. Disables the plugin. false Re-enables the plugin and generates a warning. This is the default value."},{"location":"disable-audit-log-filter.html#privileges-required","title":"Privileges required","text":"<p>Setting the value of <code>audit_log_filter_disable</code> at runtime requires the following:</p> <ul> <li><code>AUDIT_ADMIN</code> privilege</li> <li><code>SYSTEM_VARIABLES_ADMIN</code> privilege</li> </ul>"},{"location":"docker-config.html","title":"Docker environment variables","text":"<p>When running a Docker container with Percona Server, you can adjust the configuration of the instance Add one or more environment variables to the <code>docker run</code> command.</p> <p>These variables will not affect you if you start the container with a data directory that already contains a database. Any pre-existing database remains untouched on the container startup.</p> <p>The variables are optional, but you must specify at least one of the following:</p> <ul> <li> <p><code>MYSQL_DATABASE</code> - the database schema name that is created when the container starts</p> </li> <li> <p><code>MYSQL_USER</code> - create a user account when the container starts</p> </li> <li> <p><code>MYSQL_PASSWORD</code> - used with <code>MYSQL_USER</code> to create a password for that user account.</p> </li> <li> <p><code>MYSQL_ALLOW_EMPTY_PASSWORD</code> - creates a root user with an empty password. This option is insecure and only should be used for testing or proof of concept when the database can be removed afterward. Anyone can connect as <code>root</code>.</p> </li> <li> <p><code>MYSQL_ROOT_PASSWORD</code> - this password is used for the <code>root</code> user account. This option is not recommended for production.</p> </li> <li> <p><code>MYSQL_RANDOM_ROOT_PASSWORD</code> - set this variable instead of <code>MYSQL_ROOT_PASSWORD</code> when you want Percona Server to generate a password for you. The generated password is available in the container\u2019s logs only during the first start of the container. Use <code>docker logs</code>. You cannot retrieve the password after the first start.</p> </li> </ul> <p>To further secure your instance, use the <code>MYSQL_ONETIME_PASSWORD</code> variable.</p> <p>These variables are visible to anyone able to run <code>Docker inspect</code>. </p> <pre><code>$ docker inspect ps\n</code></pre> Expected output <pre><code>...\n \"Env\": [\n                \"MYSQL_ROOT_PASSWORD=root\",\n                \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\n                \"PS_VERSION=8.0.29-21.1\",\n                \"OS_VER=el8\",\n                \"FULL_PERCONA_VERSION=8.0.29-21.1.el8\"\n               ]\n...\n</code></pre> <p>You should use <code>Docker secrets</code> or volumes instead. </p> <p>Percona Server for MySQL also allows adding the <code>_FILE</code> suffix to a variable name. This suffix lets you add the value in a path so that the value cannot be inspected from outside the container.</p>"},{"location":"docker.html","title":"Running Percona Server for MySQL in a Docker Container","text":"<p>Percona Server for MySQL has an official Docker image hosted on Docker Hub. If you want the latest version, use the <code>latest</code> tag. You can reference a specific version using the Docker tag filter for the 8.0 versions. </p> <p>Make sure that you are using the latest version of Docker. The <code>apt</code> and <code>yum</code> versions may be outdated and cause errors.</p>"},{"location":"docker.html#starting-a-detached-container","title":"Starting a detached container","text":"<p>You can start a background container with the <code>--detached</code> or <code>-d</code> option, which runs the container in the background. In detached mode, the container exits when the root process used to run the container exits.</p> <p>The following example starts a container named <code>ps</code> with the latest version of Percona Server for MySQL 8.0. This action also creates the <code>root</code> user and uses <code>root</code> as the password. Please note that <code>root</code> is not a secure password. </p> <pre><code>$ docker run -d \\\n  --name ps \\\n  -e MYSQL_ROOT_PASSWORD=root \\\n  percona/percona-server:8.0\n</code></pre> Expected output <pre><code>Unable to find image 'percona/percona-server:8.0' locally\n8.0: Pulling from percona/percona-server\n</code></pre> <p>By default, Docker pulls the image from Docker Hub if it is not available locally.</p> <p>To view the container\u2019s logs, use the following command:</p> <pre><code>docker logs ps --follow\n</code></pre> Expected output <pre><code>Initializing database\n2022-09-07T15:20:03.158128Z 0 [System] [MY-013169] [Server] /usr/sbin/mysqld (mysqld 8.0.29-21) initializing of server in progress as process 15\n2022-09-07T15:20:03.167764Z 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started.\n2022-09-07T15:20:03.530600Z 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended.\n2022-09-07T15:20:04.367600Z 0 [Warning] [MY-013829] [Server] Missing data directory for ICU regular expressions: /usr/lib64/mysql/private/.\n...\n2022-09-07T15:20:13.706090Z 0 [System] [MY-011323] [Server] X Plugin ready for connections. Bind-address: '::' port: 33060, socket: /var/lib/mysql/mysqlx.sock\n2022-09-07T15:20:13.706136Z 0 [System] [MY-010931] [Server] /usr/sbin/mysqld: ready for connections. Version: '8.0.29-21'  socket: '/var/lib/mysql/mysql.sock'  port: 3306  Percona Server (GPL), Release 21, Revision c59f87d2854.\n</code></pre> <p>You can access the server when you see the <code>ready for connections</code> information in the log.</p>"},{"location":"docker.html#passing-options","title":"Passing Options","text":"<p>You can pass options with the <code>docker run</code> command. For example, the following command uses UTF-8 as the default setting for character set and collation for all databases:</p> <pre><code>[root@docker-host] $ docker run -d \\\n --name ps \\\n -e MYSQL_ROOT_PASSWORD=root \\\n percona/percona-server:8.0 \\\n --character-set-server=utf8 \\\n --collation-server=utf8_general_ci\n</code></pre>"},{"location":"docker.html#accessing-the-percona-server-container","title":"Accessing the Percona Server Container","text":"<p>The <code>docker exec</code> command lets you have a shell inside the container. This command uses <code>it</code> which forwards your input stream as an interactive TTY. </p> <p>An example of accessing the detached container:</p> <pre><code>[root@docker-host] $ docker exec -it ps /bin/bash\n</code></pre> <p>If you need to troubleshoot, the error log is found in <code>/var/log/</code> or <code>/var/log/mysql/</code>. The file name may be error.log or mysqld.log. </p>"},{"location":"docker.html#troubleshooting","title":"Troubleshooting","text":"<p>You can view the error log with the following command:</p> <pre><code>[mysql@ps] $ more /var/log/mysql/error.log\n</code></pre> Expected output <pre><code>...\n2017-08-29T04:20:22.190474Z 0 [Warning] 'NO_ZERO_DATE', 'NO_ZERO_IN_DATE' and 'ERROR_FOR_DIVISION_BY_ZERO' sql modes should be used with strict mode. They will be merged with strict mode in a future release.\n2017-08-29T04:20:22.190520Z 0 [Warning] 'NO_AUTO_CREATE_USER' sql mode was not set.\n...\n</code></pre>"},{"location":"docker.html#accessing-the-database","title":"Accessing the database","text":"<p>You can access the database either with <code>Docker exec</code> or using the <code>mysql</code> command in the container\u2019s shell.</p> <p>An example of using <code>Docker exec</code> to access the database:</p> <pre><code>$ docker exec -ti ps mysql -uroot -proot\n</code></pre> Expected output <pre><code>mysql: [Warning] Using a password on the command line interface can be insecure.\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 9\n...\n</code></pre> <p>Exiting Percona Server also exits the container.</p> <p>You can also run the MySQL command-line client within the container\u2019s shell to access the database:</p> <pre><code>[mysql@ps] $ mysql -uroot -proot\n</code></pre> Expected output <pre><code>mysql: [Warning] Using a password on the command line interface can be insecure.\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 8\nServer version: 8.0.29-21 Percona Server (GPL), Release 21, Revision c59f87d2854\n\nCopyright (c) 2009-2022 Percona LLC and/or its affiliates\nCopyright (c) 2000, 2022, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n</code></pre>"},{"location":"docker.html#accessing-the-server-from-an-application-in-another-container","title":"Accessing the server from an application in another container","text":"<p>The image exposes the standard MySQL port 3306, so container linking makes the Percona Server instance available from other containers. To link a container running your application (in this case, from an image named <code>app/image</code>) with the Percona Server container, run it with the following command:</p> <pre><code>[root@docker-host] $ docker run -d \\\n  --name app \\\n  --link ps \\\n  app/image:latest\n</code></pre> <p>This application container will be able to access the Percona Server container via port 3306.</p>"},{"location":"docker.html#storing-data","title":"Storing data","text":"<p>There are two ways to store data used by applications that run in Docker containers:</p> <ul> <li> <p>Let Docker manage the storage of your data by writing the database files to disk on the host system using its internal volume management.</p> </li> <li> <p>Create a data directory on the host system on high-performance storage and mount it to a directory visible from the container. This method places the database files in a known location on the host system, and makes it easy for tools and applications on the host system to access the files. The user should ensure that the directory exists, that the user accounts have required permissions, and that any other security mechanisms on the host system are set up correctly.</p> </li> </ul> <p>For example, if you create a data directory on a suitable volume on your host system named <code>/local/datadir</code>, you run the container with the following command:</p> <pre><code>[root@docker-host] $ docker run -d \\\n  --name ps \\\n  -e MYSQL_ROOT_PASSWORD=root \\\n  -v /local/datadir:/var/lib/mysql \\\n  percona/percona-server:8.0\n</code></pre> <p>The <code>-v /local/datadir:/var/lib/mysql</code> option mounts the <code>/local/datadir</code> directory on the host to <code>/var/lib/mysql</code> in the container, which is the default data directory used by Percona Server for MySQL.</p> <p>Do not add MYSQL_ROOT_PASSWORD to the <code>docker run</code> command if the data directory contains subdirectories, files, or data.</p> <p>Note</p> <p>If you have SELinux enabled, assign the relevant policy type to the new data directory so that the container will be allowed to access it:</p> <pre><code>[root@docker-host] $ chcon -Rt svirt_sandbox_file_t /local/datadir\n</code></pre>"},{"location":"docker.html#port-forwarding","title":"Port forwarding","text":"<p>Docker allows mapping ports on the container to ports on the host system using the <code>-p</code> option. If you run the container with this option, you can connect to the database by connecting your client to a port on the host machine. This ability simplifies consolidating instances to a single host.</p> <p>To map the standard MySQL port 3306 to port 6603 on the host:</p> <pre><code>[root@docker-host] $ docker run -d \\\n --name ps \\\n -e MYSQL_ROOT_PASSWORD=root \\\n -p 6603:3306 \\\n percona/percona-server:8.0\n</code></pre>"},{"location":"docker.html#exiting-the-container","title":"Exiting the container","text":"<p>If you are in the interactive shell, use CTRL-D or exit to exit the session.</p> <p>If you have a non-shell process running, interrupt the process with <code>CTRL-C</code> before using either <code>CTRL-D</code> or <code>exit.</code></p>"},{"location":"docker.html#stopping-the-container","title":"Stopping the container","text":"<p>The docker stop container command sends a TERM signal, then waits 10 seconds and sends a KILL signal. The following example stops the <code>ps</code> container:</p> <pre><code>$ docker stop ps\n</code></pre> <p>The default length of time before stopping a container is 10 seconds. A very large instance cannot dump the data from memory to disk within that time. With this type of instance, add the <code>--time</code> or the <code>-t</code> option to docker stop:</p> <pre><code>$ docker stop ps -t 600\n</code></pre>"},{"location":"docker.html#removing-the-container","title":"Removing the container","text":"<p>To remove a stopped container, use the <code>docker rm</code> command.</p> <pre><code>$ docker rm ps\n</code></pre>"},{"location":"docker.html#for-more-information","title":"For more information","text":"<p>Review the Docker Docs</p>"},{"location":"downgrade.html","title":"Downgrade Percona Server for MySQL","text":"<p>Downgrading Percona Server for MySQL 8.0 to 5.7 is not supported. Downgrading from a Percona Server for MySQL 8.0 release to an earlier 8.0 release is not supported.</p> <p>Each release of Percona Server for MySQL 8.0 can contain significant changes.</p> <p>Before upgrading to the latest release, do the following:</p> <ul> <li> <p>Make a full backup of your data and test the backup</p> </li> <li> <p>Thoroughly test in a staging environment</p> </li> </ul> <p>MySQL 8 Minor Version Upgrades Are ONE-WAY Only</p>"},{"location":"encrypting-binlogs.html","title":"Encrypt Binary Log Files and Relay Log Files","text":"<p>Binary log file and relay log file encryption at rest ensures the server-generated binary logs are encrypted in persistent storage.</p>"},{"location":"encrypting-binlogs.html#upgrade-from-percona-server-for-mysql-8015-5-or-later","title":"Upgrade from Percona Server for MySQL 8.0.15-5 or later","text":"<p>As of 8.0.15-5, Percona Server for MySQL uses the upstream implementation of the binary log file and relay log file encryption.</p> <p>The encrypt-binlog variable is removed, and the related command-line option <code>\u2013encrypt-binlog</code> is not supported. It is important to remove the encrypt-binlog variable from your configuration file before you attempt to upgrade either from another release in the Percona Server for MySQL 8.0 series or from Percona Server for MySQL 5.7. Otherwise, a server boot error is generated and reports an unknown variable.</p> <p>The implemented binary log file encryption is compatible with the older format. The encrypted binary log file used in a previous version of MySQL 8.0 series or Percona Server for MySQL series is supported.</p>"},{"location":"encrypting-binlogs.html#architecture","title":"Architecture","text":"<p>The Binary log encryption uses the following tiers:</p> <ul> <li> <p>File password</p> </li> <li> <p>Binary log file encryption key</p> </li> </ul> <p>The file password encrypts the content of a single binary file or relay log file. The binary log encryption key encrypts the file password and the key is stored in the keyring.</p>"},{"location":"encrypting-binlogs.html#implementation","title":"Implementation","text":"<p>After you have enabled the <code>binlog_encryption</code> variable and the keyring is available, you can encrypt the data content for new binary log files and relay log files. Only the data content is encrypted. The server generates a MySQL error if you attempt to encrypt a binary log file or relay log file without a keyring.</p> <p>In replication, the source maintains the binary log and the replica maintains a binary log copy called the relay log. The source uses SSL connections to encrypt the stream, and the events are re-executed on the replica. The source and replicas can have separate keyring storage and different keyring plugins.</p> <p>The server rotates the binary log and relay log files if <code>binlog_encryption</code> = <code>OFF</code>. All new log files are unencrypted. Any encrypted files are not unencrypted.</p> <p>When an encrypted binary log is dumped, and this operation involves decryption, use <code>mysqlbinlog</code> with the <code>--read-from-remote-server</code> option.</p> <p>Note</p> <p>The \u2013read-from-remote-server option only applies to the binary logs. Encrypted relay logs can not be dumped or decrypted with this option.</p>"},{"location":"encrypting-binlogs.html#enable-binary-log-encryption","title":"Enable binary log encryption","text":"<p>In Percona Server for MySQL 8.0.15-5 and later, set the binlog_encryption variable to <code>ON</code> in a startup configuration file, such as <code>my.cnf</code>. The default is <code>OFF</code>.</p> <pre><code>binlog_encryption=ON\n</code></pre>"},{"location":"encrypting-binlogs.html#verify-the-encryption","title":"Verify the encryption","text":"<p>To verify that the binary log encryption option is enabled, run the following statement:</p> <pre><code>mysql&gt; SHOW BINARY LOGS;\n</code></pre> <p>The <code>SHOW BINARY LOGS</code> output displays the name, size, and if a binary log file is encrypted or unencrypted.</p> Expected output <pre><code>+-------------------+----------------+---------------+\n| Log_name          | File_size      | Encrypted     |\n+-------------------+----------------+---------------+\n| binlog.00011      | 72367          | No            |\n| binlog:00012      | 71503          | No            |\n| binlog:00013      | 73762          | Yes           |\n+-------------------+----------------+---------------+\n</code></pre>"},{"location":"encrypting-binlogs.html#binary-log-file-variables","title":"Binary log file variables","text":""},{"location":"encrypting-binlogs.html#encrypt_binlog","title":"<code>encrypt_binlog</code>","text":"Option Description Command-line \u2013encrypt-binlog Dynamic No Scope Global Data type Boolean Default OFF <p>Percona Server for MySQL 8.0.15-5 removes this variable.</p> <p>This variable enables or disables the binary log and relay log file encryption.</p>"},{"location":"encrypting-doublewrite-buffers.html","title":"Encrypt doublewrite buffers","text":"<p>A summary of Doublewrite buffer and Doublewrite buffer encryption changes:</p> Percona Server for MySQL Versions Doublewrite Buffer and Doublewrite Buffer Encryption Implementation Percona Server from Percona-Server-8.0.23-14 MySQL 8.0.23 implemented its own version of parallel doublewrite encryption. Pages that belong to encrypted tablespaces are also written into the doublewrite buffer in an encrypted form. The Percona implementation was reverted and theinnodb_parallel_dblwr_encrypt is deprecated and may be removed in later releases. Percona Server from Percona-Server-8.0.20-11 to Percona-Server-8.0.22-13 inclusive MySQL 8.0.20 implemented its own parallel doublewrite buffer, which is stored in external files (#ib_16384_xxx.dblwr) and not stored in the system tablespace. Percona\u2019s implementation was reverted. As a result, innodb_parallel_doublewrite_path was deprecated.  However, MySQL did not implement parallel doublewrite buffer encryption at this time, so Percona reimplemented parallel doublewrite buffer encryption on top of the MySQL parallel doublewrite buffer implementation. Percona preserved the meaning and functionality of the innodb_parallel_dblwr_encrypt variable. Percona-Server-8.0.12-1.alpha to Percona-Server-8.0.19-10 inclusive Percona Server for MySQL had its own implementation of the parallel doublewrite buffer which was enabled by setting the innodb_parallel_doublewrite_path variable.  Enabling the innodb_parallel_dblwr_encrypt controlled whether the parallel doublewrite pages were encrypted or not. In case the parallel doublewrite buffer was disabled (innodb_parallel_doublewrite_path was set to empty string),the doublewrite buffer pages were located in the system tablespace (ibdata1). The system tablespace itself could be encrypted by setting innodb_sys_tablespace_encrypt, which also encrypted the doublewrite buffer pages. <p>For Percona Server for MySQL versions below Percona Server for MySQL version 8.0.23-14, Percona encrypts the <code>doublewrite buffer</code> using innodb_parallel_dblwr_encrypt.</p>"},{"location":"encrypting-doublewrite-buffers.html#innodb_parallel_dblwr_encrypt","title":"<code>innodb_parallel_dblwr_encrypt</code>","text":"Option Description Command-line \u2013innodb-parallel-dblwr-encrypt Scope Global Dynamic Yes Data type Boolean Default OFF <p>The variable was announced as deprecated in Percona Server for MySQL 8.0.23-14.</p> <p>This variable controls whether the parallel doublewrite buffer pages were encrypted or not. The encryption used the key of the tablespace to which the page belongs.</p> <p>Starting from Percona Server for MySQL 8.0.23-14 the value of this variable is ignored. Pages from the encrypted tablespaces are always written to the doublewrite buffer as encrypted, and pages from unencrypted tablespaces are always written unencrypted.</p> <p>The <code>innodb_parallel_dblwr_encrypt</code> is accepted but has no effect. An explicit attempt to change the value generates the following warning in the error log file:</p> Error message <pre><code>**Setting Percona-specific INNODB_PARALLEL_DBLWR_ENCRYPT is deprecated and has no effect.**\n</code></pre>"},{"location":"encrypting-redo-log.html","title":"Encrypting the Redo Log data","text":""},{"location":"encrypting-redo-log.html#version-changes","title":"Version changes","text":"<p>Percona Server for MySQL 8.0.30-22 changes the data type to Boolean and removes the <code>master_key</code> and <code>keyring_key</code> options.</p> <p>Percona Server for MySQL 8.0.16-7 implements the options.</p>"},{"location":"encrypting-redo-log.html#overview","title":"Overview","text":"<p>MySQL uses the redo log files to apply changes during data recovery.</p> <p>Writing the redo log data to disk encrypts the data and reading the redo log data from disk unencrypts the data. When the redo log data is in memory, the data is unencrypted. The Redo log data uses the tablespace encryption key.</p> <p>Warning</p> <p>After the redo log is enabled, a MySQL 8.0.30 regression prevents disabling the redo log.</p> <p>After starting the server, an attempt to encrypt the redo log files fails if you have the following conditions:</p> <ul> <li>Server started with no keyring specified</li> <li>Server started with a keyring, but you specified a redo log encryption method that is different from the previously used method on the server.</li> </ul> <p>Starting with MySQL 8.0.30, the most recent checkpoint and the redo log encryption metadata is stored in the redo log file header.</p> <p>After enabling redo log encryption, attempting a normal restart without the keyring plugin or keyring component is not possible, since InnoDB scans the redo log pages during startup. Without the keyring plugin or keyring component, this operation is not possible when the redo log pages are encrypted. You can do a forced startup without the redo logs.</p>"},{"location":"encrypting-redo-log.html#system-variable","title":"System variable","text":""},{"location":"encrypting-redo-log.html#innodb_redo_log_encrypt","title":"<code>innodb_redo_log_encrypt</code>","text":"Variable Description Command-line \u2013innodb-redo-log-encrypt Dynamic Yes Scope Global Data type Boolean Default OFF Option Description ON This option is a compatibility alias for the master_key. Any existing redo log pages remain unencrypted; new pages are encrypted when written to disk. OFF Any existing encrypted pages remain encrypted; new pages are unencrypted. master_key Removed in Percona Server for MySQL 8.0.30-22 keyring_key Removed in Percona Server for MySQL 8.0.30-22 <p>Determines the encryption for the table redo log data. The default option for the variable is <code>OFF</code>.</p>"},{"location":"encrypting-system-tablespace.html","title":"Encrypt system tablespace","text":""},{"location":"encrypting-system-tablespace.html#version-changes","title":"Version changes","text":"<p>Percona Server for MySQL 8.0.31-23 removes keyring encryption with advanced encryption key rotation and associated system variables, status variables, and options.</p> <p>Keyring encryption is a tech preview feature.</p>"},{"location":"encrypting-system-tablespace.html#overview","title":"Overview","text":"<p>Percona Server for MySQL supports system tablespace encryption. The InnoDB system tablespace may be encrypted with the master key encryption. The limitation is the following:</p> <ul> <li>You cannot convert the system tablespace from the encrypted state to the unencrypted state, or the unencrypted state to the encrypted state. If a conversion is needed, create a new instance with the system tablespace in the required state and transfer the user tables to that instance.</li> </ul> <p>To enable system tablespace encryption, edit <code>my.cnf</code>, and set the <code>innodb_sys_tablespace_encrypt</code> =\u201cON\u201d</p> <p>System tablespace encryption can only be enabled with the <code>--initialize</code> option</p> <p>You can create an encrypted table as follows:</p> <pre><code>mysql&gt; CREATE TABLE table_name TABLESPACE=innodb_system ENCRYPTION='Y';\n</code></pre>"},{"location":"encrypting-system-tablespace.html#system-variables","title":"System variables","text":""},{"location":"encrypting-system-tablespace.html#innodb_sys_tablespace_encrypt","title":"<code>innodb_sys_tablespace_encrypt</code>","text":"Option Description Command-line \u2013innodb-sys-tablespace-encrypt Scope Global Dynamic No Data type Boolean Default OFF <p>Enables the encryption of the InnoDB system tablespace.</p>"},{"location":"encrypting-system-tablespace.html#re-encrypt-the-system-tablespace","title":"Re-encrypt the system tablespace","text":"<p>You can re-encrypt the system tablespace key with master key rotation. When the master key is rotated, the tablespace key is decrypted and re-encrypt with the new master key. Only the first page of the tablespace (.ibd) file is read and written during the key rotation. The tables in the tablespace are not re-encrypted.</p> <pre><code>mysql&gt; ALTER INSTANCE ROTATE INNODB MASTER KEY;\n</code></pre>"},{"location":"encrypting-tables.html","title":"Encrypt File-Per-Table Tablespace","text":"<p>A file-per-table tablespace stores the table data and the indexes for a single InnoDB table. In this tablespace configuration, each table is stored in a <code>.ibd</code> file.</p> <p>The architecture for data at rest encryption for file-per-table tablespace has two tiers:</p> <ul> <li> <p>Master key</p> </li> <li> <p>Tablespace keys</p> </li> </ul> <p>The keyring plugin must be installed and enabled. The file_per_table tablespace inherits the schema default encryption setting unless you explicitly define encryption in <code>CREATE TABLE</code> or <code>ALTER TABLE</code>.</p> <pre><code>mysql&gt; CREATE TABLE ... ENCRYPTION='Y';\n</code></pre> <pre><code>mysql&gt; ALTER TABLE ... ENCRYPTION='Y';\n</code></pre> <p>Using <code>ALTER TABLE</code> without the <code>ENCRYPTION</code> option does not change the encryption state. An encrypted table remains encrypted or an unencrypted table remains unencrypted.</p>"},{"location":"encrypting-tablespaces.html","title":"Encrypt schema or general tablespace","text":"<p>Percona Server for MySQL uses the same encryption architecture as *MySQL, a two-tier system consisting of a master key and tablespace keys. The master key can be changed, or rotated in the keyring, as needed. Each tablespace key, when decrypted, remains the same.</p> <p>The feature requires the keyring plugin.</p>"},{"location":"encrypting-tablespaces.html#set-the-default-for-schemas-and-general-tablespace-encryption","title":"Set the default for schemas and general tablespace encryption","text":"<p>The tables in a general tablespace are either all encrypted or all unencrypted. A tablespace cannot contain a mixture of encrypted tables and unencrypted tables.</p> <p>In versions before Percona Server for MySQL 8.0.16-7, use the variable innodb_encrypt_tables.</p>"},{"location":"encrypting-tablespaces.html#innodb_encrypt_tables","title":"<code>innodb_encrypt_tables</code>","text":"Option Description Command-line \u2013innodb-encrypt-tables Scope Global Dynamic Yes Data type Text Default OFF <p>The variable is deprecated and removed in Percona Server for MySQL 8.0.16-7.</p> <p>The default setting is \u201cOFF\u201d.</p> <p>The encryption of a schema or a general tablespace is determined by the default_table_encryption variable unless you specify the ENCRYPTION clause in the CREATE SCHEMA or CREATE TABLESPACE statement. This variable is implemented in Percona Server for MySQL version 8.0.16-7.</p> <p>You can set the <code>default_table_encryption</code> variable in an individual connection.</p> <pre><code>mysql&gt; SET default_table_encryption=ON;\n</code></pre>"},{"location":"encrypting-tablespaces.html#system-variable","title":"System variable","text":""},{"location":"encrypting-tablespaces.html#default_table_encryption","title":"<code>default_table_encryption</code>","text":"<p>Percona Server for MySQL 8.0.31-23 removes the <code>ONLINE_TO_KEYRING</code> and <code>ONLINE_TO_KEYRING_TO_UNENCRYPTED</code> options. </p> Option Description Command-line default-table-encryption Scope Session Dynamic Yes Data type Text Default OFF <p>Defines the default encryption setting for schemas and general tablespaces. The variable allows you to create or alter schemas or tablespaces without specifying the ENCRYPTION clause. The default encryption setting applies only to schemas and general tablespaces and is not applied to the MySQL system tablespace.</p> <p>The variable has the following possible options:</p> Value Description <code>ON</code> New tables are encrypted. Add <code>ENCRYPTION=\"N\"</code> to the <code>CREATE TABLE</code> or <code>ALTER TABLE</code> statement to create unencrypted tables. <code>OFF</code> By default, new tables are unencrypted. Add <code>ENCRYPTION=\"Y\"</code> to the <code>CREATE TABLE</code> or <code>ALTER TABLE</code> statement to create encrypted tables. <code>ONLINE_TO_KEYRING</code> This option is technical preview quality. Percona Server for MySQL 8.0.31-23 removes this option.*  Converts a tablespace encrypted by a Master Key to use Advanced Encryption Key Rotation. You can only apply the keyring encryption when creating tables or altering tables. <code>ONLINE_FROM_KEYRING_TO_UNENCRYPTED</code> This option is technical preview quality. Percona Server for MySQL 8.0.31-23 removes this option.* Converts a tablespace encrypted by Advanced Encryption Key Rotation to unencrypted. <p>Note</p> <p>The <code>ALTER TABLE</code> statement changes the current encryption mode only if you use the <code>ENCRYPTION</code> clause.</p> <p>See also</p> <p>MySQL Documentation: default_table_encryption</p>"},{"location":"encrypting-tablespaces.html#merge-sort-encryption","title":"Merge-sort-encryption","text":""},{"location":"encrypting-tablespaces.html#innodb_encrypt_online_alter_logs","title":"<code>innodb_encrypt_online_alter_logs</code>","text":"Option Description Command-line \u2013innodb_encrypt-online-alter-logs Scope Global Dynamic Yes Data type Boolean Default OFF <p>This variable simultaneously turns on the encryption of files used by InnoDB for full-text search using parallel sorting, building indexes using merge sort, and online DDL logs created by InnoDB for online DDL. Encryption is available for file merges used in queries and backend processes.</p>"},{"location":"encrypting-tablespaces.html#use-encryption","title":"Use ENCRYPTION","text":"<p>If you do not set the default encryption setting, you can create general tablespaces with the <code>ENCRYPTION</code> setting.</p> <pre><code>mysql&gt; CREATE TABLESPACE tablespace_name ENCRYPTION='Y';\n</code></pre> <p>All tables contained in the tablespace are either encrypted or not encrypted. You cannot encrypt only some of the tables in a general tablespace. This feature extends the  CREATE TABLESPACE statement to accept the <code>ENCRYPTION='Y/N'</code> option.</p> <p>Note</p> <p>Prior to Percona Server for MySQL 8.0.13, the <code>ENCRYPTION</code> option was specific to the <code>CREATE TABLE</code> or <code>SHOW CREATE TABLE</code> statement. </p> <p>As of Percona Server for MySQL 8.0.13, the option is a tablespace attribute and is not allowed with the <code>CREATE TABLE</code> or <code>SHOW CREATE TABLE</code> statement except with file-per-table tablespaces.</p> <p>In an encrypted general tablespace, an attempt to create an unencrypted table generates the following error:</p> <pre><code>mysql&gt; CREATE TABLE t3 (a INT, b TEXT) TABLESPACE foo ENCRYPTION='N';\n</code></pre> Expected output <pre><code>ERROR 1478 (HY0000): InnoDB: Tablespace 'foo' can contain only ENCRYPTED tables.\n</code></pre> <p>The server diagnoses an attempt to create or move tables, including partitioned ones, to a general tablespace with an incompatible encryption setting and aborts the process.</p> <p>If you must move tables between incompatible tablespaces, create tables with the same structure in another tablespace and run <code>INSERT INTO SELECT</code> from each of the source tables into the destination tables.</p>"},{"location":"encrypting-tablespaces.html#export-an-encrypted-general-tablespace","title":"Export an encrypted general tablespace","text":"<p>You can only export encrypted file-per-table tablespaces</p>"},{"location":"encrypting-temporary-files.html","title":"Encrypt temporary files","text":"<p>For InnoDB user-created temporary tables are created in a temporary tablespace file and use the <code>innodb_temp_tablespace_encrypt</code> variable.</p> <p>The <code>CREATE TEMPORARY TABLE</code> does not support the <code>ENCRYPTION</code> clause. The <code>TABLESPACE</code> clause cannot be set to <code>innodb_temporary</code>.</p> <p>The global temporary tablespace datafile <code>ibtmp1</code> contains the temporary table undo logs while intrinsic temporary tables and user-created temporary tables are located in the encrypted session temporary tablespace.</p> <p>To create new temporary tablespaces unencrypted, the following variables must be set to <code>OFF</code> at runtime:</p> <ul> <li> <p><code>innodb_temp_tablespace_encrypt</code></p> </li> <li> <p><code>default_table_encryption</code></p> </li> </ul> <p>Any existing encrypted user-created temporary files and intrinsic temporary tables remain in an encrypted session.</p> <p>Temporary tables are only destroyed when the session is disconnected.</p> <p>The <code>default_table_encryption</code> setting in my.cnf determines if a temporary table is encrypted.</p> <p>If the <code>innodb_temp_tablespace_encrypt</code> = \u201cOFF\u201d and the <code>default_table_encryption</code> =\u201dON\u201d, the user-created temporary tables are encrypted. The temporary tablespace data file <code>ibtmp1</code>, which contains undo logs, is not encrypted.</p> <p>If the <code>innodb_temp_tablespace_encrypt</code> is \u201cON\u201d for the system tablespace, InnoDB generates an encryption key and encrypts the system\u2019s temporary tablespace.  If you reset the encryption to \u201cOFF\u201d, all subsequent pages are written to an unencrypted tablespace. Any generated keys are not erased to allow encrypted tables and undo data to be decrypted.</p> <p>For each temporary file, an encryption key has the following attributes:</p> <ul> <li> <p>Generated locally</p> </li> <li> <p>Maintained in memory for the lifetime of the temporary file</p> </li> <li> <p>Discarded with the temporary file</p> </li> </ul>"},{"location":"encrypting-temporary-files.html#system-variables","title":"System variables","text":""},{"location":"encrypting-temporary-files.html#encrypt_tmp_files","title":"<code>encrypt_tmp_files</code>","text":"Option Description Command-line \u2013encrypt_tmp_files Scope Global Dynamic No Data type Boolean Default OFF <p>This variable turns \u201cON\u201d the encryption of temporary files created by the Percona Server for MySQL. The default value is <code>OFF</code>.</p>"},{"location":"encrypting-temporary-files.html#innodb_temp_tablespace_encrypt","title":"<code>innodb_temp_tablespace_encrypt</code>","text":"Option Description Command-line innodb-temp-tablespace-encrypt Scope Global Dynamic Yes Data type Boolean Default OFF <p>When this variable is set to <code>ON</code>, the server encrypts the global temporary tablespace and has the .ibtmp1 file extension and the session temporary tablespace and has the .ibt file extension. </p> <p>The variable does not enforce the encryption of currently open temporary files and does not rebuild the system\u2019s temporary tablespace to encrypt data that has already been written.</p>"},{"location":"encrypting-threads.html","title":"Advanced encryption key rotation","text":"<p>Important</p> <p>This feature, and associated system variables, status variables, and options have been removed in Percona Server for MySQL 8.0.31-23.</p> <p>The Advanced Encryption Key Rotation feature lets you perform specific encryption and decryption tasks in real time.</p> <p>The following table explains the benefits of Advanced Encryption Key Rotation:</p> Advanced Encryption Key Rotation Master Key Encryption Encrypts any existing tablespaces in a single operation. Advanced Encryption Key Rotation allows encryption to be applied to all or selected existing tablespaces. You can exclude tablespaces. Encrypts each existing tablespace as a separate operation. Encrypts tables with a key from a keyring. Encrypts tables with a key that is then stored in the encryption header of the tablespace. Re-encrypts each tablespace page by page when the key is rotated. Re-encrypts only the tablespace encryption header when the key is rotated. <p>If you enable Advanced Encryption Key Rotation with a Master key encrypted tablespace, the tablespace is re-encrypted with the keyring key in a background process. If the Advanced Encryption Key Rotation feature is enabled, you cannot convert a tablespace to use Master key encryption. You must disable the feature before you convert the tablespace.</p> <p>This feature is in tech preview.</p> <p>You must have the SYSTEM_VARIABLES_ADMIN privilege or the SUPER privilege to set these variables.</p>"},{"location":"encrypting-threads.html#innodb_encryption_threads","title":"<code>innodb_encryption_threads</code>","text":"<p>This variable is removed in Percona Server for MySQL 8.0.31-23.</p> Option Description Command-line \u2013innodb-encryption-threads Scope Global Dynamic Yes Data type Numeric Default 0 <p>This variable works in combination with the default_table_encryption variable set to <code>ONLINE_TO_KEYRING</code>. This variable configures the number of threads for background encryption. For the online encryption, the value must be greater than zero.</p>"},{"location":"encrypting-threads.html#innodb_online_encryption_rotate_key_age","title":"<code>innodb_online_encryption_rotate_key_age</code>","text":"<p>This variable is removed in Percona Server for MySQL 8.0.31-23.</p> Option Description Command-line \u2013innodb-online-encryption-rotate-key-age Scope Global Dynamic Yes Data type Numeric Default 1 <p>Defines the rotation for the re-encryption of a table encrypted using KEYRING. The value of this variable determines the how frequently the encrypted tables are re-encrypted.</p> <p>For example, the following values would trigger a re-encryption in the following intervals:</p> <ul> <li> <p>The value is 1, and the table is re-encrypted on each key rotation.</p> </li> <li> <p>The value is 2, and the table is re-encrypted on every other key rotation.</p> </li> <li> <p>The value is 10, and the table is re-encrypted on every tenth key rotation.</p> </li> </ul> <p>You should select the value which best fits your operational requirements.</p>"},{"location":"encrypting-threads.html#innodb_encryption_rotation_iops","title":"<code>innodb_encryption_rotation_iops</code>","text":"<p>This variable is removed in Percona Server for MySQL 8.0.31-23.</p> Option Description Command-line \u2013innodb-encryption-rotation-iops Scope Global Dynamic Yes Data type Numeric Default 100 <p>Defines the number of input/output operations per second (iops) available for use by a key rotation process.</p>"},{"location":"encrypting-threads.html#innodb_default_encryption_key_id","title":"<code>innodb_default_encryption_key_id</code>","text":"<p>This variable is removed in Percona Server for MySQL 8.0.31-23.</p> Option Description Command-line \u2013innodb-default-encryption-key-id Scope Session Dynamic Yes Data type Numeric Default 0 <p>Defines the default encryption ID used to encrypt tablespaces.</p>"},{"location":"encrypting-threads.html#use-keyring-encryption","title":"Use Keyring Encryption","text":"<p>This feature is removed in Percona Server for MySQL 8.0.31-23.</p> <p>Keyring management is enabled for each table, per file table, separately when you set encryption in the <code>ENCRYPTION</code> clause to <code>KEYRING</code> in the supported SQL statement.</p> <ul> <li> <p>CREATE TABLE \u2026 ENCRYPTION=\u2019KEYRING\u2019</p> </li> <li> <p>ALTER TABLE \u2026 ENCRYPTION=\u2019KEYRING\u2019</p> </li> </ul> <p>Note</p> <p>Running an <code>ALTER TABLE ... ENCRYPTION='N'</code> on a table created with <code>ENCRYPTION='KEYRING'</code> converts the table to the existing MySQL schema, tablespace, or table encryption state.</p>"},{"location":"encrypting-undo-tablespace.html","title":"Encrypt the undo tablespace","text":"<p>The undo data may contain sensitive information about the database operations.</p> <p>You can encrypt the data in an undo log using the innodb_undo_log_encrypt option. You can change the setting for this variable in the configuration file, as a startup parameter, or during runtime as a global variable. The undo data encryption must be enabled; the feature is disabled by default.</p>"},{"location":"encrypting-undo-tablespace.html#innodb_undo_log_encrypt","title":"<code>innodb_undo_log_encrypt</code>","text":"Option Description Command-line \u2013innodb_undo-log_encrypt Scope Global Dynamic Yes Data type Boolean Default OFF <p>Defines if the undo log data is encrypted. The default for the undo log is \u201cOFF\u201d, which disables the encryption.</p> <p>You can create up to 127 undo tablespaces and you can, with the server running, add or reduce the number of undo tablespaces.</p> <p>Note</p> <p>If you disable encryption, any encrypted undo data remains encrypted. To remove this data, and truncate the undo tablespace.</p>"},{"location":"encrypting-undo-tablespace.html#how-to-enable-encryption-on-an-undo-log","title":"How to enable encryption on an undo log","text":"<p>You enable encryption for an undo log by adding the following to the my.cnf file:</p> <pre><code>[mysqld]\n...\ninnodb_undo_log_encrypt=ON\n...\n</code></pre>"},{"location":"encryption-functions.html","title":"Encryption functions","text":"<p>Percona Server for MySQL 8.0.28-20 adds encryption functions and variables to manage the encryption range. The functions may take an algorithm argument. Encryption converts plaintext into ciphertext using a key and an encryption algorithm.</p> <p>You can also use the user-defined functions with the PEM format keys generated externally by the OpenSSL utility.</p> <p>A digest uses plaintext and generates a hash value. This hash value can verify if the plaintext is unmodified. You can also sign or verify on digests to ensure that the original plaintext was not modified. You cannot decrypt the original text from the hash value.</p> <p>When choosing key lengths, consider the following:</p> <ul> <li> <p>Encryption strength increases with the key size and, also, the key generation time.</p> </li> <li> <p>If performance is important and the functions are frequently used, use symmetric encryption. Symmetric encryption functions are faster than asymmetric encryption functions. Moreover, asymmetric encryption has restrictions on the maximum length of a message being encrypted. For example, for RSA the algorithm maximum message size is the key length in bytes (key length in bits / 8) minus 11.</p> </li> </ul> <p>The following table and sections describe the functions. For examples, see function examples.</p> Function Name asymmetric_decrypt(algorithm, crypt_str, key_str) asymmetric_derive(pub_key_str, priv_key_str) asymmetric_encrypt(algorithm, str, key_str) asymmetric_sign(algorithm, digest_str, priv_key_str, digest_type) asymmetric_verify(algorithm, digest_str, sig_str, pub_key_str, digest_type) create_asymmetric_priv_key(algorithm, (key_len | dh_parameters)) create_asymmetric_pub_key(algorithm, priv_key_str) create_dh_parameters(key_len) create_digest(digest_type, str) <p>The following table describes the Encryption threshold variables which can be used to set the maximum value for a key length based on the type of encryption.</p> Variable Name encryption_udf.dh_bits_threshold encryption_udf.dsa_bits_threshold encryption_udf.rsa_bits_threshold"},{"location":"encryption-functions.html#install-component_encryption_udf","title":"Install component_encryption_udf","text":"<p>Use the Install Component Statement to add the component_encryption_udf component. The functions and variables are available. The user-defined functions and the Encryption threshold variables are auto-registered. There is no requirement to invoke <code>CREATE FUNCTION ... SONAME ...</code>.</p> <p>The <code>INSERT</code> privilege on the <code>mysql.component</code> system table is required to run the <code>INSTALL COMPONENT</code> statement. To register the component, the operation adds a row to this table.</p> <p>The following is an example of the installation command:</p> <pre><code>mysql&gt; INSTALL COMPONENT 'file://component_encryption_udf';\n</code></pre> <p>Note</p> <p>If you are Compiling Percona Server for MySQL from Source, the Encryption UDF component is built by default when Percona Server for MySQL is built. Specify the <code>-DWITH_ENCRYPTION_UDF=OFF</code> cmake option to exclude it.</p>"},{"location":"encryption-functions.html#user-defined-functions-described","title":"User-defined functions described","text":""},{"location":"encryption-functions.html#asymmetric_decryptalgorithm-crypt_str-key_str","title":"asymmetric_decrypt(algorithm, crypt_str, key_str)","text":"<p>Decrypts an encrypted string using the algorithm and a key string.</p>"},{"location":"encryption-functions.html#returns","title":"Returns","text":"<p>A plaintext as a string.</p>"},{"location":"encryption-functions.html#parameters","title":"Parameters","text":"<p>The following are the function\u2019s parameters:</p> <ul> <li> <p>algorithm - the encryption algorithm supports RSA to decrypt the string.</p> </li> <li> <p>key_str - a string in the PEM format. The key string must have the following attributes:</p> </li> <li> <p>Valid</p> </li> <li> <p>Public or private key string that corresponds with the private or public key string used with the asymmetric_encrypt function.</p> </li> </ul>"},{"location":"encryption-functions.html#asymmetric_derivepub_key_str-priv_key_str","title":"asymmetric_derive(pub_key_str, priv_key_str)","text":"<p>Derives a symmetric key using a public key generated on one side and a private key generated on another.</p>"},{"location":"encryption-functions.html#asymmetric_derive-output","title":"asymmetric_derive output","text":"<p>A key as a binary string.</p>"},{"location":"encryption-functions.html#asymmetric_derive-parameters","title":"asymmetric_derive parameters","text":"<p>The <code>pub_key_str</code> must be a public key in the PEM format and generated using the Diffie-Hellman (DH) algorithm.</p> <p>The <code>priv_key_str</code> must be a private key in the PEM format and generated using the Diffie-Hellman (DH) algorithm.</p>"},{"location":"encryption-functions.html#asymmetric_encryptalgorithm-str-key_str","title":"asymmetric_encrypt(algorithm, str, key_str)","text":"<p>Encrypts a string using the algorithm and a key string.</p>"},{"location":"encryption-functions.html#asymmetric_encrypt-output","title":"asymmetric_encrypt output","text":"<p>A ciphertext as a binary string.</p>"},{"location":"encryption-functions.html#asymmetric_encrypt-parameters","title":"asymmetric_encrypt parameters","text":"<p>The parameters are the following:</p> <ul> <li> <p>algorithm - the encryption algorithm supports RSA to encrypt the string.</p> </li> <li> <p>str - measured in bytes. The length of the string must not be greater than the key_str modulus length in bytes - 11 (additional bytes used for PKCS1 padding)</p> </li> <li> <p>key_str - a key (either private or public) in the PEM format</p> </li> </ul>"},{"location":"encryption-functions.html#asymmetric_signalgorithm-digest_str-priv_key_str-digest_type","title":"asymmetric_sign(algorithm, digest_str, priv_key_str, digest_type)","text":"<p>Signs a digest string using a private key string.</p>"},{"location":"encryption-functions.html#asymmetric_sign-output","title":"asymmetric_sign output","text":"<p>A signature is a binary string.</p>"},{"location":"encryption-functions.html#asymmetric_sign-parameters","title":"asymmetric_sign parameters","text":"<p>The parameters are the following:</p> <ul> <li> <p>algorithm - the encryption algorithm supports either RSA or DSA to encrypt the string.</p> </li> <li> <p>digest_str - the digest binary string that is signed. Invoking create_digest generates the digest.</p> </li> <li> <p>priv_key_str - the private key used to sign the digest string. The key must be in the PEM format.</p> </li> <li> <p>digest_type - the OpenSSL version installed on your system determines the available hash functions. The following table lists these functions:</p> OpenSSL 1.0.2 OpenSSL 1.1.0 OpenSSL 1.1.1 OpenSSL 3.0.x md5 md5 md5 md5 sha1 sha1 sha1 sha1 sha224 sha224 sha224 sha224 sha384 sha384 sha384 sha384 sha512 sha512 sha512 sha512 md4 md4 md4 md4 sha md5-sha1 md5-sha1 md5-sha1 ripemd160 ripemd160 ripemd160 sha512-224 whirlpool whirlpool sha512-224 sha512-256 blake2b512 sha512-256 sha3-224 blake2s256 whirlpool sha3-256 sm3 sha3-384 blake2b512 sha3-512 blake2s256 sha3-224 sha3-384 sha3-512 shake128 shake256 </li> </ul>"},{"location":"encryption-functions.html#asymmetric_verifyalgorithm-digest_str-sig_str-pub_key_str-digest_type","title":"asymmetric_verify(algorithm, digest_str, sig_str, pub_key_str, digest_type)","text":"<p>Verifies whether the signature string matches the digest string.</p>"},{"location":"encryption-functions.html#asymmetric_verify-output","title":"asymmetric_verify output","text":"<p>A <code>1</code> (success) or a <code>0</code> (failure).</p>"},{"location":"encryption-functions.html#asymmetric_verify-parameters","title":"asymmetric_verify parameters","text":"<p>The parameters are the following:</p> <ul> <li> <p>algorithm - supports either \u2018RSA\u2019 or \u2018DSA\u2019.</p> </li> <li> <p>digest_str - invoking create_digest generates this digest binary string.</p> </li> <li> <p>sig_str - the signature binary string. Invoking asymmetric_sign generates this string.</p> </li> <li> <p>pub_key_str - the signer\u2019s public key string. This string must correspond to the private key passed to asymmetric_sign to generate the signature string. The string must be in the PEM format.</p> </li> <li> <p>digest_type - the supported values are listed in the digest type table of create_digest</p> </li> </ul>"},{"location":"encryption-functions.html#create_asymmetric_priv_keyalgorithm-key_len-dh_parameters","title":"create_asymmetric_priv_key(algorithm, (key_len | dh_parameters))","text":"<p>Generates a private key using the given algorithm and key length for RSA or DSA or Diffie-Hellman parameters for DH. For RSA or DSA, if needed, execute <code>KILL [QUERY|CONNECTION] &lt;id&gt;</code> to terminate a long-lasting key generation. The DH key generation from existing parameters is a quick operation. Therefore, it does not make sense to terminate that operation with <code>KILL</code>.</p>"},{"location":"encryption-functions.html#create_asymmetric_priv_key-output","title":"create_asymmetric_priv_key output","text":"<p>The key as a string in the PEM format.</p>"},{"location":"encryption-functions.html#create_asymmetric_priv_key-parameters","title":"create_asymmetric_priv_key parameters","text":"<p>The parameters are the following:</p> <ul> <li> <p>algorithm - the supported values are \u2018RSA\u2019, \u2018DSA\u2019, or \u2018DH\u2019.</p> </li> <li> <p>key_len - the supported key length values are the following:</p> <ul> <li> <p>RSA - the minimum length is 1,024. The maximum length is 16,384.</p> </li> <li> <p>DSA - the minimum length is 1,024. The maximum length is 9,984.</p> </li> </ul> <p>Note</p> <p>The key length limits are defined by OpenSSL. To change the maximum key length, use either encryption_udf.rsa_bits_threshold or encryption_udf.dsa_bits_threshold.</p> </li> <li> <p>dh_parameters - Diffie-Hellman (DH) parameters. Invoking create_dh_parameter creates the DH parameters.</p> </li> </ul>"},{"location":"encryption-functions.html#create_asymmetric_pub_keyalgorithm-priv_key_str","title":"create_asymmetric_pub_key(algorithm, priv_key_str)","text":"<p>Derives a public key from the given private key using the given algorithm.</p>"},{"location":"encryption-functions.html#create_asymmetric_pub_key-output","title":"create_asymmetric_pub_key output","text":"<p>The key as a string in the PEM format.</p>"},{"location":"encryption-functions.html#create_asymmetric_pub_key-parameters","title":"create_asymmetric_pub_key parameters","text":"<p>The parameters are the following:</p> <ul> <li> <p>algorithm - the supported values are \u2018RSA\u2019, \u2018DSA\u2019, or \u2018DH\u2019.</p> </li> <li> <p>priv_key_str - must be a valid key string in the PEM format.</p> </li> </ul>"},{"location":"encryption-functions.html#create_dh_parameterskey_len","title":"create_dh_parameters(key_len)","text":"<p>Creates parameters for generating a Diffie-Hellman (DH) private/public key pair. If needed, execute <code>KILL [QUERY|CONNECTION] &lt;id&gt;</code> to terminate the generation of long-lasting parameters.</p> <p>Generating the DH parameters can take more time than generating the RSA keys or the DSA keys. OpenSSL defines the parameter length limits. To change the maximum parameter length, use encryption_udf.dh_bits_threshold.</p>"},{"location":"encryption-functions.html#create_dh_parameters-output","title":"create_dh_parameters output","text":"<p>A string in the PEM format and can be passed to create_asymmetric_private_key.</p>"},{"location":"encryption-functions.html#create_dh_parameters-parameters","title":"create_dh_parameters parameters","text":"<p>The parameters are the following:</p> <ul> <li>key_len - the range for the key length is from 1024 to 10,000. The default value is 10,000.</li> </ul>"},{"location":"encryption-functions.html#create_digestdigest_type-str","title":"create_digest(digest_type, str)","text":"<p>Creates a digest from the given string using the given digest type. The digest string can be used with asymmetric_sign and asymmetric_verify.</p>"},{"location":"encryption-functions.html#create_digest-output","title":"create_digest output","text":"<p>The digest of the given string as a binary string</p>"},{"location":"encryption-functions.html#create_digest-parameters","title":"create_digest parameters","text":"<p>The parameters are the following:</p> <ul> <li> <p>digest_type - the OpenSSL version installed on your system determines the available hash functions. The following table lists these functions:</p> OpenSSL 1.0.2 OpenSSL 1.1.0 OpenSSL 1.1.1 OpenSSL 3.0.x md5 md5 md5 md5 sha1 sha1 sha1 sha1 sha224 sha224 sha224 sha224 sha384 sha384 sha384 sha384 sha512 sha512 sha512 sha512 md4 md4 md4 md4 sha md5-sha1 md5-sha1 md5-sha1 ripemd160 ripemd160 ripemd160 sha512-224 whirlpool whirlpool sha512-224 sha512-256 blake2b512 sha512-256 sha3-224 blake2s256 whirlpool sha3-256 sm3 sha3-384 blake2b512 sha3-512 blake2s256 sm3 sha3-224 blake2b512 sha3-384 blake2s256 sha3-512 blake2b512 shake128 blake2s256 shake256 </li> <li> <p>str - String used to generate the digest string.</p> </li> </ul>"},{"location":"encryption-functions.html#encryption-threshold-variables","title":"Encryption threshold variables","text":"<p>The maximum key length limits are defined by OpenSSL. Server administrators can limit the maximum key length using the encryption threshold variables.</p> <p>The variables are automatically registered when component_encryption_udf is installed.</p> Variable Name encryption_udf.dh_bits_threshold"},{"location":"encryption-functions.html#encryption_udfdh_bits_threshold","title":"<code>encryption_udf.dh_bits_threshold</code>","text":"<p>The variable sets the maximum limit for the create_dh_parameters user-defined function and takes precedence over the OpenSSL maximum length value.</p> Option Description command-line Yes scope Global data type unsigned integer default 10000 <p>The range for this variable is from 1024 to 10,000. The default value is 10,000.</p>"},{"location":"encryption-functions.html#encryption_udfdsa_bits_threshold","title":"encryption_udf.dsa_bits_threshold","text":"<p>The variable sets the threshold limits for create_asymmetric_priv_key user-defined function when the function is invoked with the DSA parameter and takes precedence over the OpenSSL maximum length value.</p> Option Description command-line Yes scope Global data type unsigned integer default 9984 <p>The range for this variable is from 1,024 to 9,984. The default value is 9,984.</p>"},{"location":"encryption-functions.html#encryption_udfrsa_bits_threshold","title":"encryption_udf.rsa_bits_threshold","text":"<p>The variable sets the threshold limits for the create_asymmetric_priv_key user-defined function when the function is invoked with the RSA parameter and takes precedence over the OpenSSL maximum length value.</p> Option Description command-line Yes scope Global data type unsigned integer default 16384 <p>The range for this variable is from 1,024 to 16,384. The default value is 16,384.</p>"},{"location":"encryption-functions.html#examples","title":"Examples","text":"<p>Code examples for the following operations:</p> <ul> <li> <p>set the threshold variables</p> </li> <li> <p>create a private key</p> </li> <li> <p>create a public key</p> </li> <li> <p>encrypt data</p> </li> <li> <p>decrypt data</p> </li> </ul> <pre><code>-- Set Global variable\nmysql&gt; SET GLOBAL encryption_udf.dh_bits_threshold = 4096;\n\n-- Set Global variable\nmysql&gt; SET GLOBAL encryption_udf.rsa_bits_threshold = 4096;\n</code></pre> <pre><code>-- Create private key\nmysql&gt; SET @private_key = create_asymmetric_priv_key('RSA', 3072);\n\n-- Create public key\nmysql&gt; SET @public_key = create_asymmetric_pub_key('RSA', @private_key);\n\n-- Encrypt data using the private key (you can also use the public key)\nmysql&gt; SET @ciphertext = asymmetric_encrypt('RSA', 'This text is secret', @private_key);\n\n-- Decrypt data using the public key (you can also use the private key)\n-- The decrypted value @plaintext should be identical to the original 'This text is secret'\nmysql&gt; SET @plaintext = asymmetric_decrypt('RSA', @ciphertext, @public_key);\n</code></pre> <p>Code examples for the following operations:</p> <ul> <li> <p>generate a digest string</p> </li> <li> <p>generate a digest signature</p> </li> <li> <p>verify the signature against the digest</p> </li> </ul> <pre><code>-- Generate a digest string\nmysql&gt; SET @digest = create_digest('SHA256', 'This is the text for digest');\n\n-- Generate a digest signature\nmysql&gt; SET @signature = asymmetric_sign('RSA', @digest, @private_key, 'SHA256');\n\n-- Verify the signature against the digest\n-- The @verify_signature must be equal to 1\nmysql&gt; SET @verify_signature = asymmetric_verify('RSA', @digest, @signature, @public_key, 'SHA256');\n</code></pre> <p>Code examples for the following operations:</p> <ul> <li> <p>generate a DH parameter</p> </li> <li> <p>generates two DH key pairs</p> </li> <li> <p>generate a symmetric key using the public_1 and the private_2</p> </li> <li> <p>generate a symmetric key using the public_2 and the private_1</p> </li> </ul> <pre><code> -- Generate a DH parameter\n mysql&gt; SET @dh_parameter = create_dh_parameters(3072);\n\n -- Generate DH key pairs\n mysql&gt; SET @private_1 = create_asymmetric_priv_key('DH', @dh_parameter);\n mysql&gt; SET @public_1 = create_asymmetric_pub_key('DH', @private_1);\n mysql&gt; SET @private_2 = create_asymmetric_priv_key('DH', @dh_parameter);\n mysql&gt; SET @public_2 = create_asymmetric_pub_key('DH', @private_2);\n\n-- Generate a symmetric key using the public_1 and private_2\n-- The @symmetric_1 must be identical to @symmetric_2\nmysql&gt; SET symmetric_1 = asymmetric_derive(@public_1, @private_2);\n\n-- Generate a symmetric key using the public_2 and private_1\n-- The @symmetric_2 must be identical to @symmetric_1\nmysql&gt; SET symmetric_2 = asymmetric_derive(@public_2, @private_1);\n</code></pre> <p>Code examples for the following operations:</p> <ul> <li> <p>create a private key using a <code>SET</code> statement</p> </li> <li> <p>create a private key using a  <code>SELECT</code> statement</p> </li> <li> <p>create a private key using an <code>INSERT</code> statement</p> </li> </ul> <pre><code>mysql&gt; SET @private_key1 = create_asymmetric_priv_key('RSA', 3072);\nmysql&gt; SELECT create_asymmetric_priv_key('RSA', 3072) INTO @private_key2;\nmysql&gt; INSERT INTO key_table VALUES(create_asymmetric_priv_key('RSA', 3072));\n</code></pre>"},{"location":"encryption-functions.html#uninstall-component_encryption_udf","title":"Uninstall component_encryption_udf","text":"<p>You can deactivate and uninstall the component using the Uninstall Component statement.</p> <pre><code>mysql&gt; UNINSTALL COMPONENT 'file://component_encryption_udf';\n</code></pre>"},{"location":"enforce-engine.html","title":"Enforcing storage engine","text":"<p>Percona Server for MySQL has implemented variable which can be used for enforcing the use of a specific storage engine.</p> <p>When this variable is specified and a user tries to create a table using an explicit storage engine that is not the specified enforced engine, the user will get either an error if the <code>NO_ENGINE_SUBSTITUTION</code> SQL mode is enabled or a warning if <code>NO_ENGINE_SUBSTITUTION</code> is disabled and the table will be created anyway using the enforced engine (this is consistent with the default MySQL way of creating the default storage engine if other engines are not available unless <code>NO_ENGINE_SUBSTITUTION</code> is set).</p> <p>In case user tries to enable enforce_storage_engine with engine that isn\u2019t available, system will not start.</p> <p>Note</p> <p>If you\u2019re using enforce_storage_engine, you must either disable it before doing <code>mysql_upgrade</code> or perform <code>mysql_upgrade</code> with server started with <code>--skip-grants-tables</code>.</p>"},{"location":"enforce-engine.html#version-specific-information","title":"Version specific information","text":"<ul> <li>Percona Server for MySQL 8.0.13-4: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"enforce-engine.html#system-variables","title":"System variables","text":""},{"location":"enforce-engine.html#enforce_storage_engine","title":"<code>enforce_storage_engine</code>","text":"Option Description Command Line: Yes Config file Yes Scope: Global Dynamic: No Data type String Default value NULL <p>This variable is not case sensitive.</p>"},{"location":"enforce-engine.html#example","title":"Example","text":"<p>Adding following option to my.cnf will start the server with InnoDB as enforced storage engine.</p> <pre><code>enforce_storage_engine=InnoDB\n</code></pre>"},{"location":"extended-mysqlbinlog.html","title":"Extended mysqlbinlog","text":"<p>Note</p> <p>In Percona Server 8.0.18, the <code>--compress</code> option was marked as deprecated and may be removed in a future version of Percona Server for MySQL.</p> <p>Percona Server for MySQL has implemented compression support for mysqlbinlog. This is similar to support that both <code>mysql</code> and <code>mysqldump</code> programs include (the <code>-C</code>, <code>--compress</code> options \u201cUse compression in server/client protocol\u201d). Using the compressed protocol helps reduce the bandwidth use and speed up transfers.</p> <p>Percona Server for MySQL has also implemented support for <code>SSL</code>. mysqlbinlog now accepts the <code>SSL</code> connection options as all the other client programs. This feature can be useful with <code>--read-from-remote-server</code> option. </p>"},{"location":"extended-mysqlbinlog.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7</li> </ul>"},{"location":"extended-mysqldump.html","title":"Extended mysqldump","text":""},{"location":"extended-mysqldump.html#backup-locks-support","title":"Backup locks support","text":"<p>When used together with the \u2013single-transaction option, the lock-for-backup option makes <code>mysqldump</code> issue <code>LOCK TABLES FOR BACKUP</code> before starting the dump operation to prevent unsafe statements that would normally result in an inconsistent backup.</p> <p>More information can be found on the Backup Locks feature documentation.</p>"},{"location":"extended-mysqldump.html#compressed-columns-support","title":"Compressed columns support","text":"<p>mysqldump supports the Compressed columns with dictionaries feature. More information about the relevant options can be found on the Compressed columns with dictionaries feature page.</p>"},{"location":"extended-mysqldump.html#taking-backup-by-descending-primary-key-order","title":"Taking backup by descending primary key order","text":"<p>\u2013order-by-primary-desc tells <code>mysqldump</code> to take the backup by descending primary key order (<code>PRIMARY KEY DESC</code>) which can be useful if the storage engine is using the reverse order column for a primary key.</p>"},{"location":"extended-mysqldump.html#rocksdb-support","title":"RocksDB support","text":"<p>mysqldump detects when MyRocks is installed and available. If there is a session variable named rocksdb_skip_fill_cache mysqldump sets it to 1.</p> <p>mysqldump will now automatically enable session the variable rocksdb_bulk_load if it is supported by the target server.</p>"},{"location":"extended-mysqldump.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7</li> </ul>"},{"location":"extended-select-into-outfile.html","title":"Extended SELECT INTO OUTFILE/DUMPFILE","text":"<p>Percona Server for MySQL has extended the <code>SELECT INTO ... OUTFILE</code> and <code>SELECT INTO DUMPFILE</code> commands to add support for UNIX sockets and named pipes. Before this was implemented the database would return an error for such files.</p> <p>This feature allows using <code>LOAD DATA LOCAL INFILE</code> in combination with <code>SELECT INTO OUTFILE</code> to quickly load multiple partitions across the network or in other setups, without having to use an intermediate file that wastes space and I/O.</p>"},{"location":"extended-select-into-outfile.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"extended-select-into-outfile.html#other-reading","title":"Other reading","text":"<ul> <li>MySQL bug: #44835</li> </ul>"},{"location":"extended-show-grants.html","title":"Extended SHOW GRANTS","text":"<p>In Oracle MySQL <code>SHOW GRANTS</code> displays only the privileges granted explicitly to the named account. Other privileges might be available to the account, but they are not displayed. For example, if an anonymous account exists, the named account might be able to use its privileges, but <code>SHOW GRANTS</code> will not display them. Percona Server for MySQL offers the <code>SHOW EFFECTIVE GRANTS</code> command to display all the effectively available privileges to the account, including those granted to a different account.</p>"},{"location":"extended-show-grants.html#example","title":"Example","text":"<p>If we create the following users:</p> <pre><code>mysql&gt; CREATE USER grantee@localhost IDENTIFIED BY 'grantee1';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.50 sec)\n</code></pre> <pre><code>mysql&gt; CREATE USER grantee IDENTIFIED BY 'grantee2';\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.09 sec)\n</code></pre> <pre><code>mysql&gt; CREATE DATABASE db2;\n</code></pre> Expected output <pre><code>Query OK, 1 row affected (0.20 sec)\n</code></pre> <pre><code>mysql&gt; GRANT ALL PRIVILEGES ON db2.* TO grantee WITH GRANT OPTION;\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (0.12 sec)\n</code></pre> <ul> <li><code>SHOW EFFECTIVE GRANTS</code> output before the change:</li> </ul> <pre><code>mysql&gt; SHOW EFFECTIVE GRANTS;\n</code></pre> Expected output <pre><code>+----------------------------------------------------------------------------------------------------------------+\n| Grants for grantee@localhost                                                                                   |\n+----------------------------------------------------------------------------------------------------------------+\n| GRANT USAGE ON *.* TO 'grantee'@'localhost' IDENTIFIED BY PASSWORD '*9823FF338D44DAF02422CF24DD1F879FB4F6B232' |\n+----------------------------------------------------------------------------------------------------------------+\n1 row in set (0.04 sec)\n</code></pre> <p>Although the grant for the <code>db2</code> database isn\u2019t shown, <code>grantee</code> user has enough privileges to create the table in that database:</p> <pre><code>user@trusty:~$ mysql -ugrantee -pgrantee1 -h localhost\n</code></pre> <pre><code>mysql&gt; CREATE TABLE db2.t1(a int);\n</code></pre> Expected output <pre><code>Query OK, 0 rows affected (1.21 sec)\n</code></pre> <ul> <li>The output of <code>SHOW EFFECTIVE GRANTS</code> after the change shows all the privileges for the <code>grantee</code> user:</li> </ul> <pre><code>mysql&gt; SHOW EFFECTIVE GRANTS;\n</code></pre> Expected output <pre><code>+-------------------------------------------------------------------+\n| Grants for grantee@localhost                                      |\n+-------------------------------------------------------------------+\n| GRANT USAGE ON *.* TO 'grantee'@'localhost' IDENTIFIED BY PASSWORD|\n| '*9823FF338D44DAF02422CF24DD1F879FB4F6B232'                       |\n| GRANT ALL PRIVILEGES ON `db2`.* TO 'grantee'@'%' WITH GRANT OPTION|\n+-------------------------------------------------------------------+\n2 rows in set (0.00 sec)\n</code></pre>"},{"location":"extended-show-grants.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"extended-show-grants.html#other-reading","title":"Other reading","text":"<ul> <li>#53645 - <code>SHOW GRANTS</code> not displaying all the applicable grants</li> </ul>"},{"location":"faq.html","title":"Frequently asked questions","text":""},{"location":"faq.html#q-will-percona-server-for-mysql-with-xtradb-invalidate-our-mysql-support","title":"Q: Will Percona Server for MySQL with XtraDB invalidate our MySQL support?","text":"<p>A: We don\u2019t know the details of your support contract. You should check with your Oracle representative. We have heard anecdotal stories from MySQL Support team members that they have customers who use Percona Server for MySQL with XtraDB, but you should not base your decision on that.</p>"},{"location":"faq.html#q-will-we-have-to-gpl-our-whole-application-if-we-use-percona-server-for-mysql-with-xtradb","title":"Q: Will we have to GPL our whole application if we use Percona Server for MySQL with XtraDB?","text":"<p>A: This is a common misconception about the GPL. We suggest reading the Free Software Foundation \u2018s excellent reference material on the GPL Version 2, which is the license that applies to MySQL and therefore to Percona Server for MySQL with XtraDB. That document contains links to many other documents which should answer your questions. Percona is unable to give legal advice about the GPL.</p>"},{"location":"faq.html#q-do-i-need-to-install-percona-client-libraries","title":"Q: Do I need to install Percona client libraries?","text":"<p>A: No, you don\u2019t need to change anything on the clients. Percona Server for MySQL is 100% compatible with all existing client libraries and connectors.</p>"},{"location":"faq.html#q-when-using-the-percona-xtrabackup-to-set-up-a-replication-replica-on-debian-based-systems-im-getting-error-1045-28000-access-denied-for-user-debian-sys-maintlocalhost-using-password-yes","title":"Q: When using the Percona XtraBackup to set up a replication replica on Debian-based systems I\u2019m getting: \u201cERROR 1045 (28000): Access denied for user \u2018debian-sys-maint\u2019@\u2019localhost\u2019 (using password: YES)\u201d","text":"<p>A: In case you\u2019re using the init script on Debian-based system to start <code>mysqld</code>, be sure that the password for <code>debian-sys-maint</code> user has been updated and it\u2019s the same as that user\u2019s password from the server that the backup has been taken from. The password can be seen and updated in <code>/etc/mysql/debian.cnf</code>. For more information on how to set up a replication replica using Percona XtraBackup see this how-to.</p>"},{"location":"fast-updates.html","title":"Fast updates with TokuDB","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p>"},{"location":"fast-updates.html#introduction","title":"Introduction","text":"<p>Update intensive applications can have their throughput limited by the random read capacity of the storage system. The cause of the throughput limit is the read-modify-write algorithm that MySQL uses to process update statements (read a row from the storage engine, apply the updates to it, write the new row back to the storage engine).</p> <p>To address this throughput limit, TokuDB provides an experimental fast update feature, which uses a different update algorithm. Update expressions of the SQL statement are encoded into tiny programs that are stored in an update Fractal Tree message. This update message is injected into the root of the Fractal Tree index. Eventually, these update  messages reach a leaf node, where the update programs are applied to the row. Since messages are moved between Fractal Tree levels in batches, the cost of reading in the leaf node is amortized over many update messages.</p> <p>This feature is available for <code>UPDATE</code> and <code>INSERT</code> statements, and can be turned ON/OFF separately for them with use of two variables. Variable tokudb_enable_fast_update variable toggles fast updates for the <code>UPDATE</code>, and  tokudb_enable_fast_upsert does the same  for <code>INSERT</code>.</p>"},{"location":"fast-updates.html#limitations","title":"Limitations","text":"<p>Fast updates are activated instead of normal MySQL read-modify-write updates if the executed expression meets the number of conditions.</p> <ul> <li> <p>fast updates can be activated for a statement or a mixed replication,</p> </li> <li> <p>a primary key must be defined for the involved table,</p> </li> <li> <p>both simple and compound primary keys are supported, and <code>int</code>, <code>char</code> or <code>varchar</code> are the allowed data types for them,</p> </li> <li> <p>updated fields should have <code>Integer</code> or <code>char</code> data type,</p> </li> <li> <p>fields that are part of any key should be not updated,</p> </li> <li> <p>clustering keys are not allowed,</p> </li> <li> <p>triggers should be not involved,</p> </li> <li> <p>supported update expressions should belong to one of the following types:</p> <ul> <li> <p><code>x = constant</code></p> </li> <li> <p><code>x = x + constant</code></p> </li> <li> <p><code>x = x - constant</code></p> </li> <li> <p><code>x = if (x=0,0,x-1)</code></p> </li> <li> <p><code>x = x + values</code></p> </li> </ul> </li> </ul>"},{"location":"fast-updates.html#usage-specifics-and-examples","title":"Usage specifics and examples","text":"<p>Following example creates a table that associates event identifiers with their count:</p> <pre><code>CREATE TABLE t (event_id bigint unsigned NOT NULL PRIMARY KEY, event_count bigint unsigned NOT NULL\n);\n</code></pre> <p>Many graph applications that map onto relational tables can use duplicate key inserts and updates to maintain the graph. For example, one can update the meta-data associated with a link in the graph using duplicate key insertions. If the affected rows is not used by the application, then the insertion or update can be marked and executed as a fast insertion or a fast update.</p>"},{"location":"fast-updates.html#insertion-example","title":"Insertion example","text":"<p>If it is not known if the event identifier (represented by event_id) already exists in the table, then <code>INSERT ... ON DUPLICATE KEY UPDATE ...</code> statement can insert it if not existing, or increment its event_count otherwise. Here is an example with duplicate key insertion statement, where <code>%id</code> is some specific event_id value:</p> <pre><code>INSERT INTO t VALUES (%id, 1)\n  ON DUPLICATE KEY UPDATE event_count=event_count+1;\n</code></pre>"},{"location":"fast-updates.html#explanation","title":"Explanation","text":"<p>If the event id\u2019s are random, then the throughput of this application would be limited by the random read capacity of the storage system since each <code>INSERT</code> statement has to determine if this event_id exists in the table.</p> <p>TokuDB replaces the primary key existence check with an insertion of an \u201cupsert\u201d message into the Fractal Tree index. This \u201cupsert\u201d message contains a copy of the row and a program that increments event_count. As the Fractal Tree buffer\u2019s get filled, this \u201cupsert\u201d message is flushed down the tree. Eventually, the message reaches a leaf node and gets executed there. If the key exists in the leaf node, then the event_count is incremented. Otherwise, the new row is inserted into the leaf node.</p>"},{"location":"fast-updates.html#update-example","title":"Update example","text":"<p>If event_id is known to exist in the table, then <code>UPDATE</code> statement can be used to increment its event_count (once again, specific event_id value is written here as <code>%id</code>):</p> <pre><code>UPDATE t SET event_count=event_count+1 WHERE event_id=%id;\n</code></pre>"},{"location":"fast-updates.html#explanation_1","title":"Explanation","text":"<p>TokuDB generates an \u201cupdate\u201d message from the <code>UPDATE</code> statement and its update expression trees, and inserts this message into the Fractal Tree index. When the message eventually reaches the leaf node, the increment program is extracted from the message and executed.</p>"},{"location":"feature-comparison.html","title":"Percona Server for MySQL feature comparison","text":"<p>Percona Server for MySQL is a free, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers higher value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups, and increased visibility.</p> <p>We provide these benefits by significantly enhancing Percona Server for MySQL as compared to the standard MySQL database server:</p> Features Percona Server for MySQL 8.0.30 MySQL 8.0.30 Open Source Yes Yes ACID Compliance Yes Yes Multi-Version Concurrency Control Yes Yes Row-Level Locking Yes Yes Automatic Crash Recovery Yes Yes Table Partitioning Yes Yes Views Yes Yes Subqueries Yes Yes Triggers Yes Yes Stored Procedures Yes Yes Foreign Keys Yes Yes Window Functions Yes Yes Common Table Expressions Yes Yes Geospatial Features (GIS, SRS) Yes Yes GTID Replication Yes Yes Group Replication Yes Yes MyRocks Storage Engine Yes No Improvements for Developers Percona Server for MySQL 8.0.30 MySQL 8.0.30 NoSQL Socket-Level Interface Yes Yes X API Support Yes Yes JSON Functions Yes Yes InnoDB Full-Text Search Improvements Yes No Extra Hash/Digest Functions Yes No Instrumentation and Troubleshooting Features Percona Server for MySQL 8.0.30 MySQL 8.0.30 INFORMATION_SCHEMA Tables 95 65 Global Performance and Status Counters 853 434 Optimizer Histograms Yes Yes Per-Table Performance Counters Yes No Per-Index Performance Counters Yes No Per-User Performance Counters Yes No Per-Client Performance Counters Yes No Per-Thread Performance Counters Yes No Global Query Response Time Statistics Yes No Enhanced SHOW INNODB ENGINE STATUS Yes No Undo Segment Information Yes No Temporary Tables Information Yes No Extended Slow Query Logging Yes No User Statistics Yes No Performance and Scalability Features Percona Server for MySQL 8.0.30 MySQL 8.0.30 InnoDB Resource Groups Yes Yes Configurable Page Sizes Yes Yes Contention-Aware Transaction Scheduling Yes Yes Improved Scalability By Splitting Mutexes Yes No Improved MEMORY Storage Engine Yes No Improved Flushing Yes No Parallel Doublewrite Buffer Yes Yes Configurable Fast Index Creation) Yes No Per-Column Compression for VARCHAR/BLOB and JSON Yes No Compressed Columns with Dictionaries Yes No Security Features Percona Server for MySQL 8.0.30 MySQL 8.0.30 SQL Roles Yes Yes SHA-2 Based Password Hashing Yes Yes Password Rotation Policy Yes Yes PAM Authentication Plugin Yes Enterprise-Only Audit Logging Plugin Yes Enterprise-Only Encryption Features Percona Server for MySQL 8.0.30 MySQL 8.0.30 Storing Keyring in a File Yes Yes Storing Keyring in Hashicorp Vault Yes Enterprise Only Encrypt InnoDB Data Yes Yes Encrypt InnoDB Logs Yes Yes Encrypt Built-In InnoDB Tablespaces (General, System, Undo, Temp) Yes Yes Encrypt Binary Logs Yes No Encrypt Temporary Files Yes No Enforce Encryption Yes No Operational Improvements Percona Server for MySQL 8.0.30 MySQL 8.0.30 Atomic DDL Yes Yes Transactional Data Dictionary Yes Yes Instant DDL Yes Yes SET PERSIST Yes Yes Invisible Indexes Yes Yes Threadpool Yes Enterprise-Only Backup Locks Yes No Extended SHOW GRANTS Yes No Improved Handling of Corrupted Tables Yes No Ability to Kill Idle Transactions Yes No Improvements to START TRANSACTION WITH CONSISTENT SNAPSHOT Yes No Features for Running Database as a Service (DBaaS) Percona Server for MySQL 8.0.30 MySQL 8.0.30 Enforce a Specific Storage Engine Yes Yes"},{"location":"fido-authentication-plugin.html","title":"FIDO authentication plugin","text":"<p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>Percona Server for MySQL 8.0.30-22 adds support for the Fast Identify Online (FIDO) authentication method that uses a plugin. The FIDO authentication provides a set of standards that reduces the reliance on passwords.</p> <p>The server-side fido authentication plugin enables authentication using external devices. If this plugin is the only authentication plugin used by the account, this plugin allows authentication without a password. Multi-factor authentication can use non-FIDO MySQL authentication methods, the FIDO authentication method, or a combination of both. </p> <p>All distributions include the client-side <code>authentication_fido_client</code> plugin. This plugin allows clients to connect to accounts that use <code>authentication_fido</code> and authenticate on a server that has that plugin loaded.</p>"},{"location":"fido-authentication-plugin.html#plugin-and-library-file-names","title":"Plugin and library file names","text":"<p>The plugin and library file names are listed in the following table. </p> Plugin or file name Plugin or library file name Server-side plugin <code>authentication_fido</code> Client-side plugin <code>authentication_fido_client</code> Library file authentication_fido.so"},{"location":"fido-authentication-plugin.html#install-the-fido-authentication-plugin","title":"Install the FIDO authentication plugin","text":"<p>The library file must be stored in the directory named by the <code>plugin_dir</code> variable. </p> At server startupEdit my.cnf and restart the serverLoad the plugin at runtime <p>At server startup, use the <code>--plugin_load_add</code> option with the library name. The option must be added each time the server starts.</p> <pre><code>[mysqld]\n...\nplugin-load-add=authentication_fido.so\n...\n</code></pre> <pre><code>mysql&gt; INSTALL PLUGIN authentication_fido SONAME `authentication_fido.so`;\n</code></pre>"},{"location":"fido-authentication-plugin.html#verify-installation","title":"Verify installation","text":"<p>Use the <code>SHOW PLUGINS</code> statement or query the <code>INFORMATION_SCHEMA.PLUGINS</code> table to verify that the plugin was loaded successfully and is active.</p> <p>Check the server error log if the plugin is not loaded.</p>"},{"location":"fido-authentication-plugin.html#use-fido-authentication","title":"Use FIDO authentication","text":"<p>FIDO can be used with non-FIDO authentication. See Use FIDO authentication with non-FIDO authentication. FIDO can be used to create 1FA accounts that do not require passwords. For instructions, see Use FIDO.</p>"},{"location":"fido-authentication-plugin.html#use-fido-authentication-with-non-fido-authentication","title":"Use FIDO authentication with non-FIDO authentication","text":"<p>A FIDO device is associated with the account using FIDO authentication. The FIDO device must be registered before the account can be used in a one-time process. This device must be available and the user must perform whatever FIDO device action required, such as adding a thumbprint, or the registration fails.</p> <p>The registration can only be performed by the user named by the account. An error occurs if a user attempts the registration for another user. </p> <p>The device registration can be performed on the mysql client or MySQL Shell.  Use the <code>--fido-register-factor</code> option with the factor or factors for the device. For example, if you are using FIDO as a second authentication method, which is a common practice, the statement is <code>--fido-register-factor=2</code>. </p> <p>Any authentication factors that proceed the FIDO registration must succeed before the registration continues.</p> <p>The server checks the user account information to determine if the FIDO device requires registration. If the device must be registered, the server switches the client session to sandbox mode. The registration must be completed before any other activity. In this mode, only <code>ALTER USER</code> statements are permitted. If the session is started with <code>--fido-register-factor</code>, the client generates the statements required to register. After the registration is complete, the session is switched out of sandbox mode and the client can proceed as normal.</p> <p>After the device is registered, the server updates the <code>mysql.user</code> system table for that account with the device registration status and stores the public key and credential ID.</p> <p>The user must use the same FIDO device during registration and authentication. If the device is reset or the user attempts to use a different device, the authentication fails. To use a different device, the registered device must be unregistered and you must complete the registration process again.</p>"},{"location":"fido-authentication-plugin.html#use-fido-authentication-as-the-only-method","title":"Use FIDO authentication as the only method","text":"<p>If FIDO is used as the only method of authentication, the method does not use a password. The authentication uses a method such as a biometric scan or a security key.</p> <p>The user creates an account with the <code>PASSWORDLESS_USER_ADMIN</code> privilege and the <code>CREATE USER</code> privilege. </p> <p>The first element of the <code>authentication_policy</code> value must be an asterisk(*). Do not start with the plugin name. For information about configuring the <code>authentication policy</code> value, see Configuring the Multifactor Authentication Policy.</p> <p>You must include the <code>INITIAL AUTHENTICATION IDENTIFIED BY</code> clause in the <code>CREATE USER</code> statement. The server does accept the statement without the clause but the account is unusable because the user cannot connect to the server to register the device. </p> <p>The <code>CREATE USER</code> syntax is the following:</p> <pre><code>mysql&gt; CREATE USER &lt;username&gt;@&lt;hostname&gt; IDENTIFIED WITH authentication_fido INITIAL AUTHENTICATION IDENTIFIED BY '&lt;password&gt;';\n</code></pre> <p>During registration, the user must authenticate with the password. After the device is registered, the server deletes the password and modifies the account to make FIDO the only authentication method. </p>"},{"location":"fido-authentication-plugin.html#unregister-a-fido-device","title":"Unregister a FIDO device","text":"<p>If the FIDO device is replaced or lost, the following actions occur:</p> Action required Who can perform the action Unregister the previous device The account owner or any user with the <code>CREATE USER</code> privilege can unregister the device Register the new device The user planning to use the device must register the new device <p>The statement to unregister a device is as follows:</p> <pre><code>mysql&gt; ALTER USER `username`@`hostname` {2|3} FACTOR UNREGISTER;\n</code></pre>"},{"location":"filter-audit-log-filter-files.html","title":"Filter the Audit Log Filter logs","text":"<p>The feature is in tech preview.</p> <p>The audit filter log filtering is based on rules. The filter rule definition has the ability to include or exclude events based on the following attributes:</p> <ul> <li>User account</li> <li>Audit event class</li> <li>Audit event subclass</li> <li>Audit event fields (for example, <code>COMMAND_CLASS</code> or <code>STATUS</code>)</li> </ul> <p>You can define multiple filters and assign any filter to multiple accounts. You can also create a default filter for specific user accounts. The filters are defined using function calls. After the filter is defined, the filter is stored in <code>mysql</code> system tables. </p>"},{"location":"filter-audit-log-filter-files.html#audit-log-filter-functions","title":"Audit Log Filter functions","text":"<p>The Audit Log filter functions require <code>AUDIT_ADMIN</code> or <code>SUPER</code> privilege. </p> <p>The following functions are used for rule-based filtering:</p> Function Description Example audit_log_filter_flush() Manually flush the filter tables <code>SELECT audit_log_filter_flush()</code> audit_log_filter_set_filter() Defines a filter <code>SELECT audit_log_filter_set_filter('log_connections','{ \"filter\":{}}'</code>\u2019) audit_log_filter_remove_filter() Removes a filter audit_log_filter_set_user() Assigns a filter to a specific user account audit_log_filter_remove_user() Removes the filters from a specific user account <p>Using a SQL interface, you can define, display, or modify audit log filters. The filters are stored in the <code>mysql</code> system database. </p> <p>A read-only variable, <code>audit_log_filter_id</code>, signals if a filter is assigned to a specific session.</p> <p>Filter definitions are <code>JSON</code> values.</p> <p>The function, <code>audit_log_filter_flush()</code>, forces reloading all filters and should only be invoked when modifying the audit tables. This function affects all users. Users in current sessions must either execute change-user or disconnect and reconnect.</p>"},{"location":"filter-audit-log-filter-files.html#constraints","title":"Constraints","text":"<p>The <code>audit_log_filter</code> plugin must be enabled and the audit tables must exist to use the audit log filter functions. The user account must have the required privileges. </p>"},{"location":"filter-audit-log-filter-files.html#using-the-audit-log-filter-functions","title":"Using the audit log filter functions","text":"<p>With a new connection, the audit log filter plugin finds the user account name in the filter assignments. If a filter has been assigned, the plugin uses that filter. If no filter has been assigned, but there is a default account filter, the plugin uses that filter. If there is no filter assigned, and there is no default account filter, then the plugin does not process any event.</p> <p>The default account is represented by <code>%</code> as the account name.</p> <p>You can assign filters to a specific user account or disassociate a user account from a filter. To disassociate a user account, either unassign a filter or assign a different filter. If you remove a filter, that filter is unassigned from all users, including current users in current sessions.</p>"},{"location":"gap-locks-detection.html","title":"Gap locks detection","text":"<p>The Gap locks detection is based on a Facebook MySQL patch.</p> <p>If a transactional storage engine does not support gap locks (for example MyRocks) and a gap lock is being attempted while the transaction isolation level is either <code>REPEATABLE READ</code> or <code>SERIALIZABLE</code>, the following SQL error will be returned to the client and no actual gap lock will be taken on the effected rows.</p> Error message <pre><code>ERROR HY000: Using Gap Lock without full unique key in multi-table or multi-statement transactions is not allowed. You need to either rewrite queries to use all unique key columns in WHERE equal conditions, or rewrite to single-table, single-statement transaction.\n</code></pre>"},{"location":"glossary.html","title":"Glossary","text":""},{"location":"glossary.html#acid","title":"ACID","text":"<p>Set of properties that guarantee database transactions are processed reliably. Stands for Atomicity, Consistency, Isolation, Durability.</p>"},{"location":"glossary.html#atomicity","title":"Atomicity","text":"<p>Atomicity means that database operations are applied following a \u201call or nothing\u201d rule. A transaction is either fully applied or not at all.</p>"},{"location":"glossary.html#consistency","title":"Consistency","text":"<p>Consistency means that each transaction that modifies the database takes it from one consistent state to another.</p>"},{"location":"glossary.html#durability","title":"Durability","text":"<p>Once a transaction is committed, it will remain so.</p>"},{"location":"glossary.html#foreign-key","title":"Foreign Key","text":"<p>A referential constraint between two tables. Example: A purchase order in the purchase_orders table must have been made by a customer that exists in the customers table.</p>"},{"location":"glossary.html#general-availability-ga","title":"General Availability (GA)","text":"<p>A finalized version of the product which is made available to the general public. It is the final stage in the software release cycle.</p>"},{"location":"glossary.html#isolation","title":"Isolation","text":"<p>The Isolation requirement means that no transaction can interfere with another.</p>"},{"location":"glossary.html#innodb","title":"InnoDB","text":"<p>A Storage Engine for MySQL and derivatives (Percona Server, MariaDB) originally written by Innobase Oy, since acquired by Oracle. It provides ACID compliant storage engine with foreign key support. As of MySQL version 5.5, InnoDB became the default storage engine on all platforms.</p>"},{"location":"glossary.html#jenkins","title":"Jenkins","text":"<p>Jenkins is a continuous integration system that we use to help ensure the continued quality of the software we produce. It helps us achieve the aims of:</p> <ul> <li> <p>no failed tests in the trunk on any platform</p> </li> <li> <p>aid developers in ensuring merge requests build and test on all platform</p> </li> <li> <p>no known performance regressions (without a damn good explanation).</p> </li> </ul>"},{"location":"glossary.html#lsn","title":"LSN","text":"<p>The Log Sequence Number (LSN) is an 8-byte number. Every data change adds an entry to the redo log and generates an LSN. The server increments the LSN with every change.</p>"},{"location":"glossary.html#mariadb","title":"MariaDB","text":"<p>A fork of MySQL that is maintained primarily by Monty Program AB. It aims to add features, and fix bugs while maintaining 100% backward compatibility with MySQL.</p>"},{"location":"glossary.html#mycnf","title":"my.cnf","text":"<p>The file name of the default MySQL configuration file.</p>"},{"location":"glossary.html#myisam","title":"MyISAM","text":"<p>A MySQL Storage Engine that was the default until MySQL 5.5.</p>"},{"location":"glossary.html#mysql","title":"MySQL","text":"<p>An open source database that has spawned several distributions and forks. MySQL AB was the primary maintainer and distributor until bought by Sun Microsystems, which was then acquired by Oracle. As Oracle owns the MySQL trademark, the term MySQL is often used for the Oracle distribution of MySQL as distinct from the drop-in replacements such as MariaDB and Percona Server for MySQL.</p>"},{"location":"glossary.html#numa","title":"NUMA","text":"<p>Non-Uniform Memory Access (NUMA) is a computer memory design used in multiprocessing, where the memory access time depends on the memory location relative to a processor. Under NUMA, a processor can access its own local memory faster than non-local memory, that is, memory local to another processor or memory shared between processors. The whole system may still operate as one unit, and all memory is basically accessible from everywhere but at a potentially higher latency and lower performance.</p>"},{"location":"glossary.html#percona-server-for-mysql","title":"Percona Server for MySQL","text":"<p>The Percona branch of MySQL with performance and management improvements.</p>"},{"location":"glossary.html#storage-engine","title":"Storage Engine","text":"<p>A storage engine is a piece of software that implements the details of data storage and retrieval for a database system. This term is primarily used within the MySQL ecosystem due to it being the first widely used relational database to have an abstraction layer around storage. It is analogous to a Virtual File System layer in an Operating System. A VFS layer allows an operating system to read and write multiple file systems (e.g. FAT, NTFS, XFS, ext3) and a Storage Engine layer allows a database server to access tables stored in different engines (for example, MyISAM or InnoDB).</p>"},{"location":"glossary.html#tech-preview","title":"Tech Preview","text":"<p>A tech preview item can be a feature, a variable, or a value within a variable. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment and also use an alternative backup method for redundancy. A tech preview item is included in a release for users to provide feedback. The item is either updated, released as general availability(GA), or removed if not useful. The functionality can change from tech preview to GA.</p>"},{"location":"glossary.html#xtradb","title":"XtraDB","text":"<p>The Percona improved version of InnoDB provides performance, features, and reliability above what is shipped by Oracle in InnoDB.</p>"},{"location":"group-replication-flow-control.html","title":"Manage group replication flow control","text":"<p>In replication, flow control prevents one member from falling too far behind the cluster and avoids excessive buffering. A cluster is not required to keep members in sync together for replication. The pending transactions in the relay log only increase for the lagging replica. Each member sends statistics to the group.</p> <p>Flow control sets a threshold on the queue for transactions waiting in the certification queue or the transactions waiting in the applier queue. If the thresholds are exceeded, and during the duration that they are exceeded, flow control adjusts the writer members to the capacity of the delayed member. This action ensures that all members are in sync.</p> <p>Flow controls work asynchronously and depend on the following:</p> <ul> <li>Monitoring the throughput and queue sizes of each member</li> <li>Throttling members to avoid writing beyond the capacity available</li> </ul> <p>The following system variables set flow control behavior for Group Replication:</p> <ul> <li>group_replication_flow_control_mode</li> <li>group_replication_flow_control_certifier_threshold</li> <li>group_replication_flow_control_applier_threshold</li> </ul> <p>Flow control is enabled and disabled by selecting a value in the group_replication_flow_control_mode variable. Flow control can also be enabled on the certifier or applier level or both and sets the threshold level.</p>"},{"location":"group-replication-system-variables.html","title":"Group replication system variables","text":"variable name <code>group_replication_auto_evict_timeout</code> <code>group_replication_certification_loop_chunk_size</code> <code>group_replication_certification_loop_sleep_time</code> <code>group_replication_flow_control_mode</code> <code>group_replication_xcom_ssl_accept_retries</code> <code>group_replication_xcom_ssl_socket_timeout</code>"},{"location":"group-replication-system-variables.html#group_replication_auto_evict_timeout","title":"group_replication_auto_evict_timeout","text":"<p>The variable is in tech preview mode. Before using the variable in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> Option Description Introduced 8.0.30-22 Command-line \u2013group-replication-auto-evict-timeout Dynamic Yes Scope Global Type Integer Default value 0 Maximum Value 65535 Unit seconds <p>The value can be changed while Group Replication is running. The change takes effect immediately. Every node in the group can have a different timeout value, but, to avoid unexpected exits, we recommend that all nodes have the same value.</p> <p>The variable specifies a period of time in seconds before a node is automatically evicted if the node exceeds the flow control threshold. The default value is 0, which disables the eviction. To set the timeout, change the value with a number higher than zero.</p> <p>In single-primary mode, the primary server ignores the timeout.</p>"},{"location":"group-replication-system-variables.html#group_replication_certification_loop_chunk_size","title":"group_replication_certification_loop_chunk_size","text":"Option Description Introduced 8.0.32-24 Command-line \u2013group-replication-certification-loop-chunk-size Dynamic Yes Scope Global Data type ulong Default value 0 <p>Defines the size of the chunk that must be processed during the certifier garbage collection phase after which the client transactions are allowed to interleave. The default value is 0.</p> <p>The minimum value is 0. The maximum value is 4294967295.</p>"},{"location":"group-replication-system-variables.html#group_replication_certification_loop_sleep_time","title":"group_replication_certification_loop_sleep_time","text":"Option Description Introduced 8.0.32-24 Command-line \u2013group-replication-certification-loop-sleep-time Dynamic Yes Scope Global Data type ulong Default value 0 <p>Defines the sleep time in microseconds that the certifier garbage collection loop allows client transactions to interleave. The default value is 0.</p> <p>The minimum value is 0. The maximum value is 1000000.</p>"},{"location":"group-replication-system-variables.html#group_replication_flow_control_mode","title":"group_replication_flow_control_mode","text":"Option Description Introduced 8.0.32-24 Command-line \u2013group_replication_flow_control_mode Dynamic Yes Scope Global Data type Enumeration Default value Quota Valid values DISABLED  QUOTA  MAJORITY <p>The \u201cMAJORITY\u201d value is in tech preview mode. Before using the variable in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>The variable specifies the mode use for flow control.</p> <p>Percona Server for MySQL 8.0.30-22 adds the \u201cMAJORITY\u201d value to the group_replication_flow_control_mode variable. In \u201cMAJORITY\u201d mode, flow control is activated only if the majority, more than half the number of members, exceed the flow control threshold. The other values are not changed.</p>"},{"location":"group-replication-system-variables.html#group_replication_xcom_ssl_accept_retries","title":"group_replication_xcom_ssl_accept_retries","text":"Option Description Introduced 8.0.34-26 Command-line \u2013group_replication_xcom_ssl_accept_retries Dynamic Yes Scope Global Data type integer Default value 10 <p>This variable is only effective on <code>START GROUP_REPLICATION</code>, and only when group replication is configured with SSL.</p> <p>Defines the number of retries before closing the socket. On each retry, the server thread calls SSL_accept(), with a timeout defined by <code>group_replication_xcom_ssl_socket_timeout</code>. Used by the SSL handshake process after the connection has been accepted by the first accept() call.</p> <p>The default value is 10.</p>"},{"location":"group-replication-system-variables.html#group_replication_xcom_ssl_socket_timeout","title":"group_replication_xcom_ssl_socket_timeout","text":"Option Description Introduced 8.0.34-26 Command-line \u2013group_replication_xcom_ssl_socket_timeout Dynamic Yes Scope Global Data type integer Default value 0 Measured in seconds <p>This variable is only effective on <code>START GROUP_REPLICATION</code>, and only when group replication is configured with SSL.</p> <p>Defines a file-descriptor level timeout, measured in seconds, for both accept() and SSL_accept() calls when group replication listens on the xcom port.</p> <p>When set to a valid value, for example, 5 then both accept() and SSL_accept() return after 5 seconds. </p> <p>The default value has been set to 0 (waits infinitely) for backward compatibility.</p>"},{"location":"improved-memory-engine.html","title":"Improved MEMORY storage engine","text":"<p>As of <code>MySQL</code> 5.5.15, a Fixed Row Format (<code>FRF</code>) is still being used in the <code>MEMORY</code> storage engine. The fixed row format imposes restrictions on the type of columns as it assigns in advance a limited amount of memory per row. This renders a <code>VARCHAR</code> field in a <code>CHAR</code> field in practice and makes it impossible to have a <code>TEXT</code> or <code>BLOB</code> field with that engine implementation.</p> <p>To overcome this limitation, the Improved MEMORY Storage Engine is introduced in this release for supporting true <code>VARCHAR</code>, <code>VARBINARY</code>, <code>TEXT</code>, and <code>BLOB</code> fields in the <code>MEMORY</code> tables.</p> <p>This implementation is based on the Dynamic Row Format (<code>DFR</code>) introduced by the mysql-heap-dynamic-rows patch.</p> <p><code>DFR</code> is used to store column values in a variable-length form, thus helping to decrease the memory footprint of those columns and making possible <code>BLOB</code> and <code>TEXT</code> fields and real <code>VARCHAR</code> and <code>VARBINARY</code>.</p> <p>Unlike the fixed implementation, each column value in <code>DRF</code> uses only as much space as required. Variable-length values can use up to 4 bytes to store the actual value length, and only the necessary number of blocks is used to store the value.</p> <p>Rows in <code>DFR</code> are represented internally by multiple memory blocks, which means that a single row can consist of multiple blocks organized into one set. Each row occupies at least one block, there can not be multiple rows within a single block. Block size can be configured when creating a table (see below).</p> <p>This <code>DFR</code> implementation has two caveats regarding ordering and indexes.</p>"},{"location":"improved-memory-engine.html#caveats","title":"Caveats","text":""},{"location":"improved-memory-engine.html#ordering-of-rows","title":"Ordering of rows","text":"<p>In the absence of <code>ORDER BY</code>, records may be returned in a different order than the previous <code>MEMORY</code> implementation.</p> <p>This is not a bug. Any application relying on a specific order without an <code>ORDER BY</code> clause may deliver unexpected results. A specific order without <code>ORDER BY</code> is a side effect of a storage engine and query optimizer implementation which may and will change between minor MySQL releases.</p>"},{"location":"improved-memory-engine.html#indexing","title":"Indexing","text":"<p>It is currently impossible to use indexes on <code>BLOB</code> columns due to some limitations of the Dynamic Row Format. Trying to create such an index will fail with the following error:</p> Expected output <pre><code>BLOB column '&lt;name&gt;' can't be used in key specification with the used table type.\n</code></pre>"},{"location":"improved-memory-engine.html#restrictions","title":"Restrictions","text":"<p>For performance reasons, a mixed solution is implemented: the fixed format is used at the beginning of the row, while the dynamic one is used for the rest of it.</p> <p>The size of the fixed-format portion of the record is chosen automatically on <code>CREATE TABLE</code> and cannot be changed later. This, in particular, means that no indexes can be created later with <code>CREATE INDEX</code> or <code>ALTER TABLE</code> when the dynamic row format is used.</p> <p>All values for columns used in indexes are stored in fixed format at the first block of the row, then the following columns are handled with <code>DRF</code>.</p> <p>This sets two restrictions to tables:</p> <pre><code>* the order of the fields and therefore,\n\n* the minimum size of the block used in the table.\n</code></pre>"},{"location":"improved-memory-engine.html#ordering-of-columns","title":"Ordering of columns","text":"<p>The columns used in fixed format must be defined before the dynamic ones in the <code>CREATE TABLE</code> statement. If this requirement is not met, the engine will not be able to add blocks to the set for these fields and they will be treated as fixed.</p>"},{"location":"improved-memory-engine.html#minimum-block-size","title":"Minimum block size","text":"<p>The block size has to be big enough to store all fixed-length information in the first block. If not, the <code>CREATE TABLE</code> or <code>ALTER TABLE</code> statements will fail (see below).</p>"},{"location":"improved-memory-engine.html#limitations","title":"Limitations","text":"<p>MyISAM tables are still used for query optimizer internal temporary tables where the <code>MEMORY</code> tables could be used now instead: for temporary tables containing large <code>VARCHAR\\</code>`s, ``BLOB<code>, and</code>TEXT` columns.</p>"},{"location":"improved-memory-engine.html#setting-row-format","title":"Setting row format","text":"<p>Taking the restrictions into account, the Improved MEMORY Storage Engine will choose <code>DRF</code> over <code>FRF</code> at the moment of creating the table according to following criteria:</p> <pre><code>* There is an implicit request of the user in the column types **OR**\n\n* There is an explicit request of the user **AND** the overhead incurred by `DFR` is beneficial.\n</code></pre>"},{"location":"improved-memory-engine.html#implicit-request","title":"Implicit request","text":"<p>The implicit request by the user is taken when there is at least one <code>BLOB</code> or <code>TEXT</code> column in the table definition. If there are none of these columns and no relevant option is given, the engine will choose <code>FRF</code>.</p> <p>For example, this will yield the use of the dynamic format:</p> <pre><code>mysql&gt; CREATE TABLE t1 (f1 VARCHAR(32), f2 TEXT, PRIMARY KEY (f1)) ENGINE=HEAP;\n</code></pre> <p>While this will not:</p> <pre><code>mysql&gt; CREATE TABLE t1 (f1 VARCHAR(16), f2 VARCHAR(16), PRIMARY KEY (f1)) ENGINE=HEAP;\n</code></pre>"},{"location":"improved-memory-engine.html#explicit-request","title":"Explicit request","text":"<p>The explicit request is set with one of the following options in the <code>CREATE TABLE</code> statement:</p> <pre><code>* `KEY_BLOCK_SIZE = &lt;value&gt;`\n\n* Requests the DFR with the specified block size (in bytes)\n</code></pre> <p>Despite its name, the <code>KEY_BLOCK_SIZE</code> option refers to a block size used to store data rather then indexes. The reason for this is that an existing <code>CREATE TABLE</code> option is reused to avoid introducing new ones.</p> <p>The Improved MEMORY Engine checks whether the specified block size is large enough to keep all key column values. If it is too small, table creation will abort with an error.</p> <p>After <code>DRF</code> is requested explicitly and there are no <code>BLOB</code> or <code>TEXT</code> columns in the table definition, the Improved MEMORY Engine will check if using the dynamic format provides any space saving benefits as compared to the fixed one:</p> <pre><code>* if the fixed row length is less than the dynamic block size (plus the dynamic row overhead - platform dependent) **OR**\n\n* there isn\u2019t any variable-length columns in the table or `VARCHAR` fields are declared with length 31 or less,\n</code></pre> <p>the engine will revert to the fixed format as it is more space efficient in such case. The row format being used by the engine can be checked using <code>SHOW TABLE STATUS</code>.</p>"},{"location":"improved-memory-engine.html#examples","title":"Examples","text":"<p>On a 32-bit platform:</p> <pre><code>mysql&gt; CREATE TABLE t1 (f1 VARCHAR(32), f2 VARCHAR(32), f3 VARCHAR(32), f4 VARCHAR(32), PRIMARY KEY (f1)) KEY_BLOCK_SIZE=124 ENGINE=HEAP;\n\nmysql&gt; SHOW TABLE STATUS LIKE 't1'; \n</code></pre> Expected output <pre><code>Name  Engine  Version    Rows Avg_row_length  Data_length     Max_data_length Index_length    Data_free       Auto_increment  Create_time     Update_time     Check_time      Collation       Checksum        Create_options  Comment\nt1    MEMORY  10         X    0       X       0       0       NULL    NULL    NULL    NULL    latin1_swedish_ci       NULL    row_format=DYNAMIC KEY_BLOCK_SIZE=124\n</code></pre> <p>On a 64-bit platform:</p> <p><pre><code>mysqlCREATE TABLE t1 (f1 VARCHAR(32), f2 VARCHAR(32), f3 VARCHAR(32), f4 VARCHAR(32), PRIMARY KEY (f1)) KEY_BLOCK_SIZE=124 ENGINE=HEAP;\n</code></pre> <pre><code>mysqlSHOW TABLE STATUS LIKE 't1';\n</code></pre></p> Expected output <pre><code>Name  Engine  Version    Rows Avg_row_length  Data_length     Max_data_length Index_length    Data_free       Auto_increment  Create_time     Update_time     Check_time      Collation       Checksum        Create_options  Comment\nt1    MEMORY  10         X    0       X       0       0       NULL    NULL    NULL    NULL    latin1_swedish_ci       NULL    KEY_BLOCK_SIZE=124\n</code></pre>"},{"location":"improved-memory-engine.html#implementation-details","title":"Implementation details","text":"<p>MySQL MEMORY tables keep data in arrays of fixed-size chunks. These chunks are organized into two groups of <code>HP_BLOCK</code> structures:</p> <ul> <li> <p><code>group1</code> contains indexes, with one <code>HP_BLOCK</code> per key (part of <code>HP_KEYDEF</code>),</p> </li> <li> <p><code>group2</code> contains record data, with a single <code>HP_BLOCK</code> for all records.</p> </li> </ul> <p>While columns used in indexes are usually small, other columns in the table may need to accommodate larger data. Typically, larger data is placed into <code>VARCHAR</code> or <code>BLOB</code> columns.</p> <p>The Improved MEMORY Engine implements the concept of dataspace, <code>HP_DATASPACE</code>, which incorporates the <code>HP_BLOCK</code> structures for the record data, adding more information for managing variable-sized records.</p> <p>Variable-size records are stored in multiple \u201cchunks\u201d, which means that a single record of data (a database \u201crow\u201d) can consist of multiple chunks organized into one \u201cset\u201d, contained in <code>HP_BLOCK</code> structures.</p> <p>In variable-size format, one record is represented as one or many chunks depending on the actual data, while in fixed-size mode, one record is always represented as one chunk. The index structures would always point to the first chunk in the chunkset.</p> <p>Variable-size records are necessary only in the presence of variable-size columns. The Improved Memory Engine will be looking for <code>BLOB</code> or <code>VARCHAR</code> columns with a declared length of 32 or more. If no such columns are found, the table will be switched to the fixed-size format. You should always put such columns at the end of the table definition in order to use the variable-size format.</p> <p>Whenever data is being inserted or updated in the table, the Improved Memory Engine will calculate how many chunks are necessary.</p> <p>For <code>INSERT</code> operations, the engine only allocates new chunksets in the recordspace. For <code>UPDATE</code> operations it will modify the length of the existing chunkset if necessary, unlinking unnecessary chunks at the end, or allocating and adding more if a larger length is needed.</p> <p>When writing data to chunks or copying data back to a record, fixed-size columns are copied in their full format, while <code>VARCHAR</code> and <code>BLOB</code> columns are copied based on their actual length, skipping any <code>NULL</code> values.</p> <p>When allocating a new chunkset of N chunks, the engine will try to allocate chunks one-by-one, linking them as they become allocated. For allocating a single chunk, it will attempt to reuse a deleted (freed) chunk. If no free chunks are available, it will try to allocate a new area inside a <code>HP_BLOCK</code>.</p> <p>When freeing chunks, the engine will place them at the front of a free list in the dataspace, each one containing a reference to the previously freed chunk.</p> <p>The allocation and contents of the actual chunks varies between fixed and variable-size modes:</p> <ul> <li> <p>Format of a fixed-size chunk:</p> <ul> <li> <p><code>uchar[]</code> * With <code>sizeof=chunk_dataspace_length</code>, but at least <code>sizeof(uchar\\*)</code> bytes. It keeps actual data or pointer to the next deleted chunk, where <code>chunk_dataspace_length</code> equals to full record length</p> </li> <li> <p><code>uchar</code> * Status field (1 means \u201cin use\u201d, 0 means \u201cdeleted\u201d)</p> </li> </ul> </li> <li> <p>Format of a variable-size chunk:</p> <ul> <li> <p><code>uchar[]</code> * With <code>sizeof=chunk_dataspace_length</code>, but at least <code>sizeof(uchar\\*)</code> bytes. It keeps actual data or pointer to the next deleted chunk, where <code>chunk_dataspace_length</code> is set according to table\u2019s <code>key_block_size</code></p> </li> <li> <p><code>uchar\\*</code> * Pointer to the next chunk in this chunkset, or NULL for the last chunk</p> </li> <li> <p><code>uchar</code> * Status field (1 means \u201cfirst\u201d, 0 means \u201cdeleted\u201d, 2 means \u201clinked\u201d)</p> </li> </ul> </li> </ul> <p>Total chunk length is always aligned to the next <code>sizeof(uchar\\*)</code>.</p> <p>See also</p> <p>Dynamic row format for MEMORY tables</p>"},{"location":"index-info-schema-tables.html","title":"Index of INFORMATION_SCHEMA tables","text":"<p>This is a list of the <code>INFORMATION_SCHEMA TABLES</code> that exist in Percona Server for MySQL with XtraDB. The entry for each table points to the page in the documentation where item is described.</p> <ul> <li> <p>INFORMATION_SCHEMA.CLIENT_STATISTICS</p> </li> <li> <p>INFORMATION_SCHEMA.GLOBAL_TEMPORARY_TABLES</p> </li> <li> <p>[INFORMATION_SCHEMA.INDEX_STATISTICS]</p> </li> <li> <p>PROCFS</p> </li> <li> <p>INFORMATION_SCHEMA.QUERY_RESPONSE_TIME</p> </li> <li> <p>INFORMATION_SCHEMA.TABLE_STATISTICS</p> </li> <li> <p>INFORMATION_SCHEMA.TEMPORARY_TABLES</p> </li> <li> <p>THREAD_STATISTICS</p> </li> <li> <p>INFORMATION_SCHEMA.USER_STATISTICS</p> </li> <li> <p>XTRADB_INTERNAL_HASH_TABLES</p> </li> <li> <p>XTRADB_READ_VIEW</p> </li> <li> <p>INFORMATION_SCHEMA.XTRADB_RSEG</p> </li> <li> <p>INFORMATION_SCHEMA.XTRADB_ZIP_DICT</p> </li> <li> <p>INFORMATION_SCHEMA.XTRADB_ZIP_DICT_COLS</p> </li> </ul>"},{"location":"information-schema-tables.html","title":"MyRocks Information Schema tables","text":"<p>When you install the MyRocks plugin for MySQL, the Information Schema is extended to include the following tables:</p>"},{"location":"information-schema-tables.html#rocksdb_global_info","title":"ROCKSDB_GLOBAL_INFO","text":""},{"location":"information-schema-tables.html#columns","title":"Columns","text":"Column Name Type TYPE varchar(513) NAME varchar(513) VALUE varchar(513)"},{"location":"information-schema-tables.html#rocksdb_cfstats","title":"ROCKSDB_CFSTATS","text":""},{"location":"information-schema-tables.html#columns_1","title":"Columns","text":"Column Name Type CF_NAME varchar(193) STAT_TYPE varchar(193) VALUE bigint(8)"},{"location":"information-schema-tables.html#rocksdb_trx","title":"ROCKSDB_TRX","text":"<p>This table stores mappings of RocksDB transaction identifiers to MySQL client identifiers to enable associating a RocksDB transaction with a MySQL client operation.</p>"},{"location":"information-schema-tables.html#columns_2","title":"Columns","text":"Column Name Type TRANSACTION_ID bigint(8) STATE varchar(193) NAME varchar(193) WRITE_COUNT bigint(8) LOCK_COUNT bigint(8) TIMEOUT_SEC int(4) WAITING_KEY varchar(513) WAITING_COLUMN_FAMILY_ID int(4) IS_REPLICATION int(4) SKIP_TRX_API int(4) READ_ONLY int(4) HAS_DEADLOCK_DETECTION int(4) NUM_ONGOING_BULKLOAD int(4) THREAD_ID int(8) QUERY varchar(193)"},{"location":"information-schema-tables.html#rocksdb_cf_options","title":"ROCKSDB_CF_OPTIONS","text":""},{"location":"information-schema-tables.html#columns_3","title":"Columns","text":"Column Name Type CF_NAME varchar(193) OPTION_TYPE varchar(193) VALUE varchar(193)"},{"location":"information-schema-tables.html#rocksdb_active_compaction_stats","title":"ROCKSDB_ACTIVE_COMPACTION_STATS","text":""},{"location":"information-schema-tables.html#columns_4","title":"Columns","text":"Column Name Type THREAD_ID bigint CF_NAME varchar(193) INPUT_FILES varchar(513) OUTPUT_FILES varchar(513) COMPACTION_REASON varchar(513)"},{"location":"information-schema-tables.html#rocksdb_compaction_history","title":"ROCKSDB_COMPACTION_HISTORY","text":""},{"location":"information-schema-tables.html#columns_5","title":"Columns","text":"Column Name Type THREAD_ID bigint CF_NAME varchar(513) INPUT_LEVEL integer OUTPUT_LEVEL integer INPUT_FILES varchar(513) OUTPUT_FILES varchar(513) COMPACTION_REASON varchar(513) START_TIMESTAMP bigint END_TIMESTAMP bigint"},{"location":"information-schema-tables.html#rocksdb_compaction_stats","title":"ROCKSDB_COMPACTION_STATS","text":""},{"location":"information-schema-tables.html#columns_6","title":"Columns","text":"Column Name Type CF_NAME varchar(193) LEVEL varchar(513) TYPE varchar(513) VALUE double"},{"location":"information-schema-tables.html#rocksdb_dbstats","title":"ROCKSDB_DBSTATS","text":""},{"location":"information-schema-tables.html#columns_7","title":"Columns","text":"Column Name Type STAT_TYPE varchar(193) VALUE bigint(8)"},{"location":"information-schema-tables.html#rocksdb_ddl","title":"ROCKSDB_DDL","text":""},{"location":"information-schema-tables.html#columns_8","title":"Columns","text":"Column Name Type TABLE_SCHEMA varchar(193) TABLE_NAME varchar(193) PARTITION_NAME varchar(193) INDEX_NAME varchar(193) COLUMN_FAMILY int(4) INDEX_NUMBER int(4) INDEX_TYPE smallint(2) KV_FORMAT_VERSION smallint(2) TTL_DURATION bigint(8) INDEX_FLAGS bigint(8) CF varchar(193) AUTO_INCREMENT bigint(8) unsigned"},{"location":"information-schema-tables.html#rocksdb_index_file_map","title":"ROCKSDB_INDEX_FILE_MAP","text":""},{"location":"information-schema-tables.html#columns_9","title":"Columns","text":"Column Name Type COLUMN_FAMILY int(4) INDEX_NUMBER int(4) SST_NAME varchar(193) NUM_ROWS bigint(8) DATA_SIZE bigint(8) ENTRY_DELETES bigint(8) ENTRY_SINGLEDELETES bigint(8) ENTRY_MERGES bigint(8) ENTRY_OTHERS bigint(8) DISTINCT_KEYS_PREFIX varchar(400)"},{"location":"information-schema-tables.html#rocksdb_live_files_metadata","title":"ROCKSDB_LIVE_FILES_METADATA","text":"Column Name Type CF_NAME varchar(193) LEVEL varchar(513) NAME varchar(513) DB_PATH varchar(513) FILE_NUMBER bigint FILE_TYPE varchar(193) SIZE bigint RELATIVE_FILENAME varchar(193) DIRECTORY varchar(513) TEMPERATURE varchar(193) FILE_CHECKSUM varchar(513) FILE_CHECKSUM_FUNC_NAME varchar(193) SMALLEST_SEQNO bigint LARGEST_SEQNO bigint SMALLEST_KEY varchar(513) LARGEST_KEY varchar(513) NUM_READS_SAMPLED bigint BEING_COMPACTED tinyint NUM_ENTRIES bigint NUM_DELETIONS bigint OLDEST_BLOB_FILE_NUMBER bigint OLDEST_ANCESTER_TIME bigint FILE_CREATION_TIME bigint"},{"location":"information-schema-tables.html#rocksdb_locks","title":"ROCKSDB_LOCKS","text":"<p>This table contains the set of locks granted to MyRocks transactions.</p>"},{"location":"information-schema-tables.html#columns_10","title":"Columns","text":"Column Name Type COLUMN_FAMILY_ID int(4) TRANSACTION_ID int(4) KEY varchar(513) MODE varchar(32)"},{"location":"information-schema-tables.html#rocksdb_perf_context","title":"ROCKSDB_PERF_CONTEXT","text":""},{"location":"information-schema-tables.html#columns_11","title":"Columns","text":"Column Name Type TABLE_SCHEMA varchar(193) TABLE_NAME varchar(193) PARTITION_NAME varchar(193) STAT_TYPE varchar(193) VALUE bigint(8)"},{"location":"information-schema-tables.html#rocksdb_perf_context_global","title":"ROCKSDB_PERF_CONTEXT_GLOBAL","text":""},{"location":"information-schema-tables.html#columns_12","title":"Columns","text":"Column Name Type STAT_TYPE varchar(193) VALUE bigint(8)"},{"location":"information-schema-tables.html#rocksdb_deadlock","title":"ROCKSDB_DEADLOCK","text":"<p>This table records information about deadlocks.</p>"},{"location":"information-schema-tables.html#columns_13","title":"Columns","text":"Column Name Type DEADLOCK_ID bigint(8) TRANSACTION_ID bigint(8) CF_NAME varchar(193) WAITING_KEY varchar(513) LOCK_TYPE varchar(193) INDEX_NAME varchar(193) TABLE_NAME varchar(193) ROLLED_BACK bigint(8)"},{"location":"innodb-corrupt-table-action.html","title":"Handle corrupted tables","text":"<p>When a server subsystem tries to access a corrupted table, the server may crash. If this outcome is not desirable when a corrupted table is encountered, set the new system innodb_corrupt_table_action variable to a value which allows the ongoing operation to continue without crashing the server.</p> <p>The server error log registers attempts to access corrupted table pages.</p>"},{"location":"innodb-corrupt-table-action.html#interacting-with-the-innodb_force_recovery-variable","title":"Interacting with the innodb_force_recovery variable","text":"<p>The innodb_corrupt_table_action variable may work in conjunction with the innodb_force_recovery variable which considerably reduces the effect of InnoDB subsystems running in the background.</p> <p>If the innodb_force_recovery option is &lt;4, corrupted pages are lost and the server may continue to run due to the innodb_corrupt_table_action variable having a non-default value.</p> <p>For more information about the innodb_force_recovery variable, see Forcing InnoDB Recovery from the MySQL Reference Manual.</p> <p>This feature adds a new system variable.</p>"},{"location":"innodb-corrupt-table-action.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"innodb-corrupt-table-action.html#system-variables","title":"System variables","text":""},{"location":"innodb-corrupt-table-action.html#innodb_corrupt_table_action","title":"<code>innodb_corrupt_table_action</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type ULONG Default assert Range assert, warn, salvage <ul> <li> <p>Enabling <code>innodb_file_per_table</code> and using the <code>assert</code> value creates an assertion failure which causes XtraDB to intentionally crash the server. This action is expected when detecting corrupted data in a single-table tablespace.</p> </li> <li> <p>Enabling <code>innodb_file_per_table</code> and using the <code>warn</code> value causes XtraDB to pass the table corruption as <code>corrupt table</code> instead of crashing the server. Detecting the file as corrupt also disables the file I/O for that data file, except for the deletion operation.</p> </li> <li> <p>Enabling <code>innodb_file_per_table</code> and using the <code>salvage</code> value causes XtraDB to allow read access to the corrupted tablespace but ignores any corrupted pages.</p> </li> </ul>"},{"location":"innodb-expanded-fast-index-creation.html","title":"Expanded fast index creation","text":"<p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>Percona has implemented several changes related to MySQL\u2019s fast index creation feature. Fast index creation was implemented in MySQL as a way to speed up the process of adding or dropping indexes on tables with many rows.</p> <p>This feature implements a session variable that enables extended fast index creation. Besides optimizing DDL directly, expand_fast_index_creation may also optimize index access for subsequent DML statements because using it results in much less fragmented indexes.</p>"},{"location":"innodb-expanded-fast-index-creation.html#the-mysqldump-command","title":"The mysqldump command","text":"<p>A new option, <code>--innodb-optimize-keys</code>, was implemented in mysqldump. It changes the way InnoDB tables are dumped, so that secondary and foreign keys are created after loading the data, thus taking advantage of fast index creation. More specifically:</p> <ul> <li> <p><code>KEY</code>, <code>UNIQUE KEY</code>, and <code>CONSTRAINT</code> clauses are omitted from <code>CREATE TABLE</code> statements corresponding to InnoDB tables.</p> </li> <li> <p>An additional <code>ALTER TABLE</code> is issued after dumping the data, in order to create the previously omitted keys.</p> </li> </ul>"},{"location":"innodb-expanded-fast-index-creation.html#alter-table","title":"<code>ALTER TABLE</code>","text":"<p>When <code>ALTER TABLE</code> requires a table copy, secondary keys are now dropped and recreated later, after copying the data. The following restrictions apply:</p> <ul> <li> <p>Only non-unique keys can be involved in this optimization.</p> </li> <li> <p>If the table contains foreign keys, or a foreign key is being added as a part of the current <code>ALTER TABLE</code> statement, the optimization is disabled for all keys.</p> </li> </ul>"},{"location":"innodb-expanded-fast-index-creation.html#optimize-table","title":"<code>OPTIMIZE TABLE</code>","text":"<p>Internally, <code>OPTIMIZE TABLE</code> is mapped to <code>ALTER TABLE ... ENGINE=innodb</code> for InnoDB tables. As a consequence, it now also benefits from fast index creation, with the same restrictions as for <code>ALTER TABLE</code>.</p>"},{"location":"innodb-expanded-fast-index-creation.html#caveats","title":"Caveats","text":"<p>InnoDB fast index creation uses temporary files in tmpdir for all indexes being created. So make sure you have enough tmpdir space when using expand_fast_index_creation. It is a session variable, so you can temporarily switch it off if you are short on tmpdir space and/or don\u2019t want this optimization to be used for a specific table.</p> <p>There\u2019s also a number of cases when this optimization is not applicable:</p> <ul> <li> <p><code>UNIQUE</code> indexes in <code>ALTER TABLE</code> are ignored to enforce uniqueness where necessary when copying the data to a temporary table;</p> </li> <li> <p><code>ALTER TABLE</code> and <code>OPTIMIZE TABLE</code> always process tables containing foreign keys as if expand_fast_index_creation is OFF to avoid dropping keys that are part of a FOREIGN KEY constraint;</p> </li> <li> <p>mysqldump \u2013innodb-optimize-keys ignores foreign keys because InnoDB requires a full table rebuild on foreign key changes. So adding them back with a separate <code>ALTER TABLE</code> after restoring the data from a dump would actually make the restore slower;</p> </li> <li> <p>mysqldump \u2013innodb-optimize-keys ignores indexes on <code>AUTO_INCREMENT</code> columns, because they must be indexed, so it is impossible to temporarily drop the corresponding index;</p> </li> <li> <p>mysqldump \u2013innodb-optimize-keys ignores the first UNIQUE index on non-nullable columns when the table has no <code>PRIMARY KEY</code> defined, because in this case InnoDB picks such an index as the clustered one.</p> </li> </ul>"},{"location":"innodb-expanded-fast-index-creation.html#system-variables","title":"System variables","text":""},{"location":"innodb-expanded-fast-index-creation.html#expand_fast_index_creation","title":"<code>expand_fast_index_creation</code>","text":"Option Description Command Line: Yes Config file No Scope: Local/Global Dynamic: Yes Data type Boolean Default value ON/OFF <p>See also</p> <p>Improved InnoDB fast index creation</p> <p>Thinking about running OPTIMIZE on your InnoDB Table? Stop! </p>"},{"location":"innodb-fragmentation-count.html","title":"InnoDB page fragmentation counters","text":"<p>InnoDB page fragmentation is caused by random insertion or deletion from a secondary index. This means that the physical ordering of the index pages on the disk is not same as the index ordering of the records on the pages. As a consequence this means that some pages take a lot more space and that queries which require a full table scan can take a long time to finish.</p> <p>To provide more information about the InnoDB page fragmentation  Percona Server for MySQL now provides the following counters as status variables: Innodb_scan_pages_contiguous, Innodb_scan_pages_disjointed, Innodb_scan_data_size, Innodb_scan_deleted_recs_size, and Innodb_scan_pages_total_seek_distance.</p>"},{"location":"innodb-fragmentation-count.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7</li> </ul>"},{"location":"innodb-fragmentation-count.html#status-variables","title":"Status variables","text":""},{"location":"innodb-fragmentation-count.html#innodb_scan_pages_contiguous","title":"<code>Innodb_scan_pages_contiguous</code>","text":"Option Description Scope Session Data type Numeric <p>This variable shows the number of contiguous page reads inside a query.</p>"},{"location":"innodb-fragmentation-count.html#innodb_scan_pages_disjointed","title":"<code>Innodb_scan_pages_disjointed</code>","text":"Option Description Scope Session Data type Numeric <p>This variable shows the number of disjointed page reads inside a query.</p>"},{"location":"innodb-fragmentation-count.html#innodb_scan_data_size","title":"<code>Innodb_scan_data_size</code>","text":"Option Description Scope Session Data type Numeric <p>This variable shows the size of data in all InnoDB pages read inside a query (in bytes) - calculated as the sum of <code>page_get_data_size(page)</code> for every page scanned.</p>"},{"location":"innodb-fragmentation-count.html#innodb_scan_deleted_recs_size","title":"<code>Innodb_scan_deleted_recs_size</code>","text":"Option Description Scope Session Data type Numeric <p>This variable shows the size of deleted records (marked as <code>deleted</code> in <code>page_delete_rec_list_end()</code>) in all InnoDB pages read inside a query (in bytes) - calculated as the sum of <code>page_header_get_field(page, PAGE_GARBAGE)</code> for every page scanned.</p>"},{"location":"innodb-fragmentation-count.html#innodb_scan_pages_total_seek_distance","title":"<code>Innodb_scan_pages_total_seek_distance</code>","text":"Option Description Scope Session Data type Numeric <p>This variable shows the total seek distance when moving between pages.</p>"},{"location":"innodb-fragmentation-count.html#related-reading","title":"Related reading","text":"<ul> <li> <p>InnoDB: look after fragmentation</p> </li> <li> <p>Defragmenting a Table</p> </li> </ul>"},{"location":"innodb-fts-improvements.html","title":"InnoDB full-text search improvements","text":""},{"location":"innodb-fts-improvements.html#ignoring-stopword-list","title":"Ignoring stopword list","text":"<p>By default, all Full-Text Search indexes check the stopwords list, to see if any indexed elements contain words on that list.</p> <p>Using this list for n-gram indexes isn\u2019t always suitable, for example, any item that contains <code>a</code> or <code>i</code> will be ignored. Another word that can\u2019t be searched is <code>east</code>, this one will find no matches because <code>a</code> is on the FTS stopword list.</p> <p>To resolve this issue, Percona Server for MySQL has the <code>innodb_ft_ignore_stopwords</code> variable to control whether InnoDB Full-Text Search should ignore the stopword list.</p> <p>Although this variable is introduced to resolve n-gram issues, it affects all Full-Text Search indexes as well.</p> <p>Being a stopword doesn\u2019t just mean being one of the predefined words from the list. Tokens shorter than innodb_ft_min_token_size or longer than innodb_ft_max_token_size are also considered stopwords. Therefore, when innodb_ft_ignore_stopwords is set to <code>ON</code> even for non-ngram FTS, <code>innodb_ft_min_token_size</code> / <code>innodb_ft_max_token_size</code> will be ignored meaning that in this case very short and very long words will also be indexed.</p>"},{"location":"innodb-fts-improvements.html#system-variables","title":"System variables","text":""},{"location":"innodb-fts-improvements.html#innodb_ft_ignore_stopwords","title":"<code>innodb_ft_ignore_stopwords</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default OFF <p>When enabled, this variable will instruct InnoDB Full Text Search parser to ignore the stopword list when building/updating an FTS index.</p>"},{"location":"innodb-io.html","title":"Improved InnoDB I/O scalability","text":"<p>Because InnoDB is a complex storage engine it must be configured properly in order to perform at its best. Some points are not configurable in standard InnoDB. The goal of this feature is to provide a more exhaustive set of options for XtraDB.</p>"},{"location":"innodb-io.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul> <p>Note</p> <p>Implemented in Percona Server for MySQL 8.0.13-4, <code>max checkpoint age</code> has been removed because the information is identical to <code>log capacity</code>.</p>"},{"location":"innodb-io.html#system-variables","title":"System variables","text":""},{"location":"innodb-io.html#innodb_flush_method","title":"<code>innodb_flush_method</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Enumeration Default NULL Allowed values fsync, O_DSYNC, O_DIRECT, O_DIRECT_NO_FSYNC, littlesync, nosync <p>The following values are allowed:</p> <pre><code>* `fdatasync`: use `fsync()` to flush data, log, and parallel doublewrite files.\n\n* `O_SYNC`: use `O_SYNC` to open and flush the log and parallel doublewrite files; use `fsync()` to flush the data files. Do not use `fsync()` to flush the parallel doublewrite file.\n\n* `O_DIRECT`: use O_DIRECT to open the data files and `fsync()` system call to flush data, log, and parallel doublewrite files.\n\n* `O_DIRECT_NO_FSYNC`: use O_DIRECT to open the data files and parallel doublewrite files, but does not use the `fsync()` system call to flush the data files, log files, and parallel doublewrite files. Do not use this option for the *XFS* file system.\n</code></pre> <p>Note</p> <p>On an ext4 filesystem, set <code>innodb_log_write_ahead_size</code> to match the filesystem\u2019s write-ahead block size. This variable avoids <code>unaligned AIO/DIO</code> warnings.</p> <p>Starting from Percona Server for MySQL 8.0.20-11, the innodb_flush_method affects doublewrite buffers exactly the same as in MySQL 8.0.20.</p>"},{"location":"innodb-io.html#status-variables","title":"Status variables","text":"<p>The following information has been added to <code>SHOW ENGINE INNODB STATUS</code> to confirm the checkpointing activity:</p> <pre><code>The max checkpoint age\nThe current checkpoint age target\nThe current age of the oldest page modification which has not been flushed to disk yet.\nThe current age of the last checkpoint\n...\n---\nLOG\n---\nLog sequence number 0 1059494372\nLog flushed up to   0 1059494372\nLast checkpoint at  0 1055251010\nMax checkpoint age  162361775\nCheckpoint age target 104630090\nModified age        4092465\nCheckpoint age      4243362\n0 pending log writes, 0 pending chkp writes\n...\n</code></pre>"},{"location":"innodb-show-status.html","title":"Extended show engine InnoDB status","text":"<p>This feature reorganizes the output of <code>SHOW ENGINE INNODB STATUS</code> to improve readability and to provide additional information. The variable innodb_show_locks_held controls the umber of locks held to print for each InnoDB transaction.</p> <p>This feature modified the <code>SHOW ENGINE INNODB STATUS</code> command as follows:</p> <ul> <li> <p>Added extended information about InnoDB internal hash table sizes (in bytes) in the <code>BUFFER POOL AND MEMORY</code> section; also added buffer pool size in bytes.</p> </li> <li> <p>Added additional LOG section information.</p> </li> </ul>"},{"location":"innodb-show-status.html#other-information","title":"Other information","text":"<ul> <li>Author / Origin: Baron Schwartz, https://lists.mysql.com/internals/35174</li> </ul>"},{"location":"innodb-show-status.html#system-variables","title":"System variables","text":""},{"location":"innodb-show-status.html#innodb_show_locks_held","title":"<code>innodb_show_locks_held</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type ULONG Default 10 Range 0 - 1000 <p>Specifies the number of locks held to print for each InnoDB transaction in <code>SHOW ENGINE INNODB STATUS</code>.</p>"},{"location":"innodb-show-status.html#innodb_print_lock_wait_timeout_info","title":"<code>innodb_print_lock_wait_timeout_info</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Boolean Default OFF <p>Makes InnoDB to write information about all lock wait timeout errors into the log file.</p> <p>This allows to find out details about the failed transaction, and, most importantly, the blocking transaction. Query string can be obtained from EVENTS_STATEMENTS_CURRENT table, based on the <code>PROCESSLIST_ID</code> field, which corresponds to <code>thread_id</code> from the log output.</p> <p>Taking into account that blocking transaction is often a multiple statement one, following query can be used to obtain blocking thread statements history:</p> <pre><code>SELECT s.SQL_TEXT FROM performance_schema.events_statements_history s\nINNER JOIN performance_schema.threads t ON t.THREAD_ID = s.THREAD_ID\nWHERE t.PROCESSLIST_ID = %d\nUNION\nSELECT s.SQL_TEXT FROM performance_schema.events_statements_current s\nINNER JOIN performance_schema.threads t ON t.THREAD_ID = s.THREAD_ID\nWHERE t.PROCESSLIST_ID = %d;\n</code></pre> <p>The <code>PROCESSLIST_ID</code> in this example is exactly the thread id from error log output.</p>"},{"location":"innodb-show-status.html#status-variables","title":"Status variables","text":"<p>The status variables here contain information available in the output of <code>SHOW ENGINE INNODB STATUS</code>, organized by the sections <code>SHOW ENGINE INNODB STATUS</code> displays. If you are familiar with the output of <code>SHOW ENGINE INNODB STATUS</code>, you will probably already recognize the information these variables contain.</p>"},{"location":"innodb-show-status.html#background-thread","title":"BACKGROUND THREAD","text":"<p>The following variables contain information in the <code>BACKGROUND THREAD</code> section of the output from <code>SHOW ENGINE INNODB STATUS</code>. </p> Expected output <pre><code>-----------------\nBACKGROUND THREAD\n-----------------\nsrv_master_thread loops: 1 srv_active, 0 srv_shutdown, 11844 srv_idle\nsrv_master_thread log flush and writes: 11844\n</code></pre> <p>InnoDB has a source thread which performs background tasks depending on the server state, once per second. If the server is under workload, the source thread runs the following: performs background table drops; performs change buffer merge, adaptively; flushes the redo log to disk; evicts tables from the dictionary cache if needed to satisfy its size limit; makes a checkpoint. If the server is idle: performs background table drops, flushes and/or checkpoints the redo log if needed due to the checkpoint age; performs change buffer merge at full I/O capacity; evicts tables from the dictionary cache if needed; and makes a checkpoint.</p>"},{"location":"innodb-show-status.html#innodb_master_thread_active_loops","title":"<code>Innodb_master_thread_active_loops</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the number of times the above one-second loop was executed for active server states.</p>"},{"location":"innodb-show-status.html#innodb_master_thread_idle_loops","title":"<code>Innodb_master_thread_idle_loops</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the number of times the above one-second loop was executed for idle server states.</p>"},{"location":"innodb-show-status.html#innodb_background_log_sync","title":"<code>Innodb_background_log_sync</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the number of times the InnoDB source thread has written and flushed the redo log.</p>"},{"location":"innodb-show-status.html#semaphores","title":"SEMAPHORES","text":"<p>The following variables contain information in the <code>SEMAPHORES</code> section of the output from <code>SHOW ENGINE INNODB STATUS</code>. An example of that output is:</p> Expected output <pre><code>----------\nSEMAPHORES\n----------\nOS WAIT ARRAY INFO: reservation count 9664, signal count 11182\nMutex spin waits 20599, rounds 223821, OS waits 4479\nRW-shared spins 5155, OS waits 1678; RW-excl spins 5632, OS waits 2592\nSpin rounds per wait: 10.87 mutex, 15.01 RW-shared, 27.19 RW-excl\n</code></pre>"},{"location":"innodb-show-status.html#insert-buffer-and-adaptive-hash-index","title":"INSERT BUFFER AND ADAPTIVE HASH INDEX","text":"<p>The following variables contain information in the <code>INSERT BUFFER AND ADAPTIVE HASH INDEX</code> section of the output from <code>SHOW ENGINE INNODB STATUS</code>. An example of that output is:</p> Expected output <pre><code>-------------------------------------\nINSERT BUFFER AND ADAPTIVE HASH INDEX\n-------------------------------------\nIbuf: size 1, free list len 6089, seg size 6091,\n44497 inserts, 44497 merged recs, 8734 merges\n0.00 hash searches/s, 0.00 non-hash searches/s\n</code></pre>"},{"location":"innodb-show-status.html#innodb_ibuf_free_list","title":"<code>Innodb_ibuf_free_list</code>","text":"Option Description Scope Global Data type Numeric"},{"location":"innodb-show-status.html#innodb_ibuf_segment_size","title":"<code>Innodb_ibuf_segment_size</code>","text":"Option Description Scope Global Data type Numeric"},{"location":"innodb-show-status.html#log","title":"LOG","text":"<p>The following variables contain information in the <code>LOG</code> section of the output from <code>SHOW ENGINE INNODB STATUS</code>. An example of that output is:</p> Expected output <pre><code>LOG\n---\nLog sequence number 10145937666\nLog flushed up to   10145937666\nPages flushed up to 10145937666\nLast checkpoint at  10145937666\nMax checkpoint age    80826164\nCheckpoint age target 78300347\nModified age          0\nCheckpoint age        0\n0 pending log writes, 0 pending chkp writes\n9 log i/o's done, 0.00 log i/o's/second\nLog tracking enabled\nLog tracked up to   10145937666\nMax tracked LSN age 80826164\n</code></pre>"},{"location":"innodb-show-status.html#innodb_lsn_current","title":"<code>Innodb_lsn_current</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the current log sequence number.</p>"},{"location":"innodb-show-status.html#innodb_lsn_flushed","title":"<code>Innodb_lsn_flushed</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the current maximum LSN that has been written and flushed to disk.</p>"},{"location":"innodb-show-status.html#innodb_lsn_last_checkpoint","title":"<code>Innodb_lsn_last_checkpoint</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the LSN of the latest completed checkpoint.</p>"},{"location":"innodb-show-status.html#innodb_checkpoint_age","title":"<code>Innodb_checkpoint_age</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the current InnoDB checkpoint age, i.e., the difference between the current LSN and the LSN of the last completed checkpoint.</p>"},{"location":"innodb-show-status.html#innodb_checkpoint_max_age","title":"<code>Innodb_checkpoint_max_age</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the maximum allowed checkpoint age above which the redo log is close to full and a checkpoint must happen before any further redo log writes.</p> <p>Note</p> <p>This variable was removed in Percona Server for MySQL 8.0.13-4 due to a change in MySQL. The variable is identical to log capacity.</p>"},{"location":"innodb-show-status.html#buffer-pool-and-memory","title":"BUFFER POOL AND MEMORY","text":"<p>The following variables contain information in the <code>BUFFER POOL AND MEMORY</code> section of the output from <code>SHOW ENGINE INNODB STATUS</code>. An example of that output is:</p> Expected output <pre><code>----------------------\nBUFFER POOL AND MEMORY\n----------------------\nTotal memory allocated 137363456; in additional pool allocated 0\nTotal memory allocated by read views 88\nInternal hash tables (constant factor + variable factor)\n    Adaptive hash index 2266736         (2213368 + 53368)\n    Page hash           139112 (buffer pool 0 only)\n    Dictionary cache    729463  (554768 + 174695)\n    File system         824800  (812272 + 12528)\n    Lock system         333248  (332872 + 376)\n    Recovery system     0       (0 + 0)\nDictionary memory allocated 174695\nBuffer pool size        8191\nBuffer pool size, bytes 134201344\nFree buffers            7481\nDatabase pages          707\nOld database pages      280\nModified db pages       0\nPending reads 0\nPending writes: LRU 0, flush list 0 single page 0\nPages made young 0, not young 0\n0.00 youngs/s, 0.00 non-youngs/s\nPages read 707, created 0, written 1\n0.00 reads/s, 0.00 creates/s, 0.00 writes/s\nNo buffer pool page gets since the last printout\nPages read ahead 0.00/s, evicted without access 0.00/s, Random read ahead 0.00/s\nLRU len: 707, unzip_LRU len: 0\n</code></pre>"},{"location":"innodb-show-status.html#innodb_mem_adaptive_hash","title":"<code>Innodb_mem_adaptive_hash</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the current size, in bytes, of the adaptive hash index.</p>"},{"location":"innodb-show-status.html#innodb_mem_dictionary","title":"<code>Innodb_mem_dictionary</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the current size, in bytes, of the InnoDB in-memory data dictionary info.</p>"},{"location":"innodb-show-status.html#innodb_mem_total","title":"<code>Innodb_mem_total</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the total amount of memory, in bytes, InnoDB has allocated in the process heap memory.</p>"},{"location":"innodb-show-status.html#innodb_buffer_pool_pages_lru_flushed","title":"<code>Innodb_buffer_pool_pages_LRU_flushed</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the total number of buffer pool pages which have been flushed from the LRU list, i.e., too old pages which had to be flushed in order to make buffer pool room to read in new data pages.</p>"},{"location":"innodb-show-status.html#innodb_buffer_pool_pages_made_not_young","title":"<code>Innodb_buffer_pool_pages_made_not_young</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the number of times a buffer pool page was not marked as accessed recently in the LRU list because of innodb_old_blocks_time variable setting.</p>"},{"location":"innodb-show-status.html#innodb_buffer_pool_pages_made_young","title":"<code>Innodb_buffer_pool_pages_made_young</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the number of times a buffer pool page was moved to the young end of the LRU list due to its access, to prevent its eviction from the buffer pool.</p>"},{"location":"innodb-show-status.html#innodb_buffer_pool_pages_old","title":"<code>Innodb_buffer_pool_pages_old</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the total number of buffer pool pages which are considered to be old according to the Making the Buffer Pool Scan Resistant manual page.</p>"},{"location":"innodb-show-status.html#transactions","title":"TRANSACTIONS","text":"<p>The following variables contain information in the <code>TRANSACTIONS</code> section of the output from <code>SHOW INNODB STATUS</code>. An example of that output is:</p> Expected output <pre><code>------------\nTRANSACTIONS\n------------\nTrx id counter F561FD\nPurge done for trx's n:o &lt; F561EB undo n:o &lt; 0\nHistory list length 19\nLIST OF TRANSACTIONS FOR EACH SESSION:\n---TRANSACTION 0, not started, process no 993, OS thread id 140213152634640\nmysql thread id 15933, query id 32109 localhost root\nshow innodb status\n---TRANSACTION F561FC, ACTIVE 29 sec, process no 993, OS thread id 140213152769808 updating or deleting\nmysql tables in use 1, locked 1\n</code></pre>"},{"location":"innodb-show-status.html#innodb_max_trx_id","title":"<code>Innodb_max_trx_id</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the next free transaction id number.</p>"},{"location":"innodb-show-status.html#innodb_oldest_view_low_limit_trx_id","title":"<code>Innodb_oldest_view_low_limit_trx_id</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the highest transaction id, above which the current oldest open read view does not see any transaction changes. Zero if there is no open view.</p>"},{"location":"innodb-show-status.html#innodb_purge_trx_id","title":"<code>Innodb_purge_trx_id</code>","text":"Option Description Scope Global Data type Numeric <p>This variable shows the oldest transaction id whose records have not been purged yet.</p>"},{"location":"innodb-show-status.html#innodb_purge_undo_no","title":"<code>Innodb_purge_undo_no</code>","text":"Option Description Scope Global Data type Numeric"},{"location":"innodb-show-status.html#information_schema-tables","title":"INFORMATION_SCHEMA Tables","text":"<p>The following table contains information about the oldest active transaction in the system.</p>"},{"location":"innodb-show-status.html#information_schemaxtradb_read_view","title":"<code>INFORMATION_SCHEMA.XTRADB_READ_VIEW</code>","text":"Column Name Description \u2018READ_VIEW_LOW_LIMIT_TRX_NUMBER\u2019 This is the highest transactions number at the time the view was created. \u2018READ_VIEW_UPPER_LIMIT_TRX_ID\u2019 This is the highest transactions ID at the time the view was created. This means that it should not see newer transactions with IDs bigger than or equal to that value. \u2018READ_VIEW_LOW_LIMIT_TRX_ID\u2019 This is the latest committed transaction ID at the time the oldest view was created. This means that it should see all transactions with IDs smaller than or equal to that value. <p>Note</p> <p>Starting with Percona Server for MySQL 8.0.20-11, in <code>INFORMATION_SCHEMA.XTRADB_READ_VIEW</code>, the data type for the following columns is changed from <code>VARCHAR(18)</code> to <code>BIGINT UNSIGNED</code>:</p> <ul> <li> <p><code>READ_VIEW_LOW_LIMIT_TRX_NUMBER</code></p> </li> <li> <p><code>READ_VIEW_UPPER_LIMIT_TRX_ID</code></p> </li> <li> <p><code>READ_VIWE_LOW_LIMIT_TRX_ID</code></p> </li> </ul> <p>The columns contain 64-bit integers, which is too large for <code>VARCHAR(18)</code>.</p> <p>The following table contains information about the memory usage for InnoDB/XtraDB hash tables.</p>"},{"location":"innodb-show-status.html#information_schemaxtradb_internal_hash_tables","title":"<code>INFORMATION_SCHEMA.XTRADB_INTERNAL_HASH_TABLES</code>","text":"Column Name Description \u2018INTERNAL_HASH_TABLE_NAME\u2019 Hash table name \u2018TOTAL_MEMORY\u2019 Total amount of memory \u2018CONSTANT_MEMORY\u2019 Constant memory \u2018VARIABLE_MEMORY\u2019 Variable memory"},{"location":"innodb-show-status.html#other-reading","title":"Other reading","text":"<ul> <li> <p>SHOW INNODB STATUS walk through</p> </li> <li> <p>Table locks in SHOW INNODB STATUS</p> </li> </ul>"},{"location":"install-audit-log-filter.html","title":"Install the Audit Log Filter","text":"<p>The feature is in tech preview.</p> <p>The <code>plugin_dir</code> system variable defines the plugin library location. If needed, at server startup, set the <code>plugin_dir</code> variable.</p> <p>When upgrading a MySQL installation, plugins are not automatically upgraded. You may need to manually load the plugin after the MySQL upgrade.</p> <p>In the <code>share</code> directory, locate the <code>audit_log_filter_linux_install.sql</code>script.</p> <p>Implemented in 8.0.34, at the time you run the script, you can select the database used to store the JSON filter tables. </p> <ul> <li>If the plugin is loaded, the installation script takes the database name from the <code>audit_log_filter_database</code> variable</li> <li>If the plugin is not loaded, but passes the <code>-D db_name</code> to the mysql client when the installation script runs, uses the <code>db_name</code>.</li> <li>If the plugin is not loaded and the <code>-D</code> option is not provided, the installation script creates the required tables in the default database name <code>mysql</code>.</li> </ul> <p>You can also designate a different database with the <code>audit_log_filter_database</code> system variable. The database name cannot be NULL or exceed 64 characters. If the database name is invalid, the audit log filter tables are not found.</p> <p>With 8.0.34 and higher, use this command:</p> <pre><code>$ mysql -u -D database -p &lt; audit_log_filter_linux_install.sql\n</code></pre> <p>To verify the plugin installation, run the following command:</p> <pre><code>mysql&gt; SELECT PLUGIN_NAME, PLUGIN_STATUS FROM INFORMATION_SCHEMA.PLUGINS WHERE PLUGIN_NAME LIKE `audit%';\n</code></pre> Expected output <pre><code>+--------------------+---------------+\n| PLUGIN_NAME        | PLUGIN_STATUS |\n+--------------------+---------------+\n| audit_log_filter   | ACTIVE        |\n+--------------------+---------------+\n</code></pre> <p>After the installation, you can use the <code>--audit_log_filter</code> option when restarting the server. To prevent the server from not running the plugin use <code>--audit_log_filter</code> with either the <code>FORCE</code> or the <code>FORCE_PLUS_PERMANENT</code> values.</p>"},{"location":"install-data-masking-component.html","title":"Install the data masking component","text":"<p>Percona Server for MySQL 8.0.34 adds the data masking component. Percona Server for MySQL also has the Data Masking plugin. </p> <p>Useful link</p> <p>Compare the data masking component and the data masking plugin</p> <p>Before installing the component, you must uninstall the data masking plugin and all of the functions. The removal avoids conflicts.</p> <p>The component has the following parts:</p> <ul> <li>A database server system table used to store the terms and dictionaries</li> <li>A <code>component_masking_functions</code> component that contains the loadable functions</li> </ul> <p>The <code>MASKING_DICTIONARIES_ADMIN</code> privilege may be required by some functions.</p>"},{"location":"install-data-masking-component.html#install-the-component","title":"Install the component","text":"<p>The following steps install the component:</p> <ol> <li> <p>Create <code>masking_dictionaries</code>.</p> <pre><code>mysql&gt; CREATE TABLE IF NOT EXISTS\nmysql.masking_dictionaries(\n    Dictionary VARCHAR(256) NOT NULL,\n    Term VARCHAR(256) NOT NULL,\n    UNIQUE INDEX dictionary_term_idx (Dictionary, Term)\n) ENGINE = InnoDB DEFAULT CHARSET=utf8mb4;\n</code></pre> </li> <li> <p>Install the data masking components and the loadable functions.</p> <pre><code>mysql&gt; INSTALL COMPONENT 'file://component_masking_functions';\n</code></pre> </li> <li> <p>The <code>MASKING_DICTIONARIES_ADMIN</code> is required to use the the following functions:</p> <ul> <li> <p><code>masking_dictionary_term_add</code></p> </li> <li> <p><code>masking_dictionary_term_remove</code></p> </li> <li> <p><code>masking_dictionary_remove</code></p> <pre><code>mysql&gt; GRANT MASKING_DICTIONARIES_ADMIN ON *.* TO &lt;user&gt;;\n</code></pre> </li> </ul> </li> </ol>"},{"location":"install-data-masking-component.html#useful-links","title":"Useful links","text":"<p>Uninstall the data masking component</p> <p>Data masking component functions</p>"},{"location":"install-data-masking-plugin.html","title":"Install and remove the data masking plugin","text":"<p>This feature was implemented in Percona Server for MySQL version Percona Server for MySQL 8.0.17-8.</p> <p>The Percona Data Masking plugin is a free and Open Source implementation of the MySQL\u2019s data masking plugin. Data Masking provides a set of functions to hide sensitive data with modified content.</p>"},{"location":"install-data-masking-plugin.html#install-the-plugin","title":"Install the plugin","text":"<p>The following command installs the plugin and the functions:</p> <pre><code>INSTALL PLUGIN data_masking SONAME 'data_masking.so';\n</code></pre>"},{"location":"install-data-masking-plugin.html#uninstall-the-plugin","title":"Uninstall the plugin","text":"<p>Use the UNINSTALL PLUGIN statement and the DROP FUNCTION statement to disable and uninstall the plugin and then remove the functions. </p> <pre><code>UNINSTALL PLUGIN data_masking;\n</code></pre>"},{"location":"install-myrocks.html","title":"Percona MyRocks installation guide","text":"<p>Percona MyRocks is distributed as a separate package that can be enabled as a plugin for Percona Server for MySQL 8.0 and later versions.</p> <p>Note</p> <p>File formats across different MyRocks variants may not be compatible. Percona Server for MySQL supports only Percona MyRocks.  Migrating from one variant to another requires a logical data dump and reload.</p> <ul> <li> <p>Installing Percona MyRocks</p> </li> <li> <p>Removing Percona MyRocks</p> </li> </ul>"},{"location":"install-myrocks.html#install-percona-myrocks","title":"Install Percona MyRocks","text":"<p>It is recommended to install Percona software from official repositories:</p> <ol> <li> <p>Configure Percona repositories as described in Percona Software Repositories Documentation.</p> </li> <li> <p>Install Percona MyRocks using the corresponding package manager:</p> <ul> <li>For Debian or Ubuntu:</li> </ul> <pre><code>$ sudo apt install percona-server-rocksdb\n</code></pre> <p>Note</p> <p>Review the Installing and configuring Percona Server for MySQL with ZenFS support document for the Installation and the Configuration information.</p> <ul> <li>For RHEL or CentOS:</li> </ul> <pre><code>$ sudo yum install percona-server-rocksdb\n</code></pre> </li> </ol> <p>After installation, you should see the following output:</p> Expected output <pre><code>* This release of |Percona Server| is distributed with RocksDB storage engine.\n* Run the following script to enable the RocksDB storage engine in Percona Server:\n</code></pre> <pre><code>$ ps-admin --enable-rocksdb -u &lt;mysql_admin_user&gt; -p[mysql_admin_pass] [-S &lt;socket&gt;] [-h &lt;host&gt; -P &lt;port&gt;]\n</code></pre>"},{"location":"install-myrocks.html#enable-myrocks-with-ps-admin","title":"Enable MyRocks with ps-admin","text":"<p>Run the <code>ps-admin</code> script as system root user or with sudo and provide the MySQL root user credentials to properly enable the RocksDB (MyRocks) storage engine:</p> <pre><code>$ sudo ps-admin --enable-rocksdb -u root -pPassw0rd\n</code></pre> Expected output <pre><code>Checking if RocksDB plugin is available for installation ...\nINFO: ha_rocksdb.so library for RocksDB found at /usr/lib64/mysql/plugin/ha_rocksdb.so.\n\nChecking RocksDB engine plugin status...\nINFO: RocksDB engine plugin is not installed.\n\nInstalling RocksDB engine...\nINFO: Successfully installed RocksDB engine plugin.\n</code></pre> <p>Note</p> <p>When you use the <code>ps-admin</code> script to enable Percona MyRocks, it performs the following:</p> <ul> <li> <p>Disables Transparent huge pages</p> </li> <li> <p>Installs and enables the RocksDB plugin</p> </li> </ul> <p>If the script returns no errors, Percona MyRocks should be successfully enabled on the server. You can verify it as follows:</p> <pre><code>mysql&gt; SHOW ENGINES;\n</code></pre> Expected output <pre><code>+---------+---------+----------------------------------------------------------------------------+--------------+------+------------+\n| Engine  | Support | Comment                                                                    | Transactions | XA   | Savepoints |\n+---------+---------+----------------------------------------------------------------------------+--------------+------+------------+\n| ROCKSDB | YES     | RocksDB storage engine                                                     | YES          | YES  | YES        |\n...\n| InnoDB  | DEFAULT | Percona-XtraDB, Supports transactions, row-level locking, and foreign keys | YES          | YES  | YES        |\n+---------+---------+----------------------------------------------------------------------------+--------------+------+------------+\n10 rows in set (0.00 sec)\n</code></pre> <p>Note that the RocksDB engine is not set to be default, new tables will still be created using the InnoDB (XtraDB) storage engine. To make RocksDB storage engine default, set <code>default-storage-engine=rocksdb</code> in the <code>[mysqld]</code> section of <code>my.cnf</code> and restart Percona Server for MySQL.</p> <p>Alternatively, you can add <code>ENGINE=RocksDB</code> after the <code>CREATE TABLE</code> statement for every table that you create.</p>"},{"location":"install-myrocks.html#install-myrocks-plugins","title":"Install MyRocks plugins","text":"<p>You can install MyRocks manually with a series of INSTALL PLUGIN statements. You must have the <code>INSERT</code> privilege for the <code>mysql.plugin</code> system table.</p> <p>The following statements install MyRocks:</p> <pre><code>INSTALL PLUGIN ROCKSDB SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_CFSTATS SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_DBSTATS SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_PERF_CONTEXT SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_PERF_CONTEXT_GLOBAL SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_CF_OPTIONS SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_GLOBAL_INFO SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_COMPACTION_HISTORY SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_COMPACTION_STATS SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_ACTIVE_COMPACTION_STATS SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_DDL SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_INDEX_FILE_MAP SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_LOCKS SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_TRX SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_DEADLOCK SONAME 'ha_rocksdb.so';\n</code></pre>"},{"location":"install-myrocks.html#remove-percona-myrocks","title":"Remove Percona MyRocks","text":"<p>It will not be possible to access tables created using the RocksDB engine with another storage engine after you remove Percona MyRocks. If you need this data, alter the tables to another storage engine. For example, to alter the <code>City</code> table to InnoDB, run the following:</p> <pre><code>mysql&gt; ALTER TABLE City ENGINE=InnoDB;\n</code></pre> <p>To disable and uninstall the RocksDB engine plugins, use the <code>ps-admin</code> script as follows:</p> <pre><code>$ sudo ps-admin --disable-rocksdb -u root -pPassw0rd\n</code></pre> Expected output <pre><code>Checking RocksDB engine plugin status...\nINFO: RocksDB engine plugin is installed.\n\nUninstalling RocksDB engine plugin...\nINFO: Successfully uninstalled RocksDB engine plugin.\n</code></pre> <p>After the engine plugins have been uninstalled, remove the Percona MyRocks package:</p> <ul> <li> <p>For Debian or Ubuntu:</p> <pre><code>$ sudo apt remove percona-server-rocksdb-8.0\n</code></pre> </li> <li> <p>For RHEL or CentOS:</p> <pre><code>$ sudo yum remove percona-server-rocksdb-80.x86_64\n</code></pre> </li> </ul> <p>Finally, remove all the MyRocks Server Variables from the configuration file (<code>my.cnf</code>) and restart Percona Server for MySQL.</p>"},{"location":"install-myrocks.html#uninstall-myrocks-plugins","title":"Uninstall MyRocks plugins","text":"<p>You can uninstall the plugins for MyRocks. You must have the <code>DELETE</code> privilege for the <code>mysql.plugin</code> system table.</p> <p>The following statements remove the MyRocks plugins:</p> <pre><code>UNINSTALL PLUGIN ROCKSDB;\nUNINSTALL PLUGIN ROCKSDB_CFSTATS;\nUNINSTALL PLUGIN ROCKSDB_DBSTATS;\nUNINSTALL PLUGIN ROCKSDB_PERF_CONTEXT;\nUNINSTALL PLUGIN ROCKSDB_PERF_CONTEXT_GLOBAL;\nUNINSTALL PLUGIN ROCKSDB_CF_OPTIONS;\nUNINSTALL PLUGIN ROCKSDB_GLOBAL_INFO;\nUNINSTALL PLUGIN ROCKSDB_COMPACTION_HISTORY;\nUNINSTALL PLUGIN ROCKSDB_COMPACTION_STATS;\nUNINSTALL PLUGIN ROCKSDB_ACTIVE_COMPACTION_STATS;\nUNINSTALL PLUGIN ROCKSDB_DDL;\nUNINSTALL PLUGIN ROCKSDB_INDEX_FILE_MAP;\nUNINSTALL PLUGIN ROCKSDB_LOCKS;\nUNINSTALL PLUGIN ROCKSDB_TRX;\nUNINSTALL PLUGIN ROCKSDB_DEADLOCK;\n</code></pre>"},{"location":"installation.html","title":"Install Percona Server for MySQL","text":"<p>Before installing, read the Percona Server for MySQL 8.0 Release notes.</p>"},{"location":"installation.html#install-percona-server-for-mysql-from-repositories","title":"Install Percona Server for MySQL from Repositories","text":"<p>Percona provides repositories for yum (<code>RPM</code> packages for Red Hat, CentOS and Amazon Linux AMI) and apt (<code>.deb</code> packages for Ubuntu and Debian) for software such as Percona Server for MySQL, Percona XtraBackup, and Percona Toolkit. This makes it easy to install and update your software and its dependencies through your operating system package manager. This is the recommended way of installing where possible.</p> <p>The following guides describe the installation process for using the official Percona repositories for the <code>.deb</code> and <code>.rpm</code> packages.</p> <ul> <li> <p>Install Percona Server for MySQL on Debian and Ubuntu</p> </li> <li> <p>Install Percona Server for MySQL on Red Hat Enterprise Linux and derivatives</p> </li> </ul>"},{"location":"jemalloc-profiling.html","title":"Jemalloc memory allocation profiling","text":"<p>Implemented in Percona Server for MySQL 8.0.25-15, Percona Server for MySQL can take advantage of the memory-profiling ability of the jemalloc allocator. This ability provides a method to investigate memory-related issues.</p>"},{"location":"jemalloc-profiling.html#requirements","title":"Requirements","text":"<p>This memory-profiling requires jemalloc_detected. This read-only variable returns <code>true</code> if jemalloc with the profiling-enabled option is being used by Percona Server for MySQL.</p> <p>As root, customize jemalloc with the following flags:</p> Option Description \u2013enable-stats Enables statistics-gathering ability \u2013enable-prof Enables heap profiling and the ability to detect leaks. <p>Using <code>LD_PRELOAD</code>. Build the library, configure the malloc configuration with the <code>prof:true</code> string, and then use <code>LD_PRELOAD</code> to  preload the <code>libjemalloc.so</code> library. The libprocess <code>MemoryProfiler</code> class detects the library automatically and enables the profiling support.</p> <p>The following is an example of the required commands:</p> <pre><code>./configure --enable-stats --enable-prof &amp;&amp; make &amp;&amp; make install\nMALLOC_CONF=prof:true\nLD_PRELOAD=/usr/lib/libjemalloc.so\n</code></pre>"},{"location":"jemalloc-profiling.html#use-percona-server-for-mysql-with-jemalloc-with-profiling-enabled","title":"Use Percona Server for MySQL with jemalloc with profiling enabled","text":"<p>To detect if jemalloc is set, run the following command:</p> <pre><code>SELECT @@jemalloc_detected;\n</code></pre> <p>To enable jemalloc profiling in a MySQL client, run the following command:</p> <pre><code>set global jemalloc_profiling=on;\n</code></pre> <p>The malloc_stats_totals table returns the statistics, in bytes, of the memory usage. The command takes no parameters and returns the results as a table.</p> <p>The following example commands display this result:</p> <pre><code>use performance_schema;\n</code></pre> <pre><code>SELECT * FROM malloc_stats_totals;\n</code></pre> Expected output <pre><code>+----+------------+------------+------------+-------------+------------+\n| id | ALLOCATION | MAPPED     | RESIDENT   | RETAINED    | METADATA   |\n+----+------------+------------+------------+-------------+------------+\n|  1 | 390977528  | 405291008  | 520167424  | 436813824   | 9933744    |\n+----+------------+------------+------------+-------------+------------+\n1 row in set (0.00 sec)\n</code></pre> <p>The malloc_stats table returns the cumulative totals, in bytes, of several statistics per type of arena. The command takes no parameters and returns the results as a table.</p> <p>The following example commands display this result:</p> <pre><code>use performance_schema;\n</code></pre> <pre><code>mysql&gt; SELECT * FROM malloc_stats ORDER BY TYPE DESC LIMIT 3;\n</code></pre> Expected output <pre><code>+--------+-------------+-------------+-------------+-------------+\n| TYPE   | ALLOCATED   | NMALLOC     | NDALLOC     | NRESQUESTS  |\n+--------+-------------+-------------+-------------+-------------+\n| small  | 23578872    | 586156      | 0           | 2649417     |\n| large  | 367382528   | 2218        | 0           | 6355        |\n| huge   | 0           | 0           | 0           | |\n+--------+-------------+-------------+-------------+-------------+\n3 rows in set (0.00 sec)\n</code></pre>"},{"location":"jemalloc-profiling.html#dumping-the-profile","title":"Dumping the profile","text":"<p>The profiling samples the <code>malloc()</code> calls and stores the sampled stack traces in a separate location in memory. These samples can be dumped into the filesystem. A dump returns a detailed view of the state of the memory.</p> <p>The process is global; therefore, only a single concurrent run is available and only the most recent runs are stored on disk.</p> <p>Use the following command to create a profile dump file:</p> <pre><code>flush memory profile;\n</code></pre> <p>The generated memory profile dumps are written to the /tmp directory.</p> <p>You can analyze the dump files with <code>jeprof</code> program, which must be installed on the host system in the appropriate path. This program is a perl script that post-processes the dump files in their raw format. The program has no connection to the <code>jemalloc</code> library and the version numbers are not required to match.</p> <p>To verify the dump, run the following command:</p> <pre><code>ls /tmp/jeprof_mysqld*\n/tmp/jeprof_mysqld.1.0.170013202213\njeprof --show_bytes /tmp/jeprof_mysqld.1.0.170013202213 jeprof.*.heap\n</code></pre> <p>You can also access the memory profile to plot a graph of the memory use. This ability requires that <code>jeprof</code> and <code>dot</code> are in the /tmp path. For the graph to display useful information, the binary file must contain symbol information.</p> <p>Run the following command:</p> <pre><code>jeprof --dot /usr/sbin/mysqld /tmp/jeprof_mysqld.1.0.170013202213 &gt; /tmp/jeprof1.dot\ndot --Tpng /tmp/jeprof1.dot &gt; /tmp/jeprof1.png\n</code></pre> <p>Note</p> <p>An example of allocation graph.</p>"},{"location":"jemalloc-profiling.html#performance_schema-tables","title":"PERFORMANCE_SCHEMA tables","text":"<p>In 8.0.25.14, the following tables are implemented to retrieve memory allocation statistics for a running instance or return the cumulative number of allocations requested or allocations returned for a running instance.</p> <p>More information about the stats that are returned can be found in jemalloc.</p>"},{"location":"jemalloc-profiling.html#malloc_stats_totals","title":"malloc_stats_totals","text":"<p>The current stats for allocations. All measurements are in bytes.</p> Column Name Description ALLOCATED The total amount the application allocated ACTIVE The total amount allocated by the application of active pages. A multiple of the page size and this value is greater than or equal to the stats.allocated value. The sum does not include allocator metadata pages and stats.arenas.&lt;i&gt;.pdirty or stats.arenas.&lt;i&gt;.pmuzzy. MAPPED The total amount in chunks that are mapped by the allocator in active extents. This value does not include inactive chunks. The value is at least as large as the stats.active and is a multiple of the chunk size. RESIDENT A maximum number the allocator has mapped in physically resident data pages. All allocator metadata pages and unused dirty pages are included in this value. Pages may not be physically resident if they correspond to demand-zeroed virtual memory that has not yet been touched. This value is a maximum rather than a precise value and is a multiple of the page size. The value is greater than the stats.active. RETAINED The amount retained by the virtual memory mappings of the operating system. This value does not include any returned mappings. This type of memory, usually de-committed, untouched, or purged. The value is associated with physical memory and is excluded from mapped memory statistics. METADATA The total amount dedicated to metadata. This value contains the base allocations which are used for bootstrap-sensitive allocator metadata structures. Transparent huge pages usage is not included."},{"location":"jemalloc-profiling.html#malloc_stats","title":"malloc_stats","text":"<p>The cumulative number of allocations requested or allocations returned for a running instance.</p> Column Name Description Type The type of object: small, large, and huge ALLOCATED The number of bytes that are currently allocated to the application. NMALLOC A cumulative number of times an allocation was requested from the arena\u2019s bins. The number includes times when the allocation satisfied an allocation request or filled a relevant tcache if opt.tcache is enabled. NDALLOC A cumulative number of times an allocation was returned to the arena\u2019s bins. The number includes times when the allocation was deallocated or flushed the relevant tcache if opt.tcache is enabled. NREQUESTS The cumulative number of allocation requests satisfied."},{"location":"jemalloc-profiling.html#system-variables","title":"System variables","text":"<p>The following variables have been added:</p>"},{"location":"jemalloc-profiling.html#jemalloc_detected","title":"jemalloc_detected","text":"<p>Description: This read-only variable returns <code>true</code> if jemalloc with profiling enabled is detected. The following options are required:</p> <ul> <li> <p>Jemalloc is installed and compiled with profiling enabled</p> </li> <li> <p>Percona Server for MySQL is configured to use jemalloc by using the environment variable <code>LD_PRELOAD</code>.</p> </li> <li> <p>The environment variable <code>MALLOC_CONF</code> is set to <code>prof:true</code>.</p> </li> </ul> <p>The following options are:</p> <ul> <li> <p>Scope: Global</p> </li> <li> <p>Variable Type: Boolean</p> </li> <li> <p>Default Value: false</p> </li> </ul>"},{"location":"jemalloc-profiling.html#jemalloc_profiling","title":"jemalloc_profiling","text":"<p>Description: Enables jemalloc profiling. The variable requires jemalloc_detected.</p> <ul> <li> <p>Command Line: \u2013jemalloc_profiling[=(OFF|ON)]</p> </li> <li> <p>Config File: Yes</p> </li> <li> <p>Scope: Global</p> </li> <li> <p>Dynamic: Yes</p> </li> <li> <p>Variable Type: Boolean</p> </li> <li> <p>Default Value: OFF</p> </li> </ul>"},{"location":"jemalloc-profiling.html#disable-profiling","title":"Disable profiling","text":"<p>To disable jemalloc profiling, in a MySQL client, run the following command:</p> <pre><code>set global jemalloc_profiling=off;\n</code></pre>"},{"location":"kill-idle-trx.html","title":"Kill idle transactions","text":"<p>This feature limits the age of idle transactions, for all transactional storage engines. If a transaction is idle for more seconds than the threshold specified, it will be killed. This prevents users from blocking InnoDB purge by mistake.</p>"},{"location":"kill-idle-trx.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"kill-idle-trx.html#system-variables","title":"System variables","text":""},{"location":"kill-idle-trx.html#kill_idle_transaction","title":"<code>kill_idle_transaction</code>","text":"Option Description Config file Yes Scope: Global Dynamic: Yes Data type Integer Default value 0 (disabled) Units Seconds <p>If non-zero, any idle transaction will be killed after being idle for this many seconds.</p>"},{"location":"ldap-authentication.html","title":"Using LDAP authentication plugins","text":"<p>LDAP (Lightweight Directory Access Protocol) provides an alternative method to access existing directory servers, which maintain information about individuals, groups, and organizations.</p>"},{"location":"ldap-authentication.html#version-specific-information","title":"Version specific information","text":"<p>Percona Server for MySQL 8.0.30-22 implements an SASL-based LDAP authentication plugin. This plugin only supports the SCRAM-SHA-1 SASL mechanism.</p> <p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>Percona Server for MySQL 8.0.19-10 implements the simple LDAP authentication. The Percona simple LDAP authentication plugin is a free and Open Source implementation of the MySQL Enterprise Simple LDAP authentication plugin.</p>"},{"location":"ldap-authentication.html#plugin-names-and-file-names","title":"Plugin names and file names","text":"<p>The following tables show the plugin names and the file name for simple LDAP authentication and SASL-based LDAP authentication.</p> Simple LDAP authentication plugin names and library nameSASL-based LDAP authentication plugin names and library names Plugin or file Plugin name or file name Server-side plugin authentication_ldap_simple client-side plugin mysql_clear_password library file authentication_ldap_simple.so Plugin or file Plugin name or file name Server-side plugin authentication_ldap_sasl client-side plugin authentication_ldap_sasl_client library files authentication_ldap_sasl.so  authentication_ldap_sasl_client.so"},{"location":"ldap-authentication.html#how-does-the-authentication-work","title":"How does the authentication work","text":"<p>The server-side LDAP plugins work only with the specific client-side plugin:</p> <ul> <li> <p>The <code>authentication_ldap_simple</code> plugin, on the server, performs the simple LDAP authentication. The client, using <code>mysql_clear_password</code>, connects to the server. The client plugin sends the password to the server as cleartext. For this method, use a secure connection between the client and server.</p> </li> <li> <p>The <code>authentication_ldap_sasl</code> plugin, on the server, performs the SASL-based LDAP authentication. The client must use the <code>authentication_ldap_sasl_client</code> plugin. The method does not send the password to the server in cleartext. The server-side and client-side plugins use Simple Authentication and Security Layer (SASL) to send secure messages within the LDAP protocol.</p> </li> </ul> <p>For either method, the database server rejects the connection if the client user name and the host name do not match a server account.</p> <p>If a database server LDAP authentication is successful, the LDAP server searches for an entry. The LDAP server matches the user and authenticates using the LDAP password. If the database server account names the LDAP user distinguished name (DN), added by the <code>IDENTIFIED WITH &lt;plugin-name&gt; BY '&lt;auth-string&gt;'</code> clause, the LDAP server uses that value and the LDAP password provided by the client. This method fails if the DN and password have incorrect values</p> <p>If the LDAP server finds multiple matches or no match, authentication fails.</p> <p>If the password is correct, and the LDAP server finds a match, then LDAP authentication succeeds. The LDAP server returns the LDAP entry and the authentication plugin determines the authenticated user\u2019s name based on the entry. If the LDAP entry has no group attribute, the plugin returns the client user name as the authenticated name. If the LDAP entry has a group attribute, the plugin returns the group value as the authenticated name.</p> <p>The database server compares the client user name to the authenticated user name. If these names are the same, the database server uses the client user name to check for privileges. If the name differs, then the database server looks for an account that matches the authenticated name.</p>"},{"location":"ldap-authentication.html#prerequisites-for-authentication","title":"Prerequisites for authentication","text":"<p>The LDAP authentication plugins required the following:</p> <ul> <li> <p>An available LDAP server</p> </li> <li> <p>The LDAP server must contain the LDAP user accounts to be authenticated</p> </li> <li> <p>The OpenLDAP client library must be available on the same system as the plugin</p> </li> </ul> <p>The SASL-based LDAP authentication additionally requires the following:</p> <ul> <li> <p>Configure the LDAP server to communicate with a SASL server</p> </li> <li> <p>Available SASL client library on the same system as the client plugin.</p> </li> <li> <p>Services are configured to use the supported SCRAM-SHA-1 SASL mechanism</p> </li> </ul>"},{"location":"ldap-authentication.html#install-the-plugins","title":"Install the plugins","text":"<p>You can use either of the following methods to install the plugins.</p> <p>The SASL-based LDAP authentication is available on Percona Server for MySQL 8.0.30-22 and later.</p>"},{"location":"ldap-authentication.html#load-the-plugins-at-server-start","title":"Load the plugins at server start","text":"<p>Use either of the following methods to load the plugin at server start.</p> Load the simple LDAP authenticationLoad the SASL_based LDAP authentication plugin <p>Add the following statements to your <code>my.cnf</code> file to load simple LDAP authentication:</p> <pre><code>[mysqld]\nplugin-load-add=authentication_ldap_simple.so\nauthentication_ldap_simple_server_host=127.0.0.1\nauthentication_ldap_simple_bind_base_dn='dc=percona, dc=com'\n</code></pre> <p>Restart the server for the changes to take effect.</p> <p>Add the following statements to your <code>my.cnf</code> file to load the SASL-based LDAP authentication:</p> <pre><code>[mysqld]\nplugin-load-add=authentication_ldap_sasl.so\nauthentication_ldap_sasl_server_host=127.0.0.1\nauthentication_ldap_sasl_bind_base_dn='dc=percona, dc=com'\n</code></pre>"},{"location":"ldap-authentication.html#load-the-plugins-at-runtime","title":"Load the plugins at runtime","text":"<p>Install the plugin with the following statements.</p> Load the simple LDAP authentication pluginLoad the SASL-based LDAP authentication plugin <pre><code>mysql&gt; INSTALL PLUGIN authentication_ldap_simple SONAME 'authentication_ldap_simple.so';\n</code></pre> <p>To set and persist values at runtime, use the following statements:</p> <pre><code>mysql&gt; SET PERSIST authentication_ldap_simple_server_host='127.0.0.1';\nmysql&gt; SET PERSIST authentication_ldap_simple_bind_base_dn='dc=percona, dc=com';\n</code></pre> <pre><code>mysql&gt; INSTALL PLUGIN authentication_ldap_sasl SONAME 'authentication_ldap_sasl.so`;\n</code></pre> <p>To set and persist values at runtime, use the following statements:</p> <pre><code>mysql&gt; SET PERSIST authentication_ldap_sasl_server_host='127.0.0.1';\nmysql&gt; SET PERSIST authentication_ldap_sasl_bind_base_dn='dc=percona, dc=com';\n</code></pre>"},{"location":"ldap-authentication.html#create-a-user-using-simple-ldap-authentication","title":"Create a user using simple LDAP authentication","text":"<p>There are several methods to add or modify a user.</p> Use authentication_ldap_simple pluginUse the authentication string in simple LDAP <p>In the <code>CREATE USER</code> statement or the <code>ALTER USER</code> statement, for simple LDAP authentication, you can specify the <code>authentication_ldap_simple</code> plugin in the <code>IDENTIFIED WITH</code> clause:</p> <pre><code>mysql&gt; CREATE USER ... IDENTIFIED WITH authentication_ldap_simple;\n</code></pre> <p>Using the <code>IDENTIFIED WITH</code> clause, the database server assigns the specified plugin.</p> <p>If you provide the optional authentication string clause, \u2018cn,ou,dc,dc\u2019 in the example, the string is stored along with the password.</p> <pre><code>mysql&gt; CREATE USER ... IDENTIFIED WITH authentication_ldap_simple BY 'cn=[user name],ou=[organization unit],dc=[domain component],dc=com'\n</code></pre> <p>Unless the authentication_ldap_simple_group_role_mapping variable is used, creating a user with an authentication string does not use the following system variables:</p> <ul> <li> <p>authentication_ldap_simple_bind_base_dn</p> </li> <li> <p>authentication_ldap_simple_bind_root_dn</p> </li> <li> <p>authentication_ldap_simple_bind_root_pwd</p> </li> <li> <p>authentication_ldap_simple_user_search_attr</p> </li> <li> <p>authentication_ldap_simple_group_search_attr</p> </li> </ul> <p>Creating the user with <code>IDENTIFIED BY authentication_ldap_simple</code> uses the variables.</p> <p>Creating the user with the authentication_ldap_simple_group_role_mapping variable also adds the authentication_ldap_simple_bind_root_dn and authentication_ldap_simple_bind_root_pwd variables.</p>"},{"location":"ldap-authentication.html#create-a-user-using-sasl-based-ldap-authentication","title":"Create a user using SASL-based LDAP authentication","text":"<p>There are several methods to add or modify a user.</p> Use authentication_ldap_sasl pluginUse the authentication string in SASL-based LDAP <p>For SASL-based LDAP authentication, in the <code>CREATE USER</code> statement or the <code>ALTER USER</code> statement, you can specify the <code>authentication_ldap_sasl</code> plugin:</p> <pre><code>mysql&gt; CREATE USER ... IDENTIFIED WITH authentication_ldap_sasl;\n</code></pre> <p>If you provide the optional authentication string clause, \u2018cn,ou,dc,dc\u2019 in the example, the string is stored along with the password.</p> <pre><code>mysql&gt; CREATE USER ... IDENTIFIED WITH authentication_ldap_sasl BY 'cn=[user name],ou=[organization unit],dc=[domain component],dc=com'\n</code></pre> <p>Unless the authentication_ldap_sasl_group_role_mapping variable is used, creating a user with an authentication string does not use the following system variables:</p> <ul> <li> <p>authentication_ldap_sasl_bind_base_dn</p> </li> <li> <p>authentication_ldap_sasl_bind_root_dn</p> </li> <li> <p>authentication_ldap_sasl_bind_root_pwd</p> </li> <li> <p>authentication_ldap_sasl_user_search_attr</p> </li> <li> <p>authentication_ldap_sasl_group_search_attr</p> </li> </ul> <p>Creating the user with <code>IDENTIFIED BY authentication_ldap_sasl</code> uses the variables. </p> <p>Creating the user with the authentication_ldap_sasl_group_role_mapping variable also adds theauthentication_ldap_sasl_bind_root_dn and authentication_ldap_sasl_bind_root_pwd variables.</p>"},{"location":"ldap-authentication.html#examples","title":"Examples","text":"<p>The following sections are examples of using simple LDAP authentication and SASL-based LDAP authentication.</p> <p>For the purposes of this example, we use the following LDAP user:</p> <pre><code>uid=ldapuser,ou=testusers,dc=percona,dc=com\n</code></pre> Simple LDAP authenticationSASL-based LDAP authentication <p>The following example configures an LDAP user and connects to the database server.</p> <p>Create a database server account for <code>ldapuser</code> with the following statement:</p> <pre><code>mysql&gt; CREATE USER 'ldapuser'@'localhost' IDENTIFIED WITH authentication_ldap_simple BY 'uid=ldapuser,ou=testusers,dc=percona,dc=com';\n</code></pre> <p>The authentication string does not include the LDAP password. This password must be provided by the client user when they connect.</p> <pre><code>mysql&gt; mysql --user=ldapuser --password --enable-cleartext-plugin\n</code></pre> <p>The user enters the <code>ldapuser</code> password. The client sends the password as cleartext, which is necessary when using a server-side LDAP library without SASL. The following actions may minimize the risk:</p> <ul> <li>Require that the database server clients explicitly enable the <code>mysql_clear_password</code> plugin with <code>--enable-cleartext-plugin</code>. </li> <li>Require that the database server clients connect to the database server using an encrypted connection</li> </ul> <p>The following example configures an LDAP user and connect to the database server.</p> <p>Create a database server account for <code>ldapuser</code> with the following statement:</p> <pre><code>mysql&gt; CREATE USER 'ldapuser'@'localhost' IDENTIFIED WITH authentication_ldap_sasl AS 'uid=ldapuser,ou=testusers,dc=percona,dc=com';\n</code></pre> <p>The authentication string does not include the LDAP password. This password must be provided by the client user when they connect.</p> <p>Clients connect ot the database server by providing the database server user name and LDAP password:</p> <pre><code>mysql&gt; mysql --user=ldapuser --password\n</code></pre> <p>The authentication is similar to the authentication method used by simple LDAP authentication, except that the client and the database server SASL LDAP plugins use SASL messages. These messages are secure within the LDAP protocol.</p>"},{"location":"ldap-authentication.html#uninstall-the-plugins","title":"Uninstall the plugins","text":"<p>If you installed either plugin at server startup, remove those options from the <code>my.cnf</code> file, remove any startup options that set LDAP system variables, and restart the server.</p> Uninstall the simple LDAP authentication pluginUninstall the SASL-based LDAP authentication plugin <p>If you installed the plugins at runtime, run the following statements:</p> <pre><code>mysql&gt; UNINSTALL PLUGIN authentication_ldap_simple;\n</code></pre> <p>If you used <code>SET_PERSIST</code>, use <code>RESET PERSIST</code> to remove the settings.</p> <p>If you installed the plugins at runtime, run the following statements:</p> <pre><code>mysql&gt; UNINSTALL PLUGIN authentication_ldap_sasl;\n</code></pre> <p>If you used <code>SET_PERSIST</code>, use <code>RESET PERSIST</code> to remove the settings.</p>"},{"location":"ldap-system-variables.html","title":"LDAP authentication plugin system variables","text":""},{"location":"ldap-system-variables.html#authentication-system-variables","title":"Authentication system variables","text":"<p>Percona 8.0.30-22 adds LDAP_SASL variables and the <code>fallback</code> server variables for simple LDAP and SASL-based LDAP.</p> <p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>The installation adds the following variables:</p> Variable name Description authentication_ldap_sasl_bind_base_dn Base distinguished name authentication_ldap_sasl_bind_root_dn Root distinguished name authentication_ldap_sasl_bind_root_dn_pwd Password for the root distinguished name authentication_ldap_sasl_ca_path Absolute path of the certificate authority authentication_ldap_sasl_fallback_server_host If the primary server is unavailable, the authentication plugin attempts to connect to the fallback server authentication_ldap_sasl_fallback_server_port The port number for the fallback server authentication_ldap_sasl_group_role_mapping A list of LDAP group names - MySQL role pairs authentication_ldap_sasl_group_search_attr Name of the attribute that specifies the group names in the LDAP directory entries authentication_ldap_sasl_group_search_filter Custom group search filter authentication_ldap_sasl_init_pool_size Initial size of the connection pool to the LDAP server authentication_ldap_sasl_log_status logging level authentication_ldap_sasl_max_pool_size Maximum size of the pool of connections to the LDAP server authentication_ldap_sasl_server_host LDAP server host authentication_ldap_sasl_server_port LDAP server TCP/IP port number authentication_ldap_sasl_ssl If plugin connections to the LDAP server use the SSL protocol (ldaps://) authentication_ldap_sasl_tls If plugin connections to the LDAP server are secured with STARTTLS (ldap://) authentication_ldap_sasl_user_search_attr Name of the attribute that specifies user names in the LDAP directory entries authentication_ldap_simple_bind_base_dn Base distinguished name authentication_ldap_simple_bind_root_dn Root distinguished name authentication_ldap_simple_bind_root_dn_pwd Password for the root distinguished name authentication_ldap_simple_ca_path Absolute path of the certificate authority authentication_ldap_simple_fallback_server_host If the primary server is unavailable, the authentication plugin attempts to connect to the fallback server authentication_ldap_simple_fallback_server_port The port number for the fallback server authentication_ldap_simple_group_role_mapping A list of LDAP group names - MySQL role pairs authentication_ldap_simple_group_search_attr Name of the attribute that specifies the group names in the LDAP directory entries authentication_ldap_simple_group_search_filter Custom group search filter authentication_ldap_simple_init_pool_size Initial size of the connection pool to the LDAP server authentication_ldap_simple_log_status logging level authentication_ldap_simple_max_pool_size Maximum size of the pool of connections to the LDAP server authentication_ldap_simple_server_host LDAP server host authentication_ldap_simple_server_port LDAP server TCP/IP port number authentication_ldap_simple_ssl If plugin connections to the LDAP server use the SSL protocol (ldaps://) authentication_ldap_simple_tls If plugin connections to the LDAP server are secured with STARTTLS (ldap://) authentication_ldap_simple_user_search_attr Name of the attribute that specifies user names in the LDAP directory entries <p>The following variables are described in detail:</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_bind_base_dn","title":"<code>authentication_ldap_sasl_bind_base_dn</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-bind-base-dn=value Scope Global Dynamic Yes Data type String Default NULL <p>The base distinguished name (DN) for SASL-based LDAP authentication. You can limit the search scope by using the variable as the base of the search.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_bind_root_dn","title":"<code>authentication_ldap_sasl_bind_root_dn</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-bind-root-dn=value Scope Global Dynamic Yes Data type String Default NULL <p>The <code>root</code> distiguished name (DN) used to authenticate SASL-based LDAP. When performing a search, this variable is used with <code>authentication_ldap_sasl_bind_root_pwd</code> as the authenticating credentials to the LDAP server.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_bind_root_pwd","title":"<code>authentication_ldap_sasl_bind_root_pwd</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-bind-root-pwd=value Scope Global Dynamic Yes Data type String Default NULL <p>The <code>root</code> password used to authenticate against SASL-based LDAP server. This variable is used with <code>authentication_ldap_sasl_bind_root_dn</code>.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_ca_path","title":"<code>authentication_ldap_sasl_ca_path</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-ca_path=value Scope Global Dynamic Yes Data type String Default NULL <p>The certificate authority\u2019s absolute path used to verify the LDAP certificate.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_fallback_server_host","title":"<code>authentication_ldap_sasl_fallback_server_host</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-fallback-server-host Scope Global Dynamic Yes Type Sting Default NULL <p>Use with <code>authentication_ldap_sasl_fallback_server_port</code>.</p> <p>If the primary server is unavailable, the authentication plugin attempts to connect to the fallback server and authenticate using that server.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_fallback_server_port","title":"<code>authentication_ldap_sasl_fallback_server_port</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-fallback-server-port Scope Global Dynamic Yes Type Integer Default NULL <p>Use with <code>authentication_ldap_sasl_fallback_server_host</code>.</p> <p>If the primary server is unavailable, the authentication plugin attempts to connect to the fallback server and authenticate using that server.</p> <p>If the fallback server host has a value, and the fallback port is 0, users can specify multiple fallback servers.</p> <p>Use this format to specify multiple fallback servers: <code>authentication_ldap_sasl_fallback_server_host=\"ldap(s)://host:port,ldap(s)://host2:port2</code>, for example.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_group_role_mapping","title":"<code>authentication_ldap_sasl_group_role_mapping</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-group-role-mapping=value Scope Global Dynamic Yes Data type String Default Null <p>When an LDAP user logs in, the server checks if the LDAP user is a member of the specified group. If the user is, then the server automatically grants the database server roles to the user.</p> <p>The variable has this format: <code>&lt;ldap_group&gt;=&lt;mysql_role&gt;,&lt;ldap_group2&gt;=&lt;mysql_role2&gt;,</code>.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_group_search_attr","title":"<code>authentication_ldap_sasl_group_search_attr</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-group-search-attr=value Scope Global Dynamic Yes Data type String Default cn <p>The attribute name that specifies group names in the LDAP directory entries for SASL-based LDAP authentication.  </p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_group_search_filter","title":"<code>authentication_ldap_sasl_group_search_filter</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-group-search-filter=value Scope Global Dynamic Yes Data type String Default (|(&amp;(objectClass=posixGroup)(memberUid=%s))(&amp;(objectClass=group)(member=%s))) <p>The custom group search filter for SASL-based LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_init_pool_size","title":"<code>authentication_ldap_sasl_init_pool_size</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-init-pool-size=value Scope Global Dynamic Yes Data type Integer Default 10 Minimum value 0 Maximum value 32767 Unit connections <p>The initial size of the connection pool to the LDAP server for SASL-based LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_log_status","title":"<code>authentication_ldap_sasl_log_status</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-log-status=value Scope Global Dynamic Yes Data type Integer Default 1 Minimum value 1 Maximum value 6 <p>The logging level for messages written to the error log for SASL-based LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_max_pool_size","title":"<code>authentication_ldap_sasl_max_pool_size</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-max-pool-size=value Scope Global Dynamic Yes Data type Integer Default 1000 Minimum value 0 Maximum value 32767 Unit connections <p>The maximum connection pool size to the LDAP server in SASL-based LDAP authentication. The variable is used with <code>authentication_ldap_sasl_init_pool_size</code>.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_server_host","title":"<code>authentication_ldap_sasl_server_host</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-server-host=value Scope Global Dynamic Yes Data type String Default NULL <p>The LDAP server host used for SASL-based LDAP authentication.  The LDAP server host can be an IP address or a host name.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_server_port","title":"<code>authentication_ldap_sasl_server_port</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-server-port=value Scope Global Dynamic Yes Data type Integer Default 389 Minimum value 1 Maximum value 32376 <p>The LDAP server TCP/IP port number used for SASL-based LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_ssl","title":"<code>authentication_ldap_sasl_ssl</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-ssl=value Scope Global Dynamic Yes Data type Boolean Default OFF <p>If this variable is enabled, the plugin connects to the server with SSL.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_tls","title":"<code>authentication_ldap_sasl_tls</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-tls=value Scope Global Dynamic Yes Data type Boolean Default OFF <p>If this variable is enabled, the plugin connects to the server with TLS.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_sasl_user_search_attr","title":"<code>authentication_ldap_sasl_user_search_attr</code>","text":"Option Description Command-line \u2013authentication-ldap-sasl-user-search-attr=value Scope Global Dynamic Yes Data type String Default uid <p>The attribute name that specifies the user names in LDAP directory entries in SASL-based LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_bind_base_dn","title":"<code>authentication_ldap_simple_bind_base_dn</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-bind-base-dn=value Scope Global Dynamic Yes Data type String Default NULL <p>The base distinguished name (DN) for simple LDAP authentication. You can limit the search scope by using the variable as the base of the search.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_bind_root_dn","title":"<code>authentication_ldap_simple_bind_root_dn</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-bind-root-dn=value Scope Global Dynamic Yes Data type String Default NULL <p>The <code>root</code> distinguished name (DN) used to authenticate simple LDAP. When performing a search, this variable is used with <code>authentication_ldap_simple_bind_root_pwd</code> as the authenticating credentials to the LDAP server.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_bind_root_pwd","title":"<code>authentication_ldap_simple_bind_root_pwd</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-bind-root-pwd=value Scope Global Dynamic Yes Data type String Default NULL <p>The <code>root</code> password used to authenticate against simple LDAP server. This variable is used with <code>authentication_ldap_simple_bind_root_dn</code>.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_ca_path","title":"<code>authentication_ldap_simple_ca_path</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-ca_path=value Scope Global Dynamic Yes Data type String Default NULL <p>The certificate authority\u2019s absolute path used to verify the LDAP certificate.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_fallback_server_host","title":"<code>authentication_ldap_simple_fallback_server_host</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-fallback-server-host Scope Global Dynamic Yes Type Sting Default NULL <p>Use with <code>authentication_ldap_simple_fallback_server_port</code>.</p> <p>If the primary server is unavailable, the authentication plugin attempts to connect to the fallback server and authenticate using that server.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_fallback_server_port","title":"<code>authentication_ldap_simple_fallback_server_port</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-fallback-server-port Scope Global Dynamic Yes Type Integer Default NULL <p>Use with <code>authentication_ldap_simple_fallback_server_host</code>.</p> <p>If the primary server is unavailable, the authentication plugin attempts to connect to the fallback server and authenticate using that server.</p> <p>If the fallback server host has a value, and the fallback port is 0, users can specify multiple fallback servers.</p> <p>Use this format to specify multiple fallback servers: <code>authentication_ldap_simple_fallback_server_host=\"ldap(s)://host:port,ldap(s)://host2:port2</code>, for example.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_group_role_mapping","title":"<code>authentication_ldap_simple_group_role_mapping</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-group-role-mapping=value Scope Global Dynamic Yes Data type String Default Null <p>When an LDAP user logs in, the server checks if the LDAP user is a member of the specified group. If the user is, then the server automatically grants the database server roles to the user.</p> <p>The variable has this format: <code>&lt;ldap_group&gt;=&lt;mysql_role&gt;,&lt;ldap_group2&gt;=&lt;mysql_role2&gt;,</code>.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_group_search_attr","title":"<code>authentication_ldap_simple_group_search_attr</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-group-search-attr=value Scope Global Dynamic Yes Data type String Default cn <p>The attribute name that specifies group names in the LDAP directory entries for simple LDAP authentication.  </p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_group_search_filter","title":"<code>authentication_ldap_simple_group_search_filter</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-group-search-filter=value Scope Global Dynamic Yes Data type String Default (|(&amp;(objectClass=posixGroup)(memberUid=%s))(&amp;(objectClass=group)(member=%s))) <p>The custom group search filter for simple LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_init_pool_size","title":"<code>authentication_ldap_simple_init_pool_size</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-init-pool-size=value Scope Global Dynamic Yes Data type Integer Default 10 Minimum value 0 Maximum value 32767 Unit connections <p>The initial size of the connection pool to the LDAP server for simple LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_log_status","title":"<code>authentication_ldap_simple_log_status</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-log-status=value Scope Global Dynamic Yes Data type Integer Default 1 Minimum value 1 Maximum value 6 <p>The logging level for messages written to the error log for simple LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_max_pool_size","title":"<code>authentication_ldap_simple_max_pool_size</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-max-pool-size=value Scope Global Dynamic Yes Data type Integer Default 1000 Minimum value 0 Maximum value 32767 Unit connections <p>The maximum connection pool size to the LDAP server in simple LDAP authentication. The variable is used with <code>authentication_ldap_simple_init_pool_size</code>.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_server_host","title":"<code>authentication_ldap_simple_server_host</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-server-host=value Scope Global Dynamic Yes Data type String Default NULL <p>The LDAP server host used for simple LDAP authentication.  The LDAP server host can be an IP address or a host name.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_server_port","title":"<code>authentication_ldap_simple_server_port</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-server-port=value Scope Global Dynamic Yes Data type Integer Default 389 Minimum value 1 Maximum value 32376 <p>The LDAP server TCP/IP port number used for simple LDAP authentication.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_ssl","title":"<code>authentication_ldap_simple_ssl</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-ssl=value Scope Global Dynamic Yes Data type Boolean Default OFF <p>If this variable is enabled, the plugin connects to the server with SSL.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_tls","title":"<code>authentication_ldap_simple_tls</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-tls=value Scope Global Dynamic Yes Data type Boolean Default OFF <p>If this variable is enabled, the plugin connects to the server with TLS.</p>"},{"location":"ldap-system-variables.html#authentication_ldap_simple_user_search_attr","title":"<code>authentication_ldap_simple_user_search_attr</code>","text":"Option Description Command-line \u2013authentication-ldap-simple-user-search-attr=value Scope Global Dynamic Yes Data type String Default uid <p>The attribute name that specifies the user names in LDAP directory entries in simple LDAP authentication.</p>"},{"location":"libcoredumper.html","title":"Libcoredumper","text":""},{"location":"libcoredumper.html#using-libcoredumper","title":"Using libcoredumper","text":"<p>A core dump file is the documented moment of a computer when either the computer or an application exits. Developers examine the dump as one of the tasks when searching for the cause of a failure.</p> <p>The <code>libcoredumper</code> is a free and Open Source fork of <code>google-coredumper</code>, enhanced to work on newer Linux versions, and GCC and CLANG.</p>"},{"location":"libcoredumper.html#enabling-the-libcoredumper","title":"Enabling the <code>libcoredumper</code>","text":"<p>Enable core dumps for troubleshooting purposes.</p> <p>To enable the <code>libcoredumper</code>, add the <code>coredumper</code> variable to the <code>mysqld</code> section of <code>my.cnf</code>. This variable is independent of the older <code>core-file</code> variable.</p> <p>The variable can have the following possible values:</p> Value Description Blank The core dump is saved under MySQL datadir and named core. A path ending with / The core dump is saved under the specified directory and named core. Full path with a filename The core dump is saved under the specified directory and filename <p>Restart the server.</p>"},{"location":"libcoredumper.html#verifying-the-libcoredumper-is-active","title":"Verifying the <code>libcoredumper</code> is active","text":"<p>MySQL writes to the log when generating a core file and delegates the core dump operation to the Linux kernel. </p> <pre><code>Writing a core file\n</code></pre> <p>MySQL using the <code>libcoredumper</code> to generate the file creates the following message in the log:</p> <pre><code>Writing a core file using lib coredumper\n</code></pre> <p>Every core file adds a crash timestamp instead of a PID for the following reasons:</p> <ul> <li>Correlates the core file with the crash. MySQL prints a UTC timestamp on the crash log.</li> </ul> <pre><code>10:02:09 UTC - mysqld got signal 11;\n</code></pre> <ul> <li>Stores multiple core files.</li> </ul> <p>Note</p> <p>For example, operators and containers run as the process id of PID 1. If the process ID is used to identify the core file, each container crash generates a core dump that overwrites the previous core file.</p>"},{"location":"libcoredumper.html#disabling-the-libcoredumper","title":"Disabling the libcoredumper","text":"<p>You can disable the libcoredumper. A core file may contain sensitive data and takes disk space.</p> <p>To disable the <code>libcoredumper</code> you must do the following:</p> <ol> <li> <p>In the <code>mysqld</code> section of my.cnf, remove the <code>libcoredumper</code> variable.</p> </li> <li> <p>Restart the server.</p> </li> </ol>"},{"location":"limitations.html","title":"MyRocks limitations","text":"<p>The MyRocks storage engine lacks the following features compared to InnoDB:</p> <ul> <li> <p>Online DDL is not supported due to the lack of atomic DDL support.</p> <pre><code>* There is no `ALTER TABLE ... ALGORITHM=INSTANT` functionality\n\n* A partition management operation only supports the `COPY` algorithms, which rebuilds the partition table and moves the data based on the new `PARTITION ... VALUE` definition. In the case of `DROP PARTITION`, the data not moved to another partition is deleted.\n</code></pre> </li> <li> <p>ALTER TABLE .. EXCHANGE PARTITION.</p> </li> <li> <p>SAVEPOINT</p> </li> <li> <p>Transportable tablespace</p> </li> <li> <p>Foreign keys</p> </li> <li> <p>Spatial indexes</p> </li> <li> <p>Fulltext indexes</p> </li> <li> <p>Gap locks</p> </li> <li> <p>Group Replication</p> </li> <li> <p>Partial Update of LOB in InnoDB</p> </li> </ul> <p>You should also consider the following:</p> <ul> <li> <p>All collations are supported on <code>CHAR</code> and <code>VARCHAR</code> indexed columns. By default, MyRocks prevents creating indexes with non-binary collations (including <code>latin1</code>). You can optionally use it by setting rocksdb_strict_collation_exceptions to <code>t1</code> (table names with regex format), but non-binary covering indexes other than <code>latin1</code> (excluding <code>german1</code>) still require a primary key lookup to return the <code>CHAR</code> or <code>VARCHAR</code> column.</p> </li> <li> <p>Either <code>ORDER BY DESC</code> or <code>ORDER BY ASC</code> is slow. This is because of \u201cPrefix Key Encoding\u201d feature in RocksDB. See https://www.slideshare.net/matsunobu/myrocks-deep-dive/58 for details. By default, ascending scan is faster and descending scan is slower. If the \u201creverse column family\u201d is configured, then descending scan will be faster and ascending scan will be slower. Note that InnoDB also imposes a cost when the index is scanned in the opposite order.</p> </li> <li> <p>When converting from large MyISAM/InnoDB tables, either by using the <code>ALTER</code> or <code>INSERT INTO SELECT</code> statements it\u2019s recommended that you check the Data loading documentation and create MyRocks tables as below (in case the table is sufficiently big it will cause the server to consume all the memory and then be terminated by the OOM killer):</p> </li> </ul> <pre><code> SET session sql_log_bin=0;\n SET session rocksdb_bulk_load=1;\n ALTER TABLE large_myisam_table ENGINE=RocksDB;\n SET session rocksdb_bulk_load=0;\n</code></pre> Expected output <pre><code>.. warning::\n\n   If you are loading large data without enabling :ref:`rocksdb_bulk_load`\n   or :ref:`rocksdb_commit_in_the_middle`, please make sure transaction\n   ize is small enough. All modifications of the ongoing transactions are\n   kept in memory.\n</code></pre> <ul> <li> <p>With partitioned tables that use the TokuDB or MyRocks storage engine, the upgrade only works with native partitioning.</p> <p>See also</p> <p>MySQL Documentation: Preparing Your Installation for Upgrade</p> </li> <li> <p>Percona Server for MySQL 8.0 and Unicode 9.0.0 standards have defined a change in the handling of binary collations. These collations are handled as NO PAD, trailing spaces are included in key comparisons. A binary collation comparison may result in two unique rows inserted and does not generate a`DUP_ENTRY` error. MyRocks key encoding and comparison does not account for this character set attribute.</p> </li> </ul>"},{"location":"limitations.html#not-supported-on-myrocks","title":"Not supported on MyRocks","text":"<p>MyRocks does not support the following:</p> <ul> <li> <p>Operating as either a source or a replica in any replication topology that is not exclusively row-based. Statement-based and mixed-format binary logging is not supported. For more information, see Replication Formats.</p> </li> <li> <p>Using multi-valued indexes. Implemented in Percona Server for MySQL 8.0.17, InnoDB supports this feature.</p> </li> <li> <p>Using spatial data types .</p> </li> <li> <p>Using the Clone Plugin and the Clone Plugin API.  As of Percona Server for MySQL 8.0.17, InnoDB supports either these features.</p> </li> <li> <p>Using encryption in tables. At this time, during an <code>ALTER TABLE</code> operation, MyRocks mistakenly detects all InnoDB tables as encrypted. Therefore, any attempt to <code>ALTER</code> an InnoDB table to MyRocks fails.</p> <p>As a workaround, we recommend a manual move of the table. The following  steps are the same as the <code>ALTER TABLE ... ENGINE=...</code> process:</p> <ul> <li> <p>Use <code>SHOW CREATE TABLE ...</code> to return the InnoDB table definition.</p> </li> <li> <p>With the table definition as the source, perform a <code>CREATE TABLE ... ENGINE=RocksDB</code>.</p> </li> <li> <p>In the new table, use <code>INSERT INTO &lt;new table&gt; SELECT \\* FROM &lt;old table&gt;</code>.</p> </li> </ul> <p>Note</p> <p>With MyRocks and with large tables, it is recommended to set the session variable <code>rocksdb_bulk_load=1</code> during the load to prevent running out of memory. This recommendation is because of the MyRocks large transaction limitation. For more information, see MyRocks Data Loading</p> </li> </ul>"},{"location":"log-connection-error.html","title":"Too many connections warning","text":"<p>If the log_error_verbosity system variable is set to <code>2</code> or higher, this feature generates the <code>Too many connections</code> warning in the log.</p>"},{"location":"log-connection-error.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"manage-audit-log-filter.html","title":"Manage the Audit Log Filter files","text":"<p>The feature is in tech preview.</p> <p>The Audit Log Filter files have the following potential results:</p> <ul> <li>Consume a large amount of disk space</li> <li>Grow large</li> </ul> <p>You can manage the space by using log file rotation. This operation renames and then rotates the current log file and then uses the original name on a new current log file. You can rotate the file either manually or automatically.</p> <p>If automatic rotation is enabled, you can prune the log file. This pruning operation can be based on either the log file age or combined log file size.</p>"},{"location":"manage-audit-log-filter.html#manual-log-rotation","title":"Manual log rotation","text":"<p>The default setting for <code>audit_log_filter_rotate_on_size</code> is 1GB. If this option is set to <code>0</code>, the audit log filter plugin does not do an automatic rotation of the log file. You must do the rotation manually with this setting.</p> <p>The <code>SELECT audit_log_rotate()</code> command renames the file and creates a new audit log filter file with the original name. You must have the <code>AUDIT_ADMIN</code> privilege. </p> <p>The files are pruned if either <code>audit_log_filter_max_size</code> or <code>audit_log_filter_prune_seconds</code> have a value greater than 0 (zero) and <code>audit_log_filter_rotate_on_size</code> &gt; 0.</p> <p>After the files have been renamed, you must manually remove any archived audit log filter files. The renamed audit log filter files can be read by <code>audit_log_read()</code>. The <code>audit_log_read()</code> does not find the logs if the name pattern differs from the current pattern.</p>"},{"location":"misc-info-schema-tables.html","title":"Misc. INFORMATION_SCHEMA tables","text":"<p>This page lists the <code>INFORMATION_SCHEMA</code> tables added to standard MySQL by Percona Server for MySQL that don\u2019t exist elsewhere in the documentation.</p>"},{"location":"misc-info-schema-tables.html#temporary-tables","title":"Temporary tables","text":"<p>Note</p> <p>This feature implementation is considered tech preview quality.</p> <p>Only the temporary tables that were explicitly created with CREATE TEMPORARY TABLE or ALTER TABLE are shown, and not the ones created to process complex queries.</p>"},{"location":"misc-info-schema-tables.html#information_schemaglobal_temporary_tables","title":"<code>INFORMATION_SCHEMA.GLOBAL_TEMPORARY_TABLES</code>","text":"Column Name Description \u2018SESSION_ID\u2019 \u2018MySQL connection id\u2019 \u2018TABLE_SCHEMA\u2019 \u2018Schema in which the temporary table is created\u2019 \u2018TABLE_NAME\u2019 \u2018Name of the temporary table\u2019 \u2018ENGINE\u2019 \u2018Engine of the temporary table\u2019 \u2018NAME\u2019 \u2018Internal name of the temporary table\u2019 \u2018TABLE_ROWS\u2019 \u2018Number of rows of the temporary table\u2019 \u2018AVG_ROW_LENGTH\u2019 \u2018Average row length of the temporary table\u2019 \u2018DATA_LENGTH\u2019 \u2018Size of the data (Bytes)\u2019 \u2018INDEX_LENGTH\u2019 \u2018Size of the indexes (Bytes)\u2019 \u2018CREATE_TIME\u2019 \u2018Date and time of creation of the temporary table\u2019 \u2018UPDATE_TIME\u2019 \u2018Date and time of the latest update of the temporary table\u2019 <p>The feature was ported from Percona Server for MySQL 5.7 in 8.0.12-1.</p> <p>This table holds information on the temporary tables that exist for all connections. You don\u2019t need the <code>SUPER</code> privilege to query this table.</p>"},{"location":"misc-info-schema-tables.html#information_schematemporary_tables","title":"<code>INFORMATION_SCHEMA.TEMPORARY_TABLES</code>","text":"Column Name Description \u2018SESSION_ID\u2019 \u2018MySQL connection id\u2019 \u2018TABLE_SCHEMA\u2019 \u2018Schema in which the temporary table is created\u2019 \u2018TABLE_NAME\u2019 \u2018Name of the temporary table\u2019 \u2018ENGINE\u2019 \u2018Engine of the temporary table\u2019 \u2018NAME\u2019 \u2018Internal name of the temporary table\u2019 \u2018TABLE_ROWS\u2019 \u2018Number of rows of the temporary table\u2019 \u2018AVG_ROW_LENGTH\u2019 \u2018Average row length of the temporary table\u2019 \u2018DATA_LENGTH\u2019 \u2018Size of the data (Bytes)\u2019 \u2018INDEX_LENGTH\u2019 \u2018Size of the indexes (Bytes)\u2019 \u2018CREATE_TIME\u2019 \u2018Date and time of creation of the temporary table\u2019 \u2018UPDATE_TIME\u2019 \u2018Date and time of the latest update of the temporary table\u2019 <p>The feature was ported from Percona Server for MySQL 5.7 in 8.0.12-1.</p> <p>This table holds information on the temporary tables existing for the running connection.</p>"},{"location":"myrocks-index.html","title":"Percona MyRocks introduction","text":"<p>MyRocks is a storage engine for MySQL based on RocksDB, an embeddable, persistent key-value store. Percona MyRocks is an implementation for Percona Server for MySQL.</p> <p>The RocksDB store is based on the log-structured merge-tree (or LSM tree). It is optimized for fast storage and combines outstanding space and write efficiency with acceptable read performance. As a result, MyRocks has the following advantages compared to other storage engines, if your workload uses fast storage, such as SSD:</p> <ul> <li> <p>Requires less storage space</p> </li> <li> <p>Provides more storage endurance</p> </li> <li> <p>Ensures better IO capacity</p> </li> </ul> <p>Percona MyRocks Installation Guide</p> <p>MyRocks Limitations</p> <p>Differences between Percona MyRocks and Facebook MyRocks</p> <p>MyRocks Column Families</p> <p>MyRocks Server Variables</p> <p>MyRocks Information Schema Tables</p> <p>Performance Schema MyRocks changes</p>"},{"location":"pam-plugin.html","title":"PAM authentication plugin","text":"<p>Percona PAM Authentication Plugin is a free and Open Source implementation of the MySQL\u2019s authentication plugin. This plugin acts as a mediator between the MySQL server, the MySQL client, and the PAM stack. The server plugin requests authentication from the PAM stack, forwards any requests and messages from the PAM stack over the wire to the client (in cleartext) and reads back any replies for the PAM stack.</p> <p>PAM plugin uses dialog as its client side plugin. Dialog plugin can be loaded to any client application that uses <code>libperconaserverclient</code>/<code>libmysqlclient</code> library.</p> <p>Here are some of the benefits that Percona dialog plugin offers over the default one:</p> <ul> <li> <p>It correctly recognizes whether PAM wants input to be echoed or not, while the default one always echoes the input on the user\u2019s console.</p> </li> <li> <p>It can use the password which is passed to MySQL client via \u201c-p\u201d parameter.</p> </li> <li> <p>Dialog client installation bug has been fixed.</p> </li> </ul> <p>Percona offers two versions of this plugin:</p> <ul> <li> <p>Full PAM plugin called auth_pam. This plugin uses dialog.so. It fully supports the PAM protocol with arbitrary communication between client and server.</p> </li> <li> <p>Oracle-compatible PAM called auth_pam_compat. This plugin uses mysql_clear_password which is a part of Oracle MySQL client. It also has some limitations, such as, it supports only one password input. You must use <code>-p</code> option in order to pass the password to auth_pam_compat.</p> </li> </ul> <p>These two versions of plugins are physically different. To choose which one you want used, you must use IDENTIFIED WITH \u2018auth_pam\u2019 for auth_pam, and IDENTIFIED WITH \u2018auth_pam_compat\u2019 for auth_pam_compat.</p>"},{"location":"pam-plugin.html#version-specific-information","title":"Version specific information","text":"<p>Implemented in Percona Server for MySQL 8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</p> <p>A plugin may not be supported in later releases of MySQL or Percona Server for MySQL since version changes may introduce incompatible changes.</p>"},{"location":"pam-plugin.html#installation","title":"Installation","text":"<p>This plugin requires manual installation because it isn\u2019t installed by default.</p> <pre><code>mysql&gt; INSTALL PLUGIN auth_pam SONAME 'auth_pam.so';\n</code></pre> <p>After the plugin has been installed it should be present in the plugins list. To check if the plugin has been correctly installed and active</p> <pre><code>mysql&gt; SHOW PLUGINS;\n</code></pre> Expected output <pre><code>...\n| auth_pam                       | ACTIVE   | AUTHENTICATION     | auth_pam.so | GPL     |\n</code></pre>"},{"location":"pam-plugin.html#configuration","title":"Configuration","text":"<p>In order to use the plugin, authentication method should be configured. Simple setup can be to use the standard UNIX authentication method (<code>pam_unix</code>).</p> <p>Note</p> <p>To use <code>pam_unix</code>, mysql will need to be added to the shadow group in order to have enough privileges to read the /etc/shadow.</p> <p>A sample /etc/pam.d/mysqld file:</p> <pre><code>auth       required     pam_unix.so\naccount    required     pam_unix.so\n</code></pre> <p>For added information in the system log, you can expand it to be:</p> <pre><code>auth       required     pam_warn.so\nauth       required     pam_unix.so audit\naccount    required     pam_unix.so audit\n</code></pre>"},{"location":"pam-plugin.html#creating-a-user","title":"Creating a user","text":"<p>After the PAM plugin has been configured, users can be created with the PAM plugin as authentication method</p> <pre><code>mysql&gt; CREATE USER 'newuser'@'localhost' IDENTIFIED WITH auth_pam;\n</code></pre> <p>This will create a user <code>newuser</code> that can connect from <code>localhost</code> who will be authenticated using the PAM plugin. If the <code>pam_unix</code> method is being used user will need to exist on the system.</p>"},{"location":"pam-plugin.html#supplementary-groups-support","title":"Supplementary groups support","text":"<p>Percona Server for MySQL has implemented PAM plugin support for supplementary groups. Supplementary or secondary groups are extra groups a specific user is member of. For example user <code>joe</code> might be a member of groups: <code>joe</code> (his primary group) and secondary groups <code>developers</code> and <code>dba</code>. A complete list of groups and users belonging to them can be checked with <code>cat /etc/group</code> command.</p> <p>This feature enables using secondary groups in the mapping part of the authentication string, like \u201c<code>mysql, developers=joe, dba=mark</code>\u201d. Previously only primary groups could have been specified there. If user is a member of both <code>developers</code> and <code>dba</code>, PAM plugin will map it to the <code>joe</code> because <code>developers</code> matches first.</p>"},{"location":"pam-plugin.html#known-issues","title":"Known issues","text":"<p>Default mysql stack size is not enough to handle <code>pam_encryptfs</code> module. The workaround is to increase the MySQL stack size by setting the thread-stack variable to at least <code>512KB</code> or by increasing the old value by <code>256KB</code>.</p> <p>PAM authentication can fail with <code>mysqld: pam_unix(mysqld:account): Fork failed: Cannot allocate memory</code> error in the <code>/var/log/secure</code> even when there is enough memory available. Current workaround is to set vm.overcommit_memory to <code>1</code>:</p> <pre><code>echo 1 /proc/sys/vm/overcommit_memory\n</code></pre> <p>and by adding the <code>vm.overcommit_memory = 1</code> to <code>/etc/sysctl.conf</code> to make the change permanent after reboot. Authentication of internal (i.e. non PAM) accounts continues to work fine when <code>mysqld</code> reaches this memory utilization level. NOTE: Setting the <code>vm.overcommit_memory</code> to <code>1</code> will cause kernel to perform no memory overcommit handling which could increase the potential for memory overload and invoking of OOM killer.</p>"},{"location":"percona-xtradb.html","title":"The Percona XtraDB storage engine","text":"<p>Percona XtraDB is an enhanced version of the InnoDB storage engine, designed to better scale on modern hardware.  It also includes a variety of other features useful in high-performance environments. It is fully backward compatible, and so can be used as a drop-in replacement for standard InnoDB.</p> <p>Percona XtraDB includes all of InnoDB \u2018s robust, reliable <code>ACID</code>-compliant design and advanced <code>MVCC</code> architecture, and builds on that solid foundation with more features, more tunability, more metrics, and more scalability. In particular, it is designed to scale better on many cores, use memory more efficiently, and be more convenient and useful. The new features are specially designed to alleviate some of InnoDB\u2019s limitations. We choose features and fixes based on customer requests and on our best judgment of real-world needs as a high-performance consulting company.</p> <p>Percona XtraDB engine will not have further binary releases, it is distributed as part of the Percona Server for MySQL.</p>"},{"location":"post-installation.html","title":"Post-installation","text":"<p>Depending on the type of installation, you may need to do the following tasks:</p>"},{"location":"post-installation.html#installed-using-binary-files-or-compiling-from-source","title":"Installed using binary files or compiling from source","text":"Task Initialize the data dictionary Test the server Set service to start at boot time"},{"location":"post-installation.html#initialize-the-data-directory","title":"Initialize the data directory","text":"<p>If you install the server using either the source distribution or generic binary distribution files, the data directory is not initialized, and you must run the initialization process after installation.</p> <p>Run mysqld with the \u2013initialize option or the initialize-insecure option.</p> <p>Executing <code>mysqld</code> with either option does the following:</p> <ul> <li> <p>Verifies the existence of the data directory</p> </li> <li> <p>Initializes the system tablespace and related structures</p> </li> <li> <p>Creates system tables including grant tables, time zone tables, and server-side help tables</p> </li> <li> <p>Creates <code>root@localhost</code></p> </li> </ul> <p>You should run the following steps with the <code>mysql</code> login.</p> <ol> <li> <p>Navigate to the MySQL directory. The example uses the default location.</p> <pre><code>$ cd /usr/local/mysql\n</code></pre> </li> <li> <p>Create a directory for the MySQL files. The secure_file_priv uses the directory path as a value.</p> <pre><code>$ mkdir mydata\n</code></pre> <p>The <code>mysql</code> user account should have the <code>drwxr-x---</code> permissions. Four sections define the permissions; file or directory, User, Group, and Others.</p> <p>The first character designates if the permissions are for a file or directory. The first character is <code>d</code> for a directory.</p> <p>The rest of the sections are specified in three-character sets.</p> Permission User Group Other Read Yes Yes No Write Yes No No Execute Yes Yes No </li> <li> <p>Run the command to initialize the data directory.</p> <pre><code>$ bin/mysqld --initialize\n</code></pre> </li> </ol>"},{"location":"post-installation.html#test-the-server","title":"Test the server","text":"<p>After you have initialized the data directory, and the server is started, you can run tests on the server.</p> <p>This section assumes you have used the default installation settings. If you have modified the installation, navigate to the installation location. You can also add the location by Setting the Environment Variables.</p> <p>You can use the mysqladmin client to access the server.</p> <p>If you have issues connecting to the server, use the <code>root</code> user and the root account password.</p> <pre><code>$ sudo mysqladmin -u root -p version\n</code></pre> Expected output <pre><code>Enter password:\nmysql Ver 8.0.19-10 for debian-linux-gnu on x86_64 (Percona Server (GPL), Release '10', Revision 'f446c04')\n...\nServer version      8.0.19-10\nProtocol version    10\nConnection          Localhost via UNIX socket\nUNIX socket         /var/run/mysqld/mysqld.sock\nUptime:             4 hours 58 min 10 section\n\nThreads:    2 Questions:    16 Slow queries: 0 Opens: 139 Flush tables: 3\nOpen tables: 59  Queries per second avg: 0.0000\n</code></pre> <p>Use mysqlshow to display database and table information.</p> <pre><code>$ sudo mysqlshow -u root -p\n</code></pre> Expected output <pre><code>Enter password:\n\n+---------------------+\n|      Databases      |\n+=====================+\n| information_schema  |\n+---------------------+\n| mysql               |\n+---------------------+\n| performance_schema  |\n+---------------------+\n| sys                 |\n+---------------------+\n</code></pre>"},{"location":"post-installation.html#set-service-to-run-at-boot-time","title":"Set service to run at boot time","text":"<p>After a generic binary installation, manually configure systemd support.</p> <p>The following commands start, check the status, and stop the server:</p> <pre><code>$ sudo systemctl start mysqld\n$ sudo systemctl status mysqld\n$ sudo systemctl stop mysqld\n</code></pre> <p>Run the following command to start the service at boot time:</p> <p><pre><code>$ sudo systemctl enable mysqld\n</code></pre> Run the following command to prevent a service from starting at boot time:</p> <pre><code>$ sudo systemctl disable mysqld\n</code></pre>"},{"location":"post-installation.html#all-installations","title":"All installations","text":"Task Update the root password Secure the server Populate the time zone tables"},{"location":"post-installation.html#update-the-root-password","title":"Update the root password","text":"<p>During an installation on Debian/Ubuntu, you are prompted to enter a root password. On Red Hat Enterprise Linux and derivatives, you update the root password after installation.</p> <p>Restart the server with the <code>--skip-grant-tables</code> option to allow access without a password. This option is insecure. This option also disables remote connections.</p> <pre><code>$ sudo systemctl stop mysqld\n$ sudo systemctl set-environment MYSQLD_OPTS=\"--skip-grant-tables\"\n$ sudo systemctl start mysqld \n$ mysql\n</code></pre> <p>Reload the grant tables to be able to run the <code>ALTER USER</code> statement. Enter a password that satisfies the current policy.</p> <p><pre><code>mysql&gt; FLUSH PRIVILEGES;\nmysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED BY 'rootPassword_12';\nmysql&gt; exit\n</code></pre> If, when adding the password, MySQL returns <code>ERROR 1819 (HY000) Your password does not satisfy the current policy</code>, run the following command to see policy requirement.</p> <p><pre><code>mysql&gt; SHOW VARIABLES LIKE 'validate_password%';\n</code></pre> Redo your password to satisfy the requirements.</p> <p>Stop the server, remove the <code>--skip-grant-tables</code> option, start the server, and log into the server with the updated password.</p> <pre><code>$ sudo systemctl stop mysqld \n$ sudo systemctl unset-environment MYSQLD_OPTS \n$ sudo systemctl start mysqld \n$ mysql -u root -p\n</code></pre>"},{"location":"post-installation.html#secure-the-server","title":"Secure the server","text":"<p>The mysql_secure_installation script improves the security of the instance.</p> <p>The script does the following:</p> <ul> <li> <p>Changes the <code>root</code> password</p> </li> <li> <p>Disallows remote login for <code>root</code> accounts</p> </li> <li> <p>Removes anonymous users</p> </li> <li> <p>Removes the <code>test</code> database</p> </li> <li> <p>Reloads the privilege tables</p> </li> </ul> <p>The following statement runs the script:</p> <pre><code>$ mysql_secure_installation\n</code></pre>"},{"location":"post-installation.html#populate-the-time-zone-tables","title":"Populate the time zone tables","text":"<p>The time zone system tables are the following:</p> <ul> <li> <p><code>time_zone</code></p> </li> <li> <p><code>time_zone_leap_second</code></p> </li> <li> <p><code>time_zone_name</code></p> </li> <li> <p><code>time_zone_transition</code></p> </li> <li> <p><code>time_zone_transition_type</code></p> </li> </ul> <p>If you install the server using either the source distribution or the generic binary distribution files, the installation creates the time zone tables, but the tables are not populated.</p> <p>The mysql_tzinfo_to_sql program populates the tables from the <code>zoneinfo</code> directory data available in Linux.</p> <p>A common method to populate the tables is to add the zoneinfo directory path to <code>mysql_tzinfo_to_sql</code> and then send the output into the mysql system schema.</p> <p>The example assumes you are running the command with the <code>root</code> account. The account must have the privileges for modifying the <code>mysql</code> system schema.</p> <pre><code>$ mysql_tzinfo_to_sql /usr/share/zoneinfo | mysql -u root -p -D mysql\n</code></pre>"},{"location":"prefix-index-queries-optimization.html","title":"Prefix index queries optimization","text":"<p>Percona Server for MySQL has ported Prefix Index Queries Optimization feature from Facebook patch for MySQL.</p> <p>Prior to this InnoDB would always fetch the clustered index for all prefix columns in an index, even when the value of a particular record was smaller than the prefix length. This implementation optimizes that case to use the record from the secondary index and avoid the extra lookup.</p>"},{"location":"prefix-index-queries-optimization.html#status-variables","title":"Status variables","text":""},{"location":"prefix-index-queries-optimization.html#innodb_secondary_index_triggered_cluster_reads","title":"<code>Innodb_secondary_index_triggered_cluster_reads</code>","text":"Option Description Scope: Global Data type: Numeric <p>This variable shows the number of times secondary index lookup triggered cluster lookup.</p>"},{"location":"prefix-index-queries-optimization.html#innodb_secondary_index_triggered_cluster_reads_avoided","title":"<code>Innodb_secondary_index_triggered_cluster_reads_avoided</code>","text":"Option Description Scope: Global Data type: Numeric <p>This variable shows the number of times prefix optimization avoided triggering cluster lookup.</p>"},{"location":"prefix-index-queries-optimization.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7</li> </ul>"},{"location":"process-list.html","title":"Process list","text":"<p>This page describes Percona changes to both the standard MySQL <code>SHOW PROCESSLIST</code> command and the standard MySQL <code>INFORMATION_SCHEMA</code> table <code>PROCESSLIST</code>.</p>"},{"location":"process-list.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"process-list.html#information_schema-tables","title":"INFORMATION_SCHEMA Tables","text":"<p><code>INFORMATION_SCHEMA.PROCESSLIST</code></p> <p>This table implements modifications to the standard MySQL <code>INFORMATION_SCHEMA</code> table <code>PROCESSLIST</code>.</p> Column Name Description \u2018ID\u2019 \u2018The connection identifier.\u2019 \u2018USER\u2019 \u2018The MySQL user who issued the statement.\u2019 \u2018HOST\u2019 \u2018The host name of the client issuing the statement.\u2019 \u2018DB\u2019 \u2018The default database, if one is selected, otherwise NULL.\u2019 \u2018COMMAND\u2019 \u2018The type of command the thread is executing.\u2019 \u2018TIME\u2019 \u2018The time in seconds that the thread has been in its current state.\u2019 \u2018STATE\u2019 \u2018An action, event, or state that indicates what the thread is doing.\u2019 \u2018INFO\u2019 \u2018The statement that the thread is executing, or NULL if it is not executing any statement.\u2019 \u2018TIME_MS\u2019 \u2018The time in milliseconds that the thread has been in its current state.\u2019 \u2018ROWS_EXAMINED\u2019 \u2018The number of rows examined by the statement being executed (NOTE: This column is not updated for each examined row so it does not necessarily show an up-to-date value while the statement is executing. It only shows a correct value after the statement has completed.).\u2019 \u2018ROWS_SENT\u2019 \u2018The number of rows sent by the statement being executed.\u2019 \u2018TID\u2019 \u2018The Linux Thread ID. For Linux, this corresponds to light-weight process ID (LWP ID) and can be seen in the ps -L output. In case when Thread Pool is enabled, \u201cTID\u201d is not null for only currently executing statements and statements received via \u201cextra\u201d connection.\u2019"},{"location":"process-list.html#example-output","title":"Example output","text":"<p>Table PROCESSLIST:</p> <pre><code>mysql&gt; SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST;\n</code></pre> Expected output <pre><code>+----+------+-----------+--------------------+---------+------+-----------+---------------------------+---------+-----------+---------------+\n| ID | USER | HOST      | DB                 | COMMAND | TIME | STATE     | INFO                      | TIME_MS | ROWS_SENT | ROWS_EXAMINED |\n+----+------+-----------+--------------------+---------+------+-----------+---------------------------+---------+-----------+---------------+\n| 12 | root | localhost | information_schema | Query   |    0 | executing | select * from processlist |       0 |         0 |             0 |\n+----+------+-----------+--------------------+---------+------+-----------+---------------------------+---------+-----------+---------------+\n</code></pre>"},{"location":"procfs-plugin.html","title":"The ProcFS plugin","text":"<p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>Implemented in Percona Server for MySQL 8.0.25-15, the ProcFS plugin provides access to the Linux performance counters by running SQL queries against a Percona Server for MySQL 8.0.</p> <p>You may be unable to capture operating system metrics in certain environments, such as Cloud installations or MySQL-as-a-Service installations. These metrics are essential for complete system performance monitoring.</p> <p>The plugin does the following:</p> <ul> <li> <p>Reads selected files from the <code>/proc</code> file system and the <code>/sys</code> file system.</p> </li> <li> <p>Populates the file names and their content as rows in the INFORMATION_SCHEMA.PROCFS view.</p> </li> </ul> <p>The system variable procfs_files_spec provides access to the <code>/proc</code> and the <code>/sys</code> files and directories. This variable cannot be changed at run time, preventing a compromised account from giving itself greater access to those file systems.</p>"},{"location":"procfs-plugin.html#install-the-plugin-manually","title":"Install the PLUGIN manually","text":"<p>We recommend installing the plugin as part of the package. If needed, you can install this plugin manually. Copy the <code>procfs.so</code> file to the mysql plugin installation directory and execute the following command:</p> <pre><code>INSTALL PLUGIN procfs SONAME 'procfs.so';\n</code></pre>"},{"location":"procfs-plugin.html#access-privileges-required","title":"Access privileges required","text":"<p>Only users with the <code>ACCESS_PROCFS</code> dynamic privilege can access the <code>INFORMATION_SCHEMA.PROCFS</code> view. During the plugin startup, this dynamic privilege is registered with the server.</p> <p>After the plugin installation, grant a user access to the INFORMATION_SCHEMA.PROCFS view by executing the following command:</p> <pre><code>GRANT ACCESS_PROCFS ON *.* TO 'user'@'host';\n</code></pre> <p>Important</p> <p>An SELinux policy or an AppArmor profile may prevent access to file locations needed by the ProcFS plugin, such as the \u2018/proc/sys/fs/file-nr\u2019 directory or any sub-directories or files under \u2018/proc/irq/\u2019. Either edit the policy or profile to ensure that the plugin has the necessary access. If the policy and profile do not allow access, the plugin may may have unexpected behavior.</p> <p>For more information, see Working with SELinux and Working with AppArmor.</p>"},{"location":"procfs-plugin.html#using-the-procfs-plugin","title":"Using the ProcFS plugin","text":"<p>Authorized users can obtain information from individual files by specifying the exact file name within a WHERE clause. Files that are not included are ignored and considered not to exist.</p> <p>All files that match the procfs_files_spec are opened, read, stored in memory, and, finally, returned to the client. It is critical to add a WHERE clause to return only specific files to limit the impact of the plugin on the server\u2019s performance. A failure to use a WHERE clause can lead to lengthy query response times, high load, and high memory usage on the server. The WHERE clause can contain either an equality operator, the LIKE operator, or the IN operator. The LIKE operator limits file globbing. You can write file access patterns in the glob(7) style, such as <code>/sys/block/sd[a-z]/stat;/proc/version\\*</code></p> <p>The following example returns the <code>proc/version</code>:</p> <pre><code>SELECT * FROM INFORMATION_SCHEMA.PROCFS WHERE FILE = '/proc/version';\n</code></pre>"},{"location":"procfs-plugin.html#tables","title":"Tables","text":""},{"location":"procfs-plugin.html#procfs","title":"PROCFS","text":"<p>The schema definition of the INFORMATION_SCHEMA.PROCFS view is:</p> <pre><code>CREATE TEMPORARY TABLE `PROCFS` (\n`FILE` varchar(1024) NOT NULL DEFAULT '',\n`CONTENTS` longtext NOT NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n</code></pre> <p>Status variables provide the basic metrics:</p> Name Description procfs_access_violations The number of attempted queries by users without the ACCESS_PROCFS privilege. procfs_queries The number of queries made against the procfs view. procfs_files_read The number of files read to provide content procfs_bytes_read The number of bytes read to provide content"},{"location":"procfs-plugin.html#variable","title":"Variable","text":""},{"location":"procfs-plugin.html#procfs_files_spec","title":"procfs_files_spec","text":"Option Description Scope: Global Dynamic: Yes Read, Write, or Read-Only: Read-Only <p>The variable has been implemented in Percona Server for MySQL 8.0.25-14.  The default value for <code>procfs_files_spec</code> is: /proc/cpuinfo;/proc/irq//;/proc/loadavg/proc/net/dev;/proc/net/sockstat;/proc/net/sockstat_rhe4;/proc/net/tcpstat;/proc/self/net/netstat;/proc/self/stat;/proc/self/io;/proc/self/numa_maps/proc/softirqs;/proc/spl/kstat/zfs/arcstats;/proc/stat;/proc/sys/fs/file-nr;/proc/version;/proc/vmstat</p> <p>Enables access to the <code>/proc</code> and <code>/sys</code> directories and files. This variable is global, read only, and is set by using either the mysqld command line or by editing <code>my.cnf</code>.</p>"},{"location":"procfs-plugin.html#limitations","title":"Limitations","text":"<p>The following limitations are:</p> <ul> <li> <p>Only first 60k of /proc/ /sys/ files are returned</p> </li> <li> <p>The file name size is limited to 1k</p> </li> <li> <p>The plugin cannot read files if path does not start from /proc or /sys</p> </li> <li> <p>Complex WHERE conditions may force the plugin to read all configured files.</p> </li> </ul>"},{"location":"procfs-plugin.html#uninstall-plugin","title":"Uninstall plugin","text":"<p>The following statement removes the procfs plugin.</p> <pre><code>UNINSTALL PLUGIN procfs;\n</code></pre>"},{"location":"proxy-protocol-support.html","title":"Support for PROXY protocol","text":"<p>The proxy protocol allows an intermediate proxying server speaking proxy protocol (ie. HAProxy) between the server and the ultimate client (i.e. mysql client etc) to provide the source client address to the server, which normally would only see the proxying server address instead.</p> <p>As the proxy protocol amounts to spoofing the client address, it is disabled by default, and can be enabled on per-host or per-network basis for the trusted source addresses where trusted proxy servers are known to run. Unproxied connections are not allowed from these source addresses.</p> <p>Note</p> <p>Ensure that proper firewall access control lists (ACL) are in place when this feature is enabled.</p> <p>Proxying is supported only for TCP over IPv4 and IPv6 connections. The UNIX socket connections can not be proxied and do not fall under the effect of using the asterisk symbol (*).</p> <p>You cannot have a proxied IP address that is <code>127.0.0.1</code> or <code>::1</code>, even if the IP address is in the proxy_protocol_networks.</p>"},{"location":"proxy-protocol-support.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"proxy-protocol-support.html#system-variables","title":"System variables","text":""},{"location":"proxy-protocol-support.html#proxy_protocol_networks","title":"<code>proxy_protocol_networks</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Default (empty string) <p>This variable is a global-only, read-only variable, which is either an asterisk symbol(*), or a list of comma-separated IPv4 and IPv6 network and host addresses. For security reasons we do not recommend using an asterisk symbol for the IP address. This symbol causes the server to accept the proxy protocol from any host. Network addresses are specified in CIDR notation, i.e. <code>192.168.0.0/24</code>. To prevent source host spoofing, the setting of this variable must be as restrictive as possible to include only trusted proxy hosts.</p>"},{"location":"proxy-protocol-support.html#related-reading","title":"Related reading","text":"<ul> <li>PROXY protocol specification</li> </ul>"},{"location":"ps-variables.html","title":"List of variables introduced in Percona Server for MySQL 8.0","text":""},{"location":"ps-variables.html#system-variables","title":"System variables","text":"Name Cmd-Line Option File Var Scope Dynamic audit_log_buffer_size Yes Yes Global No audit_log_file Yes Yes Global No audit_log_flush Yes Yes Global Yes audit_log_format Yes Yes Global No audit_log_handler Yes Yes Global No audit_log_policy Yes Yes Global Yes audit_log_rotate_on_size Yes Yes Global No audit_log_rotations Yes Yes Global No audit_log_strategy Yes Yes Global No audit_log_syslog_facility Yes Yes Global No audit_log_syslog_ident Yes Yes Global No audit_log_syslog_priority Yes Yes Global No csv_mode Yes Yes Both Yes enforce_storage_engine Yes Yes Global No expand_fast_index_creation Yes No Both Yes extra_max_connections Yes Yes Global Yes extra_port Yes Yes Global No have_backup_locks Yes No Global No have_backup_safe_binlog_info Yes No Global No have_snapshot_cloning Yes No Global No innodb_cleaner_lsn_age_factor Yes Yes Global Yes innodb_corrupt_table_action Yes Yes Global Yes innodb_empty_free_list_algorithm Yes Yes Global Yes innodb_encrypt_online_alter_logs Yes Yes Global Yes innodb_encrypt_tables Yes Yes Global Yes innodb_kill_idle_transaction Yes Yes Global Yes innodb_max_bitmap_file_size Yes Yes Global Yes innodb_max_changed_pages Yes Yes Global Yes innodb_print_lock_wait_timeout_info Yes Yes Global Yes innodb_show_locks_held Yes Yes Global Yes innodb_temp_tablespace_encrypt Yes Yes Global No innodb_track_changed_pages Yes Yes Global No keyring_vault_config Yes Yes Global Yes keyring_vault_timeout Yes Yes Global Yes log_slow_filter Yes Yes Both Yes log_slow_rate_limit Yes Yes Both Yes log_slow_rate_type Yes Yes Global Yes log_slow_sp_statements Yes Yes Global Yes log_slow_verbosity Yes Yes Both Yes log_warnings_suppress Yes Yes Global Yes proxy_protocol_networks Yes Yes Global No query_response_time_flush Yes No Global No query_response_time_range_base Yes Yes Global Yes query_response_time_stats Yes Yes Global Yes slow_query_log_always_write_time Yes Yes Global Yes slow_query_log_use_global_control Yes Yes Global Yes thread_pool_high_prio_mode Yes Yes Both Yes thread_pool_high_prio_tickets Yes Yes Both Yes thread_pool_idle_timeout Yes Yes Global Yes thread_pool_max_threads Yes Yes Global Yes thread_pool_oversubscribe Yes Yes Global Yes thread_pool_size Yes Yes Global Yes thread_pool_stall_limit Yes Yes Global No thread_statistics Yes Yes Global Yes tokudb_alter_print_error tokudb_analyze_delete_fractionref tokudb_analyze_in_background Yes Yes Both Yes tokudb_analyze_mode Yes Yes Both Yes tokudb_analyze_throttle Yes Yes Both Yes tokudb_analyze_time Yes Yes Both Yes tokudb_auto_analyze Yes Yes Both Yes tokudb_block_size tokudb_bulk_fetch tokudb_cache_size tokudb_cachetable_pool_threads Yes Yes Global No tokudb_cardinality_scale_percent tokudb_check_jemalloc tokudb_checkpoint_lock tokudb_checkpoint_on_flush_logs tokudb_checkpoint_pool_threads Yes Yes Global No tokudb_checkpointing_period tokudb_cleaner_iterations tokudb_cleaner_period tokudb_client_pool_threads Yes Yes Global No tokudb_commit_sync tokudb_compress_buffers_before_eviction Yes Yes Global No tokudb_create_index_online tokudb_data_dir tokudb_debug tokudb_directio tokudb_disable_hot_alter tokudb_disable_prefetching tokudb_disable_slow_alter tokudb_empty_scan tokudb_enable_partial_eviction Yes Yes Global No tokudb_fanout Yes Yes Both Yes tokudb_fs_reserve_percent tokudb_fsync_log_period tokudb_hide_default_row_format tokudb_killed_time tokudb_last_lock_timeout tokudb_load_save_space tokudb_loader_memory_size tokudb_lock_timeout tokudb_lock_timeout_debug tokudb_log_dir tokudb_max_lock_memory tokudb_optimize_index_fraction tokudb_optimize_index_name tokudb_optimize_throttle tokudb_pk_insert_mode tokudb_prelock_empty tokudb_read_block_size tokudb_read_buf_size tokudb_read_status_frequency tokudb_row_format tokudb_rpl_check_readonly tokudb_rpl_lookup_rows tokudb_rpl_lookup_rows_delay tokudb_rpl_unique_checks tokudb_rpl_unique_checks_delay tokudb_strip_frm_data Yes Yes Global No tokudb_support_xa tokudb_tmp_dir tokudb_version tokudb_write_status_frequency userstat Yes Yes Global Yes version_comment Yes Yes Global Yes version_suffix Yes Yes Global Yes"},{"location":"ps-variables.html#status-variables","title":"Status variables","text":"Name Var Type Var Scope Binlog_snapshot_file String Global Binlog_snapshot_position Numeric Global Com_lock_binlog_for_backup Numeric Both Com_lock_tables_for_backup Numeric Both Com_show_client_statistics Numeric Both Com_show_index_statistics Numeric Both Com_show_table_statistics Numeric Both Com_show_thread_statistics Numeric Both Com_show_user_statistics Numeric Both Com_unlock_binlog Numeric Both Innodb_background_log_sync Numeric Global Innodb_buffer_pool_pages_LRU_flushed Numeric Global Innodb_buffer_pool_pages_made_not_young Numeric Global Innodb_buffer_pool_pages_made_young Numeric Global Innodb_buffer_pool_pages_old Numeric Global Innodb_checkpoint_age Numeric Global Innodb_checkpoint_max_age Numeric Global Innodb_ibuf_free_list Numeric Global Innodb_ibuf_segment_size Numeric Global Innodb_lsn_current Numeric Global Innodb_lsn_flushed Numeric Global Innodb_lsn_last_checkpoint Numeric Global Innodb_master_thread_active_loops Numeric Global Innodb_master_thread_idle_loops Numeric Global Innodb_max_trx_id Numeric Global Innodb_mem_adaptive_hash Numeric Global Innodb_mem_dictionary Numeric Global Innodb_oldest_view_low_limit_trx_id Numeric Global Innodb_purge_trx_id Numeric Global Innodb_purge_undo_no Numeric Global Open_tables_with_triggers Numeric Global Threadpool_idle_threads Numeric Global Threadpool_threads Numeric Global Tokudb_DB_OPENS Tokudb_DB_CLOSES Tokudb_DB_OPEN_CURRENT Tokudb_DB_OPEN_MAX Tokudb_LEAF_ENTRY_MAX_COMMITTED_XR Tokudb_LEAF_ENTRY_MAX_PROVISIONAL_XR Tokudb_LEAF_ENTRY_EXPANDED Tokudb_LEAF_ENTRY_MAX_MEMSIZE Tokudb_LEAF_ENTRY_APPLY_GC_BYTES_IN Tokudb_LEAF_ENTRY_APPLY_GC_BYTES_OUT Tokudb_LEAF_ENTRY_NORMAL_GC_BYTES_IN Tokudb_LEAF_ENTRY_NORMAL_GC_BYTES_OUT Tokudb_CHECKPOINT_PERIOD Tokudb_CHECKPOINT_FOOTPRINT Tokudb_CHECKPOINT_LAST_BEGAN Tokudb_CHECKPOINT_LAST_COMPLETE_BEGAN Tokudb_CHECKPOINT_LAST_COMPLETE_ENDED Tokudb_CHECKPOINT_DURATION Tokudb_CHECKPOINT_DURATION_LAST Tokudb_CHECKPOINT_LAST_LSN Tokudb_CHECKPOINT_TAKEN Tokudb_CHECKPOINT_FAILED Tokudb_CHECKPOINT_WAITERS_NOW Tokudb_CHECKPOINT_WAITERS_MAX Tokudb_CHECKPOINT_CLIENT_WAIT_ON_MO Tokudb_CHECKPOINT_CLIENT_WAIT_ON_CS Tokudb_CHECKPOINT_BEGIN_TIME Tokudb_CHECKPOINT_LONG_BEGIN_TIME Tokudb_CHECKPOINT_LONG_BEGIN_COUNT Tokudb_CHECKPOINT_END_TIME Tokudb_CHECKPOINT_LONG_END_TIME Tokudb_CHECKPOINT_LONG_END_COUNT Tokudb_CACHETABLE_MISS Tokudb_CACHETABLE_MISS_TIME Tokudb_CACHETABLE_PREFETCHES Tokudb_CACHETABLE_SIZE_CURRENT Tokudb_CACHETABLE_SIZE_LIMIT Tokudb_CACHETABLE_SIZE_WRITING Tokudb_CACHETABLE_SIZE_NONLEAF Tokudb_CACHETABLE_SIZE_LEAF Tokudb_CACHETABLE_SIZE_ROLLBACK Tokudb_CACHETABLE_SIZE_CACHEPRESSURE Tokudb_CACHETABLE_SIZE_CLONED Tokudb_CACHETABLE_EVICTIONS Tokudb_CACHETABLE_CLEANER_EXECUTIONS Tokudb_CACHETABLE_CLEANER_PERIOD Tokudb_CACHETABLE_CLEANER_ITERATIONS Tokudb_CACHETABLE_WAIT_PRESSURE_COUNT Tokudb_CACHETABLE_WAIT_PRESSURE_TIME Tokudb_CACHETABLE_LONG_WAIT_PRESSURE_COUNT Tokudb_CACHETABLE_LONG_WAIT_PRESSURE_TIME Tokudb_CACHETABLE_POOL_CLIENT_NUM_THREADS Tokudb_CACHETABLE_POOL_CLIENT_NUM_THREADS_ACTIVE Tokudb_CACHETABLE_POOL_CLIENT_QUEUE_SIZE Tokudb_CACHETABLE_POOL_CLIENT_MAX_QUEUE_SIZE Tokudb_CACHETABLE_POOL_CLIENT_TOTAL_ITEMS_PROCESSED Tokudb_CACHETABLE_POOL_CLIENT_TOTAL_EXECUTION_TIME Tokudb_CACHETABLE_POOL_CACHETABLE_NUM_THREADS Tokudb_CACHETABLE_POOL_CACHETABLE_NUM_THREADS_ACTIVE Tokudb_CACHETABLE_POOL_CACHETABLE_QUEUE_SIZE Tokudb_CACHETABLE_POOL_CACHETABLE_MAX_QUEUE_SIZE Tokudb_CACHETABLE_POOL_CACHETABLE_TOTAL_ITEMS_PROCESSED Tokudb_CACHETABLE_POOL_CACHETABLE_TOTAL_EXECUTION_TIME Tokudb_CACHETABLE_POOL_CHECKPOINT_NUM_THREADS Tokudb_CACHETABLE_POOL_CHECKPOINT_NUM_THREADS_ACTIVE Tokudb_CACHETABLE_POOL_CHECKPOINT_QUEUE_SIZE Tokudb_CACHETABLE_POOL_CHECKPOINT_MAX_QUEUE_SIZE Tokudb_CACHETABLE_POOL_CHECKPOINT_TOTAL_ITEMS_PROCESSED Tokudb_CACHETABLE_POOL_CHECKPOINT_TOTAL_EXECUTION_TIME Tokudb_LOCKTREE_MEMORY_SIZE Tokudb_LOCKTREE_MEMORY_SIZE_LIMIT Tokudb_LOCKTREE_ESCALATION_NUM Tokudb_LOCKTREE_ESCALATION_SECONDS Tokudb_LOCKTREE_LATEST_POST_ESCALATION_MEMORY_SIZE Tokudb_LOCKTREE_OPEN_CURRENT Tokudb_LOCKTREE_PENDING_LOCK_REQUESTS Tokudb_LOCKTREE_STO_ELIGIBLE_NUM Tokudb_LOCKTREE_STO_ENDED_NUM Tokudb_LOCKTREE_STO_ENDED_SECONDS Tokudb_LOCKTREE_WAIT_COUNT Tokudb_LOCKTREE_WAIT_TIME Tokudb_LOCKTREE_LONG_WAIT_COUNT Tokudb_LOCKTREE_LONG_WAIT_TIME Tokudb_LOCKTREE_TIMEOUT_COUNT Tokudb_LOCKTREE_WAIT_ESCALATION_COUNT Tokudb_LOCKTREE_WAIT_ESCALATION_TIME Tokudb_LOCKTREE_LONG_WAIT_ESCALATION_COUNT Tokudb_LOCKTREE_LONG_WAIT_ESCALATION_TIME Tokudb_DICTIONARY_UPDATES Tokudb_DICTIONARY_BROADCAST_UPDATES Tokudb_DESCRIPTOR_SET Tokudb_MESSAGES_IGNORED_BY_LEAF_DUE_TO_MSN Tokudb_TOTAL_SEARCH_RETRIES Tokudb_SEARCH_TRIES_GT_HEIGHT Tokudb_SEARCH_TRIES_GT_HEIGHTPLUS3 Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_BYTES Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_UNCOMPRESSED_BYTES Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_SECONDS Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_BYTES Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_UNCOMPRESSE Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_SECONDS Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_BYTES Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_UNCOMPRESSED_BYTES Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_SECONDS Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_BYTES Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_UNCOMPRESSED_BY Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_SECONDS Tokudb_LEAF_NODE_COMPRESSION_RATIO Tokudb_NONLEAF_NODE_COMPRESSION_RATIO Tokudb_OVERALL_NODE_COMPRESSION_RATIO Tokudb_NONLEAF_NODE_PARTIAL_EVICTIONS Tokudb_NONLEAF_NODE_PARTIAL_EVICTIONS_BYTES Tokudb_LEAF_NODE_PARTIAL_EVICTIONS Tokudb_LEAF_NODE_PARTIAL_EVICTIONS_BYTES Tokudb_LEAF_NODE_FULL_EVICTIONS Tokudb_LEAF_NODE_FULL_EVICTIONS_BYTES Tokudb_NONLEAF_NODE_FULL_EVICTIONS Tokudb_NONLEAF_NODE_FULL_EVICTIONS_BYTES Tokudb_LEAF_NODES_CREATED Tokudb_NONLEAF_NODES_CREATED Tokudb_LEAF_NODES_DESTROYED Tokudb_NONLEAF_NODES_DESTROYED Tokudb_MESSAGES_INJECTED_AT_ROOT_BYTES Tokudb_MESSAGES_FLUSHED_FROM_H1_TO_LEAVES_BYTES Tokudb_MESSAGES_IN_TREES_ESTIMATE_BYTES Tokudb_MESSAGES_INJECTED_AT_ROOT Tokudb_BROADCASE_MESSAGES_INJECTED_AT_ROOT Tokudb_BASEMENTS_DECOMPRESSED_TARGET_QUERY Tokudb_BASEMENTS_DECOMPRESSED_PRELOCKED_RANGE Tokudb_BASEMENTS_DECOMPRESSED_PREFETCH Tokudb_BASEMENTS_DECOMPRESSED_FOR_WRITE Tokudb_BUFFERS_DECOMPRESSED_TARGET_QUERY Tokudb_BUFFERS_DECOMPRESSED_PRELOCKED_RANGE Tokudb_BUFFERS_DECOMPRESSED_PREFETCH Tokudb_BUFFERS_DECOMPRESSED_FOR_WRITE Tokudb_PIVOTS_FETCHED_FOR_QUERY Tokudb_PIVOTS_FETCHED_FOR_QUERY_BYTES Tokudb_PIVOTS_FETCHED_FOR_QUERY_SECONDS Tokudb_PIVOTS_FETCHED_FOR_PREFETCH Tokudb_PIVOTS_FETCHED_FOR_PREFETCH_BYTES Tokudb_PIVOTS_FETCHED_FOR_PREFETCH_SECONDS Tokudb_PIVOTS_FETCHED_FOR_WRITE Tokudb_PIVOTS_FETCHED_FOR_WRITE_BYTES Tokudb_PIVOTS_FETCHED_FOR_WRITE_SECONDS Tokudb_BASEMENTS_FETCHED_TARGET_QUERY Tokudb_BASEMENTS_FETCHED_TARGET_QUERY_BYTES Tokudb_BASEMENTS_FETCHED_TARGET_QUERY_SECONDS Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE_BYTES Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE_SECONDS Tokudb_BASEMENTS_FETCHED_PREFETCH Tokudb_BASEMENTS_FETCHED_PREFETCH_BYTES Tokudb_BASEMENTS_FETCHED_PREFETCH_SECONDS Tokudb_BASEMENTS_FETCHED_FOR_WRITE Tokudb_BASEMENTS_FETCHED_FOR_WRITE_BYTES Tokudb_BASEMENTS_FETCHED_FOR_WRITE_SECONDS Tokudb_BUFFERS_FETCHED_TARGET_QUERY Tokudb_BUFFERS_FETCHED_TARGET_QUERY_BYTES Tokudb_BUFFERS_FETCHED_TARGET_QUERY_SECONDS Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE_BYTES Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE_SECONDS Tokudb_BUFFERS_FETCHED_PREFETCH Tokudb_BUFFERS_FETCHED_PREFETCH_BYTES Tokudb_BUFFERS_FETCHED_PREFETCH_SECONDS Tokudb_BUFFERS_FETCHED_FOR_WRITE Tokudb_BUFFERS_FETCHED_FOR_WRITE_BYTES Tokudb_BUFFERS_FETCHED_FOR_WRITE_SECONDS Tokudb_LEAF_COMPRESSION_TO_MEMORY_SECONDS Tokudb_LEAF_SERIALIZATION_TO_MEMORY_SECONDS Tokudb_LEAF_DECOMPRESSION_TO_MEMORY_SECONDS Tokudb_LEAF_DESERIALIZATION_TO_MEMORY_SECONDS Tokudb_NONLEAF_COMPRESSION_TO_MEMORY_SECONDS Tokudb_NONLEAF_SERIALIZATION_TO_MEMORY_SECONDS Tokudb_NONLEAF_DECOMPRESSION_TO_MEMORY_SECONDS Tokudb_NONLEAF_DESERIALIZATION_TO_MEMORY_SECONDS Tokudb_PROMOTION_ROOTS_SPLIT Tokudb_PROMOTION_LEAF_ROOTS_INJECTED_INTO Tokudb_PROMOTION_H1_ROOTS_INJECTED_INTO Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_0 Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_1 Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_2 Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_3 Tokudb_PROMOTION_INJECTIONS_LOWER_THAN_DEPTH_3 Tokudb_PROMOTION_STOPPED_NONEMPTY_BUFFER Tokudb_PROMOTION_STOPPED_AT_HEIGHT_1 Tokudb_PROMOTION_STOPPED_CHILD_LOCKED_OR_NOT_IN_MEMORY Tokudb_PROMOTION_STOPPED_CHILD_NOT_FULLY_IN_MEMORY Tokudb_PROMOTION_STOPPED_AFTER_LOCKING_CHILD Tokudb_BASEMENT_DESERIALIZATION_FIXED_KEY Tokudb_BASEMENT_DESERIALIZATION_VARIABLE_KEY Tokudb_PRO_RIGHTMOST_LEAF_SHORTCUT_SUCCESS Tokudb_PRO_RIGHTMOST_LEAF_SHORTCUT_FAIL_POS Tokudb_RIGHTMOST_LEAF_SHORTCUT_FAIL_REACTIVE Tokudb_CURSOR_SKIP_DELETED_LEAF_ENTRY Tokudb_FLUSHER_CLEANER_TOTAL_NODES Tokudb_FLUSHER_CLEANER_H1_NODES Tokudb_FLUSHER_CLEANER_HGT1_NODES Tokudb_FLUSHER_CLEANER_EMPTY_NODES Tokudb_FLUSHER_CLEANER_NODES_DIRTIED Tokudb_FLUSHER_CLEANER_MAX_BUFFER_SIZE Tokudb_FLUSHER_CLEANER_MIN_BUFFER_SIZE Tokudb_FLUSHER_CLEANER_TOTAL_BUFFER_SIZE Tokudb_FLUSHER_CLEANER_MAX_BUFFER_WORKDONE Tokudb_FLUSHER_CLEANER_MIN_BUFFER_WORKDONE Tokudb_FLUSHER_CLEANER_TOTAL_BUFFER_WORKDONE Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_STARTED Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_RUNNING Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_COMPLETED Tokudb_FLUSHER_CLEANER_NUM_DIRTIED_FOR_LEAF_MERGE Tokudb_FLUSHER_FLUSH_TOTAL Tokudb_FLUSHER_FLUSH_IN_MEMORY Tokudb_FLUSHER_FLUSH_NEEDED_IO Tokudb_FLUSHER_FLUSH_CASCADES Tokudb_FLUSHER_FLUSH_CASCADES_1 Tokudb_FLUSHER_FLUSH_CASCADES_2 Tokudb_FLUSHER_FLUSH_CASCADES_3 Tokudb_FLUSHER_FLUSH_CASCADES_4 Tokudb_FLUSHER_FLUSH_CASCADES_5 Tokudb_FLUSHER_FLUSH_CASCADES_GT_5 Tokudb_FLUSHER_SPLIT_LEAF Tokudb_FLUSHER_SPLIT_NONLEAF Tokudb_FLUSHER_MERGE_LEAF Tokudb_FLUSHER_MERGE_NONLEAF Tokudb_FLUSHER_BALANCE_LEAF Tokudb_HOT_NUM_STARTED Tokudb_HOT_NUM_COMPLETED Tokudb_HOT_NUM_ABORTED Tokudb_HOT_MAX_ROOT_FLUSH_COUNT Tokudb_TXN_BEGIN Tokudb_TXN_BEGIN_READ_ONLY Tokudb_TXN_COMMITS Tokudb_TXN_ABORTS Tokudb_LOGGER_NEXT_LSN Tokudb_LOGGER_WRITES Tokudb_LOGGER_WRITES_BYTES Tokudb_LOGGER_WRITES_UNCOMPRESSED_BYTES Tokudb_LOGGER_WRITES_SECONDS Tokudb_LOGGER_WAIT_LONG Tokudb_LOADER_NUM_CREATED Tokudb_LOADER_NUM_CURRENT Tokudb_LOADER_NUM_MAX Tokudb_MEMORY_MALLOC_COUNT Tokudb_MEMORY_FREE_COUNT Tokudb_MEMORY_REALLOC_COUNT Tokudb_MEMORY_MALLOC_FAIL Tokudb_MEMORY_REALLOC_FAIL Tokudb_MEMORY_REQUESTED Tokudb_MEMORY_USED Tokudb_MEMORY_FREED Tokudb_MEMORY_MAX_REQUESTED_SIZE Tokudb_MEMORY_LAST_FAILED_SIZE Tokudb_MEM_ESTIMATED_MAXIMUM_MEMORY_FOOTPRINT Tokudb_MEMORY_MALLOCATOR_VERSION Tokudb_MEMORY_MMAP_THRESHOLD Tokudb_FILESYSTEM_THREADS_BLOCKED_BY_FULL_DISK Tokudb_FILESYSTEM_FSYNC_TIME Tokudb_FILESYSTEM_FSYNC_NUM Tokudb_FILESYSTEM_LONG_FSYNC_TIME Tokudb_FILESYSTEM_LONG_FSYNC_NUM"},{"location":"ps-versions-comparison.html","title":"List of features available in Percona Server for MySQL releases","text":"Percona Server for MySQL 5.7 Percona Server for MySQL 8.0 Improved Buffer Pool Scalability Improved Buffer Pool Scalability Improved InnoDB I/O Scalability Improved InnoDB I/O Scalability Multiple Adaptive Hash Search Partitions Multiple Adaptive Hash Search Partitions Atomic write support for Fusion-io devices Atomic write support for Fusion-io devices Query Cache Enhancements Feature not implemented Improved NUMA support Improved NUMA support Thread Pool Thread Pool Suppress Warning Messages Suppress Warning Messages Ability to change the database for mysqlbinlog Ability to change the database for mysqlbinlog Fixed Size for the Read Ahead Area Fixed Size for the Read Ahead Area Improved MEMORY Storage Engine Improved MEMORY Storage Engine Restricting the number of binlog files Restricting the number of binlog files Ignoring missing tables in mysqldump Ignoring missing tables in mysqldump Too Many Connections Warning Too Many Connections Warning Handle Corrupted Tables Handle Corrupted Tables Lock-Free SHOW SLAVE STATUS Lock-Free SHOW REPLICA STATUS Expanded Fast Index Creation Expanded Fast Index Creation Percona Toolkit UDFs Percona Toolkit UDFs Support for Fake Changes Support for Fake Changes Kill Idle Transactions Kill Idle Transactions XtraDB changed page tracking XtraDB changed page tracking Enforcing Storage Engine Replaced with upstream implementation Utility user Utility user Extending the secure-file-priv server option Extending the secure-file-priv server option Expanded Program Option Modifiers Feature not implemented PAM Authentication Plugin PAM Authentication Plugin Log Archiving for XtraDB Log Archiving for XtraDB User Statistics User Statistics Slow Query Log Slow Query Log Count InnoDB Deadlocks Count InnoDB Deadlocks Log All Client Commands (syslog) Log All Client Commands (syslog) Response Time Distribution Feature not implemented Show Storage Engines Show Storage Engines Show Lock Names Show Lock Names Process List Process List Misc. INFORMATION_SCHEMA Tables Misc. INFORMATION_SCHEMA Tables Extended Show Engine InnoDB Status Extended Show Engine InnoDB Status Thread Based Profiling Thread Based Profiling XtraDB Performance Improvements for I/O-Bound Highly-Concurrent Workloads XtraDB Performance Improvements for I/O-Bound Highly-Concurrent Workloads Page cleaner thread tuning Page cleaner thread tuning Statement Timeout Statement Timeout Extended SELECT INTO OUTFILE/DUMPFILE Extended SELECT INTO OUTFILE/DUMPFILE Per-query variable statement Per-query variable statement Extended mysqlbinlog Extended mysqlbinlog Slow Query Log Rotation and Expiration Slow Query Log Rotation and Expiration Metrics for scalability measurement Feature not implemented Audit Log Audit Log Backup Locks Backup Locks CSV engine mode for a standard-compliant quote and comma parsing CSV engine mode for a standard-compliant quote and comma parsing Super read-only Super read-only"},{"location":"ps-versions-comparison.html#other-reading","title":"Other reading","text":"<ul> <li> <p>What Is New in MySQL 5.7</p> </li> <li> <p>What Is New in MySQL 8.0</p> </li> </ul>"},{"location":"query-limit-records.html","title":"Limit the estimation of records in a Query","text":"<p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>This page describes an alternative when running queries against a large number of table partitions. When a query runs, InnoDB estimates the records in each partition. This process can result in more pages read and more disk I/O, if the buffer pool must fetch the pages from disk. This process increases the query time if there are a large number of partitions.</p> <p>The addition of two variables makes it possible to override records_in_range which effectively bypasses the process.</p> <p>Warning</p> <p>The use of these variables may result in improper index selection by the optimizer.</p>"},{"location":"query-limit-records.html#innodb_records_in_range","title":"<code>innodb_records_in_range</code>","text":"Option Description Command-line: <code>--innodb-records-in-range</code> Scope: Global Dynamic: Yes Data type: Numeric Default 0 <p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>The variable provides a method to limit the number of records estimated for a query.</p> <pre><code>mysql&gt; SET @@GLOBAL.innodb_records_in_range=100;\n100\n</code></pre>"},{"location":"query-limit-records.html#innodb_force_index_records_in_range","title":"<code>innodb_force_index_records_in_range</code>","text":"Option Description Command-line: <code>--innodb-force-index-records-in-range</code> Scope: Global Dynamic: Yes Data type: Numeric Default 0 <p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>This variable provides a method to override the records_in_range result when a FORCE INDEX is used in a query.</p> <pre><code>mysql&gt; SET @@GLOBAL.innodb_force_index_records_in_range=100;\n100\n</code></pre>"},{"location":"query-limit-records.html#using-the-favor_range_scan-optimizer-switch","title":"Using the favor_range_scan optimizer switch","text":"<p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>In specific scenarios, the optimizer chooses to scan a table instead of using a range scan. The conditions are the following:</p> <ul> <li> <p>Table with an extremely large number of rows</p> </li> <li> <p>Compound primary keys made of two or more columns</p> </li> <li> <p>WHERE clause contains multiple range conditions</p> </li> </ul> <p>The optimizer_switch controls the optimizer behavior. The favor_range_scan switch arbitrarily lowers the cost of a range scan by a factor of 10.</p> <p>The available values are:</p> <ul> <li> <p>ON</p> </li> <li> <p>OFF (Default)</p> </li> <li> <p>DEFAULT</p> </li> </ul> <pre><code>mysql&gt; SET optimizer_switch='favor_range_scan=on';\n</code></pre>"},{"location":"quickstart-overview.html","title":"Quickstart guide for Percona Server for MySQL","text":"<p>Percona Server for MySQL is a freely available, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior and optimized performance, greater scalability and availability, enhanced backups, increased visibility, and instrumentation. Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads.</p>"},{"location":"quickstart-overview.html#install-percona-server-for-mysql","title":"Install Percona Server for MySQL","text":"<p>You can install Percona Server for MySQL using different methods. </p> <ul> <li>Use the Percona Repositories</li> <li>Use APT</li> <li>Use YUM</li> <li>Use binary tarballs</li> <li>Use Docker</li> </ul>"},{"location":"quickstart-overview.html#for-backups-and-restores","title":"For backups and restores","text":"<p>Percona XtraBackup (PXB) is a 100% open source backup solution for all versions of Percona Server for MySQL and MySQL\u00ae that performs online non-blocking, tightly compressed, highly secure full backups on transactional systems. Maintain fully available applications during planned maintenance windows with Percona XtraBackup.</p> <p>Install Percona XtraBackup</p>"},{"location":"quickstart-overview.html#for-monitoring-and-management","title":"For Monitoring and Management","text":"<p>Percona Monitoring and Management (PMM )monitors and provides actionable performance data for MySQL variants, including Percona Server for MySQL, Percona XtraDB Cluster, Oracle MySQL Community Edition, Oracle MySQL Enterprise Edition, and MariaDB. PMM captures metrics and data for the InnoDB, XtraDB, and MyRocks storage engines, and has specialized dashboards for specific engine details.</p> <p>Install PMM and connect your MySQL instances to it.</p>"},{"location":"quickstart-overview.html#for-high-availability","title":"For high availability","text":"<p>Percona XtraDB Cluster (PXC) is a 100% open source, enterprise-grade, highly available clustering solution for MySQL multi-master setups based on Galera. PXC helps enterprises minimize unexpected downtime and data loss, reduce costs, and improve performance and scalability of your database environments supporting your critical business applications in the most demanding public, private, and hybrid cloud environments.</p> <p>Percona XtraDB Cluster Quick start guide</p>"},{"location":"reading-audit-log-filter-files.html","title":"Reading Audit Log Filter files","text":"<p>The feature is in tech preview.</p> <p>The Audit Log Filter functions can provide a SQL interface to read JSON-format audit log files. The functions cannot read log files in other formats. Configuring the plugin for JSON logging lets the functions use the directory that contains the current audit log filter file and search in that location for readable files. The value of the <code>audit_log_filter_file</code> system variable provides the file location, base name, and the suffix and then searches for names that match the pattern.</p> <p>If the file is renamed and no longer fits the pattern, the file is ignored.</p>"},{"location":"reading-audit-log-filter-files.html#functions-used-for-reading-the-files","title":"Functions used for reading the files","text":"<p>The following functions read the files in the JSON-format:</p> <ul> <li><code>audit_log_read</code> - reads audit log filter events</li> <li>[<code>audit_log_read_bookmark()](audit-log-filter-variables.md#audit_log_read_bookmark) - for the most recently read event, returns a bookmark. The bookmark can be passed to</code>audit_log_read()`.</li> </ul> <p>Initialize a read sequence by using a bookmark or an argument that specifies the start position:</p> <pre><code>mysql&gt; SELECT audit_log_read(audit_log_read_bookmark());\n\nThe following example continues reading from the current position:\n\n```{.bash data-prompt=\"mysql&gt;\"}\nmysql&gt; SELECT audit_log_read();\n</code></pre> <p>Reading a file is closed when the session ends or calling <code>audit_log_read()</code> with another argument.</p>"},{"location":"removing-tokudb.html","title":"Migrate and remove the TokuDB storage engine","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p>"},{"location":"removing-tokudb.html#migrating-the-data-to-myrocks-storage-engine","title":"Migrating the data to MyRocks Storage Engine","text":"<p>To migrate data use the mysqldump client utility or the tools in the MySQL Workbench to dump and restore the database.</p> <p>We recommended migrating to the MyRocks storage engine. Follow these steps to migrate the data:</p> <ol> <li> <p>Use mysqldump to backup the TokuDB database into a single file.</p> </li> <li> <p>Create a MyRocks instance with MyRocks tables with no data.</p> </li> <li> <p>Replace the references to TokuDB with MyRocks.</p> </li> <li> <p>Enable the following variable: rocksdb_bulk_load. This variable also enables rocksdb_commit_in_the_middle.</p> </li> <li> <p>Import the data into the MyRocks database.</p> </li> </ol> <p>Follow the Removing the plugins steps.</p>"},{"location":"removing-tokudb.html#migrating-from-tokudb-to-innodb","title":"Migrating from TokuDB to InnoDB","text":"<p>In case you want remove the TokuDB storage engine from Percona Server for MySQL without causing any errors following is the recommended procedure:</p>"},{"location":"removing-tokudb.html#change-the-tables-from-tokudb-to-innodb","title":"Change the tables from TokuDB to InnoDB","text":"<p>If you still need the data in the TokuDB tables you must alter the tables to other supported storage engine i.e., InnoDB: <code>ALTER TABLE City ENGINE=InnoDB;</code></p> <p>Note</p> <p>Do not remove the TokuDB storage engine before you\u2019ve changed your tables to the other supported storage engine. Otherwise, you will not be able to access that data without reinstalling the TokuDB storage engine.</p>"},{"location":"removing-tokudb.html#removing-the-plugins","title":"Removing the plugins","text":"<p>To remove the TokuDB storage engine with all installed plugins you can use the ps-admin script:</p> <pre><code>$ ps-admin --disable-tokudb -uroot -pPassw0rd\n</code></pre> <p>Script output should look like this:</p> <p>Another option is to manually remove the TokuDB storage engine with all installed plugins:</p> <pre><code>msql&gt; UNINSTALL PLUGIN tokudb;\nmsql&gt; UNINSTALL PLUGIN tokudb_file_map;\nmsql&gt; UNINSTALL PLUGIN tokudb_fractal_tree_info;\nmsql&gt; UNINSTALL PLUGIN tokudb_fractal_tree_block_map;\nmsql&gt; UNINSTALL PLUGIN tokudb_trx;\nmsql&gt; UNINSTALL PLUGIN tokudb_locks;\nmsql&gt; UNINSTALL PLUGIN tokudb_lock_waits;\nmsql&gt; UNINSTALL PLUGIN tokudb_background_job_status;\n</code></pre> <p>After the engine and the plugins have been uninstalled you can remove the TokuDB package by using the apt/yum commands:</p> <pre><code>[root@centos ~]# yum remove Percona-Server-tokudb-80.x86_64\n</code></pre> <p>or <code>apt remove percona-server-tokudb-8.0</code></p> <p>Note</p> <p>Make sure you\u2019ve removed all the TokuDB specific variables from your configuration file (<code>my.cnf</code>) before you restart the server, otherwise server could show errors or warnings and won\u2019t be able to start.</p>"},{"location":"rotating-master-key.html","title":"Rotate the master key","text":"<p>The Master key should be periodically rotated. Rotate the key if you believe the key has been compromised. The Master key rotation changes the Master key and tablespace keys are re-encrypted and updated in the tablespace headers. The operation does not affect tablespace data.</p> <p>If the master key rotation is interrupted, the rotation operation is rolled forward when the server restarts. InnoDB reads the encryption data from the tablespace header, if certain tablespace keys have been encrypted with the prior master key, InnoDB retrieves the master key from the keyring to decrypt the tablespace key. InnoDB re-encrypts the tablespace key with the new Master key.</p> <p>To allow for Master Key rotation, you can encrypt an already encrypted InnoDB system tablespace with a new master key by running the following <code>ALTER INSTANCE</code> statement:</p> <pre><code>mysql&gt; ALTER INSTANCE ROTATE INNODB MASTER KEY;\n</code></pre> <p>The rotation operation must complete before any tablespace encryption operation can begin.</p> <p>Note</p> <p>The rotation re-encrypts each tablespace key. The tablespace key is not changed. If you want to change a tablespace key, disable and then re-enable encryption.</p>"},{"location":"secure-log-path-variable.html","title":"The secure_log_path variable","text":"<p>Use system variables to configure the server operation.</p>"},{"location":"secure-log-path-variable.html#secure_log_path","title":"secure_log_path","text":"<p>Implemented in Percona Server for MySQL 8.0.28-19 (2022-05-12).</p> Variable Name Description Command-line \u2013secure-log-path Dynamic No Scope Global Data type String Default empty string <p>This variable restricts the dynamic log file locations. The variable is read-only and must be set up in a configuration file or the command line.</p> <p>The accepted value is the directory name as a string. The default value is an empty string. When the value is an empty string, the variable only adds a warning to the error log and does nothing. If the value contains a directory name, then the slow query log and the general log must be located in that directory. An attempt to move either of these files outside of the specified directory results in an error.</p>"},{"location":"selinux.html","title":"Working with SELinux","text":"<p>The Linux kernel, through the Linux Security Module (LSM), supports Security-Enhanced Linux (SELinux). This module provides a way to support mandatory access control policies. SELinux defines how confined processes interact with files, network ports, directories, other processes, and additional server components.</p> <p>An SELinux policy defines the set of rules, the <code>types</code> for files, and the <code>domains</code> for processes. Rules determine how a process interacts with another type. SELinux decides whether to allow or deny an action based on the subject\u2019s context, what object initiates the action and what object is the action\u2019s target.</p> <p>A label represents the context for administrators and users.</p> <p>CentOS 7 and CentOS 8 contain a MySQL SELinux policy. Percona Server for MySQL is a drop-in replacement for MySQL and can use this policy without changes.</p>"},{"location":"selinux.html#selinux-context-example","title":"SELinux context example","text":"<p>To view the SELinux context, add the <code>-Z</code> switch to many of the utilities. Here is an example of the context for <code>mysqld</code>:</p> <pre><code>$ ps -eZ | grep mysqld_t\n</code></pre> Expected output <pre><code>system_u:system_r:mysqld_t:s0    3356 ?        00:00:01 mysqld\n</code></pre> <p>The context has the following properties:</p> <ul> <li> <p>User - system_u</p> </li> <li> <p>Role - system_r</p> </li> <li> <p>Type or domain - mysqld_t</p> </li> <li> <p>Sensitivity level - s0    3356</p> </li> </ul> <p>Most SELinux policy rules are based on the type or domain.</p>"},{"location":"selinux.html#list-selinux-types-or-domains-associated-with-files","title":"List SELinux types or domains associated with files","text":"<p>The security property that SELinux relies on is the Type security property. The type name often end with a <code>_t</code>. A group of objects with the same type security value belongs to the same domain.</p> <p>To view the <code>mysqldb_t</code> types associated with the MySQL directories and files, run the following command:</p> <pre><code>$ ls -laZ /var/lib/ | grep mysql\n</code></pre> Expected output <pre><code>drwxr-x--x. mysql   mysql   system_u:object_r:mysqld_db_t:s0 mysql\ndrwxr-x---. mysql   mysql   system_u:object_r:mysqld_db_t:s0 mysql-files\ndrwxr-x---. mysql   mysql   system_u:object_r:mysqld_db_t:s0 mysql-keyring\n</code></pre> <p>Note</p> <p>If a policy type does not define the type property for an object, the default value is <code>unconfined_t</code>.</p>"},{"location":"selinux.html#selinux-modes","title":"SELinux modes","text":"<p>SELinux has the following modes:</p> <ul> <li> <p>Disabled - No SELinux policy modules loaded, which disables policies. Nothing is reported.</p> </li> <li> <p>Permissive - SELinux is active, but policy modules are not enforced. A policy violation is reported but does not stop the action.</p> </li> <li> <p>Enforcing - SELinux is active, and violations are reported and denied. If there is no rule to allow access to a confined resource, SELinux denies the access.</p> </li> </ul>"},{"location":"selinux.html#policy-types","title":"Policy types","text":"<p>SELinux has several policy types:</p> <ul> <li> <p>Targeted - Most processes operate without restriction. Specific services are contained in security domains and defined by policies.</p> </li> <li> <p>Strict - All processes are contained in security domains and defined by policies.</p> </li> </ul> <p>SELinux has confined processes that run in a domain and restricts everything unless explicitly allowed. An unconfined process in an unconfined domain is allowed almost all access.</p> <p>MySQL is a confined process, and the policy module defines which files are read, which ports are opened, and so on. SELinux assumes the Percona Server for MySQL installation uses the default file locations and default ports.</p> <p>If you change the default, you must also edit the policy. If you do not update the policy, SELinux, in enforcing mode, denies access to all non-default resources.</p>"},{"location":"selinux.html#check-the-selinux-mode","title":"Check the SELinux mode","text":"<p>To check the current SELinux mode, use either of the following commands:</p> <pre><code>$ sestatus\n</code></pre> Expected output <pre><code>SELinux status:                 enabled\nSELinuxfs mount:                /sys/fs/selinux\nSELinux root directory:         /etc/selinux\nLoaded policy name:             targeted\nCurrent mode:                   enforcing\nMode from config file:          enforcing\nPolicy MLS status:              enabled\nPolicy deny_unknown status:     allowed\nMemory protection checking:     actual (secure)\nMax kernel policy version:      31\n</code></pre> <p>or</p> <pre><code>$ grep ^SELINUX= /etc/selinux/config\n</code></pre> Expected output <pre><code>SELINUX=enforcing\n</code></pre> <p>Note</p> <p>Add the <code>-b</code> parameter to <code>sestatus</code> to display the <code>Policy booleans</code>. The boolean values for each parameter is shown. An example of using the <code>b</code> parameter is the following:</p> <pre><code>$ sestatus -b | grep mysql\n</code></pre> Expected output <pre><code>mysql_connect_any                           off\nselinuxuser_mysql_connect_enabled\n</code></pre> <p>The <code>/etc/selinux/config</code> file controls if SELinux is disabled or enabled, and if enabled, whether SELinux operates in enforcing mode or permissive mode.</p>"},{"location":"selinux.html#disable-selinux","title":"Disable SELinux","text":"<p>If you plan to use the enforcing mode at another time, use the permissive mode instead of disabling SELinux. During the time that SELinux is disabled, the system may contain mislabeled objects or objects with no label. If you re-enable SELinux and plan to set SELinux to enforcing, you must follow the steps to Relabel the entire file system.</p> <p>On boot, to disable SELinux, set the <code>selinux=0</code> kernel option. The kernel does not load the SELinux infrastructure. This option has the same effect as changing the <code>SELINUX=disabled</code> instruction in the configuration file and then rebooting the system.</p>"},{"location":"selinux.html#additional-selinux-tools","title":"Additional SELinux tools","text":"<p>Install the SELinux management tools, such as <code>semanage</code> or <code>sesearch</code>, if needed.</p> <p>On RHEL 7 or compatible operating systems, use the following command as root:</p> <pre><code>$ yum -y install policycoreutils-python\n</code></pre> <p>On RHEL 8 or compatible operating systems, use the following command as root:</p> <pre><code>$ yum -y install policycoreutils-python-utils\n</code></pre> <p>Note</p> <p>You may need root privileges to run SELinux management commands.</p>"},{"location":"selinux.html#switch-the-mode-in-the-configuration-file","title":"Switch the mode in the configuration file","text":"<p>Switching between modes may help when troubleshooting or when modifying rules.</p> <p>To permanently change the mode, edit the <code>/etc/selinux/config</code> file and change the <code>SELINUX=</code> value. You should also verify the change.</p> <pre><code>$ cat /etc/selinux/config | grep SELINUX= | grep -v ^#\n</code></pre> Expected output <pre><code>SELINUX=enforcing\nSELINUX=enforcing\n</code></pre> <pre><code>$ sudo sed -i 's/^SELINUX=.*/SELINUX=permissive/g' /etc/selinux/config\n\n$ cat /etc/selinux/config | grep SELINUX= | grep -v ^#\n</code></pre> Expected output <pre><code>SELINUX=permissive\nSELINUX=permissive\n</code></pre> <p>Reboot your system after the change.</p> <p>If switching from either disabled mode or permissive mode to enforcing, see Relabel the entire file system.</p>"},{"location":"selinux.html#switch-the-mode-until-the-next-reboot","title":"Switch the mode until the next reboot","text":"<p>To change the mode until the next reboot, use either of the following commands as root:</p> <pre><code>$ setenforce Enforcing\n</code></pre> <p>or</p> <pre><code>$ setenforce 1\n</code></pre> <p>The following <code>setenforce</code> parameters are available:</p> setenforce parameters Also Permitted 0 Permissive 1 Enforcing <p>You can view the current mode by running either of the following commands:</p> <pre><code>$ getenforce\n</code></pre> Expected output <pre><code>Enforcing\n</code></pre> <p>or</p> <pre><code>$ sestatus | grep -i mode\n</code></pre> Expected output <pre><code>Current mode:                   permissive\nMode from config file:          enforcing\n</code></pre>"},{"location":"selinux.html#switch-the-mode-for-a-service","title":"Switch the mode for a service","text":"<p>You can move one or more services into a permissive domain. The other services remain in enforcing mode.</p> <p>To add a service to the permissive domain, run the following as root:</p> <pre><code>$ sudo semanage permissive -a mysqld_t\n</code></pre> <p>To list the current permissive domains, run the following command:</p> <pre><code>$ sudo semanage permissive -l\n</code></pre> Expected output <pre><code>...\nCustomized Permissive Types\n\nmysqld_t\n\nBuiltin Permissive Types\n...\n</code></pre> <p>To delete a service from the permissive domain, run the following:</p> <pre><code>$ sudo semanage permissive -d mysqld_t\n</code></pre> <p>The service returns to the system\u2019s SELinux mode. Be sure to follow the steps to Relabel the entire file system.</p>"},{"location":"selinux.html#relabel-the-entire-file-system","title":"Relabel the entire file system","text":"<p>Switching from disabled or permissive to enforcing requires additional steps. The enforcing mode requires the correct contexts, or labels, to function. The permissive mode allows users and processes to label files and system objects incorrectly. The disabled mode does not load the SELinux infrastructure and does not label resources or processes.</p> <p>RHEL and compatible systems, use the <code>fixfiles</code> application for relabeling. You can relabel the entire file system or the file contexts of an application.</p> <p>For one application, run the following command:</p> <pre><code>$ fixfiles -R mysqld restore\n</code></pre> <p>To relabel the file system without rebooting the system, use the following command:</p> <pre><code>$ fixfiles -f -F relabel\n</code></pre> <p>Another option relabels the file system during a reboot. You can either add a touch file, read during the reboot operation, or configure a kernel boot parameter. The completion of the relabeling operation automatically removes the touch file.</p> <p>Add the touch file as root:</p> <pre><code>$ touch /.autorelabel\n</code></pre> <p>To configure the kernel, add the <code>autorelabel=1</code> kernel parameter to the boot parameter list. The parameter forces a system relabel. Reboot in permissive mode to allow the process to complete before changing to enforcing.</p> <p>Note</p> <p>Relabeling an entire filesystem takes time. When the relabeling is complete, the system reboots again.</p>"},{"location":"selinux.html#set-a-custom-data-directory","title":"Set a custom data directory","text":"<p>If you do not use the default settings, SELinux, in enforcing mode, prevents access to the system.</p> <p>For example, during installation, you have used the following configuration:</p> <pre><code>datadir=/var/lib/mysqlcustom\nsocket=/var/lib/mysqlcustom/mysql.sock\n</code></pre> <p>Restart the service.</p> <pre><code>$ service mysqld restart\n</code></pre> Expected output <pre><code>Redirecting to /bin/systemctl restart mysqld.service\nJob for mysqld.service failed because the control process exited with error code.\nSee \"systemctl status mysqld.service\" and \"journalctl -xe\" for details.\n</code></pre> <p>Check the journal log to see the error code.</p> <pre><code>$ journalctl -xe\n</code></pre> Expected output <pre><code>...\nSELinux is preventing mysqld from getattr access to the file /var/lib/mysqlcustom/ibdata1.\n...\n</code></pre> <p>Check the SELinux types in <code>/var/lib/mysqlcustom</code>.</p> <pre><code>ls -1aZ /var/lib/mysqlcustom\n</code></pre> Expected output <pre><code>  total 164288\n  drwxr-x--x.  6 mysql mysql system_u:object_r:var_lib_t:s0       4096 Dec  2 07:58  .\n  drwxr-xr-x. 38 root  root  system_u:object_r:var_lib_t:s0       4096 Dec  1 14:29  ..\n  ...\n  -rw-r-----.  1 mysql mysql system_u:object_r:var_lib_t:s0   12582912 Dec  1 14:29  ibdata1\n  ...\n</code></pre> <p>To solve the issue, use the following methods:</p> <ul> <li> <p>Set the proper labels for <code>mysqlcustom</code> files</p> </li> <li> <p>Change the mysqld SELinux policy to allow mysqld access to <code>var_lib_t</code> files.</p> </li> </ul> <p>The recommended solution is to set the proper labels. The following procedure assumes you have already created and set ownership to the custom data directory location:</p> <ol> <li> <p>To change the SELinux context, use <code>semanage fcontext</code>. In this step, you define how SELinux deals with the custom paths:</p> <pre><code>$ semanage fcontext -a -e /var/lib/mysql /var/lib/mysqlcustom\n</code></pre> <p>SELinux applies the same labeling schema, defined in the mysqld policy, for the <code>/var/lib/mysql</code> directory to the custom directory. Files created within the custom directory are labeled as if they were in <code>/var/lib/mysql</code>.</p> </li> <li> <p>To <code>restorecon</code> command applies the change.</p> <pre><code>$ restorecon -R -v /var/lib/mysqlcustom\n</code></pre> </li> <li> <p>Restart the mysqld service:</p> <pre><code>$ service mysqld start\n</code></pre> </li> </ol>"},{"location":"selinux.html#set-a-custom-log-location","title":"Set a custom log location","text":"<p>If you do not use the default settings, SELinux, in enforcing mode, prevents access to the location. Change the log location to a custom location in my.cnf:</p> <pre><code>log-error=/logs/mysqld.log\n</code></pre> <p>Verify the log location with the following command:</p> <pre><code>$ ls -laZ /\n</code></pre> Expected output <pre><code>  ...\n  drwxrwxrwx.   2 root root unconfined_u:object_r:default_t:s0    6 Dec  2 09:16 logs\n  ...\n</code></pre> <p>Starting MySQL returns the following message:</p> <pre><code>$ service mysql start\n</code></pre> Expected output <pre><code>Redirecting to /bin/systemctl start mysql.service\nJob for mysqld.service failed because the control process exited with error code.\nSee \"systemctl status mysqld.service\" and \"journalctl -xe\" for details.\n\n$ journalctl -xe\n...\nSELinux is preventing mysqld from write access to the directory logs.\n...\n</code></pre> <p>The default SELinux policy allows mysqld to write logs into a location tagged with <code>var_log_t</code>, which is the <code>/var/log</code> location. You can solve the issue with either of the following methods:</p> <ul> <li> <p>Tag the <code>/logs</code> location properly</p> </li> <li> <p>Edit the SELinux policy to allow mysqld access to all directories.</p> </li> </ul> <p>To tag the custom <code>/logs</code> location is the recommended method since it locks down access. Run the following commands to tag the custom location:</p> <pre><code>$ semanage fcontext -a -t var_log_t /logs\n$ restorecon -v /logs\n</code></pre> <p>You may not be able to change the <code>/logs</code> directory label. For example, other applications, with their own rules, use the same directory.</p> <p>To adjust the SELinux policy when a directory is shared, follow these steps:</p> <ol> <li> <p>Create a local policy:</p> <pre><code>ausearch -c 'mysqld' --raw | audit2allow -M my-mysqld\n</code></pre> </li> <li> <p>This command generates the my-mysqld.te and the my-mysqld.pp files. The mysqld.te is the type enforcement policy file. The my-mysqld.pp is the policy module loaded as a binary file into the SELinux subsystem.</p> <p>An example of the my-myslqd.te file:</p> <pre><code>module my-mysqld 1.0;\n\nrequire {\n    *type mysqld_t*;\n    type var_lib_t;\n    *type default_t*;\n    class file getattr;\n    *class dir write*;\n}\n\n============= mysqld_t ==============\n*allow mysqld_t default_t:dir write*;\nallow mysqld_t var_lib_t:file getattr;\n</code></pre> <p>The policy contains rules for the custom data directory and the custom logs directory. We have set the proper labels for the data directory location, and applying this auto-generated policy would loosen our hardening by allowing mysqld to access <code>var_lib_t</code> tags.</p> </li> <li> <p>SELinux-generated events are converted to rules. A generated policy may contain rules for recent violations and include unrelated rules. Unrelated rules are generated from actions, such as changing the data directory location, that are not related to the logs directory. Add the <code>--start</code> parameter to use log events after a specific time to filter out the unwanted events. This parameter captures events when the time stamp is equal to the specified time or later. SELinux generates a policy for the current actions.</p> <pre><code>$ ausearch --start 10:00:00 -c 'mysqld' --raw | audit2allow -M my-mysqld\n</code></pre> </li> <li> <p>This policy allows mysqld writing into the tagged directories. Open the my_mysqld file:</p> <pre><code>module my-mysqld 1.0;\n\nrequire {\n    type mysqld_t;\n    type default_t;\n    class dir write;\n}\n\n============= mysqld_t ==============\nallow mysqld_t default_t:dir write;\n</code></pre> </li> <li> <p>Install the SELinux policy module:</p> <pre><code>$ semodule -i my-mysqld.pp\n</code></pre> </li> </ol> <p>Restart the service. If you have a failure, check the journal log and follow the same procedure.</p> <p>If SELinux prevents mysql from creating a log file inside the directory. You can view all the violations by changing the SELinux mode to <code>permissive</code> and then running mysqld. All violations are logged in the journal log. After this run, you can generate a local policy module, install it, and switch SELinux back to <code>enforcing</code> mode. Follow this procedure:</p> <ol> <li> <p>Unload the current local my-mysqld policy module:</p> <pre><code>$ semodule -r my-mysqld\n</code></pre> </li> <li> <p>You can put a single domain into permissive mode. Other domains on the system to remain in enforcing mode. Use <code>semanage permissive</code> with the <code>-a</code> parameter to change mysqld_t to permissive mode:</p> <pre><code>$ semanage permissive -a mysqld_t\n</code></pre> </li> <li> <p>Verify the mode change:</p> <pre><code>$ semdule -l | grep permissive\n</code></pre> Expected output <pre><code>...\npermissive_mysqld_t\n...\n</code></pre> </li> <li> <p>To make searching the log easier, return the time:</p> <pre><code>$ date\n</code></pre> </li> <li> <p>Start the service.</p> <pre><code>$ service mysqld start\n</code></pre> </li> <li> <p>MySQL starts, and SELinux logs the violations in the journal log. Check the journal log:</p> <pre><code>$ journalctl -xe\n</code></pre> </li> <li> <p>Stop the service:</p> <pre><code>$ service mysqld stop\n</code></pre> </li> <li> <p>Generate a local mysqld policy, using the time returned from step 4:</p> <pre><code>$ ausearch --start &lt;date-c 'mysqld' --raw | audit2allow -M my-mysqld\n</code></pre> </li> <li> <p>Review the policy (the policy you generate may be different):</p> <pre><code>$ cat my-mysqld.te\n</code></pre> Expected output <pre><code>module my-mysqld 1.0;\n\nrequire {\ntype default_t;\n    type mysqld_t;\n    class dir { add_name write };\n    class file { append create open };\n}\n\n============= mysqld_t ==============\nallow mysqld_t default_t:dir { add_name write };\nallow mysqld_t default_t:file { append create open };\n</code></pre> </li> <li> <p>Install the policy:</p> <pre><code>$ semodule -i my-mysqld.pp\n</code></pre> </li> <li> <p>Use <code>semanage permissive</code> with the <code>-d</code> parameter, which deletes the permissive domain for the service:</p> <pre><code>$ semanage permissive -d mysqld_t\n</code></pre> </li> <li> <p>Restart the service:</p> <pre><code>$ service mysqld start\n</code></pre> </li> </ol> <p>Note</p> <p>Use this procedure to adjust the local mysqld policy module. You should review the changes which are generated to ensure the rules are not too tolerant.</p>"},{"location":"selinux.html#set-secure_file_priv-directory","title":"Set <code>secure_file_priv</code> directory","text":"<p>Update the SELinux tags for the <code>/var/lib/mysql-files/</code> directory, used for <code>SELECT ... INTO OUTFILE</code> or similar operations, if required. The server needs only read/write access to the destination directory.</p> <p>To set <code>secure_file_priv</code> to use this directory, run the following commands to set the context:</p> <pre><code>$ semanage fcontext -a -t mysqld_db_t \"/var/lib/mysql-files/(/.*)?\"\n$ restorecon -Rv /var/lib/mysql-files\n</code></pre> <p>Edit the path for a different location, if needed.</p>"},{"location":"sequence-table.html","title":"SEQUENCE_TABLE(n) function","text":"<p>Percona Server for MySQL 8.0.20-11 adds the SEQUENCE_TABLE() function.</p> <p>A sequence of numbers can be defined as an arithmetic progression when the common difference between two consecutive terms is always the same.</p> <p>The function is an inline table-valued function. A single SELECT statement generates a multi-row result set. In contrast, a scalar function (like EXP(x) or LOWER(str) always  returns a single value of a specific data type.</p> <p>The JSON_TABLE() is the only table function available in Oracle MySQL Server. <code>JSON_TABLE</code> and <code>SEQUENCE_TABLE()</code> are the only table functions available in Percona Server.</p> <p>The basic syntax is the following:</p> <ul> <li>SEQUENCE_TABLE(n) [AS] alias</li> </ul>"},{"location":"sequence-table.html#usage","title":"Usage","text":"Expected output <pre><code>SELECT \u2026 FROM SEQUENCE_TABLE(n) [AS] alias\n\nSEQUENCE_TABLE(n&gt;) [AS] alias\n</code></pre> <p><code>n:</code> The number of generated values.</p> <p>As with any derived tables, a table function requires an alias in the <code>SELECT</code> statement.</p> <p>The result set is a single column with the predefined column name <code>value</code> of type <code>BIGINT UNSIGNED</code>. You can reference the <code>value</code> column in <code>SELECT</code> statements. The following statements are valid.</p> <pre><code>SELECT * FROM SEQUENCE_TABLE(n) AS tt;\nSELECT &lt;expr(value)&gt; FROM SEQUENCE_TABLE(n) AS tt;\n</code></pre> <p>The first number in the series, the initial term, is defined as <code>0</code> and the series ends with a value less than <code>n</code>. In this example, enter the following statement to generate a sequence:</p> <pre><code>mysql&gt; SELECT * FROM SEQUENCE_TABLE(3) AS tt;\n</code></pre> Expected output <pre><code>+-------+\n| value |\n+-------+\n|     0 |\n|     1 |\n|     2 |\n+-------+\n</code></pre> <p>You can define the initial term using the <code>WHERE</code> clause. The following example starts the sequence with <code>4</code>.</p> <pre><code>SELECT value AS result FROM SEQUENCE_TABLE(8) AS tt WHERE value &gt;= 4;\n</code></pre> Expected output <pre><code>+--------+\n| result |\n+--------+\n|      4 |\n|      5 |\n|      6 |\n|      7 |\n+--------+\n</code></pre> <p>Consecutive terms increase or decrease by a common difference. The default common difference value is <code>1</code>. However, it is possible to filter the results using the WHERE clause to simulate common differences greater than 1.</p> <p>The following example prints only even numbers from the 0..7 range:</p> <pre><code>SELECT value AS result FROM SEQUENCE_TABLE(8) AS tt WHERE value % 2 = 0;\n</code></pre> Expected output <pre><code>+--------+\n| result |\n+--------+\n|      0 |\n|      2 |\n|      4 |\n|      6 |\n+--------+\n</code></pre> <p>The following is an example of using the function to populate a table with a set of random numbers:</p> <pre><code>mysql&gt; SELECT FLOOR(RAND() * 100) AS result FROM SEQUENCE_TABLE(4) AS tt;\n</code></pre> <p>The output could be the following:</p> Expected output <pre><code>+--------+\n| result |\n+--------+\n|     24 |\n|     56 |\n|     70 |\n|     25 |\n+--------+\n</code></pre> <p>You can populate a table with a set of pseudo-random strings with the following statement:</p> <pre><code>mysql&gt; SELECT MD5(value) AS result FROM SEQUENCE_TABLE(4) AS tt;\n</code></pre> Expected output <pre><code>+----------------------------------+\n| result                           |\n+----------------------------------+\n| f17d9c990f40f8ac215f2ecdfd7d0451 |\n| 2e5751b7cfd7f053cd29e946fb2649a4 |\n| b026324c6904b2a9cb4b88d6d61c81d1 |\n| 26ab0db90d72e28ad0ba1e22ee510510 |\n+----------------------------------+\n</code></pre> <p>You can add the sequence as a column to a new table or an existing table, as shown in this example:</p> <pre><code>mysql&gt; CREATE TABLE t1 AS SELECT * FROM SEQUENCE_TABLE(4) AS tt;\n\nmysql&gt; SELECT * FROM t1;\n</code></pre> Expected output <pre><code>+-------+\n| value |\n+-------+\n|     0 |\n|     1 |\n|     2 |\n|     3 |\n+-------+\n</code></pre> <p>There are many uses for a sequence when populating tables.</p>"},{"location":"server-version-numbers.html","title":"Understand version numbers","text":"<p>A version number identifies the product release. The product contains the latest Generally Available (GA) features at the time of that release. </p> 8.0.29 -21. 2 Base version Minor build version Custom build <p>Percona uses semantic version numbering, which follows the pattern of base version, minor build version, and an optional custom build. Percona assigns unique, non-negative integers in increasing order for each minor build release. The version number combines the base MySQL 8.0 version number, the minor build version, and the custom build version, if needed.</p> <p>For example, the version numbers for Percona Server for MySQL 8.0.29-21.2 define the following information:</p> <ul> <li> <p>Base version - the leftmost numbers indicate MySQL 8.0 version used as a base. </p> </li> <li> <p>Minor build version - an internal number that increases by one every time Percona Server for MySQL is released.</p> </li> <li> <p>Custom build version - an optional number assigned to custom builds used for bug fixes. The software features, unless they\u2019re included in the bug fix, don\u2019t change.</p> </li> </ul> <p>Percona Server for MySQL 8.0.28-19 and 8.0.28-20 are both based on MySQL 8.0.28. </p>"},{"location":"show-engines.html","title":"Show storage engines","text":"<p>This feature changes the comment field displayed when the <code>SHOW STORAGE ENGINES</code> command is executed and XtraDB is the storage engine.</p>"},{"location":"show-engines.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul> <p>Before the Change:</p> <pre><code>mysql&gt; show storage engines;\n</code></pre> Expected output <pre><code>+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n| Engine     | Support | Comment                                                        | Transactions | XA   | Savepoints |\n+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n| InnoDB     | YES     | Supports transactions, row-level locking, and foreign keys     | YES          | YES  | YES        |\n...\n+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n</code></pre> <p>After the Change:</p> <pre><code>mysql&gt; show storage engines;\n</code></pre> Expected output <pre><code>+------------+---------+----------------------------------------------------------------------------+--------------+------+------------+\n| Engine     | Support | Comment                                                                    | Transactions |   XA | Savepoints |\n+------------+---------+----------------------------------------------------------------------------+--------------+------+------------+\n| InnoDB     | YES     | Percona-XtraDB, Supports transactions, row-level locking, and foreign keys |          YES | YES  | YES        |\n...\n+------------+---------+----------------------------------------------------------------------------+--------------+------+------------+\n</code></pre>"},{"location":"slow-extended.html","title":"Slow query log","text":"<p>This feature adds microsecond time resolution and additional statistics to the slow query log output. It lets you enable or disable the slow query log at runtime, adds logging for the replica SQL thread, and adds fine-grained control over what and how much to log into the slow query log.</p> <p>You can use Percona-Toolkit\u2019s pt-query-digest tool to aggregate similar queries together and report on those that consume the most execution time.</p>"},{"location":"slow-extended.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"slow-extended.html#system-variables","title":"System Variables","text":""},{"location":"slow-extended.html#log_slow_filter","title":"<code>log_slow_filter</code>","text":"Option Description Command-line Yes Config file Yes Scope Global, Session Dynamic Yes <p>Filters the slow log by the query\u2019s execution plan. The value is a comma-delimited string, and can contain any combination of the following values:</p> <ul> <li> <p><code>full_scan</code>: The query performed a full table scan.</p> </li> <li> <p><code>full_join</code>: The query performed a full join (a join without indexes).</p> </li> <li> <p><code>tmp_table</code>: The query created an implicit internal temporary table.</p> </li> <li> <p><code>tmp_table_on_disk</code>: The query\u2019s temporary table was stored on disk.</p> </li> <li> <p><code>filesort</code>: The query used a filesort.</p> </li> <li> <p><code>filesort_on_disk</code>: The filesort was performed on disk.</p> </li> </ul> <p>Values are OR\u2019ed together. If the string is empty, then the filter is disabled. If it is not empty, then queries will only be logged to the slow log if their execution plan matches one of the types of plans present in the filter.</p> <p>For example, to log only queries that perform a full table scan, set the value to <code>full_scan</code>. To log only queries that use on-disk temporary storage for intermediate results, set the value to <code>tmp_table_on_disk,filesort_on_disk</code>.</p>"},{"location":"slow-extended.html#log_slow_rate_type","title":"<code>log_slow_rate_type</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic yes Data type Enumerated Default session, query <p>Specifies semantic of log_slow_rate_limit - <code>session</code> or <code>query</code>.</p>"},{"location":"slow-extended.html#log_slow_rate_limit","title":"<code>log_slow_rate_limit</code>","text":"Option Description Command-line Yes Config file Yes Scope Global, session Dynamic yes Default 1 Range 1-1000 <p>Behavior of this variable depends on the selected log_slow_rate_type.</p> <p>Specifies that only a fraction of <code>session/query</code> should be logged. Logging is enabled for every nth <code>session/query</code>. By default, n is 1, so logging is enabled for every <code>session/query</code>. Please note: when log_slow_rate_type is <code>session</code> rate limiting is disabled for the replication thread.</p> <p>Logging all queries might consume I/O bandwidth and cause the log file to grow large.</p> <pre><code>* When log_slow_rate_type is `session`, this option lets you log full sessions, so you have complete records of sessions for later analysis; but you can rate-limit the number of sessions that are logged. Note that this feature will not work well if your application uses any type of connection pooling or persistent connections. Note that you change log_slow_rate_limit in `session` mode, you should reconnect for get effect.\n\n\n* When log_slow_rate_type is `query`, this option lets you log just some queries for later analysis. For example, if you set the value to 100, then one percent of queries will be logged.\n</code></pre> <p>Note that every query has global unique <code>query_id</code> and every connection can has it own (session) log_slow_rate_limit. Decision \u201clog or no\u201d calculated in following manner:</p> <ul> <li> <p>if <code>log_slow_rate_limit</code> is 1 - log every query</p> </li> <li> <p>If <code>log_slow_rate_limit</code> 1 - randomly log every 1/<code>log_slow_rate_limit</code> query.</p> </li> </ul> <p>This allows flexible setup logging behavior.</p> <p>For example, if you set the value to 100, then one percent of <code>sessions/queries</code> will be logged. In Percona Server for MySQL information about the log_slow_rate_limit has been added to the slow query log. This means that if the log_slow_rate_limit is effective it will be reflected in the slow query log for each written query. </p> Expected output <pre><code>Log_slow_rate_type: query  Log_slow_rate_limit: 10\n</code></pre>"},{"location":"slow-extended.html#log_slow_sp_statements","title":"<code>log_slow_sp_statements</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Enumerated Default session Range session, query <p>If <code>TRUE</code>, statements executed by stored procedures are logged to the slow if it is open.</p> <p>Percona Server for MySQL implemented improvements for logging of stored procedures to the slow query log:</p> <pre><code>* Each query from a stored procedure is now logged to the slow query log individually\n\n* `CALL` itself isn\u2019t logged to the slow query log anymore as this would be counting twice for the same query which would lead to incorrect results\n\n* Queries that were called inside of stored procedures are annotated in the slow query log with the stored procedure name in which they run.\n</code></pre> <p>Example of the improved stored procedure slow query log entry:</p> <pre><code>mysqlDELIMITER //\nmysqlCREATE PROCEDURE improved_sp_log()\n       BEGIN\n        SELECT * FROM City;\n        SELECT * FROM Country;\n       END//\nmysqlDELIMITER ;\nmysqlCALL improved_sp_log();\n</code></pre> <p>When we check the slow query log after running the stored procedure, with <code>log_slow_sp_statements</code> set to <code>TRUE</code>, it should look like this:</p> Expected output <pre><code># Time: 150109 11:38:55\n# User@Host: root[root] @ localhost []\n# Thread_id: 40  Schema: world  Last_errno: 0  Killed: 0\n# Query_time: 0.012989  Lock_time: 0.000033  Rows_sent: 4079  Rows_examined: 4079  Rows_affected: 0  Rows_read: 4079\n# Bytes_sent: 161085\n# Stored routine: world.improved_sp_log\nSET timestamp=1420803535;\nSELECT * FROM City;\n# User@Host: root[root] @ localhost []\n# Thread_id: 40  Schema: world  Last_errno: 0  Killed: 0\n# Query_time: 0.001413  Lock_time: 0.000017  Rows_sent: 4318  Rows_examined: 4318  Rows_affected: 0  Rows_read: 4318\n# Bytes_sent: 194601\n# Stored routine: world.improved_sp_log\nSET timestamp=1420803535;\n</code></pre> <p>If variable log_slow_sp_statements is set to <code>FALSE</code>:</p> <ul> <li> <p>Entry is added to a slow-log for a <code>CALL</code> statement only and not for any of the individual statements run in that stored procedure</p> </li> <li> <p>Execution time is reported for the <code>CALL</code> statement as the total execution time of the <code>CALL</code> including all its statements</p> </li> </ul> <p>If we run the same stored procedure with the <code>log_slow_sp_statements</code> is set to <code>FALSE</code> slow query log should look like this:</p> Expected output <pre><code># Time: 150109 11:51:42\n# User@Host: root[root] @ localhost []\n# Thread_id: 40  Schema: world  Last_errno: 0  Killed: 0\n# Query_time: 0.013947  Lock_time: 0.000000  Rows_sent: 4318  Rows_examined: 4318  Rows_affected: 0  Rows_read: 4318\n# Bytes_sent: 194612\nSET timestamp=1420804302;\nCALL improved_sp_log();\n</code></pre> <p>Note</p> <p>Support for logging stored procedures doesn\u2019t involve triggers, so they won\u2019t be logged even if this feature is enabled.</p>"},{"location":"slow-extended.html#log_slow_verbosity","title":"<code>log_slow_verbosity</code>","text":"Option Description Command-line Yes Config file Yes Scope Global, session Dynamic Yes <p>Specifies how much information to include in your slow log. The value is a comma-delimited string, and can contain any combination of the following values: </p> <ul> <li> <p><code>microtime</code>: Log queries with microsecond precision.</p> </li> <li> <p><code>query_plan</code>: Log information about the query\u2019s execution plan.</p> </li> <li> <p><code>innodb</code>: Log InnoDB statistics.</p> </li> <li> <p><code>minimal</code>: Equivalent to enabling just <code>microtime</code>.</p> </li> <li> <p><code>standard</code>: Equivalent to enabling <code>microtime,query_plan</code>.</p> </li> <li> <p><code>full</code>: Equivalent to all other values OR\u2019ed together without the <code>profiling</code> and <code>profiling_use_getrusage</code> options.</p> </li> <li> <p><code>profiling</code>: Enables profiling of all queries in all connections.</p> </li> <li> <p><code>profiling_use_getrusage</code>: Enables usage of the getrusage function.</p> </li> <li> <p><code>query_info</code>: Enables printing <code>Query_tables</code> and <code>Query_digest</code> into the slow query log. These fields are disabled by default.</p> </li> </ul> <p>Values are OR\u2019ed together.</p> <p>For example, to enable microsecond query timing and InnoDB statistics, set this option to <code>microtime,innodb</code> or <code>standard</code>. To turn all options on, set the option to <code>full</code>.</p>"},{"location":"slow-extended.html#slow_query_log_use_global_control","title":"<code>slow_query_log_use_global_control</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Default None <p>Specifies which variables have global scope instead of local. For such variables, the global variable value is used in the current session, but without copying this value to the session value. Value is a \u201cflag\u201d variable - you can specify multiple values separated by commas</p> <ul> <li> <p><code>none</code>: All variables use local scope</p> </li> <li> <p><code>log_slow_filter</code>: Global variable log_slow_filter has effect (instead of local)</p> </li> <li> <p><code>log_slow_rate_limit</code>: Global variable log_slow_rate_limit has effect (instead of local)</p> </li> <li> <p><code>log_slow_verbosity</code>: Global variable log_slow_verbosity has effect (instead of local)</p> </li> <li> <p><code>long_query_time</code>: Global variable long_query_time has effect (instead of local)</p> </li> <li> <p><code>min_examined_row_limit</code>: Global variable <code>min_examined_row_limit</code> has effect (instead of local)</p> </li> <li> <p><code>all</code> Global variables has effect (instead of local)</p> </li> </ul>"},{"location":"slow-extended.html#slow_query_log_always_write_time","title":"<code>slow_query_log_always_write_time</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Default 10 <p>This variable can be used to specify the query execution time after which the query will be written to the slow query log. It can be used to specify an additional execution time threshold for the slow query log, that, when exceeded, will cause a query to be logged unconditionally, that is, log_slow_rate_limit will not apply to it.</p>"},{"location":"slow-extended.html#other-information","title":"Other information","text":""},{"location":"slow-extended.html#changes-to-the-log-format","title":"Changes to the log format","text":"<p>The feature adds more information to the slow log output.</p> Expected output <pre><code># Time: 130601  8:01:06.058915\n# User@Host: root[root] @ localhost []  Id:    42\n# Schema: imdb  Last_errno: 0  Killed: 0\n# Query_time: 7.725616  Lock_time: 0.000328  Rows_sent: 4  Rows_examined: 1543720  Rows_affected: 0\n# Bytes_sent: 272  Tmp_tables: 0  Tmp_disk_tables: 0  Tmp_table_sizes: 0\n# Full_scan: Yes  Full_join: No  Tmp_table: No  Tmp_table_on_disk: No\n# Filesort: No  Filesort_on_disk: No  Merge_passes: 0\nSET timestamp=1370073666;\nSELECT id,title,production_year FROM title WHERE title = 'Bambi';\n</code></pre> <p>Another example (log_slow_verbosity <code>=profiling</code>):</p> Expected output <pre><code># Time: 130601  8:03:20.700441\n# User@Host: root[root] @ localhost []  Id:    43\n# Schema: imdb  Last_errno: 0  Killed: 0\n# Query_time: 7.815071  Lock_time: 0.000261  Rows_sent: 4  Rows_examined: 1543720  Rows_affected: 0\n# Bytes_sent: 272\n# Profile_starting: 0.000125 Profile_starting_cpu: 0.000120\nProfile_checking_permissions: 0.000021 Profile_checking_permissions_cpu: 0.000021\nProfile_Opening_tables: 0.000049 Profile_Opening_tables_cpu: 0.000048 Profile_init: 0.000048\nProfile_init_cpu: 0.000049 Profile_System_lock: 0.000049 Profile_System_lock_cpu: 0.000048\nProfile_optimizing: 0.000024 Profile_optimizing_cpu: 0.000024 Profile_statistics: 0.000036 \nProfile_statistics_cpu: 0.000037 Profile_preparing: 0.000029 Profile_preparing_cpu: 0.000029\nProfile_executing: 0.000012 Profile_executing_cpu: 0.000012 Profile_Sending_data: 7.814583\nProfile_Sending_data_cpu: 7.811634 Profile_end: 0.000013 Profile_end_cpu: 0.000012\nProfile_query_end: 0.000014 Profile_query_end_cpu: 0.000014 Profile_closing_tables: 0.000023\nProfile_closing_tables_cpu: 0.000023 Profile_freeing_items: 0.000051\nProfile_freeing_items_cpu: 0.000050 Profile_logging_slow_query: 0.000006\nProfile_logging_slow_query_cpu: 0.000006\n# Profile_total: 7.815085 Profile_total_cpu: 7.812127\nSET timestamp=1370073800;\nSELECT id,title,production_year FROM title WHERE title = 'Bambi';\n</code></pre> <p>Notice that the <code>Killed: \\</code>` keyword is followed by zero when the query successfully completes. If the query was killed, the ``Killed:` keyword is followed by a number other than zero:</p> Killed Numeric Code Exception 0 NOT_KILLED 1 KILL_BAD_DATA 1053 ER_SERVER_SHUTDOWN (see MySQL Documentation) 1317 ER_QUERY_INTERRUPTED (see MySQL Documentation) 3024 ER_QUERY_TIMEOUT (see MySQL Documentation) Any other number KILLED_NO_VALUE (Catches all other cases)"},{"location":"slow-extended.html#connection-and-schema-identifier","title":"Connection and Schema Identifier","text":"<p>Each slow log entry now contains a connection identifier, so you can trace all the queries coming from a single connection. This is the same value that is shown in the Id column in <code>SHOW FULL PROCESSLIST</code> or returned from the <code>CONNECTION_ID()</code> function.</p> <p>Each entry also contains a schema name, so you can trace all the queries whose default database was set to a particular schema.</p> Expected output <pre><code># Id: 43  Schema: imdb\n</code></pre>"},{"location":"slow-extended.html#microsecond-time-resolution-and-extra-row-information","title":"Microsecond time resolution and extra row information","text":"<p>This is the original functionality offered by the <code>microslow</code> feature. <code>Query_time</code> and <code>Lock_time</code> are logged with microsecond resolution.</p> <p>The feature also adds information about how many rows were examined for <code>SELECT</code> queries, and how many were analyzed and affected for <code>UPDATE</code>, <code>DELETE</code>, and <code>INSERT</code> queries,</p> Expected output <pre><code># Query_time: 0.962742  Lock_time: 0.000202  Rows_sent: 4  Rows_examined: 1543719  Rows_affected: 0\n</code></pre> <p>Values and context:</p> <ul> <li> <p><code>Rows_examined</code>: Number of rows scanned - <code>SELECT</code></p> </li> <li> <p><code>Rows_affected</code>: Number of rows changed - <code>UPDATE</code>, <code>DELETE</code>, <code>INSERT</code></p> </li> </ul>"},{"location":"slow-extended.html#memory-footprint","title":"Memory footprint","text":"<p>The feature provides information about the amount of bytes sent for the result of the query and the number of temporary tables created for its execution - differentiated by whether they were created on memory or on disk - with the total number of bytes used by them.</p> Expected output <pre><code># Bytes_sent: 8053  Tmp_tables: 1  Tmp_disk_tables: 0  Tmp_table_sizes: 950528\n</code></pre> <p>Values and context:</p> <ul> <li> <p><code>Bytes_sent</code>: The amount of bytes sent for the result of the query</p> </li> <li> <p><code>Tmp_tables</code>: Number of temporary tables created on memory for the query</p> </li> <li> <p><code>Tmp_disk_tables</code>: Number of temporary tables created on disk for the query</p> </li> <li> <p><code>Tmp_table_sizes</code>: Total Size in bytes for all temporary tables used in the query</p> </li> </ul>"},{"location":"slow-extended.html#query-plan-information","title":"Query plan information","text":"<p>Each query can be executed in various ways. For example, it may use indexes or do a full table scan, or a temporary table may be needed. These are the things that you can usually see by running <code>EXPLAIN</code> on the query. The feature will now allow you to see the most important facts about the execution in the log file.</p> Expected output <pre><code># Full_scan: Yes  Full_join: No  Tmp_table: No  Tmp_table_on_disk: No\n# Filesort: No  Filesort_on_disk: No  Merge_passes: 0\n</code></pre> <p>The values and their meanings are documented with the log_slow_filter option.</p>"},{"location":"slow-extended.html#innodb-usage-information","title":"InnoDB usage information","text":"<p>The final part of the output is the InnoDB usage statistics. MySQL currently shows many per-session statistics for operations with <code>SHOW SESSION STATUS</code>, but that does not include those of InnoDB, which are always global and shared by all threads. This feature lets you see those values for a given query.</p> Expected output <pre><code>#   InnoDB_IO_r_ops: 6415  InnoDB_IO_r_bytes: 105103360  InnoDB_IO_r_wait: 0.001279\n#   InnoDB_rec_lock_wait: 0.000000  InnoDB_queue_wait: 0.000000\n#   InnoDB_pages_distinct: 6430\n</code></pre> <p>Values:</p> <ul> <li> <p><code>innodb_IO_r_ops</code>: Counts the number of page read operations scheduled. The actual number of read operations may be different, but since this can be done asynchronously, there is no good way to measure it.</p> </li> <li> <p><code>innodb_IO_r_bytes</code>: Similar to innodb_IO_r_ops, but the unit is bytes.</p> </li> <li> <p><code>innodb_IO_r_wait</code>: Shows how long (in seconds) it took InnoDB to actually read the data from storage.</p> </li> <li> <p><code>innodb_rec_lock_wait</code>: Shows how long (in seconds) the query waited for row locks.</p> </li> <li> <p><code>innodb_queue_wait</code>: Shows how long (in seconds) the query spent either waiting to enter the InnoDB queue or inside that queue waiting for execution.</p> </li> <li> <p><code>innodb_pages_distinct</code>: Counts approximately the number of unique pages the query accessed. The approximation is based on a small hash array representing the entire buffer pool, because it could take a lot of memory to map all the pages. The inaccuracy grows with the number of pages accessed by a query, because there is a higher probability of hash collisions.</p> </li> </ul> <p>If the query did not use InnoDB tables, that information is written into the log instead of the above statistics.</p>"},{"location":"slow-extended.html#related-reading","title":"Related reading","text":"<ul> <li> <p>Impact of logging on MySQL\u2019s performance</p> </li> <li> <p>log_slow_filter Usage</p> </li> <li> <p>Added microseconds to the slow query log event time</p> </li> </ul>"},{"location":"slowlog-rotation.html","title":"Slow query log rotation and expiration","text":"<p>Important</p> <p>This feature is a tech preview. Before using this feature in production, we recommend that you test restoring production from physical backups in your environment, and also use the alternative backup method for redundancy.</p> <p>This feature was implemented in Percona Server for MySQL 8.0.27-18.</p> <p>Percona has implemented two new variables, <code>max_slowlog_size</code> and <code>max_slowlog_files</code> to provide users with ability to control the slow query log disk usage. These variables have the same behavior as the max_binlog_size variable and the max_binlog_files variable used for controlling the binary log.</p>"},{"location":"slowlog-rotation.html#system-variables","title":"System variables","text":""},{"location":"slowlog-rotation.html#max_slowlog_size","title":"<code>max_slowlog_size</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type numeric Default 0 (unlimited) Range 0 - 1073741824 <p>The server rotates the slow query log when the log\u2019s size reaches this value. The default value is <code>0</code>. If you limit the size and this feature is enabled, the server renames the slow query log file to slow_query_log_file.000001.</p>"},{"location":"slowlog-rotation.html#max_slowlog_files","title":"<code>max_slowlog_files</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type numeric Default 0 (unlimited) Range 0 - 102400 <p>This variable limits the total amount of slow query log files and is used with max_slowlog_size.</p> <p>The server creates and adds slow query logs until reaching the range\u2019s upper value. When the upper value is reached, the server creates a new slow query log file with a higher sequence number and deletes the log file with the lowest sequence number maintaining the total amount defined in the range.</p>"},{"location":"source-tarball.html","title":"Install Percona Server for MySQL from a source tarball","text":"<p>Fetch and extract the source tarball. For example:</p> <pre><code>$ wget https://downloads.percona.com/downloads/Percona-Server-8.0/Percona-Server-8.0.26-16/binary/tarball/Percona-Server-8.0.26-16-Linux.x86_64.glibc2.12.tar.gz\n$ tar xfz Percona-Server-8.0.26-16-Linux.x86_64.glibc2.12.tar.gz\n</code></pre> <p>To complete the installation, follow the instructions in Compile Percona Server for MySQL from Source.</p>"},{"location":"ssl-improvement.html","title":"SSL improvements","text":"<p>Percona Server for MySQL passes Elliptic Curve Cryptography (ECC) ciphers to OpenSSL by default.</p> <p>Note</p> <p>Although documented as supported, elliptic-curve crypto-based ciphers do not work with MySQL.</p>"},{"location":"stacktrace.html","title":"Stacktrace","text":""},{"location":"stacktrace.html#stack-trace","title":"Stack trace","text":"<p>Developers use the stack trace in the debug process, either an interactive investigation or during the post-mortem. No configuration is required to generate a stack trace.</p> <p>Implemented in Percona Server for MySQL 8.0.21-12, stack trace adds the following:</p> Name Description Prints binary BuildID The Strip utility removes unneeded sections and debugging information to reduce the size. This method is standard with containers where the size of the image is essential. The BuildID lets you resolve the stack trace when the Strip utility removes the binary symbols table. Print the server version information The version information establishes the starting point for analysis. Some applications, such as MySQL, only print this information to a log on startup, and when the crash occurs, the size of the log may be large, rotated, or truncated."},{"location":"start-transaction-with-consistent-snapshot.html","title":"Start transaction with consistent snapshot","text":"<p>Percona Server for MySQL has ported MariaDB enhancement for <code>START TRANSACTION WITH CONSISTENT SNAPSHOTS</code> feature to MySQL 5.6 group commit implementation. This enhancement makes binary log positions consistent with InnoDB transaction snapshots.</p> <p>This feature is quite useful to obtain logical backups with correct positions without running a <code>FLUSH TABLES WITH READ LOCK</code>. Binary log position can be obtained by two newly implemented status variables: Binlog_snapshot_file and Binlog_snapshot_position. After starting a transaction using the <code>START TRANSACTION WITH CONSISTENT SNAPSHOT</code>, these two variables will provide you with the binlog position corresponding to the state of the database of the consistent snapshot so taken, irrespectively of which other transactions have been committed since the snapshot was taken.</p>"},{"location":"start-transaction-with-consistent-snapshot.html#snapshot-cloning","title":"Snapshot cloning","text":"<p>The Percona Server for MySQL implementation extends the <code>START TRANSACTION WITH CONSISTENT SNAPSHOT</code> syntax with the optional <code>FROM SESSION</code> clause:</p> <pre><code>START TRANSACTION WITH CONSISTENT SNAPSHOT FROM SESSION &lt;session_id&gt;;\n</code></pre> <p>When specified, all participating storage engines and binary log instead of creating a new snapshot of data (or binary log coordinates), create a copy of the snapshot which has been created by an active transaction in the specified session. <code>session_id</code> is the session identifier reported in the <code>Id</code> column of <code>SHOW PROCESSLIST</code>.</p> <p>Currently snapshot cloning is only supported by XtraDB and the binary log. As with the regular <code>START TRANSACTION WITH CONSISTENT SNAPSHOT</code>, snapshot clones can only be created with the <code>REPEATABLE READ</code> isolation level.</p> <p>For XtraDB, a transaction with a cloned snapshot will only see data visible or changed by the donor transaction. That is, the cloned transaction will see no changes committed by transactions that started after the donor transaction, not even changes made by itself. Note that in case of chained cloning the donor transaction is the first one in the chain. For example, if transaction A is cloned into transaction B, which is in turn cloned into transaction C, the latter will have read view from transaction A (i.e., the donor transaction). Therefore, it will see changes made by transaction A, but not by transaction B.</p>"},{"location":"start-transaction-with-consistent-snapshot.html#mysqldump","title":"mysqldump","text":"<p><code>mysqldump</code> has been updated to use new status variables automatically when they are supported by the server and both \u2013single-transaction and \u2013master-data are specified on the command line. Along with the <code>mysqldump</code> improvements introduced in Backup Locks there is now a way to generate <code>mysqldump</code> backups that are guaranteed to be consistent without using <code>FLUSH TABLES WITH READ LOCK</code> even if <code>--master-data</code> is requested.</p>"},{"location":"start-transaction-with-consistent-snapshot.html#system-variables","title":"System variables","text":""},{"location":"start-transaction-with-consistent-snapshot.html#have_snapshot_cloning","title":"<code>have_snapshot_cloning</code>","text":"Option Description Command Line: Yes Config file No Scope: Global Dynamic: No Data type Boolean <p>This server variable is implemented to help other utilities detect if the server supports the <code>FROM SESSION</code> extension. When available, the snapshot cloning feature and the syntax extension to <code>START TRANSACTION WITH CONSISTENT SNAPSHOT</code> are supported by the server, and the variable value is always <code>YES</code>.</p>"},{"location":"start-transaction-with-consistent-snapshot.html#status-variables","title":"Status variables","text":""},{"location":"start-transaction-with-consistent-snapshot.html#binlog_snapshot_file","title":"<code>Binlog_snapshot_file</code>","text":"Option Description Scope: Global Data type String"},{"location":"start-transaction-with-consistent-snapshot.html#binlog_snapshot_position","title":"<code>Binlog_snapshot_position</code>","text":"Option Description Scope: Global Data type Numeric <p>These status variables are only available when the binary log is enabled globally.</p>"},{"location":"start-transaction-with-consistent-snapshot.html#other-reading","title":"Other reading","text":"<ul> <li>MariaDB Enhancements for START TRANSACTION WITH CONSISTENT SNAPSHOT</li> </ul>"},{"location":"status-variables.html","title":"MyRocks status variables","text":"<p>MyRocks status variables provide details about the inner workings of the storage engine and they can be useful in tuning the storage engine to a particular environment.</p> <p>You can view these variables and their values by running:</p> <pre><code>mysql&gt; SHOW STATUS LIKE 'rocksdb%';\n</code></pre> <p>The following global status variables are available:</p> Name Var Type <code>rocksdb_rows_deleted</code> Numeric <code>rocksdb_rows_inserted</code> Numeric <code>rocksdb_rows_read</code> Numeric <code>rocksdb_rows_unfiltered_no_snapshot</code> Numeric <code>rocksdb_rows_updated</code> Numeric <code>rocksdb_rows_expired</code> Numeric <code>rocksdb_system_rows_deleted</code> Numeric <code>rocksdb_system_rows_inserted</code> Numeric <code>rocksdb_system_rows_read</code> Numeric <code>rocksdb_system_rows_updated</code> Numeric <code>rocksdb_memtable_total</code> Numeric <code>rocksdb_memtable_unflushed</code> Numeric <code>rocksdb_queries_point</code> Numeric <code>rocksdb_queries_range</code> Numeric <code>rocksdb_covered_secondary_key_lookups</code> Numeric <code>rocksdb_additional_compactions_trigger</code> Numeric <code>rocksdb_block_cache_add</code> Numeric <code>rocksdb_block_cache_add_failures</code> Numeric <code>rocksdb_block_cache_bytes_read</code> Numeric <code>rocksdb_block_cache_bytes_write</code> Numeric <code>rocksdb_block_cache_data_add</code> Numeric <code>rocksdb_block_cache_data_bytes_insert</code> Numeric <code>rocksdb_block_cache_data_hit</code> Numeric <code>rocksdb_block_cache_data_miss</code> Numeric <code>rocksdb_block_cache_filter_add</code> Numeric <code>rocksdb_block_cache_filter_bytes_evict</code> Numeric <code>rocksdb_block_cache_filter_bytes_insert</code> Numeric <code>rocksdb_block_cache_filter_hit</code> Numeric <code>rocksdb_block_cache_filter_miss</code> Numeric <code>rocksdb_block_cache_hit</code> Numeric <code>rocksdb_block_cache_index_add</code> Numeric <code>rocksdb_block_cache_index_bytes_evict</code> Numeric <code>rocksdb_block_cache_index_bytes_insert</code> Numeric <code>rocksdb_block_cache_index_hit</code> Numeric <code>rocksdb_block_cache_index_miss</code> Numeric <code>rocksdb_block_cache_miss</code> Numeric <code>rocksdb_block_cache_compressed_hit</code> Numeric <code>rocksdb_block_cache_compressed_miss</code> Numeric <code>rocksdb_bloom_filter_prefix_checked</code> Numeric <code>rocksdb_bloom_filter_prefix_useful</code> Numeric <code>rocksdb_bloom_filter_useful</code> Numeric <code>rocksdb_bytes_read</code> Numeric <code>rocksdb_bytes_written</code> Numeric <code>rocksdb_compact_read_bytes</code> Numeric <code>rocksdb_compact_write_bytes</code> Numeric <code>rocksdb_compaction_key_drop_new</code> Numeric <code>rocksdb_compaction_key_drop_obsolete</code> Numeric <code>rocksdb_compaction_key_drop_user</code> Numeric <code>rocksdb_flush_write_bytes</code> Numeric <code>rocksdb_get_hit_l0</code> Numeric <code>rocksdb_get_hit_l1</code> Numeric <code>rocksdb_get_hit_l2_and_up</code> Numeric <code>rocksdb_get_updates_since_calls</code> Numeric <code>rocksdb_iter_bytes_read</code> Numeric <code>rocksdb_memtable_hit</code> Numeric <code>rocksdb_memtable_miss</code> Numeric <code>rocksdb_no_file_closes</code> Numeric <code>rocksdb_no_file_errors</code> Numeric <code>rocksdb_no_file_opens</code> Numeric <code>rocksdb_num_iterators</code> Numeric <code>rocksdb_number_block_not_compressed</code> Numeric <code>rocksdb_number_db_next</code> Numeric <code>rocksdb_number_db_next_found</code> Numeric <code>rocksdb_number_db_prev</code> Numeric <code>rocksdb_number_db_prev_found</code> Numeric <code>rocksdb_number_db_seek</code> Numeric <code>rocksdb_number_db_seek_found</code> Numeric <code>rocksdb_number_deletes_filtered</code> Numeric <code>rocksdb_number_keys_read</code> Numeric <code>rocksdb_number_keys_updated</code> Numeric <code>rocksdb_number_keys_written</code> Numeric <code>rocksdb_number_merge_failures</code> Numeric <code>rocksdb_number_multiget_bytes_read</code> Numeric <code>rocksdb_number_multiget_get</code> Numeric <code>rocksdb_number_multiget_keys_read</code> Numeric <code>rocksdb_number_reseeks_iteration</code> Numeric <code>rocksdb_number_sst_entry_delete</code> Numeric <code>rocksdb_number_sst_entry_merge</code> Numeric <code>rocksdb_number_sst_entry_other</code> Numeric <code>rocksdb_number_sst_entry_put</code> Numeric <code>rocksdb_number_sst_entry_singledelete</code> Numeric <code>rocksdb_number_stat_computes</code> Numeric <code>rocksdb_number_superversion_acquires</code> Numeric <code>rocksdb_number_superversion_cleanups</code> Numeric <code>rocksdb_number_superversion_releases</code> Numeric <code>rocksdb_rate_limit_delay_millis</code> Numeric <code>rocksdb_row_lock_deadlocks</code> Numeric <code>rocksdb_row_lock_wait_timeouts</code> Numeric <code>rocksdb_snapshot_conflict_errors</code> Numeric <code>rocksdb_stall_l0_file_count_limit_slowdowns</code> Numeric <code>rocksdb_stall_locked_l0_file_count_limit_slowdowns</code> Numeric <code>rocksdb_stall_l0_file_count_limit_stops</code> Numeric <code>rocksdb_stall_locked_l0_file_count_limit_stops</code> Numeric <code>rocksdb_stall_pending_compaction_limit_stops</code> Numeric <code>rocksdb_stall_pending_compaction_limit_slowdowns</code> Numeric <code>rocksdb_stall_memtable_limit_stops</code> Numeric <code>rocksdb_stall_memtable_limit_slowdowns</code> Numeric <code>rocksdb_stall_total_stops</code> Numeric <code>rocksdb_stall_total_slowdowns</code> Numeric <code>rocksdb_stall_micros</code> Numeric <code>rocksdb_wal_bytes</code> Numeric <code>rocksdb_wal_group_syncs</code> Numeric <code>rocksdb_wal_synced</code> Numeric <code>rocksdb_write_other</code> Numeric <code>rocksdb_write_self</code> Numeric <code>rocksdb_write_timedout</code> Numeric <code>rocksdb_write_wal</code> Numeric"},{"location":"status-variables.html#rocksdb_rows_deleted","title":"<code>rocksdb_rows_deleted</code>","text":"<p>This variable shows the number of rows that were deleted from MyRocks tables.</p>"},{"location":"status-variables.html#rocksdb_rows_inserted","title":"<code>rocksdb_rows_inserted</code>","text":"<p>This variable shows the number of rows that were inserted into MyRocks tables.</p>"},{"location":"status-variables.html#rocksdb_rows_read","title":"<code>rocksdb_rows_read</code>","text":"<p>This variable shows the number of rows that were read from MyRocks tables.</p>"},{"location":"status-variables.html#rocksdb_rows_unfiltered_no_snapshot","title":"<code>rocksdb_rows_unfiltered_no_snapshot</code>","text":"<p>This variable shows how many reads need TTL and have no snapshot timestamp.</p>"},{"location":"status-variables.html#rocksdb_rows_updated","title":"<code>rocksdb_rows_updated</code>","text":"<p>This variable shows the number of rows that were updated in MyRocks tables.</p>"},{"location":"status-variables.html#rocksdb_rows_expired","title":"<code>rocksdb_rows_expired</code>","text":"<p>This variable shows the number of expired rows in MyRocks tables.</p>"},{"location":"status-variables.html#rocksdb_system_rows_deleted","title":"<code>rocksdb_system_rows_deleted</code>","text":"<p>This variable shows the number of rows that were deleted from MyRocks system tables.</p>"},{"location":"status-variables.html#rocksdb_system_rows_inserted","title":"<code>rocksdb_system_rows_inserted</code>","text":"<p>This variable shows the number of rows that were inserted into MyRocks system tables.</p>"},{"location":"status-variables.html#rocksdb_system_rows_read","title":"<code>rocksdb_system_rows_read</code>","text":"<p>This variable shows the number of rows that were read from MyRocks system tables.</p>"},{"location":"status-variables.html#rocksdb_system_rows_updated","title":"<code>rocksdb_system_rows_updated</code>","text":"<p>This variable shows the number of rows that were updated in MyRocks system tables.</p>"},{"location":"status-variables.html#rocksdb_memtable_total","title":"<code>rocksdb_memtable_total</code>","text":"<p>This variable shows the memory usage, in bytes, of all memtables.</p>"},{"location":"status-variables.html#rocksdb_memtable_unflushed","title":"<code>rocksdb_memtable_unflushed</code>","text":"<p>This variable shows the memory usage, in bytes, of all unflushed memtables.</p>"},{"location":"status-variables.html#rocksdb_queries_point","title":"<code>rocksdb_queries_point</code>","text":"<p>This variable shows the number of single row queries.</p>"},{"location":"status-variables.html#rocksdb_queries_range","title":"<code>rocksdb_queries_range</code>","text":"<p>This variable shows the number of multi/range row queries.</p>"},{"location":"status-variables.html#rocksdb_covered_secondary_key_lookups","title":"<code>rocksdb_covered_secondary_key_lookups</code>","text":"<p>This variable shows the number of lookups via the secondary index that returned all fields requested directly from the secondary index.</p>"},{"location":"status-variables.html#rocksdb_additional_compactions_trigger","title":"<code>rocksdb_additional_compactions_trigger</code>","text":"<p>This variable shows the number of triggered additional compactions. MyRocks triggers an additional compaction if (number of deletions / number of entries) &gt; (rocksdb_compaction_sequential_deletes / rocksdb_compaction_sequential_deletes_window) in the SST file.</p>"},{"location":"status-variables.html#rocksdb_block_cache_add","title":"<code>rocksdb_block_cache_add</code>","text":"<p>This variable shows the number of blocks added to block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_add_failures","title":"<code>rocksdb_block_cache_add_failures</code>","text":"<p>This variable shows the number of failures when adding blocks to block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_bytes_read","title":"<code>rocksdb_block_cache_bytes_read</code>","text":"<p>This variable shows the number of bytes read from cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_bytes_write","title":"<code>rocksdb_block_cache_bytes_write</code>","text":"<p>This variable shows the number of bytes written into cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_data_add","title":"<code>rocksdb_block_cache_data_add</code>","text":"<p>This variable shows the number of data blocks added to block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_data_bytes_insert","title":"<code>rocksdb_block_cache_data_bytes_insert</code>","text":"<p>This variable shows the number of bytes of data blocks inserted into cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_data_hit","title":"<code>rocksdb_block_cache_data_hit</code>","text":"<p>This variable shows the number of cache hits when accessing the data block from the block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_data_miss","title":"<code>rocksdb_block_cache_data_miss</code>","text":"<p>This variable shows the number of cache misses when accessing the data block from the block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_filter_add","title":"<code>rocksdb_block_cache_filter_add</code>","text":"<p>This variable shows the number of filter blocks added to block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_filter_bytes_evict","title":"<code>rocksdb_block_cache_filter_bytes_evict</code>","text":"<p>This variable shows the number of bytes of bloom filter blocks removed from cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_filter_bytes_insert","title":"<code>rocksdb_block_cache_filter_bytes_insert</code>","text":"<p>This variable shows the number of bytes of bloom filter blocks inserted into cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_filter_hit","title":"<code>rocksdb_block_cache_filter_hit</code>","text":"<p>This variable shows the number of times cache hit when accessing filter block from block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_filter_miss","title":"<code>rocksdb_block_cache_filter_miss</code>","text":"<p>This variable shows the number of times cache miss when accessing filter block from block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_hit","title":"<code>rocksdb_block_cache_hit</code>","text":"<p>This variable shows the total number of block cache hits.</p>"},{"location":"status-variables.html#rocksdb_block_cache_index_add","title":"<code>rocksdb_block_cache_index_add</code>","text":"<p>This variable shows the number of index blocks added to block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_index_bytes_evict","title":"<code>rocksdb_block_cache_index_bytes_evict</code>","text":"<p>This variable shows the number of bytes of index block erased from cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_index_bytes_insert","title":"<code>rocksdb_block_cache_index_bytes_insert</code>","text":"<p>This variable shows the number of bytes of index blocks inserted into cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_index_hit","title":"<code>rocksdb_block_cache_index_hit</code>","text":"<p>This variable shows the total number of block cache index hits.</p>"},{"location":"status-variables.html#rocksdb_block_cache_index_miss","title":"<code>rocksdb_block_cache_index_miss</code>","text":"<p>This variable shows the number of times cache hit when accessing index block from block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_miss","title":"<code>rocksdb_block_cache_miss</code>","text":"<p>This variable shows the total number of block cache misses.</p>"},{"location":"status-variables.html#rocksdb_block_cache_compressed_hit","title":"<code>rocksdb_block_cache_compressed_hit</code>","text":"<p>This variable shows the number of hits in the compressed block cache.</p>"},{"location":"status-variables.html#rocksdb_block_cache_compressed_miss","title":"<code>rocksdb_block_cache_compressed_miss</code>","text":"<p>This variable shows the number of misses in the compressed block cache.</p>"},{"location":"status-variables.html#rocksdb_bloom_filter_prefix_checked","title":"<code>rocksdb_bloom_filter_prefix_checked</code>","text":"<p>This variable shows the number of times bloom was checked before creating iterator on a file.</p>"},{"location":"status-variables.html#rocksdb_bloom_filter_prefix_useful","title":"<code>rocksdb_bloom_filter_prefix_useful</code>","text":"<p>This variable shows the number of times the check was useful in avoiding iterator creation (and thus likely IOPs).</p>"},{"location":"status-variables.html#rocksdb_bloom_filter_useful","title":"<code>rocksdb_bloom_filter_useful</code>","text":"<p>This variable shows the number of times bloom filter has avoided file reads.</p>"},{"location":"status-variables.html#rocksdb_bytes_read","title":"<code>rocksdb_bytes_read</code>","text":"<p>This variable shows the total number of uncompressed bytes read. It could be either from memtables, cache, or table files.</p>"},{"location":"status-variables.html#rocksdb_bytes_written","title":"<code>rocksdb_bytes_written</code>","text":"<p>This variable shows the total number of uncompressed bytes written.</p>"},{"location":"status-variables.html#rocksdb_compact_read_bytes","title":"<code>rocksdb_compact_read_bytes</code>","text":"<p>This variable shows the number of bytes read during compaction</p>"},{"location":"status-variables.html#rocksdb_compact_write_bytes","title":"<code>rocksdb_compact_write_bytes</code>","text":"<p>This variable shows the number of bytes written during compaction.</p>"},{"location":"status-variables.html#rocksdb_compaction_key_drop_new","title":"<code>rocksdb_compaction_key_drop_new</code>","text":"<p>This variable shows the number of key drops during compaction because it was overwritten with a newer value.</p>"},{"location":"status-variables.html#rocksdb_compaction_key_drop_obsolete","title":"<code>rocksdb_compaction_key_drop_obsolete</code>","text":"<p>This variable shows the number of key drops during compaction because it was obsolete.</p>"},{"location":"status-variables.html#rocksdb_compaction_key_drop_user","title":"<code>rocksdb_compaction_key_drop_user</code>","text":"<p>This variable shows the number of key drops during compaction because user compaction function has dropped the key.</p>"},{"location":"status-variables.html#rocksdb_flush_write_bytes","title":"<code>rocksdb_flush_write_bytes</code>","text":"<p>This variable shows the number of bytes written during flush.</p>"},{"location":"status-variables.html#rocksdb_get_hit_l0","title":"<code>rocksdb_get_hit_l0</code>","text":"<p>This variable shows the number of <code>Get()</code> queries served by L0.</p>"},{"location":"status-variables.html#rocksdb_get_hit_l1","title":"<code>rocksdb_get_hit_l1</code>","text":"<p>This variable shows the number of <code>Get()</code> queries served by L1.</p>"},{"location":"status-variables.html#rocksdb_get_hit_l2_and_up","title":"<code>rocksdb_get_hit_l2_and_up</code>","text":"<p>This variable shows the number of <code>Get()</code> queries served by L2 and up.</p>"},{"location":"status-variables.html#rocksdb_get_updates_since_calls","title":"<code>rocksdb_get_updates_since_calls</code>","text":"<p>This variable shows the number of calls to <code>GetUpdatesSince</code> function. Useful to keep track of transaction log iterator refreshes</p>"},{"location":"status-variables.html#rocksdb_iter_bytes_read","title":"<code>rocksdb_iter_bytes_read</code>","text":"<p>This variable shows the number of uncompressed bytes read from an iterator. It includes size of key and value.</p>"},{"location":"status-variables.html#rocksdb_memtable_hit","title":"<code>rocksdb_memtable_hit</code>","text":"<p>This variable shows the number of memtable hits.</p>"},{"location":"status-variables.html#rocksdb_memtable_miss","title":"<code>rocksdb_memtable_miss</code>","text":"<p>This variable shows the number of memtable misses.</p>"},{"location":"status-variables.html#rocksdb_no_file_closes","title":"<code>rocksdb_no_file_closes</code>","text":"<p>This variable shows the number of time file were closed.</p>"},{"location":"status-variables.html#rocksdb_no_file_errors","title":"<code>rocksdb_no_file_errors</code>","text":"<p>This variable shows number of errors trying to read in data from an sst file.</p>"},{"location":"status-variables.html#rocksdb_no_file_opens","title":"<code>rocksdb_no_file_opens</code>","text":"<p>This variable shows the number of time file were opened.</p>"},{"location":"status-variables.html#rocksdb_num_iterators","title":"<code>rocksdb_num_iterators</code>","text":"<p>This variable shows the number of currently open iterators.</p>"},{"location":"status-variables.html#rocksdb_number_block_not_compressed","title":"<code>rocksdb_number_block_not_compressed</code>","text":"<p>This variable shows the number of uncompressed blocks.</p>"},{"location":"status-variables.html#rocksdb_number_db_next","title":"<code>rocksdb_number_db_next</code>","text":"<p>This variable shows the number of calls to <code>next</code>.</p>"},{"location":"status-variables.html#rocksdb_number_db_next_found","title":"<code>rocksdb_number_db_next_found</code>","text":"<p>This variable shows the number of calls to <code>next</code> that returned data.</p>"},{"location":"status-variables.html#rocksdb_number_db_prev","title":"<code>rocksdb_number_db_prev</code>","text":"<p>This variable shows the number of calls to <code>prev</code>.</p>"},{"location":"status-variables.html#rocksdb_number_db_prev_found","title":"<code>rocksdb_number_db_prev_found</code>","text":"<p>This variable shows the number of calls to <code>prev</code> that returned data.</p>"},{"location":"status-variables.html#rocksdb_number_db_seek","title":"<code>rocksdb_number_db_seek</code>","text":"<p>This variable shows the number of calls to <code>seek</code>.</p>"},{"location":"status-variables.html#rocksdb_number_db_seek_found","title":"<code>rocksdb_number_db_seek_found</code>","text":"<p>This variable shows the number of calls to <code>seek</code> that returned data.</p>"},{"location":"status-variables.html#rocksdb_number_deletes_filtered","title":"<code>rocksdb_number_deletes_filtered</code>","text":"<p>This variable shows the number of deleted records that were not required to be written to storage because key did not exist.</p>"},{"location":"status-variables.html#rocksdb_number_keys_read","title":"<code>rocksdb_number_keys_read</code>","text":"<p>This variable shows the number of keys read.</p>"},{"location":"status-variables.html#rocksdb_number_keys_updated","title":"<code>rocksdb_number_keys_updated</code>","text":"<p>This variable shows the number of keys updated, if inplace update is enabled.</p>"},{"location":"status-variables.html#rocksdb_number_keys_written","title":"<code>rocksdb_number_keys_written</code>","text":"<p>This variable shows the number of keys written to the database.</p>"},{"location":"status-variables.html#rocksdb_number_merge_failures","title":"<code>rocksdb_number_merge_failures</code>","text":"<p>This variable shows the number of failures performing merge operator actions in RocksDB.</p>"},{"location":"status-variables.html#rocksdb_number_multiget_bytes_read","title":"<code>rocksdb_number_multiget_bytes_read</code>","text":"<p>This variable shows the number of bytes read during RocksDB <code>MultiGet()</code> calls.</p>"},{"location":"status-variables.html#rocksdb_number_multiget_get","title":"<code>rocksdb_number_multiget_get</code>","text":"<p>This variable shows the number <code>MultiGet()</code> requests to RocksDB.</p>"},{"location":"status-variables.html#rocksdb_number_multiget_keys_read","title":"<code>rocksdb_number_multiget_keys_read</code>","text":"<p>This variable shows the keys read via <code>MultiGet()</code>.</p>"},{"location":"status-variables.html#rocksdb_number_reseeks_iteration","title":"<code>rocksdb_number_reseeks_iteration</code>","text":"<p>This variable shows the number of times reseek happened inside an iteration to skip over large number of keys with same userkey.</p>"},{"location":"status-variables.html#rocksdb_number_sst_entry_delete","title":"<code>rocksdb_number_sst_entry_delete</code>","text":"<p>This variable shows the total number of delete markers written by MyRocks.</p>"},{"location":"status-variables.html#rocksdb_number_sst_entry_merge","title":"<code>rocksdb_number_sst_entry_merge</code>","text":"<p>This variable shows the total number of merge keys written by MyRocks.</p>"},{"location":"status-variables.html#rocksdb_number_sst_entry_other","title":"<code>rocksdb_number_sst_entry_other</code>","text":"<p>This variable shows the total number of non-delete, non-merge, non-put keys written by MyRocks.</p>"},{"location":"status-variables.html#rocksdb_number_sst_entry_put","title":"<code>rocksdb_number_sst_entry_put</code>","text":"<p>This variable shows the total number of put keys written by MyRocks.</p>"},{"location":"status-variables.html#rocksdb_number_sst_entry_singledelete","title":"<code>rocksdb_number_sst_entry_singledelete</code>","text":"<p>This variable shows the total number of single delete keys written by MyRocks.</p>"},{"location":"status-variables.html#rocksdb_number_stat_computes","title":"<code>rocksdb_number_stat_computes</code>","text":"<p>This variable isn\u2019t used anymore and will be removed in future releases.</p>"},{"location":"status-variables.html#rocksdb_number_superversion_acquires","title":"<code>rocksdb_number_superversion_acquires</code>","text":"<p>This variable shows the number of times the superversion structure has been acquired in RocksDB, this is used for tracking all of the files for the database.</p>"},{"location":"status-variables.html#rocksdb_number_superversion_cleanups","title":"<code>rocksdb_number_superversion_cleanups</code>","text":""},{"location":"status-variables.html#rocksdb_number_superversion_releases","title":"<code>rocksdb_number_superversion_releases</code>","text":""},{"location":"status-variables.html#rocksdb_rate_limit_delay_millis","title":"<code>rocksdb_rate_limit_delay_millis</code>","text":"<p>This variable was removed in Percona Server for MySQL Percona Server 5.7.23-23.</p>"},{"location":"status-variables.html#rocksdb_row_lock_deadlocks","title":"<code>rocksdb_row_lock_deadlocks</code>","text":"<p>This variable shows the total number of deadlocks that have been detected since the instance was started.</p>"},{"location":"status-variables.html#rocksdb_row_lock_wait_timeouts","title":"<code>rocksdb_row_lock_wait_timeouts</code>","text":"<p>This variable shows the total number of row lock wait timeouts that have been detected since the instance was started.</p>"},{"location":"status-variables.html#rocksdb_snapshot_conflict_errors","title":"<code>rocksdb_snapshot_conflict_errors</code>","text":"<p>This variable shows the number of snapshot conflict errors occurring during write transactions that forces the transaction to rollback.</p>"},{"location":"status-variables.html#rocksdb_stall_l0_file_count_limit_slowdowns","title":"<code>rocksdb_stall_l0_file_count_limit_slowdowns</code>","text":"<p>This variable shows the slowdowns in write due to L0 being close to full.</p>"},{"location":"status-variables.html#rocksdb_stall_locked_l0_file_count_limit_slowdowns","title":"<code>rocksdb_stall_locked_l0_file_count_limit_slowdowns</code>","text":"<p>This variable shows the slowdowns in write due to L0 being close to full and compaction for L0 is already in progress.</p>"},{"location":"status-variables.html#rocksdb_stall_l0_file_count_limit_stops","title":"<code>rocksdb_stall_l0_file_count_limit_stops</code>","text":"<p>This variable shows the stalls in write due to L0 being full.</p>"},{"location":"status-variables.html#rocksdb_stall_locked_l0_file_count_limit_stops","title":"<code>rocksdb_stall_locked_l0_file_count_limit_stops</code>","text":"<p>This variable shows the stalls in write due to L0 being full and compaction for L0 is already in progress.</p>"},{"location":"status-variables.html#rocksdb_stall_pending_compaction_limit_stops","title":"<code>rocksdb_stall_pending_compaction_limit_stops</code>","text":"<p>This variable shows the stalls in write due to hitting limits set for max number of pending compaction bytes.</p>"},{"location":"status-variables.html#rocksdb_stall_pending_compaction_limit_slowdowns","title":"<code>rocksdb_stall_pending_compaction_limit_slowdowns</code>","text":"<p>This variable shows the slowdowns in write due to getting close to limits set for max number of pending compaction bytes.</p>"},{"location":"status-variables.html#rocksdb_stall_memtable_limit_stops","title":"<code>rocksdb_stall_memtable_limit_stops</code>","text":"<p>This variable shows the stalls in write due to hitting max number of <code>memTables</code> allowed.</p>"},{"location":"status-variables.html#rocksdb_stall_memtable_limit_slowdowns","title":"<code>rocksdb_stall_memtable_limit_slowdowns</code>","text":"<p>This variable shows the slowdowns in writes due to getting close to max number of memtables allowed.</p>"},{"location":"status-variables.html#rocksdb_stall_total_stops","title":"<code>rocksdb_stall_total_stops</code>","text":"<p>This variable shows the total number of write stalls.</p>"},{"location":"status-variables.html#rocksdb_stall_total_slowdowns","title":"<code>rocksdb_stall_total_slowdowns</code>","text":"<p>This variable shows the total number of write slowdowns.</p>"},{"location":"status-variables.html#rocksdb_stall_micros","title":"<code>rocksdb_stall_micros</code>","text":"<p>This variable shows how long (in microseconds) the writer had to wait for compaction or flush to finish.</p>"},{"location":"status-variables.html#rocksdb_wal_bytes","title":"<code>rocksdb_wal_bytes</code>","text":"<p>This variables shows the number of bytes written to WAL.</p>"},{"location":"status-variables.html#rocksdb_wal_group_syncs","title":"<code>rocksdb_wal_group_syncs</code>","text":"<p>This variable shows the number of group commit WAL file syncs that have occurred.</p>"},{"location":"status-variables.html#rocksdb_wal_synced","title":"<code>rocksdb_wal_synced</code>","text":"<p>This variable shows the number of times WAL sync was done.</p>"},{"location":"status-variables.html#rocksdb_write_other","title":"<code>rocksdb_write_other</code>","text":"<p>This variable shows the number of writes processed by another thread.</p>"},{"location":"status-variables.html#rocksdb_write_self","title":"<code>rocksdb_write_self</code>","text":"<p>This variable shows the number of writes that were processed by a requesting thread.</p>"},{"location":"status-variables.html#rocksdb_write_timedout","title":"<code>rocksdb_write_timedout</code>","text":"<p>This variable shows the number of writes ending up with timed-out.</p>"},{"location":"status-variables.html#rocksdb_write_wal","title":"<code>rocksdb_write_wal</code>","text":"<p>This variable shows the number of Write calls that request WAL.</p>"},{"location":"thread-based-profiling.html","title":"Thread based profiling","text":"<p>Percona Server for MySQL now uses thread based profiling by default, instead of process based profiling. This was implemented because with process based profiling, threads on the server, other than the one being profiled, can affect the profiling information.</p>"},{"location":"thread-based-profiling.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul> <p>Thread based profiling is using the information provided by the kernel getrusage function. Since the 2.6.26 kernel version, thread based resource usage is available with the RUSAGE_THREAD. This means that the thread based profiling will be used if you\u2019re running the 2.6.26 kernel or newer, or if the RUSAGE_THREAD has been ported back.</p> <p>This feature is enabled by default if your system supports it, in other cases it uses process based profiling.</p>"},{"location":"threadpool.html","title":"Thread pool","text":"<p>MySQL executes statements using one thread per client connection. Once the number of connections increases past a certain point performance will degrade.</p> <p>This feature enables the server to keep the top performance even with a large number of client connections by introducing a dynamic thread pool. By using the thread pool server would decrease the number of threads, which will then reduce the context switching and hot locks contentions. Using the thread pool will have the most effect with <code>OLTP</code> workloads (relatively short CPU-bound queries).</p> <p>In order to enable the thread pool variable thread_handling should be set up to <code>pool-of-threads</code> value. This can be done by adding:</p> <pre><code>thread_handling=pool-of-threads\n</code></pre> <p>Although the default values for the thread pool should provide good performance, additional tuning can be performed with the dynamic system variables.</p> <p>Note</p> <p>Current implementation of the thread pool is built in the server, unlike the upstream version which is implemented as a plugin. Another significant implementation difference is that this implementation doesn\u2019t try to minimize the number of concurrent transactions like the <code>MySQL Enterprise Threadpool</code>. Because of these differences, this implementation is not compatible with the upstream version.</p>"},{"location":"threadpool.html#priority-connection-scheduling","title":"Priority connection scheduling","text":"<p>Even though thread pool puts a limit on the number of concurrently running queries, the number of open transactions may remain high, because connections with already started transactions are put to the end of the queue. Higher number of open transactions has a number of implications on the currently running queries. To improve the performance new thread_pool_high_prio_tickets variable has been introduced.</p> <p>This variable controls the high priority queue policy. Each new connection is assigned this many tickets to enter the high priority queue. Whenever a query has to be queued to be executed later because no threads are available, the thread pool puts the connection into the high priority queue if the following conditions apply:</p> <ul> <li> <p>The connection has an open transaction in the server.</p> </li> <li> <p>The number of high priority tickets of this connection is non-zero.</p> </li> </ul> <p>If both the above conditions hold, the connection is put into the high priority queue and its tickets value is decremented. Otherwise the connection is put into the common queue with the initial tickets value specified with this option.</p> <p>Each time the thread pool looks for a new connection to process, first it checks the high priority queue, and picks connections from the common queue only when the high priority one is empty.</p> <p>The goal is to minimize the number of open transactions in the server. In many cases it is beneficial to give short-running transactions a chance to commit faster and thus deallocate server resources and locks without waiting in the same queue with other connections that are about to start a new transaction, or those that have run out of their high priority tickets.</p> <p>The default thread pool behavior is to always put events from already started transactions into the high priority queue, as we believe that results in better performance in vast majority of cases.</p> <p>With the value of <code>0</code>, all connections are always put into the common queue, i.e. no priority scheduling is used as in the original implementation in MariaDB. The higher is the value, the more chances each transaction gets to enter the high priority queue and commit before it is put in the common queue.</p> <p>In some cases it is required to prioritize all statements for a specific connection regardless of whether they are executed as a part of a multi-statement transaction or in the autocommit mode. Or vice versa, some connections may require using the low priority queue for all statements unconditionally. To implement this new thread_pool_high_prio_mode variable has been introduced in Percona Server for MySQL.</p>"},{"location":"threadpool.html#low-priority-queue-throttling","title":"Low priority queue throttling","text":"<p>One case that can limit thread pool performance and even lead to deadlocks under high concurrency is a situation when thread groups are oversubscribed due to active threads reaching the oversubscribe limit, but all/most worker threads are actually waiting on locks currently held by a transaction from another connection that is not currently in the thread pool.</p> <p>What happens in this case is that those threads in the pool that have marked themselves inactive are not accounted to the oversubscribe limit. As a result, the number of threads (both active and waiting) in the pool grows until it hits thread_pool_max_threads value. If the connection executing the transaction which is holding the lock has managed to enter the thread pool by then, we get a large (depending on the thread_pool_max_threads value) number of concurrently running threads, and thus, suboptimal performance as a result. Otherwise, we get a deadlock as no more threads can be created to process those transaction(s) and release the lock(s).</p> <p>Such situations are prevented by throttling the low priority queue when the total number of worker threads (both active and waiting ones) reaches the oversubscribe limit. That is, if there are too many worker threads, do not start new transactions and create new threads until queued events from the already started transactions are processed.</p>"},{"location":"threadpool.html#handling-of-long-network-waits","title":"Handling of long network waits","text":"<p>Certain types of workloads (large result sets, BLOBs, slow clients) can have longer waits on network I/O (socket reads and writes). Whenever server waits, this should be communicated to the Thread Pool, so it can start new query by either waking a waiting thread or sometimes creating a new one. This implementation has been ported from MariaDB patch MDEV-156.</p>"},{"location":"threadpool.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: <code>Thread Pool</code> feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"threadpool.html#system-variables","title":"System variables","text":""},{"location":"threadpool.html#thread_pool_idle_timeout","title":"<code>thread_pool_idle_timeout</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: Yes Data type: Numeric Default value: 60 (seconds) <p>This variable can be used to limit the time an idle thread should wait before exiting.</p>"},{"location":"threadpool.html#thread_pool_high_prio_mode","title":"<code>thread_pool_high_prio_mode</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global, Session Dynamic: Yes Data type: String Default value: <code>transactions</code> Allowed values: <code>transactions</code>, <code>statements</code>, <code>none</code> <p>This variable is used to provide more fine-grained control over high priority scheduling either globally or per connection.</p> <p>The following values are allowed:</p> <ul> <li> <p><code>transactions</code> (the default). In this mode only statements from already started transactions may go into the high priority queue depending on the number of high priority tickets currently available in a connection (see thread_pool_high_prio_tickets).</p> </li> <li> <p><code>statements</code>. In this mode all individual statements go into the high priority queue, regardless of connection\u2019s transactional state and the number of available high priority tickets. This value can be used to prioritize <code>AUTOCOMMIT</code> transactions or other kinds of statements such as administrative ones for specific connections. Note that setting this value globally essentially disables high priority scheduling, since in this case all statements from all connections will use a single queue (the high priority one)</p> </li> <li> <p><code>none</code>. This mode disables high priority queue for a connection. Some connections (e.g. monitoring) may be insensitive to execution latency and/or never allocate any server resources that would otherwise impact performance in other connections and thus, do not really require high priority scheduling. Note that setting thread_pool_high_prio_mode to <code>none</code> globally has essentially the same effect as setting it to <code>statements</code> globally: all connections will always use a single queue (the low priority one in this case).</p> </li> </ul>"},{"location":"threadpool.html#thread_pool_high_prio_tickets","title":"<code>thread_pool_high_prio_tickets</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global, Session Dynamic: Yes Data type: Numeric Default value: 4294967295 <p>This variable controls the high priority queue policy. Each new connection is assigned this many tickets to enter the high priority queue. Setting this variable to <code>0</code> will disable the high priority queue.</p>"},{"location":"threadpool.html#thread_pool_max_threads","title":"<code>thread_pool_max_threads</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: Yes Data type: Numeric Default value: 100000 <p>This variable can be used to limit the maximum number of threads in the pool. Once this number is reached no new threads will be created.</p>"},{"location":"threadpool.html#thread_pool_oversubscribe","title":"<code>thread_pool_oversubscribe</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: Yes Data type: Numeric Default value: 3 <p>The higher the value of this parameter the more threads can be run at the same time, if the values is lower than <code>3</code> it could lead to more sleeps and wake-ups.</p>"},{"location":"threadpool.html#thread_pool_size","title":"<code>thread_pool_size</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: Yes Data type: Numeric Default value: Number of processors <p>This variable can be used to define the number of threads that can use the CPU at the same time.</p>"},{"location":"threadpool.html#thread_pool_stall_limit","title":"<code>thread_pool_stall_limit</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: No Data type: Numeric Default value: 500 (ms) <p>The number of milliseconds before a running thread is considered stalled. When this limit is reached thread pool will wake up or create another thread. This is being used to prevent a long-running query from monopolizing the pool.</p>"},{"location":"threadpool.html#upgrading-from-a-version-before-8014-to-8014-or-higher","title":"Upgrading from a version before 8.0.14 to 8.0.14 or higher","text":"<p>Starting with 8.0.14, Percona Server for MySQL uses the upstream implementation of the admin_port. The variables extra_port and extra_max_connections are removed and not supported. It is essential to remove the <code>extra_port</code> and <code>extra_max_connections</code> variables from your configuration file before you attempt to upgrade from a release before 8.0.14 to Percona Server for MySQL version 8.0.14 or higher. Otherwise, a server produces a boot error and refuses to start.</p> <p>See also</p> <p>MySQL Documentation:</p> <ul> <li>admin_port</li> </ul>"},{"location":"threadpool.html#extra_port","title":"<code>extra_port</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: No Data type: Numeric Default value: 0 <p>The varible was removed in Percona Server for MySQL 8.0.14. This variable can be used to specify an additional port that Percona Server for MySQL will listen on. This can be used in case no new connections can be established due to all worker threads being busy or being locked when <code>pool-of-threads</code> feature is enabled. To connect to the extra port the following command can be used:</p> <pre><code>mysql --port='extra-port-number' --protocol=tcp\n</code></pre>"},{"location":"threadpool.html#extra_max_connections","title":"<code>extra_max_connections</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: No Data type: Numeric Default value: 1 <p>The varible was removed in Percona Server for MySQL 8.0.14. This variable can be used to specify the maximum allowed number of connections plus one extra <code>SUPER</code> users connection on the extra_port. This can be used with the extra_port variable to access the server in case no new connections can be established due to all worker threads being busy or being locked when <code>pool-of-threads</code> feature is enabled.</p>"},{"location":"threadpool.html#status-variables","title":"Status variables","text":""},{"location":"threadpool.html#threadpool_idle_threads","title":"<code>Threadpool_idle_threads</code>","text":"Option Description Scope: Global Data type: Numeric <p>This status variable shows the number of idle threads in the pool.</p>"},{"location":"threadpool.html#threadpool_threads","title":"<code>Threadpool_threads</code>","text":"Option Description Scope: Global Data type: Numeric <p>This status variable shows the number of threads in the pool.</p>"},{"location":"threadpool.html#other-reading","title":"Other reading","text":"<ul> <li> <p>Thread pool in MariaDB 5.5</p> </li> <li> <p>Thread pool implementation in Oracle MySQL</p> </li> </ul>"},{"location":"toku-backup.html","title":"Percona TokuBackup","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>Percona TokuBackup is an open-source hot backup utility for MySQL servers running the TokuDB storage engine (including Percona Server for MySQL and MariaDB). It does not lock your database during backup. The TokuBackup library intercepts system calls that write files and duplicates the writes to the backup directory.</p> <p>Note</p> <p>This feature is currently considered tech preview and should not be used in a production environment.</p>"},{"location":"toku-backup.html#installing-from-binaries","title":"Installing From Binaries","text":"<p>The installation of TokuBackup can be performed with the ps-admin script.</p> <p>To install Percona TokuBackup complete the following steps. Run the following commands as root or by using the sudo command.</p> <ol> <li> <p>Run ps-admin.enable-tokubackup to add the <code>preload-hotbackup</code> option into [mysqld_safe] section of <code>my.cnf</code>.</p> <p>The output could be:</p> <p><pre><code>Checking SELinux status... INFO: SELinux is disabled.\n\nChecking if preload-hotbackup option is already set in config file... INFO: Option preload-hotbackup is not set in the config file.\n\nChecking TokuBackup plugin status... INFO: TokuBackup plugin is not installed.\n\nAdding preload-hotbackup option into /etc/my.cnf INFO: Successfully added preload-hotbackup option into /etc/my.cnf PLEASE RESTART MYSQL SERVICE AND RUN THIS SCRIPT AGAIN TO FINISH INSTALLATION!\n</code></pre> 2. Restart mysql service: :bash:</p> <pre><code>    $ service mysql restart\n</code></pre> </li> <li> <p>Run ps-admin \u2013enable-tokubackup again to finish the installation of the TokuBackup plugin.</p> <p>```text Checking SELinux status\u2026 INFO: SELinux is disabled.</p> <p>Checking if preload-hotbackup option is already set in config file\u2026 INFO: Option preload-hotbackup is set in the config file.</p> <p>Checking TokuBackup plugin status\u2026 INFO: TokuBackup plugin is not installed.</p> <p>Checking if Percona Server is running with libHotBackup.so preloaded\u2026 INFO: Percona Server is running with libHotBackup.so preloaded.</p> <p>Installing TokuBackup plugin\u2026 INFO: Successfully installed TokuBackup plugin.</p> </li> </ol>"},{"location":"toku-backup.html#making-a-backup","title":"Making a Backup","text":"<p>To run Percona TokuBackup, the backup destination directory must exist, be writable and owned by the same user under which MySQL server is running (usually <code>mysql</code>) and empty.</p> <p>Once this directory is created, the backup can be run using the following command:</p> <pre><code>mysql&gt; set tokudb_backup_dir='/path_to_empty_directory';\n</code></pre> <p>Note</p> <p>Setting the tokudb_backup_dir variable automatically starts the backup process to the specified directory. Percona TokuBackup will take full backup each time, currently there is no incremental backup option</p> <p>If you get any error on this step (e.g. caused by some misconfiguration), the Reporting Errors section explains how to find out the reason.</p>"},{"location":"toku-backup.html#restoring-from-backup","title":"Restoring From Backup","text":"<p>Percona TokuBackup does not have any functionality for restoring a backup. You can use rsync or cp to restore the files. You should check that the restored files have the correct ownership and permissions.</p> <p>NOTE: Make sure that the datadir is empty and that MySQL server is shut down before restoring from backup. You can\u2019t restore to a datadir of a running mysqld instance (except when importing a partial backup).</p> <p>The following example shows how you might use the rsync command to restore the backup:</p> <pre><code>$ rsync -avrP /data/backup/ /var/lib/mysql/\n</code></pre> <p>Since attributes of files are preserved, in most cases you will need to change their ownership to mysql before starting the database server. Otherwise, the files will be owned by the user who created the backup.</p> <pre><code>$ chown -R mysql:mysql /var/lib/mysql\n</code></pre> <p>If you have changed default TokuDB data directory (tokudb_data_dir) or TokuDB log directory (tokudb_log_dir) or both of them, you will see separate folders for each setting in backup directory after taking backup. You\u2019ll need to restore each folder separately:</p> <pre><code>$ rsync -avrP /data/backup/mysql_data_dir/ /var/lib/mysql/\n$ rsync -avrP /data/backup/tokudb_data_dir/ /path/to/original/tokudb_data_dir/\n$ rsync -avrP /data/backup/tokudb_log_dir/ /path/to/original/tokudb_log_dir/\n$ chown -R mysql:mysql /var/lib/mysql\n$ chown -R mysql:mysql /path/to/original/tokudb_data_dir\n$ chown -R mysql:mysql /path/to/original/tokudb_log_dir\n</code></pre>"},{"location":"toku-backup.html#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"toku-backup.html#monitoring-progress","title":"Monitoring Progress","text":"<p>TokuBackup updates the PROCESSLIST state while the backup is in progress. You can see the output by running <code>SHOW PROCESSLIST</code> or <code>SHOW FULL PROCESSLIST</code>.</p>"},{"location":"toku-backup.html#excluding-source-files","title":"Excluding Source Files","text":"<p>You can exclude certain files and directories based on a regular expression set in the tokudb_backup_exclude session variable. If the source file name matches the excluded regular expression, then the source file is excluded from backup.</p> <p>For example, to exclude all <code>lost+found</code> directories from backup, use the following command:</p> <pre><code>mysql&gt; SET tokudb_backup_exclude='/lost\\\\+found($|/)';\n</code></pre> <p>Note</p> <p>The server <code>pid</code> file is excluded by default. If you\u2019re providing your own additions to the exclusions and have the <code>pid</code> file in the default location, you will need to add the mysqld_safe.pid entry.</p>"},{"location":"toku-backup.html#throttling-backup-rate","title":"Throttling Backup Rate","text":"<p>You can throttle the backup rate using the tokudb_backup_throttle session-level variable. This variable throttles the write rate in bytes per second of the backup to prevent TokuBackup from crowding out other jobs in the system. The default and max value is 18446744073709551615.</p> <pre><code>mysql&gt; SET tokudb_backup_throttle=1000000;\n</code></pre>"},{"location":"toku-backup.html#restricting-backup-target","title":"Restricting Backup Target","text":"<p>You can restrict the location of the destination directory where the backups can be located using the tokudb_backup_allowed_prefix system-level variable. Attempts to backup to a location outside of the specified directory or its children will result in an error.</p> <p>The default is <code>null</code>, backups have no restricted locations. This read-only variable can be set in the <code>my.cnf</code> configuration file and displayed with the <code>SHOW VARIABLES</code> command:</p> <pre><code>mysql&gt; SHOW VARIABLES LIKE 'tokudb_backup_allowed_prefix';\n</code></pre> <p>The output could be:</p> <pre><code>+------------------------------+-----------+\n| Variable_name                | Value     |\n+------------------------------+-----------+\n| tokudb_backup_allowed_prefix | /dumpdir  |\n+------------------------------+-----------+\n</code></pre>"},{"location":"toku-backup.html#reporting-errors","title":"Reporting Errors","text":"<p>Percona TokuBackup uses two variables to capture errors. They are tokudb_backup_last_error and tokudb_backup_last_error_string. When TokuBackup encounters an error, these will report on the error number and the error string respectively. For example, the following output shows these parameters following an attempted backup to a directory that was not empty:</p> <pre><code>mysql&gt; SET tokudb_backup_dir='/tmp/backupdir';\n</code></pre> <p>The output could be:</p> <pre><code>ERROR 1231 (42000): Variable 'tokudb_backup_dir' can't be set to the value of '/tmp/backupdir'\n\nmysql&gt; SELECT @@tokudb_backup_last_error;\n+----------------------------+\n| @@tokudb_backup_last_error |\n+----------------------------+\n|                         17 |\n+----------------------------+\n</code></pre> <pre><code>mysql&gt; SELECT @@tokudb_backup_last_error_string;\n</code></pre> <p>The output could be:</p> <pre><code>+---------------------------------------------------+\n| @@tokudb_backup_last_error_string                 |\n+---------------------------------------------------+\n| tokudb backup couldn't create needed directories. |\n+---------------------------------------------------+\n</code></pre>"},{"location":"toku-backup.html#using-tokudb-hot-backup-for-replication","title":"Using TokuDB Hot Backup for Replication","text":"<p>TokuDB Hot Backup makes a transactionally consistent copy of the TokuDB files while applications read and write to these files. The TokuDB hot backup library intercepts certain system calls that writes files and duplicates the writes on backup files while copying files to the backup directory. The copied files contain the same content as the original files.</p> <p>TokuDB Hot Backup also has an API. This API includes the <code>start capturing</code> and <code>stop capturing</code> commands. The \u201ccapturing\u201d command starts the process, when a portion of a file is copied to the backup location, and this portion is changed, these changes are also applied to the backup location.</p> <p>Replication often uses backup replication to create replicas. You must know the last executed global transaction identifier (GTID) or binary log position both for the replica and source configuration.</p> <p>To lock tables, use <code>FLUSH TABLE WITH READ LOCK</code> or use the smart locks like <code>LOCK TABLES FOR BACKUP</code> or <code>LOCK BINLOG FOR BACKUP</code>.</p> <p>During the copy process, the binlog is flushed, and the changes are copied to backup by the \u201ccapturing\u201d mechanism. After everything has been copied, and the \u201ccapturing\u201d mechanism is still running, use the <code>LOCK BINLOG FOR BACKUP</code>. After this statement is executed, the binlog is flushed, the changes are captured, and any queries that could change the binlog position or executed GTID are blocked.</p> <p>After this command, we can stop capturing and retrieve the last executed GTID or binlog log position and unlock the binlog.</p> <p>After a backup is taken, there are the following files in the backup directory:</p> <ul> <li> <p>tokubackup_slave_info</p> </li> <li> <p>tokubackup_binlog_info</p> </li> </ul> <p>These files contain information for replica and source. You can use this information to start a new replica from the source or replica.</p> <p>The <code>SHOW MASTER STATUS</code> and <code>SHOW SLAVE STATUS</code> commands provide the information.</p> <p>Important</p> <p>As of MySQL 8.0.22, the <code>SHOW SLAVE STATUS</code> statement is deprecated. Use <code>SHOW REPLICA STATUS</code> instead.</p> <p>In specific binlog formats, a binary log event can contain statements that produce temporary tables on the replica side, and the result of further statements may depend on the temporary table content. Typically, temporary tables are not selected for backup because they are created in a separate directory. A backup created with temporary tables created by binlog events can cause issues when restored because the temporary tables are not restored. The data may be inconsistent.</p> <p>The following system variables \u2013tokudb-backup-safe-slave, which enables or disables the safe-slave mode, and \u2013tokudb-backup-safe-slave-timeout, which defines the maximum amount of time in seconds to wait until temporary tables disappear.  The <code>safe-slave</code> mode, when used with <code>LOCK BINLOG FOR BACKUP</code>, the replica SQL thread is stopped and checked to see if temporary tables produced by the replica exist or do not exist. If temporary tables exist, the replica SQL thread is restarted until there are no temporary tables or a defined timeout is reached.</p> <p>You should not use this option for group-replication.</p>"},{"location":"toku-backup.html#create-a-backup-with-a-timestamp","title":"Create a Backup with a Timestamp","text":"<p>If you plan to store more than one backup in a location, you should add a timestamp to the backup directory name.</p> <p>A sample Bash script has this information:</p> <pre><code>#!/bin/bash\n\ntm=$(date \"+%Y-%m-%d-%H-%M-%S\");\nbackup_dir=$PWD/backup/$tm;\nmkdir -p $backup_dir;\nbin/mysql -uroot -e \"set tokudb_backup_dir='$backup_dir'\"\n</code></pre>"},{"location":"toku-backup.html#limitations-and-known-issues","title":"Limitations and known issues","text":"<ul> <li> <p>You must disable InnoDB asynchronous IO if backing up InnoDB tables with TokuBackup. Otherwise you will have inconsistent, unrecoverable backups. The appropriate setting is <code>innodb_use_native_aio=0</code>.</p> </li> <li> <p>To be able to run Point-In-Time-Recovery you\u2019ll need to manually get the binary log position.</p> </li> <li> <p>Transactional storage engines (TokuDB and InnoDB) will perform recovery on the backup copy of the database when it is first started.</p> </li> <li> <p>Tables using non-transactional storage engines (MyISAM) are not locked during the copy and may report issues when starting up the backup. It is best to avoid operations that modify these tables at the end of a hot backup operation (adding/changing users, stored procedures, etc.).</p> </li> <li> <p>The database is copied locally to the path specified in <code>/path/to/backup</code>. This folder must exist, be writable, be empty, and contain enough space for a full copy of the database.</p> </li> <li> <p>TokuBackup always makes a backup of the MySQL datadir and optionally the tokudb_data_dir, tokudb_log_dir, and the binary log folder. The latter three are only backed up separately if they are not the same as or contained in the MySQL datadir. None of these three folders can be a parent of the MySQL datadir.</p> </li> <li> <p>No other directory structures are supported. All InnoDB, MyISAM, and other storage engine files must be within the MySQL datadir.</p> </li> <li> <p>TokuBackup does not follow symbolic links.</p> </li> <li> <p>TokuBackup does not backup MySQL configuration file(s).</p> </li> <li> <p>TokuBackup does not backup tablespaces if they are out of datadir.</p> </li> <li> <p>Due to upstream bug #80183, TokuBackup can\u2019t recover backed-up table data if backup was taken while running <code>OPTIMIZE TABLE</code> or <code>ALTER TABLE ... TABLESPACE</code>.</p> </li> <li> <p>TokuBackup doesn\u2019t support incremental backups.</p> </li> </ul>"},{"location":"tokudb-background-analyze-table.html","title":"TokuDB background ANALYZE TABLE","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>Percona Server for MySQL has an option to automatically analyze tables in the background based on a measured change in data. This has been done by implementing the background job manager that can perform operations on a background thread.</p>"},{"location":"tokudb-background-analyze-table.html#background-jobs","title":"Background Jobs","text":"<p>Background jobs and schedule are transient in nature and are not persisted anywhere. Any currently running job will be terminated on shutdown and all scheduled jobs will be forgotten about on server restart. There can\u2019t be two jobs on the same table scheduled or running at any one point in time. If you manually invoke an <code>ANALYZE TABLE</code> that conflicts with either a pending or running job, the running job will be canceled and the users task will run immediately in the foreground. All the scheduled and running background jobs can be viewed by querying the TOKUDB_BACKGROUND_JOB_STATUS table.</p> <p>New tokudb_analyze_in_background variable has been implemented in order to control if the <code>ANALYZE TABLE</code> will be dispatched to the background process or if it will be running in the foreground. To control the function of <code>ANALYZE TABLE</code> a new tokudb_analyze_mode variable has been implemented. This variable offers options to cancel any running or scheduled job on the specified table (<code>TOKUDB_ANALYZE_CANCEL</code>), use existing analysis algorithm (<code>TOKUDB_ANALYZE_STANDARD</code>), or to recount the logical rows in table and update persistent count (<code>TOKUDB_ANALYZE_RECOUNT_ROWS</code>).</p> <p><code>TOKUDB_ANALYZE_RECOUNT_ROWS</code> is a new mechanism that is used to perform a logical recount of all rows in a table and persist that as the basis value for the table row estimate. This mode was added for tables that have been upgraded from an older version of TokuDB that only reported physical row counts and never had a proper logical row count. Newly created tables/partitions will begin counting logical rows correctly from their creation and should not need to be recounted unless some odd edge condition causes the logical count to become inaccurate over time. This analysis mode has no effect on the table cardinality counts. It will take the currently set session values for tokudb_analyze_in_background, and tokudb_analyze_throttle. Changing the global or session instances of these values after scheduling will have no effect on the job.</p> <p>Any background job, both pending and running, can be canceled by setting the tokudb_analyze_mode to <code>TOKUDB_ANALYZE_CANCEL</code> and issuing the <code>ANALYZE TABLE</code> on the table for which you want to cancel all the jobs for.</p>"},{"location":"tokudb-background-analyze-table.html#auto-analysis","title":"Auto analysis","text":"<p>To implement the background analysis and gathering of cardinality statistics on a TokuDB tables new <code>delta</code> value is now maintained in memory for each TokuDB table. This value is not persisted anywhere and it is reset to <code>0</code> on a server start. It is incremented for each <code>INSERT/UPDATE/DELETE</code> command and ignores the impact of transactions (rollback specifically). When this delta value exceeds the tokudb_auto_analyze percentage of rows in the table an analysis is performed according to the current session\u2019s settings. Other analysis for this table will be disabled until this analysis completes. When this analysis completes, the delta is reset to <code>0</code> to begin recalculating table changes for the next potential analysis.</p> <p>Status values are now reported to server immediately upon completion of any analysis (previously new status values were not used until the table has been closed and re-opened). Half-time direction reversal of analysis has been implemented, meaning that if a tokudb_analyze_time is in effect and the analysis has not reached the half way point of the index by the time tokudb_analyze_time/2 has been reached: it will stop the forward progress and restart the analysis from the last/rightmost row in the table, progressing leftwards and keeping/adding to the status information accumulated from the first half of the scan.</p> <p>For small ratios of <code>table_rows</code> / tokudb_auto_analyze, auto analysis will be run for almost every change. The trigger formula is: <code>if (table_delta &gt;= ((table_rows \\* tokudb_auto_analyze) / 100))</code> then run <code>ANALYZE TABLE</code>. If a user manually invokes an <code>ANALYZE TABLE</code> and tokudb_auto_analyze is enabled and there are no conflicting background jobs, the users <code>ANALYZE TABLE</code> will behave exactly as if the delta level has been exceeded in that the analysis is executed and delta reset to <code>0</code> upon completion.</p>"},{"location":"tokudb-background-analyze-table.html#system-variables","title":"System Variables","text":""},{"location":"tokudb-background-analyze-table.html#tokudb_analyze_in_background","title":"<code>tokudb_analyze_in_background</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Boolean Default ON <p>When this variable is set to <code>ON</code>  it will dispatch any <code>ANALYZE TABLE</code> job to a background process and return immediately, otherwise <code>ANALYZE TABLE</code> will run in foreground/client context.</p>"},{"location":"tokudb-background-analyze-table.html#tokudb_analyze_mode","title":"<code>tokudb_analyze_mode</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type ENUM Default TOKUDB_ANALYZE_STANDARD Range TOKUDB_ANALYZE_CANCEL, TOKUDB_ANALYZE_STANDARD, TOKUDB_ANALYZE_RECOUNT_ROWS <p>This variable is used to control the function of <code>ANALYZE TABLE</code>. Possible values are:</p> <pre><code>* `TOKUDB_ANALYZE_CANCEL` - Cancel any running or scheduled job on the specified table.\n\n\n* `TOKUDB_ANALYZE_STANDARD` - Use existing analysis algorithm. This is the standard table cardinality analysis mode used to obtain cardinality statistics for a tables and its indexes. It will take the currently set session values for tokudb_analyze_time, tokudb_analyze_in_background, and tokudb_analyze_throttle at the time of its scheduling, either via a user invoked `ANALYZE TABLE` or an auto schedule as a result of tokudb_auto_analyze threshold being hit. Changing the global or session instances of these values after scheduling will have no effect on the scheduled job.\n\n\n* `TOKUDB_ANALYZE_RECOUNT_ROWS` - Recount logical rows in table and update persistent count. This is a new mechanism that is used to perform a logical recount of all rows in a table and persist that as the basis value for the table row estimate. This mode was added for tables that have been upgraded from an older version of *TokuDB*/PerconaFT that only reported physical row counts and never had a proper logical row count. Newly created tables/partitions will begin counting logical rows correctly from their creation and should not need to be recounted unless some odd edge condition causes the logical count to become inaccurate over time. This analysis mode has no effect on the table cardinality counts. It will take the currently set session values for tokudb_analyze_in_background, and tokudb_analyze_throttle. Changing the global or session instances of these values after scheduling will have no effect on the job.\n</code></pre>"},{"location":"tokudb-background-analyze-table.html#tokudb_analyze_throttle","title":"<code>tokudb_analyze_throttle</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Numeric Default 0 <p>This variable is used to define maximum number of keys to visit per second when performing <code>ANALYZE TABLE</code> with either a <code>TOKUDB_ANALYZE_STANDARD</code> or <code>TOKUDB_ANALYZE_RECOUNT_ROWS</code>.</p>"},{"location":"tokudb-background-analyze-table.html#tokudb_analyze_time","title":"<code>tokudb_analyze_time</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Numeric Default 5 <p>This session variable controls the number of seconds an analyze operation will spend on each index when calculating cardinality. Cardinality is shown by executing the following command:</p> <pre><code>```text\nSHOW INDEXES FROM table_name;\n```\n</code></pre> <p>If an analyze is never performed on a table then the cardinality is <code>1</code> for primary key indexes and unique secondary indexes, and <code>NULL</code> (unknown) for all other indexes. Proper cardinality can lead to improved performance of complex SQL statements.</p>"},{"location":"tokudb-background-analyze-table.html#tokudb_auto_analyze","title":"<code>tokudb_auto_analyze</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Numeric Default 30 <p>Percentage of table change as <code>INSERT/UPDATE/DELETE</code> commands to trigger an <code>ANALYZE TABLE</code> using the current session tokudb_analyze_in_background, tokudb_analyze_mode, tokudb_analyze_throttle, and tokudb_analyze_time settings. If this variable is enabled and tokudb_analyze_in_background variable is set to <code>OFF</code>, analysis will be performed directly within the client thread context that triggered the analysis. NOTE: InnoDB enabled this functionality by default when they introduced it. Due to the potential unexpected new load it might place on a server, it is disabled by default in TokuDB.</p>"},{"location":"tokudb-background-analyze-table.html#tokudb_cardinality_scale_percent","title":"<code>tokudb_cardinality_scale_percent</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Numeric Default 100 Range 0-100 <p>Percentage to scale table/index statistics when sending to the server to make an index appear to be either more or less unique than it actually is. InnoDB has a hard coded scaling factor of 50%. So if a table of 200 rows had an index with 40 unique values, InnoDB would return 200/40/2 or 2 for the index. The new TokuDB formula is the same but factored differently to use percent, for the same table.index (200/40 * tokudb_cardinality_scale) / 100, for a scale of 50% the result would also be 2 for the index.</p>"},{"location":"tokudb-background-analyze-table.html#information_schema-tables","title":"INFORMATION_SCHEMA Tables","text":"<p><code>INFORMATION_SCHEMA.TOKUDB_BACKGROUND_JOB_STATUS</code></p> Column Name Description \u2018id\u2019 \u2018Simple monotonically incrementing job id, resets to 0 on server start.\u2019 \u2018database_name\u2019 \u2018Database name\u2019 \u2018table_name\u2019 \u2018Table name\u2019 \u2018job_type\u2019 \u2018Type of job, either TOKUDB_ANALYZE_STANDARD or TOKUDB_ANALYZE_RECOUNT_ROWS\u2019 \u2018job_params\u2019 \u2018Param values used by this job in string format. For example: TOKUDB_ANALYZE_DELETE_TIME=1.0; TOKUDB_ANALYZE_TIME=5; TOKUDB_ANALYZE_THROTTLE=2048;\u2019 \u2018scheduler\u2019 \u2018Either USER or AUTO to indicate if the job was explicitly scheduled by a user or if it was scheduled as an automatic trigger\u2019 \u2018scheduled_time\u2019 \u2018The time the job was scheduled\u2019 \u2018started_time\u2019 \u2018The time the job was started\u2019 \u2018status\u2019 \u2018Current job status if running. For example: ANALYZE TABLE standard db.tbl.idx 3 of 5 50% rows 10% time scanning forward\u2019 <p>This table holds the information on scheduled and running background <code>ANALYZE TABLE</code> jobs for TokuDB tables.</p>"},{"location":"tokudb-faq.html","title":"TokuDB frequently asked questions","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>This section contains frequently asked questions regarding TokuDB and related software.</p>"},{"location":"tokudb-faq.html#transactional-operations","title":"Transactional Operations","text":""},{"location":"tokudb-faq.html#what-transactional-operations-does-tokudb-support","title":"What transactional operations does TokuDB support?","text":"<p>TokuDB supports <code>BEGIN TRANSACTION</code>, <code>END TRANSACTION</code>, <code>COMMIT</code>, <code>ROLLBACK</code>, <code>SAVEPOINT</code>, and <code>RELEASE SAVEPOINT</code>.</p>"},{"location":"tokudb-faq.html#tokudb-and-the-file-system","title":"TokuDB and the File System","text":""},{"location":"tokudb-faq.html#how-can-i-determine-which-files-belong-to-the-various-tables-and-indexes-in-my-schemas","title":"How can I determine which files belong to the various tables and indexes in my schemas?","text":"<p>The tokudb_file_map plugin lists all Fractal Tree Indexes and their corresponding data files. The <code>internal_file_name</code> is the actual file name (in the data folder).</p> <pre><code>mysqlSELECT * FROM information_schema.tokudb_file_map;\n</code></pre> <p>The output could be:</p> <pre><code>+--------------------------+---------------------------------------+---------------+-------------+------------------------+\n| dictionary_name          | internal_file_name                    | table_schema  | table_name  | table_dictionary_name  |\n+--------------------------+---------------------------------------+---------------+-------------+------------------------+\n| ./test/tmc-key-idx_col2  | ./_test_tmc_key_idx_col2_a_14.tokudb  | test          | tmc         | key_idx_col2           |\n| ./test/tmc-main          | ./_test_tmc_main_9_14.tokudb          | test          | tmc         | main                   |\n| ./test/tmc-status        | ./_test_tmc_status_8_14.tokudb        | test          | tmc         | status                 |\n+--------------------------+---------------------------------------+---------------+-------------+------------------------+\n</code></pre>"},{"location":"tokudb-faq.html#full-disks","title":"Full Disks","text":""},{"location":"tokudb-faq.html#what-happens-when-the-disk-system-fills-up","title":"What happens when the disk system fills up?","text":"<p>The disk system may fill up during bulk load operations, such as <code>LOAD DATA IN FILE</code> or <code>CREATE INDEX</code>, or during incremental operations like <code>INSERT</code>.</p> <p>In the bulk case, running out of disk space will cause the statement to fail with <code>ERROR 1030 (HY000): Got error 1 from storage engine</code>. The temporary space used by the bulk loader will be released. If this happens, you can use a separate physical disk for the temporary files (for more information, see tokudb_tmp_dir). If server runs out of free space TokuDB will assert the server to prevent data corruption to existing data files.</p> <p>Otherwise, disk space can run low during non-bulk operations. When available space is below a user-configurable reserve (5% by default) inserts are prevented and transactions that perform inserts are aborted. If the disk becomes completely full then TokuDB will freeze until some disk space is made available.</p> <p>Details about the disk system:</p> <ul> <li>There is a free-space reserve requirement, which is a user-configurable parameter given as a percentage of the total space in the file system. The default reserve is five percent. This value is available in the global variable tokudb_fs_reserve_percent. We recommend that this reserve be at least half the size of your physical memory.</li> </ul> <p>TokuDB polls the file system every five seconds to determine how much free space is available. If the free space dips below the reserve, then further table inserts are prohibited. Any transaction that attempts to insert rows will be aborted. Inserts are re-enabled when twice the reserve is available in the file system (so freeing a small amount of disk storage will not be sufficient to resume inserts). Warning messages are sent to the system error log when free space dips below twice the reserve and again when free space dips below the reserve.</p> <p>Even with inserts prohibited it is still possible for the file system to become completely full. For example this can happen because another storage engine or another application consumes disk space.</p> <ul> <li> <p>If the file system becomes completely full, then TokuDB will freeze. It will not crash, but it will not respond to most SQL commands until some disk space is made available. When TokuDB is frozen in this state, it will still respond to the following command:</p> <pre><code>SHOW ENGINE TokuDB STATUS;\n</code></pre> <p>The output could be:</p> <pre><code>Make disk space available will allow the storage engine to continue running, but inserts will still be prohibited until twice the reserve is free.\n</code></pre> <p>Note</p> <p>Engine status displays a field indicating if disk free space is above twice the reserve, below twice the reserve, or below the reserve. It will also display a special warning if the disk is completely full.</p> </li> <li> <p>In order to make space available on this system you can:</p> <ul> <li> <p>Add some disk space to the filesystem.</p> </li> <li> <p>Delete some non-TokuDB files manually.</p> </li> <li> <p>If the disk is not completely full, you may be able to reclaim space by aborting any transactions that are very old. Old transactions can consume large volumes of disk space in the recovery log.</p> </li> <li> <p>If the disk is not completely full, you can drop indexes or drop tables from your TokuDB databases.</p> </li> <li> <p>Deleting large numbers of rows from an existing table and then closing the table may free some space, but it may not. Deleting rows may simply leave unused space (available for new inserts) inside TokuDB data files rather than shrink the files (internal fragmentation).</p> </li> </ul> </li> </ul> <p>The fine print:</p> <ul> <li> <p>The TokuDB storage engine can use up to three separate file systems simultaneously, one each for the data, the recovery log, and the error log. All three are monitored, and if any one of the three falls below the relevant threshold then a warning message will be issued and inserts may be prohibited.</p> </li> <li> <p>Warning messages to the error log are not repeated unless available disk space has been above the relevant threshold for at least one minute. This prevents excess messages in the error log if the disk free space is fluctuating around the limit.</p> </li> <li> <p>Even if there are no other storage engines or other applications running, it is still possible for TokuDB to consume more disk space when operations such as row delete and query are performed, or when checkpoints are taken. This can happen because TokuDB can write cached information when it is time-efficient rather than when inserts are issued by the application, because operations in addition to insert (such as delete) create log entries, and also because of internal fragmentation of TokuDB data files.</p> </li> <li> <p>The tokudb_fs_reserve_percent variable can not be changed once the system has started. It can only be set in <code>my.cnf</code> or on the mysqld command line.</p> </li> </ul>"},{"location":"tokudb-faq.html#backup","title":"Backup","text":""},{"location":"tokudb-faq.html#how-do-i-back-up-a-system-with-tokudb-tables","title":"How do I back up a system with TokuDB tables?","text":""},{"location":"tokudb-faq.html#taking-backups-with-percona-tokubackup","title":"Taking backups with Percona TokuBackup","text":"<p>TokuDB is capable of performing online backups with Percona TokuBackup. To perform a backup, execute <code>backup to '/path/to/backup';</code>. This will create backup of the server and return when complete. The backup can be used by another server using a copy of the binaries on the source server. You can view the progress of the backup by executing <code>SHOW PROCESSLIST;</code>. TokuBackup produces a copy of your running MySQL server that is consistent at the end time of the backup process. The thread copying files from source to destination can be throttled by setting the tokudb_backup_throttle server variable. For more information check Percona TokuBackup.</p> <p>The following conditions apply:</p> <pre><code>* Currently, *TokuBackup* only supports tables using the *TokuDB* storage engine and the *MyISAM* tables in the `mysql` database.\n\n!!! warning\n\n    You must disable *InnoDB* asynchronous IO if backing up *InnoDB* tables via *TokuBackup* utility. Otherwise you will have inconsistent, unrecoverable backups. The appropriate setting is innodb_use_native_aio to `0`.\n\n\n* Transactional storage engines (*TokuDB* and *InnoDB*) will perform recovery on the backup copy of the database when it is first started.\n\n\n* Tables using non-transactional storage engines (*MyISAM*) are not locked during the copy and may report issues when starting up the backup. It is best to avoid operations that modify these tables at the end of a hot backup operation (adding/changing users, stored procedures, etc.).\n\n\n* The database is copied locally to the path specified in `/path/to/backup`. This folder must exist, be writable, be empty, and contain enough space for a full copy of the database.\n\n\n* *TokuBackup* always makes a backup of the *MySQL* `datadir` and optionally the tokudb_data_dir, tokudb_log_dir, and the binary log folder. The latter three are only backed up separately if they are not the same as or contained in the *MySQL* `datadir`. None of these three folders can be a parent of the *MySQL* `datadir`.\n\n\n* A folder is created in the given backup destination for each of the source folders.\n\n\n* No other directory structures are supported. All *InnoDB*, *MyISAM*, and other storage engine files must be within the *MySQL* `datadir`.\n\n\n* *TokuBackup* does not follow symbolic links.\n</code></pre>"},{"location":"tokudb-faq.html#other-options-for-taking-backups","title":"Other options for taking backups","text":"<p>TokuDB tables are represented in the file system with dictionary files, log files, and metadata files. A consistent copy of all of these files must be made during a backup. Copying the files while they may be modified by a running MySQL may result in an inconsistent copy of the database.</p> <p>LVM snapshots may be used to get a consistent snapshot of all of the TokuDB files. The LVM snapshot may then be backed up at leisure.</p> <p>The <code>SELECT INTO OUTFILE</code> statement or mysqldump application may also be used to get a logical backup of the database.</p>"},{"location":"tokudb-faq.html#references","title":"References","text":"<p>The MySQL 5.5 reference manual describes several backup methods and strategies. In addition, we recommend reading the backup and recovery chapter in High Performance MySQL, 3<sup>rd</sup> Edition, by Baron Schwartz, Peter Zaitsev, and Vadim Tkachenko, Copyright 2012, O\u2019Reilly Media.</p>"},{"location":"tokudb-faq.html#cold-backup","title":"Cold Backup","text":"<p>When MySQL is shut down, a copy of the MySQL data directory, the TokuDB data directory, and the TokuDB log directory can be made. In the simplest configuration, the TokuDB files are stored in the MySQL data directory with all of other MySQL files. One merely has to back up this directory.</p>"},{"location":"tokudb-faq.html#hot-backup-using-mylvmbackup","title":"Hot Backup using mylvmbackup","text":"<p>The mylvmbackup utility, located on Launchpad, works with TokuDB. It does all of the magic required to get consistent copies of all of the MySQL tables, including MyISAM tables, InnoDB tables, etc., creates the LVM snapshots, and backs up the snapshots.</p>"},{"location":"tokudb-faq.html#logical-snapshots","title":"Logical Snapshots","text":"<p>A logical snapshot of the databases uses a SQL statements to retrieve table rows and restore them. When used within a transaction, a consistent snapshot of the database can be taken. This method can be used to export tables from one database server and import them into another server.</p> <p>The <code>SELECT INTO OUTFILE</code> statement is used to take a logical snapshot of a database. The <code>LOAD DATA INFILE</code> statement is used to load the table data. Please see the MySQL 5.6 reference manual for details.</p> <p>Note</p> <p>Please do not use the mysqlhotcopy to back up TokuDB tables. This script is incompatible with TokuDB.</p>"},{"location":"tokudb-faq.html#missing-log-files","title":"Missing Log Files","text":""},{"location":"tokudb-faq.html#what-do-i-do-if-i-delete-my-logs-files-or-they-are-otherwise-missing","title":"What do I do if I delete my logs files or they are otherwise missing?","text":"<p>You\u2019ll need to recover from a backup. It is essential that the log files be present in order to restart the database.</p>"},{"location":"tokudb-faq.html#isolation-levels","title":"Isolation Levels","text":""},{"location":"tokudb-faq.html#what-is-the-default-isolation-level-for-tokudb","title":"What is the default isolation level for TokuDB?","text":"<p>It is repeatable-read (MVCC).</p>"},{"location":"tokudb-faq.html#how-can-i-change-the-isolation-level","title":"How can I change the isolation level?","text":"<p>TokuDB supports repeatable-read, serializable, read-uncommitted and read-committed isolation levels (other levels are not supported). TokuDB employs pessimistic locking, and aborts a transaction when a lock conflict is detected.</p> <p>To guarantee that lock conflicts do not occur, use repeatable-read, read-uncommitted or read-committed isolation level.</p>"},{"location":"tokudb-faq.html#lock-wait-timeout-exceeded","title":"Lock Wait Timeout Exceeded","text":""},{"location":"tokudb-faq.html#why-do-my-mysql-clients-get-lock-timeout-errors-for-my-update-queries-and-what-should-my-application-do-when-it-gets-these-errors","title":"Why do my MySQL clients get lock timeout errors for my update queries? And what should my application do when it gets these errors?","text":"<p>Updates can get lock timeouts if some other transaction is holding a lock on the rows being updated for longer than the TokuDB lock timeout. You may want to increase the this timeout.</p> <p>If an update deadlocks, then the transaction should abort and retry.</p> <p>For more information on diagnosing locking issues, see Lock Visualization in TokuDB.</p>"},{"location":"tokudb-faq.html#row-size","title":"Row Size","text":""},{"location":"tokudb-faq.html#what-is-the-maximum-row-size","title":"What is the maximum row size?","text":"<p>The maximum row size is 32 MiB.</p>"},{"location":"tokudb-faq.html#nfs-cifs","title":"NFS &amp; CIFS","text":""},{"location":"tokudb-faq.html#can-the-data-directories-reside-on-a-disk-that-is-nfs-or-cifs-mounted","title":"Can the data directories reside on a disk that is NFS or CIFS mounted?","text":"<p>Yes, we do have customers in production with NFS &amp; CIFS volumes today. However, both of these disk types can pose a challenge to performance and data integrity due to their complexity. If you\u2019re seeking performance, the switching infrastructure and protocols of a traditional network were not conceptualized for low response times and can be very difficult to troubleshoot. If you\u2019re concerned with data integrity, the possible data caching at the NFS level can cause inconsistencies between the logs and data files that may never be detected in the event of a crash. If you are thinking of using a NFS or CIFS mount, we would recommend that you use synchronous mount options, which are available from the NFS mount man page, but these settings may decrease performance. For further discussion please look here.</p>"},{"location":"tokudb-faq.html#using-other-storage-engines","title":"Using Other Storage Engines","text":""},{"location":"tokudb-faq.html#can-the-myisam-and-innodb-storage-engines-be-used","title":"Can the MyISAM and InnoDB Storage Engines be used?","text":"<p>MyISAM and InnoDB can be used directly in conjunction with TokuDB. Please note that you should not over-commit memory between InnoDB and TokuDB. The total memory assigned to both caches must be less than physical memory.</p>"},{"location":"tokudb-faq.html#can-the-federated-storage-engines-be-used","title":"Can the Federated Storage Engines be used?","text":"<p>The Federated Storage Engine can also be used, however it is disabled by default in MySQL. It can be enabled by either running mysqld with <code>--federated</code> as a command line parameter, or by putting <code>federated</code> in the <code>[mysqld]</code> section of the <code>my.cnf</code> file.</p> <p>For more information see the MySQL 8.0 Reference Manual: FEDERATED Storage Engine.</p>"},{"location":"tokudb-faq.html#using-mysql-patches-with-tokudb","title":"Using MySQL Patches with TokuDB","text":""},{"location":"tokudb-faq.html#can-i-use-mysql-source-code-patches-with-tokudb","title":"Can I use MySQL source code patches with TokuDB?","text":"<p>Yes, but you need to apply Percona patches as well as your patches to MySQL to build a binary that works with the Percona Fractal Tree library.</p>"},{"location":"tokudb-faq.html#truncate-table-vs-delete-from-table","title":"Truncate Table vs Delete from Table","text":""},{"location":"tokudb-faq.html#which-is-faster-truncate-table-or-delete-from-table","title":"Which is faster, TRUNCATE TABLE or DELETE FROM TABLE?","text":"<p>Use <code>TRUNCATE TABLE</code> whenever possible. A table truncation runs in constant time, whereas a <code>DELETE FROM TABLE</code> requires a row-by-row deletion and thus runs in time linear to the table size.</p>"},{"location":"tokudb-faq.html#foreign-keys","title":"Foreign Keys","text":""},{"location":"tokudb-faq.html#does-tokudb-enforce-foreign-key-constraints","title":"Does TokuDB enforce foreign key constraints?","text":"<p>No. TokuDB ignores foreign key declarations.</p>"},{"location":"tokudb-faq.html#dropping-indexes","title":"Dropping Indexes","text":""},{"location":"tokudb-faq.html#is-dropping-an-index-in-tokudb-hot","title":"Is dropping an index in TokuDB hot?","text":"<p>No, the table is locked for the amount of time it takes the file system to delete the file associated with the index.</p>"},{"location":"tokudb-file-management.html","title":"TokuDB file management","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>As mentioned in the TokuDB files and file types Percona FT is particular when validating its data set. If a file goes missing or can\u2019t be accessed, or seems to contain some nonsensical data, it will assert, abort or fail to start. It does this not to annoy you, but to try to protect you from doing any further damage to your data.</p> <p>This document contains examples of common file maintenance operations and instructions on how to safely execute these operations.</p> <p>The <code>tokudb_dir_per_db</code> option addressed two shortcomings the renaming of data files on table/index rename, and the ability to group data files together within a directory that represents a single database. This feature is enabled by default.</p> <p>The tokudb_dir_cmd variable can be used to edit the contents of the TokuDB/PerconaFT directory map.</p>"},{"location":"tokudb-file-management.html#moving-tokudb-data-files-to-a-location-outside-of-the-default-mysql-datadir","title":"Moving TokuDB data files to a location outside of the default MySQL datadir","text":"<p>TokuDB uses the location specified by the tokudb_data_dir variable for all of its data files. If the tokudb_data_dir variable is not explicitly set, TokuDB will use the location specified by the servers datadir for these files.</p> <p>The TokuDB data files are protected from concurrent process access by the <code>__tokudb_lock_dont_delete_me_data</code> file that is located in the same directory as the TokuDB data files.</p> <p>TokuDB data files may be moved to other locations with symlinks left behind in their place. If those symlinks refer to files on other physical data volumes, the tokudb_fs_reserve_percent monitor will not traverse the symlink and monitor the real location for adequate space in the file system.</p> <p>To safely move your TokuDB data files:</p> <ol> <li> <p>Shut the server down cleanly.</p> </li> <li> <p>Change the <code>tokudb_data_dir</code> in your <code>my.cnf</code> configuration file to the location where you wish to store your TokuDB data files.</p> </li> <li> <p>Create your new target directory.</p> </li> <li> <p>Move your <code>\\*.tokudb</code> files and your <code>__tokudb_lock_dont_delete_me_data</code> from the current location to the new location.</p> </li> <li> <p>Restart your server.</p> </li> </ol>"},{"location":"tokudb-file-management.html#moving-tokudb-temporary-files-to-a-location-outside-of-the-default-mysql-datadir","title":"Moving TokuDB temporary files to a location outside of the default MySQL datadir","text":"<p>TokuDB will use the location specified by the tokudb_tmp_dir variable for all of its temporary files. If tokudb_tmp_dir variable is not explicitly set, TokuDB will use the location specified by the tokudb_data_dir variable. If the tokudb_data_dir variable is also not explicitly set, TokuDB will use the location specified by the servers datadir for these files.</p> <p>TokuDB temporary files are protected from concurrent process access by the <code>__tokudb_lock_dont_delete_me_temp</code> file that is located in the same directory as the TokuDB temporary files.</p> <p>If you locate your TokuDB temporary files on a physical volume that is different from where your TokuDB data files or recovery log files are located, the tokudb_fs_reserve_percent monitor will not monitor their location for adequate space in the file system.</p> <p>To safely move your TokuDB temporary files:</p> <ol> <li> <p>Shut the server down cleanly. A clean shutdown will ensure that there are no temporary files that need to be relocated.</p> </li> <li> <p>Change the tokudb_tmp_dir variable in your <code>my.cnf</code> configuration file to the location where you wish to store your new TokuDB temporary files.</p> </li> <li> <p>Create your new target directory.</p> </li> <li> <p>Move your <code>__tokudb_lock_dont_delete_me_temp</code> file from the current location to the new location.</p> </li> <li> <p>Restart your server.</p> </li> </ol>"},{"location":"tokudb-file-management.html#moving-tokudb-recovery-log-files-to-a-location-outside-of-the-default-mysql-datadir","title":"Moving TokuDB recovery log files to a location outside of the default MySQL datadir","text":"<p>TokuDB will use the location specified by the tokudb_log_dir variable for all of its recovery log files. If the tokudb_log_dir variable is not explicitly set, TokuDB will use the location specified by the servers source/glossary.rst`datadir` for these files.</p> <p>The TokuDB recovery log files are protected from concurrent process access by the <code>__tokudb_lock_dont_delete_me_logs</code> file that is located in the same directory as the TokuDB recovery log files.</p> <p>TokuDB recovery log files may be moved to another location with symlinks left behind in place of the tokudb_log_dir. If that symlink refers to a directory on another physical data volume, the tokudb_fs_reserve_percent monitor will not traverse the symlink and monitor the real location for adequate space in the file system.</p> <p>To safely move your TokuDB recovery log files:</p> <ol> <li> <p>Shut the server down cleanly.</p> </li> <li> <p>Change the tokudb_log_dir in your <code>my.cnf</code> configuration file to the location where you wish to store your TokuDB recovery log files.</p> </li> <li> <p>Create your new target directory.</p> </li> <li> <p>Move your <code>log\\*.tokulog\\*</code> files and your <code>__tokudb_lock_dont_delete_me_logs</code> file from the current location to the new location.</p> </li> <li> <p>Restart your server.</p> </li> </ol>"},{"location":"tokudb-file-management.html#improved-table-renaming-functionality","title":"Improved table renaming functionality","text":"<p>When you rename a TokuDB table via SQL, the data files on disk keep their original names and only the mapping in the Percona FT directory file is changed to map the new dictionary name to the original internal file names. This makes it difficult to quickly match database/table/index names to their actual files on disk, requiring you to use the refTOKUDB_FILE_MAP table to cross reference.</p> <p>The tokudb_dir_per_db variable is implemented to address this issue.</p> <p>When tokudb_dir_per_dbis enabled (<code>ON</code> by default), this is no longer the case. When you rename a table, the mapping in the Percona FT directory file will be updated and the files will be renamed on disk to reflect the new table name.</p>"},{"location":"tokudb-file-management.html#improved-directory-layout-functionality","title":"Improved directory layout functionality","text":"<p>Many users have had issues with managing the huge volume of individual files that TokuDB and Percona FT use. The tokudb_dir_per_db variable addresses this issue.</p> <p>When tokudb_dir_per_db variable is enabled (<code>ON</code> by default), all new tables and indices will be placed within their corresponding database directory within the <code>tokudb_data_dir</code> or server datadir.</p> <p>If you have tokudb_data_dir variable set to something other than the server datadir, TokuDB will create a directory matching the name of the database, but upon dropping of the database, this directory will remain behind.</p> <p>Existing table files will not be automatically relocated to their corresponding database directory.</p> <p>You can easily move a tables data files into the new scheme and proper database directory with a few steps:</p> <pre><code>mysql&gt; SET GLOBAL tokudb_dir_per_db=true;\nmysql&gt; RENAME TABLE &lt;table&gt; TO &lt;tmp_table&gt;;\nmysql&gt; RENAME TABLE &lt;tmp_table&gt; TO &lt;table&gt;;\n</code></pre> <p>Note</p> <p>Two renames are needed because MySQL doesn\u2019t allow you to rename a table to itself. The first rename, renames the table to the temporary name and moves the table files into the owning database directory. The second rename sets the table name back to the original name. Tables can also be renamed/moved across databases and will be placed correctly into the corresponding database directory.</p> <p>Warning</p> <p>You must be careful with renaming tables in case you have used any tricks to create symlinks of the database directories on different storage volumes, the move is not a simple directory move on the same volume but a physical copy across volumes. This can take quite some time and prevent access to the table being moved during the copy.</p>"},{"location":"tokudb-file-management.html#system-variables","title":"System Variables","text":""},{"location":"tokudb-file-management.html#tokudb_dir_cmd","title":"<code>tokudb_dir_cmd</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type String <p>This variable is used to send commands to edit TokuDB directory files.</p> <p>Warning</p> <p>Use this variable only if you know what you are doing otherwise it WILL lead to data loss.</p>"},{"location":"tokudb-file-management.html#status-variables","title":"Status Variables","text":""},{"location":"tokudb-file-management.html#tokudb_dir_cmd_last_error","title":"<code>tokudb_dir_cmd_last_error</code>","text":"Option Description Scope Global Data type Numeric <p>This variable contains the error number of the last executed command by using the tokudb_dir_cmd variable.</p>"},{"location":"tokudb-file-management.html#tokudb_dir_cmd_last_error_string","title":"<code>tokudb_dir_cmd_last_error_string</code>","text":"Option Description Scope Global Data type Numeric <p>This variable contains the error string of the last executed command by using the tokudb_dir_cmd variable.</p>"},{"location":"tokudb-files-file-types.html","title":"TokuDB files and file types","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>The TokuDB file set consists of many different files that all serve various purposes.</p> <p>If you have any TokuDB data your data directory should look similar to this:</p> <pre><code>root@server:/var/lib/mysql# ls -lah\n</code></pre> <p>The output could be:</p> <pre><code>...\n-rw-rw----  1 mysql mysql  76M Oct 13 18:45 ibdata1\n...\n-rw-rw----  1 mysql mysql  16K Oct 13 15:52 tokudb.directory\n-rw-rw----  1 mysql mysql  16K Oct 13 15:52 tokudb.environment\n-rw-------  1 mysql mysql    0 Oct 13 15:52 __tokudb_lock_dont_delete_me_data\n-rw-------  1 mysql mysql    0 Oct 13 15:52 __tokudb_lock_dont_delete_me_environment\n-rw-------  1 mysql mysql    0 Oct 13 15:52 __tokudb_lock_dont_delete_me_logs\n-rw-------  1 mysql mysql    0 Oct 13 15:52 __tokudb_lock_dont_delete_me_recovery\n-rw-------  1 mysql mysql    0 Oct 13 15:52 __tokudb_lock_dont_delete_me_temp\n-rw-rw----  1 mysql mysql  16K Oct 13 15:52 tokudb.rollback\n...\n</code></pre> <p>This document lists the different types of TokuDB and Percona Fractal Tree files, explains their purpose, shows their location and how to move them around.</p>"},{"location":"tokudb-files-file-types.html#tokudbenvironment","title":"tokudb.environment","text":"<p>This file is the root of the Percona FT file set and contains various bits of metadata about the system, such as creation times, current file format versions, etc.</p> <p>Percona FT will create/expect this file in the directory specified by the MySQL datadir.</p>"},{"location":"tokudb-files-file-types.html#tokudbrollback","title":"tokudb.rollback","text":"<p>Every transaction within Percona FT maintains its own transaction rollback log. These logs are stored together within a single Percona FT dictionary file and take up space within the Percona FT cachetable (just like any other Percona FT dictionary).</p> <p>The transaction rollback logs will <code>undo</code> any changes made by a transaction if the transaction is explicitly rolled back, or rolled back via recovery as a result of an uncommitted transaction when a crash occurs.</p> <p>Percona FT will create/expect this file in the directory specified by the MySQL datadir.</p>"},{"location":"tokudb-files-file-types.html#tokudbdirectory","title":"tokudb.directory","text":"<p>Percona FT maintains a mapping of a dictionary name (example: <code>sbtest.sbtest1.main</code>) to an internal file name (example: <code>_sbtest_sbtest1_main_xx_x_xx.tokudb</code>). This mapping is stored within this single Percona FT dictionary file and takes up space within the Percona FT cachetable just like any other Percona FT dictionary.</p> <p>Percona FT will create/expect this file in the directory specified by the MySQL datadir.</p>"},{"location":"tokudb-files-file-types.html#dictionary-files","title":"Dictionary files","text":"<p>TokuDB dictionary (data) files store actual user data. For each MySQL table there will be:</p> <ul> <li> <p>One <code>status</code> dictionary that contains metadata about the table.</p> </li> <li> <p>One <code>main</code> dictionary that stores the full primary key (an imaginary key is used if one was not explicitly specified) and full row data.</p> </li> <li> <p>One <code>key</code> dictionary for each additional key/index on the table.</p> </li> </ul> <p>These are typically named: <code>_&lt;database&gt;_&lt;table&gt;_&lt;key&gt;_&lt;internal_txn_id&gt;.tokudb</code></p> <p>Percona FT creates/expects these files in the directory specified by tokudb_data_dir if set, otherwise the MySQL <code>datadir</code> is used.</p>"},{"location":"tokudb-files-file-types.html#recovery-log-files","title":"Recovery log files","text":"<p>The Percona FT recovery log records every operation that modifies a Percona FT dictionary. Periodically, the system will take a snapshot of the system called a checkpoint. This checkpoint ensures that the modifications recorded within the Percona FT recovery logs have been applied to the appropriate dictionary files up to a known point in time and synced to disk.</p> <p>These files have a rolling naming convention, but use: <code>log&lt;log_file_number&gt;.tokulog&lt;log_file_format_version&gt;</code>.</p> <p>Percona FT creates/expects these files in the directory specified by tokudb_log_dir if set, otherwise the MySQL datadir is used.</p> <p>Percona FT does not track what log files should or shouldn\u2019t be present. Upon startup, it discovers the logs in the log directory, and replays them in order. If the wrong logs are present, the recovery aborts and possibly damages the dictionaries.</p>"},{"location":"tokudb-files-file-types.html#temporary-files","title":"Temporary files","text":"<p>Percona FT might need to create some temporary files in order to perform some operations. When the bulk loader is active, these temporary files might grow to be quite large.</p> <p>As different operations start and finish, the files will come and go.</p> <p>There are no temporary files left behind upon a clean shutdown,</p> <p>Percona FT creates/expects these files in the directory specified by tokudb_tmp_dir if set. If not, the tokudb_data_dir is used if set, otherwise the MySQL datadir is used.</p>"},{"location":"tokudb-files-file-types.html#lock-files","title":"Lock files","text":"<p>Percona FT uses lock files to prevent multiple processes from accessing and writing to the files in the assorted Percona FT functionality areas. Each lock file will be in the same directory as the file(s) that it is protecting.</p> <p>These empty files are only used as semaphores across processes. They are safe to delete/ignore as long as no server instances are currently running and using the data set.</p> <p><code>__tokudb_lock_dont_delete_me_environment</code></p> <p><code>__tokudb_lock_dont_delete_me_recovery</code></p> <p><code>__tokudb_lock_dont_delete_me_logs</code></p> <p><code>__tokudb_lock_dont_delete_me_data</code></p> <p><code>__tokudb_lock_dont_delete_me_temp</code></p> <p>Percona FT validates its data set. If a file goes missing or not found, or seems to contain some nonsensical data, it will assert, abort or fail to start. It does this not to annoy you, but to try to protect you from doing any further damage to your data.</p>"},{"location":"tokudb-fractal-tree-indexing.html","title":"TokuDB fractal tree indexing","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>Fractal Tree indexing is the technology behind TokuDB and is protected by multiple patents. This type of index enhances the traditional B-tree data structure used in other database engines, and optimizes performance for modern hardware and data sets.</p>"},{"location":"tokudb-fractal-tree-indexing.html#background","title":"Background","text":"<p>The B-tree data structure was optimized for large blocks of data but the performance is limited by I/O bandwidth. The size of a production database generally exceeds available main memory. Most leaves in a tree are stored on disk, not in RAM. If a leaf is not in main memory inserting information requires a disk I/O operation. Continually adding RAM to keep pace with the data growth is too expensive.</p>"},{"location":"tokudb-fractal-tree-indexing.html#buffers","title":"Buffers","text":"<p>Like a B-tree structure, a fractal tree index is a tree data structure, but each node has buffers that allow messages to be stored. Insertions, deletions, and updates are inserted into the buffers as messages. Buffers let each disk operation be more efficient by writing large amounts of data. Buffers also avoid the common B-tree scenario when disk writes change only a small amount of data.</p> <p>In fractal tree indexes, non-leaf (internal) nodes have child nodes. The number of child nodes is variable and based on a pre-defined range. When data is inserted or deleted from a node, the number of child nodes changes. Internal nodes may join or split to maintain the defined range. When the buffer is full, the messages are flushed to children nodes.</p> <p>Fractal tree index data structure involves the same algorithmic complexity as B-tree queries. There is no data loss because the queries follow the path from the root to leaf and pass through all messages. A query knows the current state of data even if changes have not been propagated to the corresponding leaves.</p> <p>Each message is stamped with a unique message sequence number (MSN) when the message is stored in a non-leaf node message buffer. The MSN maintains the order of messages and ensures the messages are only applied once to leaf nodes when the leaf node is updated by messages.</p> <p>Buffers are also serialized to disk, messages in internal nodes are not lost in the case of a crash or outage. If a write happened after a checkpoint, but before a crash, recovery replays the operation from the log.</p>"},{"location":"tokudb-installation.html","title":"TokuDB installation","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>Percona Server for MySQL is compatible with the separately available TokuDB storage engine package. The TokuDB engine must be separately downloaded and then enabled as a plug-in component. This package can be installed alongside with standard Percona Server for MySQL 8.0 releases and does not require any specially adapted version of Percona Server for MySQL.</p> <p>The TokuDB storage engine is a scalable, ACID and MVCC compliant storage engine that provides indexing-based query improvements, offers online schema modifications, and reduces replica lag for both hard disk drives and flash memory. This storage engine is specifically designed for high performance on write-intensive workloads which is achieved with Fractal Tree indexing. To learn more about Fractal Tree indexing, you can visit the following Wikipedia page.</p> <p>Warning</p> <p>Only the Percona supplied TokuDB engine should be used with Percona Server for MySQL 8.0. A TokuDB engine downloaded from other sources is not compatible. TokuDB file formats are not the same across MySQL variants. Migrating from one variant to any other variant requires a logical data dump and reload.</p>"},{"location":"tokudb-installation.html#prerequisites","title":"Prerequisites","text":""},{"location":"tokudb-installation.html#libjemalloc-library","title":"<code>libjemalloc</code> library","text":"<p>TokuDB storage engine requires <code>libjemalloc</code> library 3.3.0 or greater. If the version in the distribution repository is lower than that you can use one from Percona Software Repositories or download it.</p> <p>If the <code>libjemalloc</code> wasn\u2019t installed and enabled before it will be automatically installed when installing the TokuDB storage engine package by using the **apt<code>** or **yum** package manager, but *Percona Server for MySQL* instance should be restarted for</code>libjemalloc<code>to be loaded. This way</code>libjemalloc<code>will be loaded with</code>LD_PRELOAD<code>. You can also enable</code>libjemalloc<code>by specifying malloc-lib variable in the</code>[mysqld_safe]<code>section of the</code>my.cnf` file:</p> <pre><code>[mysqld_safe]\nmalloc-lib= /path/to/jemalloc\n</code></pre>"},{"location":"tokudb-installation.html#transparent-huge-pages","title":"Transparent huge pages","text":"<p>TokuDB won\u2019t be able to start if the transparent huge pages are enabled. Transparent huge pages is a feature available in the newer kernel versions. You can check if the Transparent huge pages are enabled with: <code>cat /sys/kernel/mm/transparent_hugepage/enabled</code></p> <p>If transparent huge pages are enabled and you try to start the TokuDB engine you\u2019ll get the following message in you <code>error.log</code>:</p> <pre><code>Transparent huge pages are enabled, according to /sys/kernel/mm/redhat_transparent_hugepage/enabled\nTransparent huge pages are enabled, according to /sys/kernel/mm/transparent_hugepage/enabled\n</code></pre> <p>You can disable transparent huge pages permanently by passing <code>transparent_hugepage=never</code> to the kernel in your bootloader</p> <p>Note</p> <p>For this change to take an effect you must reboot your server.</p> <p>You can disable the transparent huge pages by running the following command as root.</p> <p>Note</p> <p>This setting lasts only until the server is rebooted.</p> <pre><code>echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled\necho never &gt; /sys/kernel/mm/transparent_hugepage/defrag\n</code></pre>"},{"location":"tokudb-installation.html#installation","title":"Installation","text":"<p>The TokuDB storage engine for Percona Server for MySQL is currently available in our apt and yum repositories.</p> <p>You can install the Percona Server for MySQL with the TokuDB engine by using the respective package manager:</p> <p>For yum, use the following command:</p> <pre><code>    $ yum install percona-server-tokudb.x86_64\n</code></pre> <p>For apt, use the following command:</p> <pre><code>    $ apt install percona-server-tokudb\n</code></pre>"},{"location":"tokudb-installation.html#enabling-the-tokudb-storage-engine","title":"Enabling the TokuDB Storage Engine","text":"<p>Once the TokuDB server package is installed, the following output is shown:</p> <p>Percona Server for MySQL has implemented ps-admin to make the enabling the TokuDB storage engine easier. This script will automatically disable Transparent huge pages, if they\u2019re enabled, and install and enable the TokuDB storage engine with all the required plugins. You need to run this script as root or with sudo. The script should only be used for local installations and should not be used to install TokuDB to a remote server. After you run the script with required parameters:</p> <p>Percona Server for MySQL has implemented <code>ps_tokudb_admin</code> script to make the enabling the TokuDB storage engine easier. This script will automatically disable Transparent huge pages, if they\u2019re enabled, and install and enable the TokuDB storage engine with all the required plugins. You need to run this script as root or with sudo. The script should only be used for local installations and should not be used to install TokuDB to a remote server. After you run the script with required parameters:</p> <pre><code>$ ps-admin --enable-tokudb -uroot -pPassw0rd\n</code></pre> <p>Following output will be displayed:</p> <pre><code>Checking if Percona server is running with jemalloc enabled...\n&gt;&gt; Percona server is running with jemalloc enabled.\n\nChecking transparent huge pages status on the system...\n&gt;&gt; Transparent huge pages are currently disabled on the system.\n\nChecking if thp-setting=never option is already set in config file...\n&gt;&gt; Option thp-setting=never is not set in the config file.\n&gt;&gt; (needed only if THP is not disabled permanently on the system)\n\nChecking TokuDB plugin status...\n&gt;&gt; TokuDB plugin is not installed.\n\nAdding thp-setting=never option into /etc/mysql/my.cnf\n&gt;&gt; Successfuly added thp-setting=never option into /etc/mysql/my.cnf\n\nInstalling TokuDB engine...\n&gt;&gt; Successfuly installed TokuDB plugin.\n</code></pre> <p>If the script returns no errors, TokuDB storage engine should be successfully enabled on your server. You can check it out by running <code>SHOW ENGINES;</code></p>"},{"location":"tokudb-installation.html#enabling-the-tokudb-storage-engine-manually","title":"Enabling the TokuDB Storage Engine Manually","text":"<p>If you don\u2019t want to use ps-admin you\u2019ll need to manually install the storage engine ad required plugins.</p> <pre><code>INSTALL PLUGIN tokudb SONAME 'ha_tokudb.so';\nINSTALL PLUGIN tokudb_file_map SONAME 'ha_tokudb.so';\nINSTALL PLUGIN tokudb_fractal_tree_info SONAME 'ha_tokudb.so';\nINSTALL PLUGIN tokudb_fractal_tree_block_map SONAME 'ha_tokudb.so';\nINSTALL PLUGIN tokudb_trx SONAME 'ha_tokudb.so';\nINSTALL PLUGIN tokudb_locks SONAME 'ha_tokudb.so';\nINSTALL PLUGIN tokudb_lock_waits SONAME 'ha_tokudb.so';\nINSTALL PLUGIN tokudb_background_job_status SONAME 'ha_tokudb.so';\n</code></pre> <p>After the engine has been installed it should be present in the engines list. To check if the engine has been correctly installed and active: <code>SHOW ENGINES;</code></p> <p>To check if all the TokuDB plugins have been installed correctly you should run: <code>SHOW PLUGINS;</code></p>"},{"location":"tokudb-installation.html#tokudb-version","title":"TokuDB Version","text":"<p>TokuDB storage engine version can be checked with: <code>SELECT @@tokudb_version;</code></p>"},{"location":"tokudb-installation.html#upgrade","title":"Upgrade","text":"<p>Before upgrading to Percona Server for MySQL 8.0, make sure that your system is ready by running mysqlcheck: <code>mysqlcheck -u root -p --all-databases --check-upgrade</code></p> <p>Warning</p> <p>With partitioned tables that use the TokuDB or MyRocks storage engine, the upgrade only works with native partitioning.</p>"},{"location":"tokudb-intro.html","title":"TokuDB introduction","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>TokuDB is a highly scalable, zero-maintenance downtime MySQL storage engine that delivers indexing-based query acceleration, improved replication performance, unparalleled compression, and live schema modification. The TokuDB storage engine is a scalable, ACID and MVCC compliant storage engine that provides indexing-based query improvements, offers online schema modifications, and reduces replica lag for both hard disk drives and flash memory. This storage engine is specifically designed for high performance on write-intensive workloads which is achieved with Fractal Tree indexing.</p> <p>Percona Server for MySQL is compatible with the separately available TokuDB storage engine package. The TokuDB engine must be separately downloaded and then enabled as a plug-in component. This package can be installed alongside with standard Percona Server for MySQL releases and does not require any specially adapted version of Percona Server for MySQL.</p> <p>Warning</p> <p>Only the Percona supplied TokuDB engine should be used with Percona Server for MySQL. A TokuDB engine downloadedfrom other sources is not compatible. TokuDB file formats are not the same across MySQL variants. Migrating from one variant to any other variant requires a logical data dump and reload.</p> <p>Additional features unique to TokuDB include:</p> <ul> <li> <p>Up to 25x Data Compression</p> </li> <li> <p>Fast Inserts</p> </li> <li> <p>Eliminates Replica Lag with Read Free Replication</p> </li> <li> <p>Hot Schema Changes</p> </li> <li> <p>Hot Index Creation - TokuDB tables support insertions, deletions and queries with no down time while indexes are being added to that table</p> </li> <li> <p>Hot column addition, deletion, expansion, and rename - TokuDB tables support insertions, deletions and queries without down-time when an alter table adds, deletes, expands, or renames columns</p> </li> <li> <p>On-line Backup</p> </li> </ul> <p>Note</p> <p>The TokuDB storage engine does not support the <code>nowait</code> and <code>skip locked</code> modifiers introduced in the InnoDB storage engine with MySQL 8.0.</p> <p>For more information on installing and using TokuDB click on the following links:</p> <ul> <li> <p>TokuDB Installation</p> </li> <li> <p>Using TokuDB</p> </li> <li> <p>Getting Started with TokuDB</p> </li> <li> <p>TokuDB Variables</p> </li> <li> <p>Percona TokuBackup</p> </li> <li> <p>TokuDB Troubleshooting</p> </li> <li> <p>Frequently Asked Questions</p> </li> <li> <p>Migrating and Removing the TokuDB storage engine</p> </li> </ul>"},{"location":"tokudb-intro.html#getting-the-most-from-tokudb","title":"Getting the Most from TokuDB","text":"<p>Compression</p> <pre><code>*TokuDB* compresses all data on disk, including indexes. Compression\nlowers cost by reducing the amount of storage required and frees up disk\nspace for additional indexes to achieve improved query performance. Depending\non the compressibility of the data, we have seen compression ratios up to 25x\nfor high compression. Compression can also lead to improved performance since\nless data needs to be read from and written to disk.\n</code></pre> <p>Fast Insertions and Deletions</p> <pre><code>TokuDB\u2019s Fractal Tree technology enables fast\nindexed insertions and deletions. Fractal Trees match B-trees in their\nindexing sweet spot (sequential data) and are up to two orders of magnitude\nfaster for random data with high cardinality.\n</code></pre> <p>Eliminates Replica Lag</p> <pre><code>*TokuDB* replication replicas can be configured to process\nthe replication stream with virtually no read IO. Uniqueness checking is\nperformed on the *TokuDB* source and can be skipped on all *TokuDB*\nreplica. Also, row based replication ensures that all before and after row\nimages are captured in the binary logs, so the *TokuDB* replicas can harness\nthe power of Fractal Tree indexes and bypass traditional read-modify-write\nbehavior. This \u201cRead Free Replication\u201d ensures that replication replicas do not\nfall behind the source and can be used for read scaling, backups, and\ndisaster recovery, without sharding, expensive hardware, or limits on what\ncan be replicated.\n</code></pre> <p>Hot Index Creation</p> <pre><code>*TokuDB* allows the addition of indexes to an existing table\nwhile inserts and queries are being performed on that table. This means that\n*MySQL* can be run continuously with no blocking of queries or insertions\nwhile indexes are added and eliminates the down-time that index changes would\notherwise require.\n</code></pre> <p>Hot Column Addition, Deletion, Expansion and Rename</p> <pre><code>*TokuDB* allows the addition\nof new columns to an existing table, the deletion of existing columns from an\nexisting table, the expansion of `char`, `varchar`, `varbinary`, and\n`integer` type columns in an existing table, and the renaming of an\nexisting column while inserts and queries are being performed on that table.\n</code></pre> <p>Online (Hot) Backup</p> <pre><code>The *TokuDB* can create backups of online database servers without downtime.\n</code></pre> <p>Fast Indexing</p> <pre><code>In practice, slow indexing often leads users to choose a smaller\nnumber of sub-optimal indexes in order to keep up with incoming data\nrates. These sub-optimal indexes result in disproportionately slower queries,\nsince the difference in speed between a query with an index and the same\nquery when no index is available can be many orders of magnitude. Thus, fast\nindexing means fast queries.\n</code></pre> <p>Clustering Keys and Other Indexing Improvements</p> <pre><code>*TokuDB* tables are clustered on\nthe primary key. *TokuDB* also supports clustering secondary keys, providing\nbetter performance on a broader range of queries. A clustering key includes\n(or clusters) all of the columns in a table along with the key. As a result,\none can efficiently retrieve any column when doing a range query on a\nclustering key. Also, with *TokuDB*, an auto-increment column can be used in\nany index and in any position within an index. Lastly, *TokuDB* indexes can\ninclude up to 32 columns.\n</code></pre> <p>Less Aging/Fragmentation</p> <pre><code>*TokuDB* can run much longer, likely indefinitely,\nwithout the need to perform the customary practice of dump/reload or\n`OPTIMIZE TABLE` to restore database performance. The key is the\nfundamental difference with which the Fractal Tree stores data on\ndisk. Since, by default, the Fractal Tree will store data in 4MB chunks\n(pre-compression), as compared to InnoDB\u2019s 16KB, *TokuDB* has the ability to\navoid \u201cdatabase disorder\u201d up to 250x better than InnoDB.\n</code></pre> <p>Bulk Loader</p> <pre><code>*TokuDB* uses a parallel loader to create tables and offline\nindexes. This parallel loader will use multiple cores for fast offline table\nand index creation.\n</code></pre> <p>Full-Featured Database</p> <pre><code>*TokuDB* supports fully ACID-compliant transactions, MVCC\n(Multi-Version Concurrency Control), serialized isolation levels, row-level\nlocking, and XA. *TokuDB* scales with high number of client connections, even\nfor large tables.\n</code></pre> <p>Lock Diagnostics</p> <pre><code>*TokuDB* provides users with the tools to diagnose locking and\ndeadlock issues. For more information, see [Lock Visualization in TokuDB](tokudb_troubleshooting.md#lock-visualization-in-tokudb).\n</code></pre> <p>Progress Tracking</p> <pre><code>Running `SHOW PROCESSLIST` when adding indexes provides\nstatus on how many rows have been processed. Running `SHOW PROCESSLIST`\nalso shows progress on queries, as well as insertions, deletions and\nupdates. This information is helpful for estimating how long operations will\ntake to complete.\n</code></pre> <p>Fast Recovery</p> <pre><code>*TokuDB* supports very fast recovery, typically less than a minute.\n</code></pre>"},{"location":"tokudb-performance-schema.html","title":"TokuDB Performance Schema integration","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>TokuDB is integrated with Performance Schema</p> <p>This integration can be used for profiling additional TokuDB operations.</p> <p>TokuDB instruments available in Performance Schema can be seen in PERFORMANCE_SCHEMA.SETUP_INSTRUMENTS table:</p> <pre><code>mysql&gt; SELECT * FROM performance_schema.setup_instruments WHERE NAME LIKE \"%/fti/%\";\n</code></pre> <p>The output could be the following:</p> <pre><code>+------------------------------------------------------------+---------+-------+\n| NAME                                                       | ENABLED | TIMED |\n+------------------------------------------------------------+---------+-------+\n| wait/synch/mutex/fti/kibbutz_mutex                         | NO      | NO    |\n| wait/synch/mutex/fti/minicron_p_mutex                      | NO      | NO    |\n| wait/synch/mutex/fti/queue_result_mutex                    | NO      | NO    |\n| wait/synch/mutex/fti/tpool_lock_mutex                      | NO      | NO    |\n| wait/synch/mutex/fti/workset_lock_mutex                    | NO      | NO    |\n| wait/synch/mutex/fti/bjm_jobs_lock_mutex                   | NO      | NO    |\n| wait/synch/mutex/fti/log_internal_lock_mutex               | NO      | NO    |\n| wait/synch/mutex/fti/cachetable_ev_thread_lock_mutex       | NO      | NO    |\n| wait/synch/mutex/fti/cachetable_disk_nb_mutex              | NO      | NO    |\n| wait/synch/mutex/fti/safe_file_size_lock_mutex             | NO      | NO    |\n| wait/synch/mutex/fti/cachetable_m_mutex_key                | NO      | NO    |\n| wait/synch/mutex/fti/checkpoint_safe_mutex                 | NO      | NO    |\n| wait/synch/mutex/fti/ft_ref_lock_mutex                     | NO      | NO    |\n| wait/synch/mutex/fti/ft_open_close_lock_mutex              | NO      | NO    |\n| wait/synch/mutex/fti/loader_error_mutex                    | NO      | NO    |\n| wait/synch/mutex/fti/bfs_mutex                             | NO      | NO    |\n| wait/synch/mutex/fti/loader_bl_mutex                       | NO      | NO    |\n| wait/synch/mutex/fti/loader_fi_lock_mutex                  | NO      | NO    |\n| wait/synch/mutex/fti/loader_out_mutex                      | NO      | NO    |\n| wait/synch/mutex/fti/result_output_condition_lock_mutex    | NO      | NO    |\n| wait/synch/mutex/fti/block_table_mutex                     | NO      | NO    |\n| wait/synch/mutex/fti/rollback_log_node_cache_mutex         | NO      | NO    |\n| wait/synch/mutex/fti/txn_lock_mutex                        | NO      | NO    |\n| wait/synch/mutex/fti/txn_state_lock_mutex                  | NO      | NO    |\n| wait/synch/mutex/fti/txn_child_manager_mutex               | NO      | NO    |\n| wait/synch/mutex/fti/txn_manager_lock_mutex                | NO      | NO    |\n| wait/synch/mutex/fti/treenode_mutex                        | NO      | NO    |\n| wait/synch/mutex/fti/locktree_request_info_mutex           | NO      | NO    |\n| wait/synch/mutex/fti/locktree_request_info_retry_mutex_key | NO      | NO    |\n| wait/synch/mutex/fti/manager_mutex                         | NO      | NO    |\n| wait/synch/mutex/fti/manager_escalation_mutex              | NO      | NO    |\n| wait/synch/mutex/fti/db_txn_struct_i_txn_mutex             | NO      | NO    |\n| wait/synch/mutex/fti/manager_escalator_mutex               | NO      | NO    |\n| wait/synch/mutex/fti/indexer_i_indexer_lock_mutex          | NO      | NO    |\n| wait/synch/mutex/fti/indexer_i_indexer_estimate_lock_mutex | NO      | NO    |\n| wait/synch/mutex/fti/fti_probe_1                           | NO      | NO    |\n| wait/synch/rwlock/fti/multi_operation_lock                 | NO      | NO    |\n| wait/synch/rwlock/fti/low_priority_multi_operation_lock    | NO      | NO    |\n| wait/synch/rwlock/fti/cachetable_m_list_lock               | NO      | NO    |\n| wait/synch/rwlock/fti/cachetable_m_pending_lock_expensive  | NO      | NO    |\n| wait/synch/rwlock/fti/cachetable_m_pending_lock_cheap      | NO      | NO    |\n| wait/synch/rwlock/fti/cachetable_m_lock                    | NO      | NO    |\n| wait/synch/rwlock/fti/result_i_open_dbs_rwlock             | NO      | NO    |\n| wait/synch/rwlock/fti/checkpoint_safe_rwlock               | NO      | NO    |\n| wait/synch/rwlock/fti/cachetable_value                     | NO      | NO    |\n| wait/synch/rwlock/fti/safe_file_size_lock_rwlock           | NO      | NO    |\n| wait/synch/rwlock/fti/cachetable_disk_nb_rwlock            | NO      | NO    |\n| wait/synch/cond/fti/result_state_cond                      | NO      | NO    |\n| wait/synch/cond/fti/bjm_jobs_wait                          | NO      | NO    |\n| wait/synch/cond/fti/cachetable_p_refcount_wait             | NO      | NO    |\n| wait/synch/cond/fti/cachetable_m_flow_control_cond         | NO      | NO    |\n| wait/synch/cond/fti/cachetable_m_ev_thread_cond            | NO      | NO    |\n| wait/synch/cond/fti/bfs_cond                               | NO      | NO    |\n| wait/synch/cond/fti/result_output_condition                | NO      | NO    |\n| wait/synch/cond/fti/manager_m_escalator_done               | NO      | NO    |\n| wait/synch/cond/fti/lock_request_m_wait_cond               | NO      | NO    |\n| wait/synch/cond/fti/queue_result_cond                      | NO      | NO    |\n| wait/synch/cond/fti/ws_worker_wait                         | NO      | NO    |\n| wait/synch/cond/fti/rwlock_wait_read                       | NO      | NO    |\n| wait/synch/cond/fti/rwlock_wait_write                      | NO      | NO    |\n| wait/synch/cond/fti/rwlock_cond                            | NO      | NO    |\n| wait/synch/cond/fti/tp_thread_wait                         | NO      | NO    |\n| wait/synch/cond/fti/tp_pool_wait_free                      | NO      | NO    |\n| wait/synch/cond/fti/frwlock_m_wait_read                    | NO      | NO    |\n| wait/synch/cond/fti/kibbutz_k_cond                         | NO      | NO    |\n| wait/synch/cond/fti/minicron_p_condvar                     | NO      | NO    |\n| wait/synch/cond/fti/locktree_request_info_retry_cv_key     | NO      | NO    |\n| wait/io/file/fti/tokudb_data_file                          | YES     | YES   |\n| wait/io/file/fti/tokudb_load_file                          | YES     | YES   |\n| wait/io/file/fti/tokudb_tmp_file                           | YES     | YES   |\n| wait/io/file/fti/tokudb_log_file                           | YES     | YES   |\n+------------------------------------------------------------+---------+-------+\n</code></pre> <p>For TokuDB-related objects, following clauses can be used when querying Performance Schema tables:</p> <ul> <li> <p><code>WHERE EVENT_NAME LIKE '%fti%'</code> or</p> </li> <li> <p><code>WHERE NAME LIKE '%fti%'</code></p> </li> </ul> <p>For example, to get the information about TokuDB related events you can query PERFORMANCE_SCHEMA.events_waits_summary_global_by_event_name like:</p> <pre><code>mysql&gt; SELECT * FROM performance_schema.events_waits_summary_global_by_event_name WHERE EVENT_NAME LIKE '%fti%';\n</code></pre> <p>The output could be the following:</p> <pre><code>+-----------------------------------------+------------+----------------+----------------+----------------+----------------+\n| EVENT_NAME                              | COUNT_STAR | SUM_TIMER_WAIT | MIN_TIMER_WAIT | AVG_TIMER_WAIT | MAX_TIMER_WAIT |\n+-----------------------------------------+------------+----------------+----------------+----------------+----------------+\n| wait/synch/mutex/fti/kibbutz_mutex      |          0 |              0 |              0 |              0 |              0 |\n| wait/synch/mutex/fti/minicron_p_mutex   |          0 |              0 |              0 |              0 |              0 |\n| wait/synch/mutex/fti/queue_result_mutex |          0 |              0 |              0 |              0 |              0 |\n| wait/synch/mutex/fti/tpool_lock_mutex   |          0 |              0 |              0 |              0 |              0 |\n| wait/synch/mutex/fti/workset_lock_mutex |          0 |              0 |              0 |              0 |              0 |\n...\n| wait/io/file/fti/tokudb_data_file       |         30 |      179862410 |              0 |        5995080 |       68488420 |\n| wait/io/file/fti/tokudb_load_file       |          0 |              0 |              0 |              0 |              0 |\n| wait/io/file/fti/tokudb_tmp_file        |          0 |              0 |              0 |              0 |              0 |\n| wait/io/file/fti/tokudb_log_file        |       1367 |  2925647870145 |              0 |     2140195785 |    12013357720 |\n+-----------------------------------------+------------+----------------+----------------+----------------+----------------+\n71 rows in set (0.02 sec)\n</code></pre>"},{"location":"tokudb-status-variables.html","title":"TokuDB status variables","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>TokuDB status variables provide details about the inner workings of TokuDB storage engine and they can be useful in tuning the storage engine to a particular environment.</p> <p>You can view these variables and their values by running:</p> <pre><code>mysql&gt; SHOW STATUS LIKE 'tokudb%';\n</code></pre>"},{"location":"tokudb-status-variables.html#tokudb-status-variables-summary","title":"TokuDB Status Variables Summary","text":"<p>The following global status variables are available:</p> Name Var Type Tokudb_DB_OPENS integer Tokudb_DB_CLOSES integer Tokudb_DB_OPEN_CURRENT integer Tokudb_DB_OPEN_MAX integer Tokudb_LEAF_ENTRY_MAX_COMMITTED_XR integer Tokudb_LEAF_ENTRY_MAX_PROVISIONAL_XR integer Tokudb_LEAF_ENTRY_EXPANDED integer Tokudb_LEAF_ENTRY_MAX_MEMSIZE integer Tokudb_LEAF_ENTRY_APPLY_GC_BYTES_IN integer Tokudb_LEAF_ENTRY_APPLY_GC_BYTES_OUT integer Tokudb_LEAF_ENTRY_NORMAL_GC_BYTES_IN integer Tokudb_LEAF_ENTRY_NORMAL_GC_BYTES_OUT integer Tokudb_CHECKPOINT_PERIOD integer Tokudb_CHECKPOINT_FOOTPRINT integer Tokudb_CHECKPOINT_LAST_BEGAN datetime Tokudb_CHECKPOINT_LAST_COMPLETE_BEGAN datetime Tokudb_CHECKPOINT_LAST_COMPLETE_ENDED datetime Tokudb_CHECKPOINT_DURATION integer Tokudb_CHECKPOINT_DURATION_LAST integer Tokudb_CHECKPOINT_LAST_LSN integer Tokudb_CHECKPOINT_TAKEN integer Tokudb_CHECKPOINT_FAILED integer Tokudb_CHECKPOINT_WAITERS_NOW integer Tokudb_CHECKPOINT_WAITERS_MAX integer Tokudb_CHECKPOINT_CLIENT_WAIT_ON_MO integer Tokudb_CHECKPOINT_CLIENT_WAIT_ON_CS integer Tokudb_CHECKPOINT_BEGIN_TIME integer Tokudb_CHECKPOINT_LONG_BEGIN_TIME integer Tokudb_CHECKPOINT_LONG_BEGIN_COUNT integer Tokudb_CHECKPOINT_END_TIME integer Tokudb_CHECKPOINT_LONG_END_TIME integer Tokudb_CHECKPOINT_LONG_END_COUNT integer Tokudb_CACHETABLE_MISS integer Tokudb_CACHETABLE_MISS_TIME integer Tokudb_CACHETABLE_PREFETCHES integer Tokudb_CACHETABLE_SIZE_CURRENT integer Tokudb_CACHETABLE_SIZE_LIMIT integer Tokudb_CACHETABLE_SIZE_WRITING integer Tokudb_CACHETABLE_SIZE_NONLEAF integer Tokudb_CACHETABLE_SIZE_LEAF integer Tokudb_CACHETABLE_SIZE_ROLLBACK integer Tokudb_CACHETABLE_SIZE_CACHEPRESSURE integer Tokudb_CACHETABLE_SIZE_CLONED integer Tokudb_CACHETABLE_EVICTIONS integer Tokudb_CACHETABLE_CLEANER_EXECUTIONS integer Tokudb_CACHETABLE_CLEANER_PERIOD integer Tokudb_CACHETABLE_CLEANER_ITERATIONS integer Tokudb_CACHETABLE_WAIT_PRESSURE_COUNT integer Tokudb_CACHETABLE_WAIT_PRESSURE_TIME integer Tokudb_CACHETABLE_LONG_WAIT_PRESSURE_COUNT integer Tokudb_CACHETABLE_LONG_WAIT_PRESSURE_TIME integer Tokudb_CACHETABLE_POOL_CLIENT_NUM_THREADS integer Tokudb_CACHETABLE_POOL_CLIENT_NUM_THREADS_ACTIVE integer Tokudb_CACHETABLE_POOL_CLIENT_QUEUE_SIZE integer Tokudb_CACHETABLE_POOL_CLIENT_MAX_QUEUE_SIZE integer Tokudb_CACHETABLE_POOL_CLIENT_TOTAL_ITEMS_PROCESSED integer Tokudb_CACHETABLE_POOL_CLIENT_TOTAL_EXECUTION_TIME integer Tokudb_CACHETABLE_POOL_CACHETABLE_NUM_THREADS integer Tokudb_CACHETABLE_POOL_CACHETABLE_NUM_THREADS_ACTIVE integer Tokudb_CACHETABLE_POOL_CACHETABLE_QUEUE_SIZE integer Tokudb_CACHETABLE_POOL_CACHETABLE_MAX_QUEUE_SIZE integer Tokudb_CACHETABLE_POOL_CACHETABLE_TOTAL_ITEMS_PROCESSED integer Tokudb_CACHETABLE_POOL_CACHETABLE_TOTAL_EXECUTION_TIME integer Tokudb_CACHETABLE_POOL_CHECKPOINT_NUM_THREADS integer Tokudb_CACHETABLE_POOL_CHECKPOINT_NUM_THREADS_ACTIVE integer Tokudb_CACHETABLE_POOL_CHECKPOINT_QUEUE_SIZE integer Tokudb_CACHETABLE_POOL_CHECKPOINT_MAX_QUEUE_SIZE integer Tokudb_CACHETABLE_POOL_CHECKPOINT_TOTAL_ITEMS_PROCESSED integer Tokudb_CACHETABLE_POOL_CHECKPOINT_TOTAL_EXECUTION_TIME integer Tokudb_LOCKTREE_MEMORY_SIZE integer Tokudb_LOCKTREE_MEMORY_SIZE_LIMIT integer Tokudb_LOCKTREE_ESCALATION_NUM integer Tokudb_LOCKTREE_ESCALATION_SECONDS numeric Tokudb_LOCKTREE_LATEST_POST_ESCALATION_MEMORY_SIZE integer Tokudb_LOCKTREE_OPEN_CURRENT integer Tokudb_LOCKTREE_PENDING_LOCK_REQUESTS integer Tokudb_LOCKTREE_STO_ELIGIBLE_NUM integer Tokudb_LOCKTREE_STO_ENDED_NUM integer Tokudb_LOCKTREE_STO_ENDED_SECONDS numeric Tokudb_LOCKTREE_WAIT_COUNT integer Tokudb_LOCKTREE_WAIT_TIME integer Tokudb_LOCKTREE_LONG_WAIT_COUNT integer Tokudb_LOCKTREE_LONG_WAIT_TIME integer Tokudb_LOCKTREE_TIMEOUT_COUNT integer Tokudb_LOCKTREE_WAIT_ESCALATION_COUNT integer Tokudb_LOCKTREE_WAIT_ESCALATION_TIME integer Tokudb_LOCKTREE_LONG_WAIT_ESCALATION_COUNT integer Tokudb_LOCKTREE_LONG_WAIT_ESCALATION_TIME integer Tokudb_DICTIONARY_UPDATES integer Tokudb_DICTIONARY_BROADCAST_UPDATES integer Tokudb_DESCRIPTOR_SET integer Tokudb_MESSAGES_IGNORED_BY_LEAF_DUE_TO_MSN integer Tokudb_TOTAL_SEARCH_RETRIES integer Tokudb_SEARCH_TRIES_GT_HEIGHT integer Tokudb_SEARCH_TRIES_GT_HEIGHTPLUS3 integer Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT integer Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_BYTES integer Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_UNCOMPRESSED_BYTES integer Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_SECONDS numeric Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT integer Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_BYTES integer Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_UNCOMPRESSE integer Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_SECONDS numeric Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT integer Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_BYTES integer Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_UNCOMPRESSED_BYTES integer Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_SECONDS numeric Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT integer Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_BYTES integer Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_UNCOMPRESSED_BY integer Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_SECONDS numeric Tokudb_LEAF_NODE_COMPRESSION_RATIO numeric Tokudb_NONLEAF_NODE_COMPRESSION_RATIO numeric Tokudb_OVERALL_NODE_COMPRESSION_RATIO numeric Tokudb_NONLEAF_NODE_PARTIAL_EVICTIONS numeric Tokudb_NONLEAF_NODE_PARTIAL_EVICTIONS_BYTES integer Tokudb_LEAF_NODE_PARTIAL_EVICTIONS integer Tokudb_LEAF_NODE_PARTIAL_EVICTIONS_BYTES integer Tokudb_LEAF_NODE_FULL_EVICTIONS integer Tokudb_LEAF_NODE_FULL_EVICTIONS_BYTES integer Tokudb_NONLEAF_NODE_FULL_EVICTIONS integer Tokudb_NONLEAF_NODE_FULL_EVICTIONS_BYTES integer Tokudb_LEAF_NODES_CREATED integer Tokudb_NONLEAF_NODES_CREATED integer Tokudb_LEAF_NODES_DESTROYED integer Tokudb_NONLEAF_NODES_DESTROYED integer Tokudb_MESSAGES_INJECTED_AT_ROOT_BYTES integer Tokudb_MESSAGES_FLUSHED_FROM_H1_TO_LEAVES_BYTES integer Tokudb_MESSAGES_IN_TREES_ESTIMATE_BYTES integer Tokudb_MESSAGES_INJECTED_AT_ROOT integer Tokudb_BROADCASE_MESSAGES_INJECTED_AT_ROOT integer Tokudb_BASEMENTS_DECOMPRESSED_TARGET_QUERY integer Tokudb_BASEMENTS_DECOMPRESSED_PRELOCKED_RANGE integer Tokudb_BASEMENTS_DECOMPRESSED_PREFETCH integer Tokudb_BASEMENTS_DECOMPRESSED_FOR_WRITE integer Tokudb_BUFFERS_DECOMPRESSED_TARGET_QUERY integer Tokudb_BUFFERS_DECOMPRESSED_PRELOCKED_RANGE integer Tokudb_BUFFERS_DECOMPRESSED_PREFETCH integer Tokudb_BUFFERS_DECOMPRESSED_FOR_WRITE integer Tokudb_PIVOTS_FETCHED_FOR_QUERY integer Tokudb_PIVOTS_FETCHED_FOR_QUERY_BYTES integer Tokudb_PIVOTS_FETCHED_FOR_QUERY_SECONDS numeric Tokudb_PIVOTS_FETCHED_FOR_PREFETCH integer Tokudb_PIVOTS_FETCHED_FOR_PREFETCH_BYTES integer Tokudb_PIVOTS_FETCHED_FOR_PREFETCH_SECONDS numeric Tokudb_PIVOTS_FETCHED_FOR_WRITE integer Tokudb_PIVOTS_FETCHED_FOR_WRITE_BYTES integer Tokudb_PIVOTS_FETCHED_FOR_WRITE_SECONDS numeric Tokudb_BASEMENTS_FETCHED_TARGET_QUERY integer Tokudb_BASEMENTS_FETCHED_TARGET_QUERY_BYTES integer Tokudb_BASEMENTS_FETCHED_TARGET_QUERY_SECONDS numeric Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE integer Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE_BYTES integer Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE_SECONDS numeric Tokudb_BASEMENTS_FETCHED_PREFETCH integer Tokudb_BASEMENTS_FETCHED_PREFETCH_BYTES integer Tokudb_BASEMENTS_FETCHED_PREFETCH_SECONDS numeric Tokudb_BASEMENTS_FETCHED_FOR_WRITE integer Tokudb_BASEMENTS_FETCHED_FOR_WRITE_BYTES integer Tokudb_BASEMENTS_FETCHED_FOR_WRITE_SECONDS numeric Tokudb_BUFFERS_FETCHED_TARGET_QUERY integer Tokudb_BUFFERS_FETCHED_TARGET_QUERY_BYTES integer Tokudb_BUFFERS_FETCHED_TARGET_QUERY_SECONDS numeric Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE integer Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE_BYTES integer Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE_SECONDS numeric Tokudb_BUFFERS_FETCHED_PREFETCH integer Tokudb_BUFFERS_FETCHED_PREFETCH_BYTES integer Tokudb_BUFFERS_FETCHED_PREFETCH_SECONDS numeric Tokudb_BUFFERS_FETCHED_FOR_WRITE integer Tokudb_BUFFERS_FETCHED_FOR_WRITE_BYTES integer Tokudb_BUFFERS_FETCHED_FOR_WRITE_SECONDS integer Tokudb_LEAF_COMPRESSION_TO_MEMORY_SECONDS numeric Tokudb_LEAF_SERIALIZATION_TO_MEMORY_SECONDS numeric Tokudb_LEAF_DECOMPRESSION_TO_MEMORY_SECONDS numeric Tokudb_LEAF_DESERIALIZATION_TO_MEMORY_SECONDS numeric Tokudb_NONLEAF_COMPRESSION_TO_MEMORY_SECONDS numeric Tokudb_NONLEAF_SERIALIZATION_TO_MEMORY_SECONDS numeric Tokudb_NONLEAF_DECOMPRESSION_TO_MEMORY_SECONDS numeric Tokudb_NONLEAF_DESERIALIZATION_TO_MEMORY_SECONDS numeric Tokudb_PROMOTION_ROOTS_SPLIT integer Tokudb_PROMOTION_LEAF_ROOTS_INJECTED_INTO integer Tokudb_PROMOTION_H1_ROOTS_INJECTED_INTO integer Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_0 integer Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_1 integer Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_2 integer Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_3 integer Tokudb_PROMOTION_INJECTIONS_LOWER_THAN_DEPTH_3 integer Tokudb_PROMOTION_STOPPED_NONEMPTY_BUFFER integer Tokudb_PROMOTION_STOPPED_AT_HEIGHT_1 integer Tokudb_PROMOTION_STOPPED_CHILD_LOCKED_OR_NOT_IN_MEMORY integer Tokudb_PROMOTION_STOPPED_CHILD_NOT_FULLY_IN_MEMORY integer Tokudb_PROMOTION_STOPPED_AFTER_LOCKING_CHILD integer Tokudb_BASEMENT_DESERIALIZATION_FIXED_KEY integer Tokudb_BASEMENT_DESERIALIZATION_VARIABLE_KEY integer Tokudb_PRO_RIGHTMOST_LEAF_SHORTCUT_SUCCESS integer Tokudb_PRO_RIGHTMOST_LEAF_SHORTCUT_FAIL_POS integer Tokudb_RIGHTMOST_LEAF_SHORTCUT_FAIL_REACTIVE integer Tokudb_CURSOR_SKIP_DELETED_LEAF_ENTRY integer Tokudb_FLUSHER_CLEANER_TOTAL_NODES integer Tokudb_FLUSHER_CLEANER_H1_NODES integer Tokudb_FLUSHER_CLEANER_HGT1_NODES integer Tokudb_FLUSHER_CLEANER_EMPTY_NODES integer Tokudb_FLUSHER_CLEANER_NODES_DIRTIED integer Tokudb_FLUSHER_CLEANER_MAX_BUFFER_SIZE integer Tokudb_FLUSHER_CLEANER_MIN_BUFFER_SIZE integer Tokudb_FLUSHER_CLEANER_TOTAL_BUFFER_SIZE integer Tokudb_FLUSHER_CLEANER_MAX_BUFFER_WORKDONE integer Tokudb_FLUSHER_CLEANER_MIN_BUFFER_WORKDONE integer Tokudb_FLUSHER_CLEANER_TOTAL_BUFFER_WORKDONE integer Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_STARTED integer Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_RUNNING integer Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_COMPLETED integer Tokudb_FLUSHER_CLEANER_NUM_DIRTIED_FOR_LEAF_MERGE integer Tokudb_FLUSHER_FLUSH_TOTAL integer Tokudb_FLUSHER_FLUSH_IN_MEMORY integer Tokudb_FLUSHER_FLUSH_NEEDED_IO integer Tokudb_FLUSHER_FLUSH_CASCADES integer Tokudb_FLUSHER_FLUSH_CASCADES_1 integer Tokudb_FLUSHER_FLUSH_CASCADES_2 integer Tokudb_FLUSHER_FLUSH_CASCADES_3 integer Tokudb_FLUSHER_FLUSH_CASCADES_4 integer Tokudb_FLUSHER_FLUSH_CASCADES_5 integer Tokudb_FLUSHER_FLUSH_CASCADES_GT_5 integer Tokudb_FLUSHER_SPLIT_LEAF integer Tokudb_FLUSHER_SPLIT_NONLEAF integer Tokudb_FLUSHER_MERGE_LEAF integer Tokudb_FLUSHER_MERGE_NONLEAF integer Tokudb_FLUSHER_BALANCE_LEAF integer Tokudb_HOT_NUM_STARTED integer Tokudb_HOT_NUM_COMPLETED integer Tokudb_HOT_NUM_ABORTED integer Tokudb_HOT_MAX_ROOT_FLUSH_COUNT integer Tokudb_TXN_BEGIN integer Tokudb_TXN_BEGIN_READ_ONLY integer Tokudb_TXN_COMMITS integer Tokudb_TXN_ABORTS integer Tokudb_LOGGER_NEXT_LSN integer Tokudb_LOGGER_WRITES integer Tokudb_LOGGER_WRITES_BYTES integer Tokudb_LOGGER_WRITES_UNCOMPRESSED_BYTES integer Tokudb_LOGGER_WRITES_SECONDS numeric Tokudb_LOGGER_WAIT_LONG integer Tokudb_LOADER_NUM_CREATED integer Tokudb_LOADER_NUM_CURRENT integer Tokudb_LOADER_NUM_MAX integer Tokudb_MEMORY_MALLOC_COUNT integer Tokudb_MEMORY_FREE_COUNT integer Tokudb_MEMORY_REALLOC_COUNT integer Tokudb_MEMORY_MALLOC_FAIL integer Tokudb_MEMORY_REALLOC_FAIL integer Tokudb_MEMORY_REQUESTED integer Tokudb_MEMORY_USED integer Tokudb_MEMORY_FREED integer Tokudb_MEMORY_MAX_REQUESTED_SIZE integer Tokudb_MEMORY_LAST_FAILED_SIZE integer Tokudb_MEM_ESTIMATED_MAXIMUM_MEMORY_FOOTPRINT integer Tokudb_MEMORY_MALLOCATOR_VERSION string Tokudb_MEMORY_MMAP_THRESHOLD integer Tokudb_FILESYSTEM_THREADS_BLOCKED_BY_FULL_DISK integer Tokudb_FILESYSTEM_FSYNC_TIME integer Tokudb_FILESYSTEM_FSYNC_NUM integer Tokudb_FILESYSTEM_LONG_FSYNC_TIME integer Tokudb_FILESYSTEM_LONG_FSYNC_NUM integer"},{"location":"tokudb-status-variables.html#tokudb_db_opens","title":"<code>Tokudb_DB_OPENS</code>","text":"<p>This variable shows the number of times an individual PerconaFT dictionary file was opened. This is a not a useful value for a regular user to use for any purpose due to layers of open/close caching on top.</p>"},{"location":"tokudb-status-variables.html#tokudb_db_closes","title":"<code>Tokudb_DB_CLOSES</code>","text":"<p>This variable shows the number of times an individual PerconaFT dictionary file was closed. This is a not a useful value for a regular user to use for any purpose due to layers of open/close caching on top.</p>"},{"location":"tokudb-status-variables.html#tokudb_db_open_current","title":"<code>Tokudb_DB_OPEN_CURRENT</code>","text":"<p>This variable shows the number of currently opened databases.</p>"},{"location":"tokudb-status-variables.html#tokudb_db_open_max","title":"<code>Tokudb_DB_OPEN_MAX</code>","text":"<p>This variable shows the maximum number of concurrently opened databases.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_entry_max_committed_xr","title":"<code>Tokudb_LEAF_ENTRY_MAX_COMMITTED_XR</code>","text":"<p>This variable shows the maximum number of committed transaction records that were stored on disk in a new or modified row.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_entry_max_provisional_xr","title":"<code>Tokudb_LEAF_ENTRY_MAX_PROVISIONAL_XR</code>","text":"<p>This variable shows the maximum number of provisional transaction records that were stored on disk in a new or modified row.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_entry_expanded","title":"<code>Tokudb_LEAF_ENTRY_EXPANDED</code>","text":"<p>This variable shows the number of times that an expanded memory mechanism was used to store a new or modified row on disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_entry_max_memsize","title":"<code>Tokudb_LEAF_ENTRY_MAX_MEMSIZE</code>","text":"<p>This variable shows the maximum number of bytes that were stored on disk as a new or modified row. This is the maximum uncompressed size of any row stored in TokuDB that was created or modified since the server started.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_entry_apply_gc_bytes_in","title":"<code>Tokudb_LEAF_ENTRY_APPLY_GC_BYTES_IN</code>","text":"<p>This variable shows the total number of bytes of leaf nodes data before performing garbage collection for non-flush events.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_entry_apply_gc_bytes_out","title":"<code>Tokudb_LEAF_ENTRY_APPLY_GC_BYTES_OUT</code>","text":"<p>This variable shows the total number of bytes of leaf nodes data after performing garbage collection for non-flush events.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_entry_normal_gc_bytes_in","title":"<code>Tokudb_LEAF_ENTRY_NORMAL_GC_BYTES_IN</code>","text":"<p>This variable shows the total number of bytes of leaf nodes data before performing garbage collection for flush events.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_entry_normal_gc_bytes_out","title":"<code>Tokudb_LEAF_ENTRY_NORMAL_GC_BYTES_OUT</code>","text":"<p>This variable shows the total number of bytes of leaf nodes data after performing garbage collection for flush events.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_period","title":"<code>Tokudb_CHECKPOINT_PERIOD</code>","text":"<p>This variable shows the interval in seconds between the end of an automatic checkpoint and the beginning of the next automatic checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_footprint","title":"<code>Tokudb_CHECKPOINT_FOOTPRINT</code>","text":"<p>This variable shows at what stage the checkpointer is at. It\u2019s used for debugging purposes only and not a useful value for a normal user.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_last_began","title":"<code>Tokudb_CHECKPOINT_LAST_BEGAN</code>","text":"<p>This variable shows the time the last checkpoint began. If a checkpoint is currently in progress, then this time may be later than the time the last checkpoint completed. If no checkpoint has ever taken place, then this value will be <code>Dec 31, 1969</code> on Linux hosts.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_last_complete_began","title":"<code>Tokudb_CHECKPOINT_LAST_COMPLETE_BEGAN</code>","text":"<p>This variable shows the time the last complete checkpoint started. Any data that changed after this time will not be captured in the checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_last_complete_ended","title":"<code>Tokudb_CHECKPOINT_LAST_COMPLETE_ENDED</code>","text":"<p>This variable shows the time the last complete checkpoint ended.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_duration","title":"<code>Tokudb_CHECKPOINT_DURATION</code>","text":"<p>This variable shows time (in seconds) required to complete all checkpoints.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_duration_last","title":"<code>Tokudb_CHECKPOINT_DURATION_LAST</code>","text":"<p>This variable shows time (in seconds) required to complete the last checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_last_lsn","title":"<code>Tokudb_CHECKPOINT_LAST_LSN</code>","text":"<p>This variable shows the last successful checkpoint LSN. Each checkpoint from the time the PerconaFT environment is created has a monotonically incrementing LSN. This is not a useful value for a normal user to use for any purpose other than having some idea of how many checkpoints have occurred since the system was first created.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_taken","title":"<code>Tokudb_CHECKPOINT_TAKEN</code>","text":"<p>This variable shows the number of complete checkpoints that have been taken.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_failed","title":"<code>Tokudb_CHECKPOINT_FAILED</code>","text":"<p>This variable shows the number of checkpoints that have failed for any reason.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_waiters_now","title":"<code>Tokudb_CHECKPOINT_WAITERS_NOW</code>","text":"<p>This variable shows the current number of threads waiting for the <code>checkpoint safe</code> lock. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_waiters_max","title":"<code>Tokudb_CHECKPOINT_WAITERS_MAX</code>","text":"<p>This variable shows the maximum number of threads that concurrently waited for the <code>checkpoint safe</code> lock. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_client_wait_on_mo","title":"<code>Tokudb_CHECKPOINT_CLIENT_WAIT_ON_MO</code>","text":"<p>This variable shows the number of times a non-checkpoint client thread waited for the multi-operation lock. It is an internal <code>rwlock</code> that is similar in nature to the InnoDB kernel mutex, it effectively halts all access to the PerconaFT API when write locked. The <code>begin</code> phase of the checkpoint takes this lock for a brief period.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_client_wait_on_cs","title":"<code>Tokudb_CHECKPOINT_CLIENT_WAIT_ON_CS</code>","text":"<p>This variable shows the number of times a non-checkpoint client thread waited for the checkpoint-safe lock. This is the lock taken when you <code>SET tokudb_checkpoint_lock=1</code>. If a client trying to lock/postpone the checkpointer has to wait for the currently running checkpoint to complete, that wait time will be reflected here and summed. This is not a useful metric as regular users should never be manipulating the checkpoint lock.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_begin_time","title":"<code>Tokudb_CHECKPOINT_BEGIN_TIME</code>","text":"<p>This variable shows the cumulative time (in microseconds) required to mark all dirty nodes as pending a checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_long_begin_time","title":"<code>Tokudb_CHECKPOINT_LONG_BEGIN_TIME</code>","text":"<p>This variable shows the cumulative actual time (in microseconds) of checkpoint <code>begin</code> stages that took longer than 1 second.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_long_begin_count","title":"<code>Tokudb_CHECKPOINT_LONG_BEGIN_COUNT</code>","text":"<p>This variable shows the number of checkpoints whose <code>begin</code> stage took longer than 1 second.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_end_time","title":"<code>Tokudb_CHECKPOINT_END_TIME</code>","text":"<p>This variable shows the time spent in checkpoint end operation in seconds.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_long_end_time","title":"<code>Tokudb_CHECKPOINT_LONG_END_TIME</code>","text":"<p>This variable shows the total time of long checkpoints in seconds.</p>"},{"location":"tokudb-status-variables.html#tokudb_checkpoint_long_end_count","title":"<code>Tokudb_CHECKPOINT_LONG_END_COUNT</code>","text":"<p>This variable shows the number of checkpoints whose <code>end_checkpoint</code> operations exceeded 1 minute.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_miss","title":"<code>Tokudb_CACHETABLE_MISS</code>","text":"<p>This variable shows the number of times the application was unable to access the data in the internal cache. A cache miss means that date will need to be read from disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_miss_time","title":"<code>Tokudb_CACHETABLE_MISS_TIME</code>","text":"<p>This variable shows the total time, in microseconds, of how long the database has had to wait for a disk read to complete.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_prefetches","title":"<code>Tokudb_CACHETABLE_PREFETCHES</code>","text":"<p>This variable shows the total number of times that a block of memory has been prefetched into the database\u2019s cache. Data is prefetched when the database\u2019s algorithms determine that a block of memory is likely to be accessed by the application.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_size_current","title":"<code>Tokudb_CACHETABLE_SIZE_CURRENT</code>","text":"<p>This variable shows how much of the uncompressed data, in bytes, is currently in the database\u2019s internal cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_size_limit","title":"<code>Tokudb_CACHETABLE_SIZE_LIMIT</code>","text":"<p>This variable shows how much of the uncompressed data, in bytes, will fit in the database\u2019s internal cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_size_writing","title":"<code>Tokudb_CACHETABLE_SIZE_WRITING</code>","text":"<p>This variable shows the number of bytes that are currently queued up to be written to disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_size_nonleaf","title":"<code>Tokudb_CACHETABLE_SIZE_NONLEAF</code>","text":"<p>This variable shows the amount of memory, in bytes, the current set of non-leaf nodes occupy in the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_size_leaf","title":"<code>Tokudb_CACHETABLE_SIZE_LEAF</code>","text":"<p>This variable shows the amount of memory, in bytes, the current set of (decompressed) leaf nodes occupy in the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_size_rollback","title":"<code>Tokudb_CACHETABLE_SIZE_ROLLBACK</code>","text":"<p>This variable shows the rollback nodes size, in bytes, in the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_size_cachepressure","title":"<code>Tokudb_CACHETABLE_SIZE_CACHEPRESSURE</code>","text":"<p>This variable shows the number of bytes causing cache pressure (the sum of buffers and work done counters), helps to understand if cleaner threads are keeping up with workload. It should really be looked at as more of a value to use in a ratio of cache pressure / cache table size. The closer that ratio evaluates to 1, the higher the cache pressure.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_size_cloned","title":"<code>Tokudb_CACHETABLE_SIZE_CLONED</code>","text":"<p>This variable shows the amount of memory, in bytes, currently used for cloned nodes. During the checkpoint operation, dirty nodes are cloned prior to serialization/compression, then written to disk. After which, the memory for the cloned block is returned for re-use.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_evictions","title":"<code>Tokudb_CACHETABLE_EVICTIONS</code>","text":"<p>This variable shows the number of blocks evicted from cache. On its own this is not a useful number as its impact on performance depends entirely on the hardware and workload in use. For example, two workloads, one random, one linear for the same starting data set will have two wildly different eviction patterns.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_cleaner_executions","title":"<code>Tokudb_CACHETABLE_CLEANER_EXECUTIONS</code>","text":"<p>This variable shows the total number of times the cleaner thread loop has executed.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_cleaner_period","title":"<code>Tokudb_CACHETABLE_CLEANER_PERIOD</code>","text":"<p>TokuDB includes a cleaner thread that optimizes indexes in the background. This variable is the time, in seconds, between the completion of a group of cleaner operations and the beginning of the next group of cleaner operations. The cleaner operations run on a background thread performing work that does not need to be done on the client thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_cleaner_iterations","title":"<code>Tokudb_CACHETABLE_CLEANER_ITERATIONS</code>","text":"<p>This variable shows the number of cleaner operations that are performed every cleaner period.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_wait_pressure_count","title":"<code>Tokudb_CACHETABLE_WAIT_PRESSURE_COUNT</code>","text":"<p>This variable shows the number of times a thread was stalled due to cache pressure.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_wait_pressure_time","title":"<code>Tokudb_CACHETABLE_WAIT_PRESSURE_TIME</code>","text":"<p>This variable shows the total time, in microseconds, waiting on cache pressure to subside.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_long_wait_pressure_count","title":"<code>Tokudb_CACHETABLE_LONG_WAIT_PRESSURE_COUNT</code>","text":"<p>This variable shows the number of times a thread was stalled for more than one second due to cache pressure.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_long_wait_pressure_time","title":"<code>Tokudb_CACHETABLE_LONG_WAIT_PRESSURE_TIME</code>","text":"<p>This variable shows the total time, in microseconds, waiting on cache pressure to subside for more than one second.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_client_num_threads","title":"<code>Tokudb_CACHETABLE_POOL_CLIENT_NUM_THREADS</code>","text":"<p>This variable shows the number of threads in the client thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_client_num_threads_active","title":"<code>Tokudb_CACHETABLE_POOL_CLIENT_NUM_THREADS_ACTIVE</code>","text":"<p>This variable shows the number of currently active threads in the client thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_client_queue_size","title":"<code>Tokudb_CACHETABLE_POOL_CLIENT_QUEUE_SIZE</code>","text":"<p>This variable shows the number of currently queued work items in the client thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_client_max_queue_size","title":"<code>Tokudb_CACHETABLE_POOL_CLIENT_MAX_QUEUE_SIZE</code>","text":"<p>This variable shows the largest number of queued work items in the client thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_client_total_items_processed","title":"<code>Tokudb_CACHETABLE_POOL_CLIENT_TOTAL_ITEMS_PROCESSED</code>","text":"<p>This variable shows the total number of work items processed in the client thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_client_total_execution_time","title":"<code>Tokudb_CACHETABLE_POOL_CLIENT_TOTAL_EXECUTION_TIME</code>","text":"<p>This variable shows the total execution time of processing work items in the client thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_cachetable_num_threads","title":"<code>Tokudb_CACHETABLE_POOL_CACHETABLE_NUM_THREADS</code>","text":"<p>This variable shows the number of threads in the cachetable threadpool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_cachetable_num_threads_active","title":"<code>Tokudb_CACHETABLE_POOL_CACHETABLE_NUM_THREADS_ACTIVE</code>","text":"<p>This variable shows the number of currently active threads in the cachetable thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_cachetable_queue_size","title":"<code>Tokudb_CACHETABLE_POOL_CACHETABLE_QUEUE_SIZE</code>","text":"<p>This variable shows the number of currently queued work items in the cachetable thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_cachetable_max_queue_size","title":"<code>Tokudb_CACHETABLE_POOL_CACHETABLE_MAX_QUEUE_SIZE</code>","text":"<p>This variable shows the largest number of queued work items in the cachetable thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_cachetable_total_items_processed","title":"<code>Tokudb_CACHETABLE_POOL_CACHETABLE_TOTAL_ITEMS_PROCESSED</code>","text":"<p>This variable shows the total number of work items processed in the cachetable thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_cachetable_total_execution_time","title":"<code>Tokudb_CACHETABLE_POOL_CACHETABLE_TOTAL_EXECUTION_TIME</code>","text":"<p>This variable shows the total execution time of processing work items in the cachetable thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_checkpoint_num_threads","title":"<code>Tokudb_CACHETABLE_POOL_CHECKPOINT_NUM_THREADS</code>","text":"<p>This variable shows the number of threads in the checkpoint threadpool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_checkpoint_num_threads_active","title":"<code>Tokudb_CACHETABLE_POOL_CHECKPOINT_NUM_THREADS_ACTIVE</code>","text":"<p>This variable shows the number of currently active threads in the checkpoint thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_checkpoint_queue_size","title":"<code>Tokudb_CACHETABLE_POOL_CHECKPOINT_QUEUE_SIZE</code>","text":"<p>This variable shows the number of currently queued work items in the checkpoint thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_checkpoint_max_queue_size","title":"<code>Tokudb_CACHETABLE_POOL_CHECKPOINT_MAX_QUEUE_SIZE</code>","text":"<p>This variable shows the largest number of queued work items in the checkpoint thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_checkpoint_total_items_processed","title":"<code>Tokudb_CACHETABLE_POOL_CHECKPOINT_TOTAL_ITEMS_PROCESSED</code>","text":"<p>This variable shows the total number of work items processed in the checkpoint thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_cachetable_pool_checkpoint_total_execution_time","title":"<code>Tokudb_CACHETABLE_POOL_CHECKPOINT_TOTAL_EXECUTION_TIME</code>","text":"<p>This variable shows the total execution time of processing work items in the checkpoint thread pool.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_memory_size","title":"<code>Tokudb_LOCKTREE_MEMORY_SIZE</code>","text":"<p>This variable shows the amount of memory, in bytes, that the locktree is currently using.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_memory_size_limit","title":"<code>Tokudb_LOCKTREE_MEMORY_SIZE_LIMIT</code>","text":"<p>This variable shows the maximum amount of memory, in bytes, that the locktree is allowed to use.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_escalation_num","title":"<code>Tokudb_LOCKTREE_ESCALATION_NUM</code>","text":"<p>This variable shows the number of times the locktree needed to run lock escalation to reduce its memory footprint.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_escalation_seconds","title":"<code>Tokudb_LOCKTREE_ESCALATION_SECONDS</code>","text":"<p>This variable shows the total number of seconds spent performing locktree escalation.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_latest_post_escalation_memory_size","title":"<code>Tokudb_LOCKTREE_LATEST_POST_ESCALATION_MEMORY_SIZE</code>","text":"<p>This variable shows the locktree size, in bytes, after most current locktree escalation.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_open_current","title":"<code>Tokudb_LOCKTREE_OPEN_CURRENT</code>","text":"<p>This variable shows the number of locktrees that are currently opened.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_pending_lock_requests","title":"<code>Tokudb_LOCKTREE_PENDING_LOCK_REQUESTS</code>","text":"<p>This variable shows the number of requests waiting for a lock grant.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_sto_eligible_num","title":"<code>Tokudb_LOCKTREE_STO_ELIGIBLE_NUM</code>","text":"<p>This variable shows the number of locktrees eligible for <code>Single Transaction optimizations</code>. STO optimization are behaviors that can happen within the locktree when there is exactly one transaction active within the locktree. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_sto_ended_num","title":"<code>Tokudb_LOCKTREE_STO_ENDED_NUM</code>","text":"<p>This variable shows the total number of times a <code>Single Transaction Optimization</code> was ended early due to another transaction starting. STO optimization are behaviors that can happen within the locktree when there is exactly one transaction active within the locktree. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_sto_ended_seconds","title":"<code>Tokudb_LOCKTREE_STO_ENDED_SECONDS</code>","text":"<p>This variable shows the total number of seconds ending the <code>Single Transaction Optimizations</code>. STO optimization are behaviors that can happen within the locktree when there is exactly one transaction active within the locktree. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_wait_count","title":"<code>Tokudb_LOCKTREE_WAIT_COUNT</code>","text":"<p>This variable shows the number of times that a lock request could not be acquired because of a conflict with some other transaction. PerconaFT lock request  cycles to try to obtain a lock, if it can not get a lock, it sleeps/waits and times out, checks to get the lock again, repeat. This value indicates the number of cycles it needed to execute before it obtained the lock.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_wait_time","title":"<code>Tokudb_LOCKTREE_WAIT_TIME</code>","text":"<p>This variable shows the total time, in microseconds, spent by client waiting for a lock conflict to be resolved.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_long_wait_count","title":"<code>Tokudb_LOCKTREE_LONG_WAIT_COUNT</code>","text":"<p>This variable shows number of lock waits greater than one second in duration.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_long_wait_time","title":"<code>Tokudb_LOCKTREE_LONG_WAIT_TIME</code>","text":"<p>This variable shows the total time, in microseconds, of the long waits.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_timeout_count","title":"<code>Tokudb_LOCKTREE_TIMEOUT_COUNT</code>","text":"<p>This variable shows the number of times that a lock request timed out.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_wait_escalation_count","title":"<code>Tokudb_LOCKTREE_WAIT_ESCALATION_COUNT</code>","text":"<p>When the sum of the sizes of locks taken reaches the lock tree limit, we run lock escalation on a background thread. The clients threads need to wait for escalation to consolidate locks and free up memory. This variables shows the number of times a client thread had to wait on lock escalation.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_wait_escalation_time","title":"<code>Tokudb_LOCKTREE_WAIT_ESCALATION_TIME</code>","text":"<p>This variable shows the total time, in microseconds, that a client thread spent waiting for lock escalation to free up memory.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_long_wait_escalation_count","title":"<code>Tokudb_LOCKTREE_LONG_WAIT_ESCALATION_COUNT</code>","text":"<p>This variable shows number of times that a client thread had to wait on lock escalation and the wait time was greater than one second.</p>"},{"location":"tokudb-status-variables.html#tokudb_locktree_long_wait_escalation_time","title":"<code>Tokudb_LOCKTREE_LONG_WAIT_ESCALATION_TIME</code>","text":"<p>This variable shows the total time, in microseconds, of the long waits for lock escalation to free up memory.</p>"},{"location":"tokudb-status-variables.html#tokudb_dictionary_updates","title":"<code>Tokudb_DICTIONARY_UPDATES</code>","text":"<p>This variable shows the total number of rows that have been updated in all primary and secondary indexes combined, if those updates have been done with a separate recovery log entry per index.</p>"},{"location":"tokudb-status-variables.html#tokudb_dictionary_broadcast_updates","title":"<code>Tokudb_DICTIONARY_BROADCAST_UPDATES</code>","text":"<p>This variable shows the number of broadcast updates that have been successfully performed. A broadcast update is an update that affects all rows in a dictionary.</p>"},{"location":"tokudb-status-variables.html#tokudb_descriptor_set","title":"<code>Tokudb_DESCRIPTOR_SET</code>","text":"<p>This variable shows the number of time a descriptor was updated when the entire dictionary was updated (for example, when the schema has been changed).</p>"},{"location":"tokudb-status-variables.html#tokudb_messages_ignored_by_leaf_due_to_msn","title":"<code>Tokudb_MESSAGES_IGNORED_BY_LEAF_DUE_TO_MSN</code>","text":"<p>This variable shows the number of messages that were ignored by a leaf because it had already been applied.</p>"},{"location":"tokudb-status-variables.html#tokudb_total_search_retries","title":"<code>Tokudb_TOTAL_SEARCH_RETRIES</code>","text":"<p>Internal value that is no use to anyone other than a developer debugging a specific query/search issue.</p>"},{"location":"tokudb-status-variables.html#tokudb_search_tries_gt_height","title":"<code>Tokudb_SEARCH_TRIES_GT_HEIGHT</code>","text":"<p>Internal value that is no use to anyone other than a developer debugging a specific query/search issue.</p>"},{"location":"tokudb-status-variables.html#tokudb_search_tries_gt_heightplus3","title":"<code>Tokudb_SEARCH_TRIES_GT_HEIGHTPLUS3</code>","text":"<p>Internal value that is no use to anyone other than a developer debugging a specific query/search issue.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_flushed_not_checkpoint","title":"<code>Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT</code>","text":"<p>This variable shows the number of leaf nodes flushed to disk, not for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_flushed_not_checkpoint_bytes","title":"<code>Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_BYTES</code>","text":"<p>This variable shows the size, in bytes, of leaf nodes flushed to disk, not for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_flushed_not_checkpoint_uncompressed_bytes","title":"<code>Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_UNCOMPRESSED_BYTES</code>","text":"<p>This variable shows the size, in bytes, of uncompressed leaf nodes flushed to disk not for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_flushed_not_checkpoint_seconds","title":"<code>Tokudb_LEAF_NODES_FLUSHED_NOT_CHECKPOINT_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when writing leaf nodes flushed to disk, not for checkpoint</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_flushed_to_disk_not_checkpoint","title":"<code>Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT</code>","text":"<p>This variable shows the number of non-leaf nodes flushed to disk, not for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_flushed_to_disk_not_checkpoint_bytes","title":"<code>Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_BYTES</code>","text":"<p>This variable shows the size, in bytes, of non-leaf nodes flushed to disk, not for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_flushed_to_disk_not_checkpoint_uncompresse","title":"<code>Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_UNCOMPRESSE</code>","text":"<p>This variable shows the size, in bytes, of uncompressed non-leaf nodes flushed to disk not for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_flushed_to_disk_not_checkpoint_seconds","title":"<code>Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_NOT_CHECKPOINT_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when writing non-leaf nodes flushed to disk, not for checkpoint</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_flushed_checkpoint","title":"<code>Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT</code>","text":"<p>This variable shows the number of leaf nodes flushed to disk, for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_flushed_checkpoint_bytes","title":"<code>Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_BYTES</code>","text":"<p>This variable shows the size, in bytes, of leaf nodes flushed to disk, for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_flushed_checkpoint_uncompressed_bytes","title":"<code>Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_UNCOMPRESSED_BYTES</code>","text":"<p>This variable shows the size, in bytes, of uncompressed leaf nodes flushed to disk for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_flushed_checkpoint_seconds","title":"<code>Tokudb_LEAF_NODES_FLUSHED_CHECKPOINT_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when writing leaf nodes flushed to disk for checkpoint</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_flushed_to_disk_checkpoint","title":"<code>Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT</code>","text":"<p>This variable shows the number of non-leaf nodes flushed to disk, for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_flushed_to_disk_checkpoint_bytes","title":"<code>Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_BYTES</code>","text":"<p>This variable shows the size, in bytes, of non-leaf nodes flushed to disk, for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_flushed_to_disk_checkpoint_uncompressed_by","title":"<code>Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_UNCOMPRESSED_BY</code>","text":"<p>This variable shows the size, in bytes, of uncompressed non-leaf nodes flushed to disk for checkpoint.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_flushed_to_disk_checkpoint_seconds","title":"<code>Tokudb_NONLEAF_NODES_FLUSHED_TO_DISK_CHECKPOINT_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when writing non-leaf nodes flushed to disk for checkpoint</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_node_compression_ratio","title":"<code>Tokudb_LEAF_NODE_COMPRESSION_RATIO</code>","text":"<p>This variable shows the ratio of uncompressed bytes (in-memory) to compressed bytes (on-disk) for leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_node_compression_ratio","title":"<code>Tokudb_NONLEAF_NODE_COMPRESSION_RATIO</code>","text":"<p>This variable shows the ratio of uncompressed bytes (in-memory) to compressed bytes (on-disk) for non-leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_overall_node_compression_ratio","title":"<code>Tokudb_OVERALL_NODE_COMPRESSION_RATIO</code>","text":"<p>This variable shows the ratio of uncompressed bytes (in-memory) to compressed bytes (on-disk) for all nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_node_partial_evictions","title":"<code>Tokudb_NONLEAF_NODE_PARTIAL_EVICTIONS</code>","text":"<p>This variable shows the number of times a partition of a non-leaf node was evicted from the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_node_partial_evictions_bytes","title":"<code>Tokudb_NONLEAF_NODE_PARTIAL_EVICTIONS_BYTES</code>","text":"<p>This variable shows the amount, in bytes, of memory freed by evicting partitions of non-leaf nodes from the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_node_partial_evictions","title":"<code>Tokudb_LEAF_NODE_PARTIAL_EVICTIONS</code>","text":"<p>This variable shows the number of times a partition of a leaf node was evicted from the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_node_partial_evictions_bytes","title":"<code>Tokudb_LEAF_NODE_PARTIAL_EVICTIONS_BYTES</code>","text":"<p>This variable shows the amount, in bytes, of memory freed by evicting partitions of leaf nodes from the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_node_full_evictions","title":"<code>Tokudb_LEAF_NODE_FULL_EVICTIONS</code>","text":"<p>This variable shows the number of times a full leaf node was evicted from the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_node_full_evictions_bytes","title":"<code>Tokudb_LEAF_NODE_FULL_EVICTIONS_BYTES</code>","text":"<p>This variable shows the amount, in bytes, of memory freed by evicting full leaf nodes from the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_node_full_evictions","title":"<code>Tokudb_NONLEAF_NODE_FULL_EVICTIONS</code>","text":"<p>This variable shows the number of times a full non-leaf node was evicted from the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_node_full_evictions_bytes","title":"<code>Tokudb_NONLEAF_NODE_FULL_EVICTIONS_BYTES</code>","text":"<p>This variable shows the amount, in bytes, of memory freed by evicting full non-leaf nodes from the cache.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_created","title":"<code>Tokudb_LEAF_NODES_CREATED</code>","text":"<p>This variable shows the number of created leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_created","title":"<code>Tokudb_NONLEAF_NODES_CREATED</code>","text":"<p>This variable shows the number of created non-leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_nodes_destroyed","title":"<code>Tokudb_LEAF_NODES_DESTROYED</code>","text":"<p>This variable shows the number of destroyed leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_nodes_destroyed","title":"<code>Tokudb_NONLEAF_NODES_DESTROYED</code>","text":"<p>This variable shows the number of destroyed non-leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_messages_injected_at_root_bytes","title":"<code>Tokudb_MESSAGES_INJECTED_AT_ROOT_BYTES</code>","text":"<p>This variable shows the size, in bytes, of messages injected at root (for all trees).</p>"},{"location":"tokudb-status-variables.html#tokudb_messages_flushed_from_h1_to_leaves_bytes","title":"<code>Tokudb_MESSAGES_FLUSHED_FROM_H1_TO_LEAVES_BYTES</code>","text":"<p>This variable shows the size, in bytes, of messages flushed from <code>h1</code> nodes to leaves.</p>"},{"location":"tokudb-status-variables.html#tokudb_messages_in_trees_estimate_bytes","title":"<code>Tokudb_MESSAGES_IN_TREES_ESTIMATE_BYTES</code>","text":"<p>This variable shows the estimated size, in bytes, of messages currently in trees.</p>"},{"location":"tokudb-status-variables.html#tokudb_messages_injected_at_root","title":"<code>Tokudb_MESSAGES_INJECTED_AT_ROOT</code>","text":"<p>This variables shows the number of messages that were injected at root node of a tree.</p>"},{"location":"tokudb-status-variables.html#tokudb_broadcase_messages_injected_at_root","title":"<code>Tokudb_BROADCASE_MESSAGES_INJECTED_AT_ROOT</code>","text":"<p>This variable shows the number of broadcast messages dropped into the root node of a tree. These are things such as the result of <code>OPTIMIZE TABLE</code> and a few other operations. This is not a useful metric for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_decompressed_target_query","title":"<code>Tokudb_BASEMENTS_DECOMPRESSED_TARGET_QUERY</code>","text":"<p>This variable shows the number of basement nodes decompressed for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_decompressed_prelocked_range","title":"<code>Tokudb_BASEMENTS_DECOMPRESSED_PRELOCKED_RANGE</code>","text":"<p>This variable shows the number of basement nodes aggressively decompressed by queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_decompressed_prefetch","title":"<code>Tokudb_BASEMENTS_DECOMPRESSED_PREFETCH</code>","text":"<p>This variable shows the number of basement nodes decompressed by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_decompressed_for_write","title":"<code>Tokudb_BASEMENTS_DECOMPRESSED_FOR_WRITE</code>","text":"<p>This variable shows the number of basement nodes decompressed for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_decompressed_target_query","title":"<code>Tokudb_BUFFERS_DECOMPRESSED_TARGET_QUERY</code>","text":"<p>This variable shows the number of buffers decompressed for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_decompressed_prelocked_range","title":"<code>Tokudb_BUFFERS_DECOMPRESSED_PRELOCKED_RANGE</code>","text":"<p>This variable shows the number of buffers decompressed by queries aggressively.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_decompressed_prefetch","title":"<code>Tokudb_BUFFERS_DECOMPRESSED_PREFETCH</code>","text":"<p>This variable shows the number of buffers decompressed by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_decompressed_for_write","title":"<code>Tokudb_BUFFERS_DECOMPRESSED_FOR_WRITE</code>","text":"<p>This variable shows the number of buffers decompressed for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_query","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_QUERY</code>","text":"<p>This variable shows the number of pivot nodes fetched for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_query_bytes","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_QUERY_BYTES</code>","text":"<p>This variable shows the number of bytes of pivot nodes fetched for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_query_seconds","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_QUERY_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching pivot nodes for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_prefetch","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_PREFETCH</code>","text":"<p>This variable shows the number of pivot nodes fetched by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_prefetch_bytes","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_PREFETCH_BYTES</code>","text":"<p>This variable shows the number of bytes of pivot nodes fetched for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_prefetch_seconds","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_PREFETCH_SECONDS</code>","text":"<p>This variable shows the number seconds waiting for I/O when fetching pivot nodes by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_write","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_WRITE</code>","text":"<p>This variable shows the number of pivot nodes fetched for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_write_bytes","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_WRITE_BYTES</code>","text":"<p>This variable shows the number of bytes of pivot nodes fetched for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_pivots_fetched_for_write_seconds","title":"<code>Tokudb_PIVOTS_FETCHED_FOR_WRITE_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching pivot nodes for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_target_query","title":"<code>Tokudb_BASEMENTS_FETCHED_TARGET_QUERY</code>","text":"<p>This variable shows the number of basement nodes fetched from disk for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_target_query_bytes","title":"<code>Tokudb_BASEMENTS_FETCHED_TARGET_QUERY_BYTES</code>","text":"<p>This variable shows the number of basement node bytes fetched from disk for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_target_query_seconds","title":"<code>Tokudb_BASEMENTS_FETCHED_TARGET_QUERY_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching basement nodes from disk for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_prelocked_range","title":"<code>Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE</code>","text":"<p>This variable shows the number of basement nodes fetched from disk aggressively.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_prelocked_range_bytes","title":"<code>Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE_BYTES</code>","text":"<p>This variable shows the number of basement node bytes fetched from disk aggressively.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_prelocked_range_seconds","title":"<code>Tokudb_BASEMENTS_FETCHED_PRELOCKED_RANGE_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching basement nodes from disk aggressively.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_prefetch","title":"<code>Tokudb_BASEMENTS_FETCHED_PREFETCH</code>","text":"<p>This variable shows the number of basement nodes fetched from disk by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_prefetch_bytes","title":"<code>Tokudb_BASEMENTS_FETCHED_PREFETCH_BYTES</code>","text":"<p>This variable shows the number of basement node bytes fetched from disk by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_prefetch_seconds","title":"<code>Tokudb_BASEMENTS_FETCHED_PREFETCH_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching basement nodes from disk by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_for_write","title":"<code>Tokudb_BASEMENTS_FETCHED_FOR_WRITE</code>","text":"<p>This variable shows the number of buffers fetched from disk for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_for_write_bytes","title":"<code>Tokudb_BASEMENTS_FETCHED_FOR_WRITE_BYTES</code>","text":"<p>This variable shows the number of buffer bytes fetched from disk for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_basements_fetched_for_write_seconds","title":"<code>Tokudb_BASEMENTS_FETCHED_FOR_WRITE_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching buffers from disk for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_target_query","title":"<code>Tokudb_BUFFERS_FETCHED_TARGET_QUERY</code>","text":"<p>This variable shows the number of buffers fetched from disk for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_target_query_bytes","title":"<code>Tokudb_BUFFERS_FETCHED_TARGET_QUERY_BYTES</code>","text":"<p>This variable shows the number of buffer bytes fetched from disk for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_target_query_seconds","title":"<code>Tokudb_BUFFERS_FETCHED_TARGET_QUERY_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching buffers from disk for queries.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_prelocked_range","title":"<code>Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE</code>","text":"<p>This variable shows the number of buffers fetched from disk aggressively.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_prelocked_range_bytes","title":"<code>Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE_BYTES</code>","text":"<p>This variable shows the number of buffer bytes fetched from disk aggressively.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_prelocked_range_seconds","title":"<code>Tokudb_BUFFERS_FETCHED_PRELOCKED_RANGE_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching buffers from disk aggressively.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_prefetch","title":"<code>Tokudb_BUFFERS_FETCHED_PREFETCH</code>","text":"<p>This variable shows the number of buffers fetched from disk aggressively.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_prefetch_bytes","title":"<code>Tokudb_BUFFERS_FETCHED_PREFETCH_BYTES</code>","text":"<p>This variable shows the number of buffer bytes fetched from disk by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_prefetch_seconds","title":"<code>Tokudb_BUFFERS_FETCHED_PREFETCH_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching buffers from disk by a prefetch thread.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_for_write","title":"<code>Tokudb_BUFFERS_FETCHED_FOR_WRITE</code>","text":"<p>This variable shows the number of buffers fetched from disk for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_for_write_bytes","title":"<code>Tokudb_BUFFERS_FETCHED_FOR_WRITE_BYTES</code>","text":"<p>This variable shows the number of buffer bytes fetched from disk for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_buffers_fetched_for_write_seconds","title":"<code>Tokudb_BUFFERS_FETCHED_FOR_WRITE_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for I/O when fetching buffers from disk for writes.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_compression_to_memory_seconds","title":"<code>Tokudb_LEAF_COMPRESSION_TO_MEMORY_SECONDS</code>","text":"<p>This variable shows the total time, in seconds, spent compressing leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_serialization_to_memory_seconds","title":"<code>Tokudb_LEAF_SERIALIZATION_TO_MEMORY_SECONDS</code>","text":"<p>This variable shows the total time, in seconds, spent serializing leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_decompression_to_memory_seconds","title":"<code>Tokudb_LEAF_DECOMPRESSION_TO_MEMORY_SECONDS</code>","text":"<p>This variable shows the total time, in seconds, spent decompressing leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_leaf_deserialization_to_memory_seconds","title":"<code>Tokudb_LEAF_DESERIALIZATION_TO_MEMORY_SECONDS</code>","text":"<p>This variable shows the total time, in seconds, spent deserializing leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_compression_to_memory_seconds","title":"<code>Tokudb_NONLEAF_COMPRESSION_TO_MEMORY_SECONDS</code>","text":"<p>This variable shows the total time, in seconds, spent compressing non leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_serialization_to_memory_seconds","title":"<code>Tokudb_NONLEAF_SERIALIZATION_TO_MEMORY_SECONDS</code>","text":"<p>This variable shows the total time, in seconds, spent serializing non leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_decompression_to_memory_seconds","title":"<code>Tokudb_NONLEAF_DECOMPRESSION_TO_MEMORY_SECONDS</code>","text":"<p>This variable shows the total time, in seconds, spent decompressing non leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_nonleaf_deserialization_to_memory_seconds","title":"<code>Tokudb_NONLEAF_DESERIALIZATION_TO_MEMORY_SECONDS</code>","text":"<p>This variable shows the total time, in seconds, spent deserializing non leaf nodes.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_roots_split","title":"<code>Tokudb_PROMOTION_ROOTS_SPLIT</code>","text":"<p>This variable shows the number of times the root split during promotion.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_leaf_roots_injected_into","title":"<code>Tokudb_PROMOTION_LEAF_ROOTS_INJECTED_INTO</code>","text":"<p>This variable shows the number of times a message stopped at a root with height <code>0</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_h1_roots_injected_into","title":"<code>Tokudb_PROMOTION_H1_ROOTS_INJECTED_INTO</code>","text":"<p>This variable shows the number of times a message stopped at a root with height <code>1</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_injections_at_depth_0","title":"<code>Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_0</code>","text":"<p>This variable shows the number of times a message stopped at depth <code>0</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_injections_at_depth_1","title":"<code>Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_1</code>","text":"<p>This variable shows the number of times a message stopped at depth <code>1</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_injections_at_depth_2","title":"<code>Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_2</code>","text":"<p>This variable shows the number of times a message stopped at depth <code>2</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_injections_at_depth_3","title":"<code>Tokudb_PROMOTION_INJECTIONS_AT_DEPTH_3</code>","text":"<p>This variable shows the number of times a message stopped at depth <code>3</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_injections_lower_than_depth_3","title":"<code>Tokudb_PROMOTION_INJECTIONS_LOWER_THAN_DEPTH_3</code>","text":"<p>This variable shows the number of times a message was promoted past depth <code>3</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_stopped_nonempty_buffer","title":"<code>Tokudb_PROMOTION_STOPPED_NONEMPTY_BUFFER</code>","text":"<p>This variable shows the number of times a message stopped because it reached a nonempty buffer.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_stopped_at_height_1","title":"<code>Tokudb_PROMOTION_STOPPED_AT_HEIGHT_1</code>","text":"<p>This variable shows the number of times a message stopped because it had reached height <code>1</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_stopped_child_locked_or_not_in_memory","title":"<code>Tokudb_PROMOTION_STOPPED_CHILD_LOCKED_OR_NOT_IN_MEMORY</code>","text":"<p>This variable shows the number of times a message stopped because it could not cheaply get access to a child.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_stopped_child_not_fully_in_memory","title":"<code>Tokudb_PROMOTION_STOPPED_CHILD_NOT_FULLY_IN_MEMORY</code>","text":"<p>This variable shows the number of times a message stopped because it could not cheaply get access to a child.</p>"},{"location":"tokudb-status-variables.html#tokudb_promotion_stopped_after_locking_child","title":"<code>Tokudb_PROMOTION_STOPPED_AFTER_LOCKING_CHILD</code>","text":"<p>This variable shows the number of times a message stopped before a child which had been locked.</p>"},{"location":"tokudb-status-variables.html#tokudb_basement_deserialization_fixed_key","title":"<code>Tokudb_BASEMENT_DESERIALIZATION_FIXED_KEY</code>","text":"<p>This variable shows the number of basement nodes deserialized where all keys had the same size, leaving the basement in a format that is optimal for in-memory workloads.</p>"},{"location":"tokudb-status-variables.html#tokudb_basement_deserialization_variable_key","title":"<code>Tokudb_BASEMENT_DESERIALIZATION_VARIABLE_KEY</code>","text":"<p>This variable shows the number of basement nodes deserialized where all keys did not have the same size, and thus ineligible for an in-memory optimization.</p>"},{"location":"tokudb-status-variables.html#tokudb_pro_rightmost_leaf_shortcut_success","title":"<code>Tokudb_PRO_RIGHTMOST_LEAF_SHORTCUT_SUCCESS</code>","text":"<p>This variable shows the number of times a message injection detected a series of sequential inserts to the rightmost side of the tree and successfully applied an insert message directly to the rightmost leaf node. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_pro_rightmost_leaf_shortcut_fail_pos","title":"<code>Tokudb_PRO_RIGHTMOST_LEAF_SHORTCUT_FAIL_POS</code>","text":"<p>This variable shows the number of times a message injection detected a series of sequential inserts to the rightmost side of the tree and was unable to follow the pattern of directly applying an insert message directly to the rightmost leaf node because the key does not continue the sequence. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_rightmost_leaf_shortcut_fail_reactive","title":"<code>Tokudb_RIGHTMOST_LEAF_SHORTCUT_FAIL_REACTIVE</code>","text":"<p>This variable shows the number of times a message injection detected a series of sequential inserts to the rightmost side of the tree and was unable to follow the pattern of directly applying an insert message directly to the rightmost leaf node because the leaf is full. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_cursor_skip_deleted_leaf_entry","title":"<code>Tokudb_CURSOR_SKIP_DELETED_LEAF_ENTRY</code>","text":"<p>This variable shows the number of leaf entries skipped during search/scan because the result of message application and reconciliation of the leaf entry MVCC stack reveals that the leaf entry is <code>deleted</code> in the current transactions view. It is a good indicator that there might be excessive garbage in a tree if a range scan seems to take too long.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_total_nodes","title":"<code>Tokudb_FLUSHER_CLEANER_TOTAL_NODES</code>","text":"<p>This variable shows the total number of nodes potentially flushed by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_h1_nodes","title":"<code>Tokudb_FLUSHER_CLEANER_H1_NODES</code>","text":"<p>This variable shows the number of height <code>1</code> nodes that had messages flushed by flusher or cleaner threads, i.e., internal nodes immediately above leaf nodes. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_hgt1_nodes","title":"<code>Tokudb_FLUSHER_CLEANER_HGT1_NODES</code>","text":"<p>This variable shows the number of nodes with height greater than <code>1</code> that had messages flushed by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_empty_nodes","title":"<code>Tokudb_FLUSHER_CLEANER_EMPTY_NODES</code>","text":"<p>This variable shows the number of nodes cleaned by flusher or cleaner threads which had empty message buffers. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_nodes_dirtied","title":"<code>Tokudb_FLUSHER_CLEANER_NODES_DIRTIED</code>","text":"<p>This variable shows the number of nodes dirtied by flusher or cleaner threads as a result of flushing messages downward. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_max_buffer_size","title":"<code>Tokudb_FLUSHER_CLEANER_MAX_BUFFER_SIZE</code>","text":"<p>This variable shows the maximum bytes in a message buffer flushed by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_min_buffer_size","title":"<code>Tokudb_FLUSHER_CLEANER_MIN_BUFFER_SIZE</code>","text":"<p>This variable shows the minimum bytes in a message buffer flushed by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_total_buffer_size","title":"<code>Tokudb_FLUSHER_CLEANER_TOTAL_BUFFER_SIZE</code>","text":"<p>This variable shows the total bytes in buffers flushed by flusher and cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_max_buffer_workdone","title":"<code>Tokudb_FLUSHER_CLEANER_MAX_BUFFER_WORKDONE</code>","text":"<p>This variable shows the maximum bytes worth of work done in a message buffer flushed by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_min_buffer_workdone","title":"<code>Tokudb_FLUSHER_CLEANER_MIN_BUFFER_WORKDONE</code>","text":"<p>This variable shows the minimum bytes worth of work done in a message buffer flushed by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_total_buffer_workdone","title":"<code>Tokudb_FLUSHER_CLEANER_TOTAL_BUFFER_WORKDONE</code>","text":"<p>This variable shows the total bytes worth of work done in buffers flushed by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_num_leaf_merges_started","title":"<code>Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_STARTED</code>","text":"<p>This variable shows the number of times flusher and cleaner threads tried to merge two leafs. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_num_leaf_merges_running","title":"<code>Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_RUNNING</code>","text":"<p>This variable shows the number of flusher and cleaner threads leaf merges in progress. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_num_leaf_merges_completed","title":"<code>Tokudb_FLUSHER_CLEANER_NUM_LEAF_MERGES_COMPLETED</code>","text":"<p>This variable shows the number of successful flusher and cleaner threads leaf merges. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_cleaner_num_dirtied_for_leaf_merge","title":"<code>Tokudb_FLUSHER_CLEANER_NUM_DIRTIED_FOR_LEAF_MERGE</code>","text":"<p>This variable shows the number of nodes dirtied by flusher or cleaner threads performing leaf node merges. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_total","title":"<code>Tokudb_FLUSHER_FLUSH_TOTAL</code>","text":"<p>This variable shows the total number of flushes done by flusher threads or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_in_memory","title":"<code>Tokudb_FLUSHER_FLUSH_IN_MEMORY</code>","text":"<p>This variable shows the number of in memory flushes (required no disk reads) by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_needed_io","title":"<code>Tokudb_FLUSHER_FLUSH_NEEDED_IO</code>","text":"<p>This variable shows the number of flushes that read something off disk by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_cascades","title":"<code>Tokudb_FLUSHER_FLUSH_CASCADES</code>","text":"<p>This variable shows the number of flushes that triggered a flush in child node by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_cascades_1","title":"<code>Tokudb_FLUSHER_FLUSH_CASCADES_1</code>","text":"<p>This variable shows the number of flushes that triggered one cascading flush by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_cascades_2","title":"<code>Tokudb_FLUSHER_FLUSH_CASCADES_2</code>","text":"<p>This variable shows the number of flushes that triggered two cascading flushes by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_cascades_3","title":"<code>Tokudb_FLUSHER_FLUSH_CASCADES_3</code>","text":"<p>This variable shows the number of flushes that triggered three cascading flushes by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_cascades_4","title":"<code>Tokudb_FLUSHER_FLUSH_CASCADES_4</code>","text":"<p>This variable shows the number of flushes that triggered four cascading flushes by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_cascades_5","title":"<code>Tokudb_FLUSHER_FLUSH_CASCADES_5</code>","text":"<p>This variable shows the number of flushes that triggered five cascading flushes by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_flush_cascades_gt_5","title":"<code>Tokudb_FLUSHER_FLUSH_CASCADES_GT_5</code>","text":"<p>This variable shows the number of flushes that triggered more than five cascading flushes by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_split_leaf","title":"<code>Tokudb_FLUSHER_SPLIT_LEAF</code>","text":"<p>This variable shows the total number of leaf node splits done by flusher threads or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_split_nonleaf","title":"<code>Tokudb_FLUSHER_SPLIT_NONLEAF</code>","text":"<p>This variable shows the total number of non-leaf node splits done by flusher threads or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_merge_leaf","title":"<code>Tokudb_FLUSHER_MERGE_LEAF</code>","text":"<p>This variable shows the total number of leaf node merges done by flusher threads or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_merge_nonleaf","title":"<code>Tokudb_FLUSHER_MERGE_NONLEAF</code>","text":"<p>This variable shows the total number of non-leaf node merges done by flusher threads or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_flusher_balance_leaf","title":"<code>Tokudb_FLUSHER_BALANCE_LEAF</code>","text":"<p>This variable shows the number of times two adjacent leaf nodes were rebalanced or had their content redistributed evenly by flusher or cleaner threads. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_hot_num_started","title":"<code>Tokudb_HOT_NUM_STARTED</code>","text":"<p>This variable shows the number of hot operations started (<code>OPTIMIZE TABLE</code>). This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_hot_num_completed","title":"<code>Tokudb_HOT_NUM_COMPLETED</code>","text":"<p>This variable shows the number of hot operations completed (<code>OPTIMIZE TABLE</code>). This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_hot_num_aborted","title":"<code>Tokudb_HOT_NUM_ABORTED</code>","text":"<p>This variable shows the number of hot operations aborted (<code>OPTIMIZE TABLE</code>). This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_hot_max_root_flush_count","title":"<code>Tokudb_HOT_MAX_ROOT_FLUSH_COUNT</code>","text":"<p>This variable shows the maximum number of flushes from root ever required to optimize trees. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_txn_begin","title":"<code>Tokudb_TXN_BEGIN</code>","text":"<p>This variable shows the number of transactions that have been started.</p>"},{"location":"tokudb-status-variables.html#tokudb_txn_begin_read_only","title":"<code>Tokudb_TXN_BEGIN_READ_ONLY</code>","text":"<p>This variable shows the number of read-only transactions started.</p>"},{"location":"tokudb-status-variables.html#tokudb_txn_commits","title":"<code>Tokudb_TXN_COMMITS</code>","text":"<p>This variable shows the total number of transactions that have been committed.</p>"},{"location":"tokudb-status-variables.html#tokudb_txn_aborts","title":"<code>Tokudb_TXN_ABORTS</code>","text":"<p>This variable shows the total number of transactions that have been aborted.</p>"},{"location":"tokudb-status-variables.html#tokudb_logger_next_lsn","title":"<code>Tokudb_LOGGER_NEXT_LSN</code>","text":"<p>This variable shows the recovery logger next LSN. This is a not a useful value for a regular user to use for any purpose.</p>"},{"location":"tokudb-status-variables.html#tokudb_logger_writes","title":"<code>Tokudb_LOGGER_WRITES</code>","text":"<p>This variable shows the number of times the logger has written to disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_logger_writes_bytes","title":"<code>Tokudb_LOGGER_WRITES_BYTES</code>","text":"<p>This variable shows the number of bytes the logger has written to disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_logger_writes_uncompressed_bytes","title":"<code>Tokudb_LOGGER_WRITES_UNCOMPRESSED_BYTES</code>","text":"<p>This variable shows the number of uncompressed bytes the logger has written to disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_logger_writes_seconds","title":"<code>Tokudb_LOGGER_WRITES_SECONDS</code>","text":"<p>This variable shows the number of seconds waiting for IO when writing logs to disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_logger_wait_long","title":"<code>Tokudb_LOGGER_WAIT_LONG</code>","text":"<p>This variable shows the number of times a logger write operation required 100ms or more.</p>"},{"location":"tokudb-status-variables.html#tokudb_loader_num_created","title":"<code>Tokudb_LOADER_NUM_CREATED</code>","text":"<p>This variable shows the number of times one of our internal objects, a loader, has been created.</p>"},{"location":"tokudb-status-variables.html#tokudb_loader_num_current","title":"<code>Tokudb_LOADER_NUM_CURRENT</code>","text":"<p>This variable shows the number of loaders that currently exist.</p>"},{"location":"tokudb-status-variables.html#tokudb_loader_num_max","title":"<code>Tokudb_LOADER_NUM_MAX</code>","text":"<p>This variable shows the maximum number of loaders that ever existed simultaneously.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_malloc_count","title":"<code>Tokudb_MEMORY_MALLOC_COUNT</code>","text":"<p>This variable shows the number of <code>malloc</code> operations by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_free_count","title":"<code>Tokudb_MEMORY_FREE_COUNT</code>","text":"<p>This variable shows the number of <code>free</code> operations by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_realloc_count","title":"<code>Tokudb_MEMORY_REALLOC_COUNT</code>","text":"<p>This variable shows the number of <code>realloc</code> operations by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_malloc_fail","title":"<code>Tokudb_MEMORY_MALLOC_FAIL</code>","text":"<p>This variable shows the number of <code>malloc</code> operations that failed by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_realloc_fail","title":"<code>Tokudb_MEMORY_REALLOC_FAIL</code>","text":"<p>This variable shows the number of <code>realloc</code> operations that failed by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_requested","title":"<code>Tokudb_MEMORY_REQUESTED</code>","text":"<p>This variable shows the number of bytes requested by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_used","title":"<code>Tokudb_MEMORY_USED</code>","text":"<p>This variable shows the number of bytes used (requested + overhead) by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_freed","title":"<code>Tokudb_MEMORY_FREED</code>","text":"<p>This variable shows the number of bytes freed by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_max_requested_size","title":"<code>Tokudb_MEMORY_MAX_REQUESTED_SIZE</code>","text":"<p>This variable shows the largest attempted allocation size by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_last_failed_size","title":"<code>Tokudb_MEMORY_LAST_FAILED_SIZE</code>","text":"<p>This variable shows the size of the last failed allocation attempt by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_mem_estimated_maximum_memory_footprint","title":"<code>Tokudb_MEM_ESTIMATED_MAXIMUM_MEMORY_FOOTPRINT</code>","text":"<p>This variable shows the maximum memory footprint of the storage engine, the max value of (used - freed).</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_mallocator_version","title":"<code>Tokudb_MEMORY_MALLOCATOR_VERSION</code>","text":"<p>This variable shows the version of the memory allocator library detected by PerconaFT.</p>"},{"location":"tokudb-status-variables.html#tokudb_memory_mmap_threshold","title":"<code>Tokudb_MEMORY_MMAP_THRESHOLD</code>","text":"<p>This variable shows the <code>mmap</code> threshold in PerconaFT, anything larger than this gets <code>mmap'ed</code>.</p>"},{"location":"tokudb-status-variables.html#tokudb_filesystem_threads_blocked_by_full_disk","title":"<code>Tokudb_FILESYSTEM_THREADS_BLOCKED_BY_FULL_DISK</code>","text":"<p>This variable shows the number of threads that are currently blocked because they are attempting to write to a full disk. This is normally zero. If this value is non-zero, then a warning will appear in the <code>disk free space</code> field.</p>"},{"location":"tokudb-status-variables.html#tokudb_filesystem_fsync_time","title":"<code>Tokudb_FILESYSTEM_FSYNC_TIME</code>","text":"<p>This variable shows the total time, in microseconds, used to <code>fsync</code> to disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_filesystem_fsync_num","title":"<code>Tokudb_FILESYSTEM_FSYNC_NUM</code>","text":"<p>This variable shows the total number of times the database has flushed the operating system\u2019s file buffers to disk.</p>"},{"location":"tokudb-status-variables.html#tokudb_filesystem_long_fsync_time","title":"<code>Tokudb_FILESYSTEM_LONG_FSYNC_TIME</code>","text":"<p>This variable shows the total time, in microseconds, used to <code>fsync</code> to dis k when the operation required more than one second.</p>"},{"location":"tokudb-status-variables.html#tokudb_filesystem_long_fsync_num","title":"<code>Tokudb_FILESYSTEM_LONG_FSYNC_NUM</code>","text":"<p>This variable shows the total number of times the database has flushed the operating system\u2019s file buffers to disk and this operation required more than one second.</p>"},{"location":"tokudb-troubleshooting.html","title":"TokuDB troubleshooting","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p>"},{"location":"tokudb-troubleshooting.html#known-issues","title":"Known Issues","text":"<p>Replication and binary logging: TokuDB supports binary logging and replication, with one restriction. TokuDB does not implement a lock on the auto-increment function, so concurrent insert statements with one or more of the statements inserting multiple rows may result in a non-deterministic interleaving of the auto-increment values. When running replication with these concurrent inserts, the auto-increment values on the replica table may not match the auto-increment values on the source table. Note that this is only an issue with Statement Based Replication (SBR), and not Row Based Replication (RBR).</p> <p>For more information about auto-increment and replication, see the MySQL Reference Manual: AUTO_INCREMENT handling in InnoDB.</p> <p>In addition, when using the <code>REPLACE INTO</code> or <code>INSERT IGNORE</code> on tables with no secondary indexes or tables where secondary indexes are subsets of the primary, the session variable tokudb_pk_insert_mode controls whether row based replication will work.</p> <p>Uninformative error message: The <code>LOAD DATA INFILE</code> command can sometimes</p> <pre><code>produce `ERROR 1030 (HY000): Got error 1 from storage engine`. The message\nshould say that the error is caused by insufficient disk space for the\ntemporary files created by the loader.\n</code></pre> <p>Transparent Huge Pages: TokuDB will refuse to start if transparent huge</p> <pre><code>pages are enabled. Transparent huge page support can be disabled by issuing the\nfollowing as root:\n</code></pre> <pre><code># echo never &gt; /sys/kernel/mm/redhat_transparent_hugepage/enabled\n</code></pre> <p>Lock</p> <p>Note</p> <p>The previous command needs to be executed after every reboot, because it defaults to <code>always</code>.</p> <p>XA behavior vs. InnoDB: InnoDB forces a deadlocked XA transaction to</p> <pre><code>abort, *TokuDB* does not.\n</code></pre> <p>Disabling the unique checks: For tables with unique keys, every insertion into the table causes a lookup by key followed by an insertion, if the key is not in the table. This greatly limits insertion performance. If one knows by design that the rows being inserted into the table have unique keys, then one can disable the key lookup prior to insertion.</p> <p>If your primary key is an auto-increment key, and none of your secondary keys are declared to be unique, then setting <code>unique_checks=OFF</code> will provide limited performance gains. On the other hand, if your primary key has a lot of entropy (it looks random), or your secondary keys are declared unique and have a lot of entropy, then disabling unique checks can provide a significant performance boost.</p> <p>If unique_checks is disabled when the primary key is not unique, secondary indexes may become corrupted. In this case, the indexes should be dropped and rebuilt. This behavior differs from that of InnoDB, in which uniqueness is always checked on the primary key, and setting unique_checks to off turns off uniqueness checking on secondary indexes only. Turning off uniqueness checking on the primary key can provide large performance boosts, but it should only be done when the primary key is known to be unique.</p> <p>Group Replication: TokuDB storage engine doesn\u2019t support Group Replication.</p> <p>As of 8.0.17, InnoDB supports multi-valued indexes. TokuDB does not support this feature.</p> <p>As of 8.0.17, InnoDB supports the Clone Plugin and the Clone Plugin API. TokuDB tables do not support either of these features.</p>"},{"location":"tokudb-troubleshooting.html#lock-visualization-in-tokudb","title":"Lock Visualization in TokuDB","text":"<p>TokuDB uses key range locks to implement serializable transactions, which are acquired as the transaction progresses. The locks are released when the transaction commits or aborts (this implements two phase locking).</p> <p>TokuDB stores these locks in a data structure called the lock tree. The lock tree stores the set of range locks granted to each transaction. In addition, the lock tree stores the set of locks that are not granted due to a conflict with locks granted to some other transaction. When these other transactions are retired, these pending lock requests are retried. If a pending lock request is not granted before the lock timer expires, then the lock request is aborted.</p> <p>Lock visualization in TokuDB exposes the state of the lock tree with tables in the information schema. We also provide a mechanism that may be used by a database client to retrieve details about lock conflicts that it encountered while executing a transaction.</p>"},{"location":"tokudb-troubleshooting.html#the-tokudb_trx-table","title":"The <code>TOKUDB_TRX</code> table","text":"<p>The TOKUDB_TRX table in the <code>INFORMATION_SCHEMA</code> maps TokuDB transaction identifiers to MySQL client identifiers. This mapping allows one to associate a TokuDB transaction with a MySQL client operation.</p> <p>The following query returns the MySQL clients that have a live TokuDB transaction:</p> <pre><code>SELECT * FROM INFORMATION_SCHEMA.TOKUDB_TRX,\nINFORMATION_SCHEMA.PROCESSLIST\nWHERE trx_mysql_thread_id = id;\n</code></pre>"},{"location":"tokudb-troubleshooting.html#the-tokudb_locks-table","title":"The <code>TOKUDB_LOCKS</code> table","text":"<p>The tokudb_locks table in the information schema contains the set of locks granted to TokuDB transactions.</p> <p>The following query returns all of the locks granted to some TokuDB transaction:</p> <pre><code>SELECT * FROM INFORMATION_SCHEMA.TOKUDB_LOCKS;\n</code></pre> <p>The following query returns the locks granted to some MySQL client:</p> <pre><code>SELECT id FROM INFORMATION_SCHEMA.TOKUDB_LOCKS,\nINFORMATION_SCHEMA.PROCESSLIST\nWHERE locks_mysql_thread_id = id;\n</code></pre>"},{"location":"tokudb-troubleshooting.html#the-tokudb_lock_waits-table","title":"The <code>TOKUDB_LOCK_WAITS</code> table","text":"<p>The tokudb_lock_waits table in the information schema contains the set of lock requests that are not granted due to a lock conflict with some other transaction.</p> <p>The following query returns the locks that are waiting to be granted due to a lock conflict with some other transaction:</p> <pre><code>SELECT * FROM INFORMATION_SCHEMA.TOKUDB_LOCK_WAITS;\n</code></pre>"},{"location":"tokudb-troubleshooting.html#supporting-explicit-default-value-expressions-as-of-8013-3","title":"Supporting explicit DEFAULT value expressions as of 8.0.13-3","text":"<p>TokuDB does not support explicit DEFAULT value expressions as of verion 8.0.13-3.</p>"},{"location":"tokudb-troubleshooting.html#the-tokudb_lock_timeout_debug-session-variable","title":"The tokudb_lock_timeout_debug session variable","text":"<p>The tokudb_lock_timeout_debug session variable controls how lock timeouts and lock deadlocks seen by the database client are reported.</p> <p>The following values are available:</p> <ul> <li> <p>0</p> <p>No lock timeouts or lock deadlocks are reported.</p> </li> <li> <p>1</p> <p>A JSON document that describes the lock conflict is stored in the tokudb_last_lock_timeout session variable</p> </li> <li> <p>2</p> <p>A JSON document that describes the lock conflict is printed to the MySQL error log.</p> <p>Supported since 7.5.5: In addition to the JSON document describing the lock conflict, the following lines are printed to the MySQL error log:</p> <ul> <li> <p>A line containing the blocked thread id and blocked SQL</p> </li> <li> <p>A line containing the blocking thread id and the blocking SQL.</p> </li> </ul> </li> <li> <p>3</p> <p>A JSON document that describes the lock conflict is stored in the tokudb_last_lock_timeout session variable and is printed to the MySQL error log.</p> <p>Supported since 7.5.5: In addition to the JSON document describing the lock conflict, the following lines are printed to the MySQL error log:</p> <ul> <li> <p>A line containing the blocked thread id and blocked SQL</p> </li> <li> <p>A line containing the blocking thread id and the blocking SQL.</p> </li> </ul> </li> </ul>"},{"location":"tokudb-troubleshooting.html#the-tokudb_last_lock_timeout-session-variable","title":"The tokudb_last_lock_timeout session variable","text":"<p>The tokudb_last_lock_timeout session variable contains a JSON document that describes the last lock conflict seen by the current MySQL client. It gets set when a blocked lock request times out or a lock deadlock is detected. The tokudb_lock_timeout_debug session variable should have bit <code>0</code> set (decimal <code>1</code>).</p>"},{"location":"tokudb-troubleshooting.html#example","title":"Example","text":"<p>Suppose that we create a table with a single column that is the primary key.</p> <pre><code>mysql&gt; SHOW CREATE TABLE table;\n\nCreate Table: CREATE TABLE \u2018table\u2018 (\n\u2018id\u2018 int(11) NOT NULL,\nPRIMARY KEY (\u2018id\u2018)) ENGINE=TokuDB DEFAULT CHARSET=latin1\n</code></pre> <p>Suppose that we have 2 MySQL clients with ID\u2019s 1 and 2 respectively. Suppose that MySQL client 1 inserts some values into <code>table</code>. TokuDB transaction 51 is created for the insert statement. Since autocommit is disabled, transaction 51 is still live after the insert statement completes, and we can query the tokudb_locks table in information schema to see the locks that are held by the transaction.</p> <pre><code>mysql&gt; SET AUTOCOMMIT=OFF;\nmysql&gt; INSERT INTO table VALUES (1),(10),(100);\n</code></pre> <pre><code>mysql&gt; SELECT * FROM INFORMATION_SCHEMA.TOKUDB_LOCKS;\n</code></pre> <pre><code>mysql&gt; SELECT * FROM INFORMATION_SCHEMA.TOKUDB_LOCK_WAITS;\n</code></pre> <p>The keys are currently hex dumped.</p> <p>Now we switch to the other MySQL client with ID 2.</p> <pre><code>mysql&gt; INSERT INTO table VALUES (2),(20),(100);\n</code></pre> <p>The insert gets blocked since there is a conflict on the primary key with value 100.</p> <p>The granted TokuDB locks are:</p> <pre><code>SELECT * FROM INFORMATION_SCHEMA.TOKUDB_LOCKS;\n</code></pre> <p>The locks that are pending due to a conflict are:</p> <pre><code>SELECT * FROM INFORMATION_SCHEMA.TOKUDB_LOCK_WAITS;\n</code></pre> <p>THe output could be:</p> <pre><code>+-------------------+-----------------+------------------+---------------------+----------------------+-----------------------+--------------------+------------------+-----------------------------+\n| requesting_trx_id | blocking_trx_id | lock_waits_dname | lock_waits_key_left | lock_waits_key_right | lock_waits_start_time | locks_table_schema | locks_table_name | locks_table_dictionary_name |\n+-------------------+-----------------+------------------+---------------------+----------------------+-----------------------+--------------------+------------------+-----------------------------+\n|                62 |              51 | ./test/t-main    | 0064000000          | 0064000000           |         1380656990910 | test               | t                | main                        |\n+-------------------+-----------------+------------------+---------------------+----------------------+-----------------------+--------------------+------------------+-----------------------------+\n</code></pre> <p>Eventually, the lock for client 2 times out, and we can retrieve a JSON document that describes the conflict.</p> <pre><code>SELECT @@TOKUDB_LAST_LOCK_TIMEOUT;\n</code></pre> <pre><code>ROLLBACK;\n</code></pre> <p>Since transaction 62 was rolled back, all of the locks taken by it are released.</p> <pre><code>SELECT * FROM INFORMATION_SCHEMA.TOKUDB_LOCKS;\n</code></pre>"},{"location":"tokudb-troubleshooting.html#engine-status","title":"Engine Status","text":"<p>Engine status provides details about the inner workings of TokuDB and can be useful in tuning your particular environment. The engine status can be determined by running the following command:  <code>SHOW ENGINE tokudb STATUS;</code></p> <p>The following is a reference of the table status statements:</p> <p>Table Status</p> <p>Description</p> <p>disk free space</p> <p>This is a gross estimate of how much of your file system is available. Possible displays in this field are:</p> <ul> <li><p>More than twice the reserve (\u201cmore than 10 percent of total file system space\u201d)</p></li> <li><p>Less than twice the reserve</p></li> <li><p>Less than the reserve</p></li> <li><p>File system is completely full</p></li> </ul> <p>time of environment creation</p> <p>This is the time when the TokuDB storage engine was first started up. Normally, this is when <code>mysqld</code> was initially installed with TokuDB. If the environment was upgraded from TokuDB 4.x (4.2.0 or later), then this will be displayed as \u201cDec 31, 1969\u201d on Linux hosts.</p> <p>time of engine startup</p> <p>This is the time when the TokuDB storage engine started up. Normally, this is when <code>mysqld</code> started.</p> <p>time now</p> <p>Current date/time on server.</p> <p>db opens</p> <p>This is the number of times an individual PerconaFT dictionary file was opened. This is a not a useful value for a regular user to use for any purpose due to layers of open/close caching on top.</p> <p>db closes</p> <p>This is the number of times an individual PerconaFT dictionary file was closed. This is a not a useful value for a regular user to use for any purpose due to layers of open/close caching on top.</p> <p>num open dbs now</p> <p>This is the number of currently open databases.</p> <p>max open dbs</p> <p>This is the maximum number of concurrently opened databases.</p> <p>period, in ms, that recovery log is automatically fsynced</p> <p><code>fsync()</code> frequency in milliseconds.</p> <p>dictionary inserts</p> <p>This is the total number of rows that have been inserted into all primary and secondary indexes combined, when those inserts have been done with a separate recovery log entry per index. For example, inserting a row into a table with one primary and two secondary indexes will increase this count by three, if the inserts were done with separate recovery log entries.</p> <p>dictionary inserts fail</p> <p>This is the number of single-index insert operations that failed.</p> <p>dictionary deletes</p> <p>This is the total number of rows that have been deleted from all primary and secondary indexes combined, if those deletes have been done with a separate recovery log entry per index.</p> <p>dictionary deletes fail</p> <p>This is the number of single-index delete operations that failed.</p> <p>dictionary updates</p> <p>This is the total number of rows that have been updated in all primary and secondary indexes combined, if those updates have been done with a separate recovery log entry per index.</p> <p>dictionary updates fail</p> <p>This is the number of single-index update operations that failed.</p> <p>dictionary broadcast updates</p> <p>This is the number of broadcast updates that have been successfully performed. A broadcast update is an update that affects all rows in a dictionary.</p> <p>dictionary broadcast updates fail</p> <p>This is the number of broadcast updates that have failed.</p> <p>dictionary multi inserts</p> <p>This is the total number of rows that have been inserted into all primary and secondary indexes combined, when those inserts have been done with a single recovery log entry for the entire row. (For example, inserting a row into a table with one primary and two secondary indexes will normally increase this count by three).</p> <p>dictionary multi inserts fail</p> <p>This is the number of multi-index insert operations that failed.</p> <p>dictionary multi deletes</p> <p>This is the total number of rows that have been deleted from all primary and secondary indexes combined, when those deletes have been done with a single recovery log entry for the entire row.</p> <p>dictionary multi deletes fail</p> <p>This is the number of multi-index delete operations that failed.</p> <p>dictionary updates multi</p> <p>This is the total number of rows that have been updated in all primary and secondary indexes combined, if those updates have been done with a single recovery log entry for the entire row.</p> <p>dictionary updates fail multi</p> <p>This is the number of multi-index update operations that failed.</p> <p>le: max committed xr</p> <p>This is the maximum number of committed transaction records that were stored on disk in a new or modified row.</p> <p>le: max provisional xr</p> <p>This is the maximum number of provisional transaction records that were stored on disk in a new or modified row.</p> <p>le: expanded</p> <p>This is the number of times that an expanded memory mechanism was used to store a new or modified row on disk.</p> <p>le: max memsize</p> <p>This is the maximum number of bytes that were stored on disk as a new or modified row. This is the maximum uncompressed size of any row stored in TokuDB that was created or modified since the server started.</p> <p>le: size of leafentries before garbage collection (during message application)</p> <p>Total number of bytes of leaf nodes data before performing garbage collection for non-flush events.</p> <p>le: size of leafentries after garbage collection (during message application)</p> <p>Total number of bytes of leaf nodes data after performing garbage collection for non-flush events.</p> <p>le: size of leafentries before garbage collection (outside message application)</p> <p>Total number of bytes of leaf nodes data before performing garbage collection for flush events.</p> <p>le: size of leafentries after garbage collection (outside message application)</p> <p>Total number of bytes of leaf nodes data after performing garbage collection for flush events.</p> <p>checkpoint: period</p> <p>This is the interval in seconds between the end of an automatic checkpoint and the beginning of the next automatic checkpoint.</p> <p>checkpoint: footprint</p> <p>Where the database is in the checkpoint process.</p> <p>checkpoint: last checkpoint began</p> <p>This is the time the last checkpoint began. If a checkpoint is currently in progress, then this time may be later than the time the last checkpoint completed.</p> <p>Note</p> <p>If no checkpoint has ever taken place, then this value will be <code>Dec 31, 1969</code> on Linux hosts.</p> <p>checkpoint: last complete checkpoint began</p> <p>This is the time the last complete checkpoint started. Any data that changed after this time will not be captured in the checkpoint.</p> <p>checkpoint: last complete checkpoint ended</p> <p>This is the time the last complete checkpoint ended.</p> <p>checkpoint: time spent during checkpoint (begin and end phases)</p> <p>Time (in seconds) required to complete all checkpoints.</p> <p>checkpoint: time spent during last checkpoint (begin and end phases)</p> <p>Time (in seconds) required to complete the last checkpoint.</p> <p>checkpoint: last complete checkpoint LSN</p> <p>This is the Log Sequence Number of the last complete checkpoint.</p> <p>checkpoint: checkpoints taken</p> <p>This is the number of complete checkpoints that have been taken.</p> <p>checkpoint: checkpoints failed</p> <p>This is the number of checkpoints that have failed for any reason.</p> <p>checkpoint: waiters now</p> <p>This is the current number of threads simultaneously waiting for the checkpoint-safe lock to perform a checkpoint.</p> <p>checkpoint: waiters max</p> <p>This is the maximum number of threads ever simultaneously waiting for the checkpoint-safe lock to perform a checkpoint.</p> <p>checkpoint: non-checkpoint client wait on mo lock</p> <p>The number of times a non-checkpoint client thread waited for the multi-operation lock.</p> <p>checkpoint: non-checkpoint client wait on cs lock</p> <p>The number of times a non-checkpoint client thread waited for the checkpoint-safe lock.</p> <p>checkpoint: checkpoint begin time</p> <p>Cumulative time (in microseconds) required to mark all dirty nodes as pending a checkpoint.</p> <p>checkpoint: long checkpoint begin time</p> <p>The total time, in microseconds, of long checkpoint begins. A long checkpoint begin is one taking more than 1 second.</p> <p>checkpoint: long checkpoint begin count</p> <p>The total number of times a checkpoint begin took more than 1 second.</p> <p>checkpoint: checkpoint end time</p> <p>The time spent in checkpoint end operation in seconds.</p> <p>checkpoint: long checkpoint end time</p> <p>The time spent in checkpoint end operation in seconds.</p> <p>checkpoint: long checkpoint end count</p> <p>This is the count of end_checkpoint operations that exceeded 1 minute.</p> <p>cachetable: miss</p> <p>This is a count of how many times the application was unable to access your data in the internal cache.</p> <p>cachetable: miss time</p> <p>This is the total time, in microseconds, of how long the database has had to wait for a disk read to complete.</p> <p>cachetable: prefetches</p> <p>This is the total number of times that a block of memory has been prefetched into the database\u2019s cache. Data is prefetched when the database\u2019s algorithms determine that a block of memory is likely to be accessed by the application.</p> <p>cachetable: size current</p> <p>This shows how much of the uncompressed data, in bytes, is currently in the database\u2019s internal cache.</p> <p>cachetable: size limit</p> <p>This shows how much of the uncompressed data, in bytes, will fit in the database\u2019s internal cache.</p> <p>cachetable: size writing</p> <p>This is the number of bytes that are currently queued up to be written to disk.</p> <p>cachetable: size nonleaf</p> <p>This shows the amount of memory, in bytes, the current set of non-leaf nodes occupy in the cache.</p> <p>cachetable: size leaf</p> <p>This shows the amount of memory, in bytes, the current set of (decompressed) leaf nodes occupy in the cache.</p> <p>cachetable: size rollback</p> <p>This shows the rollback nodes size, in bytes, in the cache.</p> <p>cachetable: size cachepressure</p> <p>This shows the number of bytes causing cache pressure (the sum of buffers and work done counters), helps to understand if cleaner threads are keeping up with workload. It should really be looked at as more of a value to use in a ratio of cache pressure / cache table size. The closer that ratio evaluates to 1, the higher the cache pressure.</p> <p>cachetable: size currently cloned data for checkpoint</p> <p>Amount of memory, in bytes, currently used for cloned nodes. During the checkpoint operation, dirty nodes are cloned prior to serialization/compression, then written to disk. After which, the memory for the cloned block is returned for re-use.</p> <p>cachetable: evictions</p> <p>Number of blocks evicted from cache.</p> <p>cachetable: cleaner executions</p> <p>Total number of times the cleaner thread loop has executed.</p> <p>cachetable: cleaner period</p> <p>TokuDB includes a cleaner thread that optimizes indexes in the background. This variable is the time, in seconds, between the completion of a group of cleaner operations and the beginning of the next group of cleaner operations. The cleaner operations run on a background thread performing work that does not need to be done on the client thread.</p> <p>cachetable: cleaner iterations</p> <p>This is the number of cleaner operations that are performed every cleaner period.</p> <p>cachetable: number of waits on cache pressure</p> <p>The number of times a thread was stalled due to cache pressure.</p> <p>cachetable: time waiting on cache pressure</p> <p>Total time, in microseconds, waiting on cache pressure to subside.</p> <p>cachetable: number of long waits on cache pressure</p> <p>The number of times a thread was stalled for more than 1 second due to cache pressure.</p> <p>cachetable: long time waiting on cache pressure</p> <p>Total time, in microseconds, waiting on cache pressure to subside for more than 1 second.</p> <p>cachetable: client pool: number of threads in pool</p> <p>The number of threads in the client thread pool.</p> <p>cachetable: client pool: number of currently active threads in pool</p> <p>The number of currently active threads in the client thread pool.</p> <p>cachetable: client pool: number of currently queued work items</p> <p>The number of currently queued work items in the client thread pool.</p> <p>cachetable: client pool: largest number of queued work items</p> <p>The largest number of queued work items in the client thread pool.</p> <p>cachetable: client pool: total number of work items processed</p> <p>The total number of work items processed in the client thread pool.</p> <p>cachetable: client pool: total execution time of processing work items</p> <p>The total execution time of processing work items in the client thread pool.</p> <p>cachetable: cachetable pool: number of threads in pool</p> <p>The number of threads in the cachetable thread pool.</p> <p>cachetable: cachetable pool: number of currently active threads in pool</p> <p>The number of currently active threads in the cachetable thread pool.</p> <p>cachetable: cachetable pool: number of currently queued work items</p> <p>The number of currently queued work items in the cachetable thread pool.</p> <p>cachetable: cachetable pool: largest number of queued work items</p> <p>The largest number of queued work items in the cachetable thread pool.</p> <p>cachetable: cachetable pool: total number of work items processed</p> <p>The total number of work items processed in the cachetable thread pool.</p> <p>cachetable: cachetable pool: total execution time of processing work items</p> <p>The total execution time of processing work items in the cachetable thread pool.</p> <p>cachetable: checkpoint pool: number of threads in pool</p> <p>The number of threads in the checkpoint thread pool.</p> <p>cachetable: checkpoint pool: number of currently active threads in pool</p> <p>The number of currently active threads in the checkpoint thread pool.</p> <p>cachetable: checkpoint pool: number of currently queued work items</p> <p>The number of currently queued work items in the checkpoint thread pool.</p> <p>cachetable: checkpoint pool: largest number of queued work items</p> <p>The largest number of queued work items in the checkpoint thread pool.</p> <p>cachetable: checkpoint pool: total number of work items processed</p> <p>The total number of work items processed in the checkpoint thread pool.</p> <p>cachetable: checkpoint pool: total execution time of processing work items</p> <p>The total execution time of processing work items in the checkpoint thread pool.</p> <p>locktree: memory size</p> <p>The amount of memory, in bytes, that the locktree is currently using.</p> <p>locktree: memory size limit</p> <p>The maximum amount of memory, in bytes, that the locktree is allowed to use.</p> <p>locktree: number of times lock escalation ran</p> <p>Number of times the locktree needed to run lock escalation to reduce its memory footprint.</p> <p>locktree: time spent running escalation (seconds)</p> <p>Total number of seconds spent performing locktree escalation.</p> <p>locktree: latest post-escalation memory size</p> <p>Size of the locktree, in bytes, after most current locktree escalation.</p> <p>locktree: number of locktrees open now</p> <p>Number of locktrees currently open.</p> <p>locktree: number of pending lock requests</p> <p>Number of requests waiting for a lock grant.</p> <p>locktree: number of locktrees eligible for the STO</p> <p>Number of locktrees eligible for \u201cSingle Transaction Optimizations\u201d. <code>STO</code> optimization are behaviors that can happen within the locktree when there is exactly one transaction active within the locktree. This is a not a useful value for a regular user to use for any purpose.</p> <p>locktree: number of times a locktree ended the STO early</p> <p>Total number of times a \u201csingle transaction optimization\u201d was ended early due to another trans- action starting.</p> <p>locktree: time spent ending the STO early (seconds)</p> <p>Total number of seconds ending \u201cSingle Transaction Optimizations\u201d. <code>STO</code> optimization are behaviors that can happen within the locktree when there is exactly one transaction active within the locktree. This is a not a useful value for a regular user to use for any purpose.</p> <p>locktree: number of wait locks</p> <p>Number of times that a lock request could not be acquired because of a conflict with some other transaction.</p> <p>locktree: time waiting for locks</p> <p>Total time, in microseconds, spend by some client waiting for a lock conflict to be resolved.</p> <p>locktree: number of long wait locks</p> <p>Number of lock waits greater than 1 second in duration.</p> <p>locktree: long time waiting for locks</p> <p>Total time, in microseconds, of the long waits.</p> <p>locktree: number of lock timeouts</p> <p>Count of the number of times that a lock request timed out.</p> <p>locktree: number of waits on lock escalation</p> <p>When the sum of the sizes of locks taken reaches the lock tree limit, we run lock escalation on a background thread. The clients threads need to wait for escalation to consolidate locks and free up memory. This counter counts the number of times a client thread has to wait on lock escalation.</p> <p>locktree: time waiting on lock escalation</p> <p>Total time, in microseconds, that a client thread spent waiting for lock escalation to free up memory.</p> <p>locktree: number of long waits on lock escalation</p> <p>Number of times that a client thread had to wait on lock escalation and the wait time was greater than 1 second.</p> <p>locktree: long time waiting on lock escalation</p> <p>Total time, in microseconds, of the long waits for lock escalation to free up memory.</p> <p>ft: dictionary updates</p> <p>This is the total number of rows that have been updated in all primary and secondary indexes combined, if those updates have been done with a separate recovery log entry per index.</p> <p>ft: dictionary broadcast updates</p> <p>This is the number of broadcast updates that have been successfully performed. A broadcast update is an update that affects all rows in a dictionary.</p> <p>ft: descriptor set</p> <p>This is the number of time a descriptor was updated when the entire dictionary was updated (for example, when the schema has been changed).</p> <p>ft: messages ignored by leaf due to msn</p> <p>The number of messages that were ignored by a leaf because it had already been applied.</p> <p>ft: total search retries due to TRY AGAIN</p> <p>Total number of search retries due to TRY AGAIN. Internal value that is no use to anyone other than a developer debugging a specific query/search issue.</p> <p>ft: searches requiring more tries than the height of the tree</p> <p>Number of searches that required more tries than the height of the tree.</p> <p>ft: searches requiring more tries than the height of the tree plus three</p> <p>Number of searches that required more tries than the height of the tree plus three.</p> <p>ft: leaf nodes flushed to disk (not for checkpoint)</p> <p>Number of leaf nodes flushed to disk, not for checkpoint.</p> <p>ft: leaf nodes flushed to disk (not for checkpoint) (bytes)</p> <p>Number of bytes of leaf nodes flushed to disk, not for checkpoint.</p> <p>ft: leaf nodes flushed to disk (not for checkpoint) (uncompressed bytes)</p> <p>Number of bytes of leaf nodes flushed to disk, not for checkpoint.</p> <p>ft: leaf nodes flushed to disk (not for checkpoint) (seconds)</p> <p>Number of seconds waiting for IO when writing leaf nodes flushed to disk, not for checkpoint.</p> <p>ft: nonleaf nodes flushed to disk (not for checkpoint)</p> <p>Number of non-leaf nodes flushed to disk, not for checkpoint.</p> <p>ft: nonleaf nodes flushed to disk (not for checkpoint) (bytes)</p> <p>Number of bytes of non-leaf nodes flushed to disk, not for checkpoint.</p> <p>ft: nonleaf nodes flushed to disk (not for checkpoint) (uncompressed bytes)</p> <p>Number of uncompressed bytes of non-leaf nodes flushed to disk, not for checkpoint.</p> <p>ft: nonleaf nodes flushed to disk (not for checkpoint) (seconds)</p> <p>Number of seconds waiting for I/O when writing non-leaf nodes flushed to disk, not for checkpoint.</p> <p>ft: leaf nodes flushed to disk (for checkpoint)</p> <p>Number of leaf nodes flushed to disk for checkpoint.</p> <p>ft: leaf nodes flushed to disk (for checkpoint) (bytes)</p> <p>Number of bytes of leaf nodes flushed to disk for checkpoint.</p> <p>ft: leaf nodes flushed to disk (for checkpoint) (uncompressed bytes)</p> <p>Number of uncompressed bytes of leaf nodes flushed to disk for checkpoint.</p> <p>ft: leaf nodes flushed to disk (for checkpoint) (seconds)</p> <p>Number of seconds waiting for IO when writing leaf nodes flushed to disk for checkpoint.</p> <p>ft: nonleaf nodes flushed to disk (for checkpoint)</p> <p>Number of non-leaf nodes flushed to disk for checkpoint.</p> <p>ft: nonleaf nodes flushed to disk (for checkpoint) (bytes)</p> <p>Number of bytes of non-leaf nodes flushed to disk for checkpoint.</p> <p>ft: nonleaf nodes flushed to disk (for checkpoint) (uncompressed bytes)</p> <p>Number of uncompressed bytes of non-leaf nodes flushed to disk for checkpoint.</p> <p>ft: nonleaf nodes flushed to disk (for checkpoint) (seconds)</p> <p>Number of seconds waiting for IO when writing non-leaf nodes flushed to disk for checkpoint.</p> <p>ft: uncompressed / compressed bytes written (leaf)</p> <p>Ratio of uncompressed bytes (in-memory) to compressed bytes (on-disk) for leaf nodes.</p> <p>ft: uncompressed / compressed bytes written (nonleaf)</p> <p>Ratio of uncompressed bytes (in-memory) to compressed bytes (on-disk) for non-leaf nodes.</p> <p>ft: uncompressed / compressed bytes written (overall)</p> <p>Ratio of uncompressed bytes (in-memory) to compressed bytes (on-disk) for all nodes.</p> <p>ft: nonleaf node partial evictions</p> <p>The number of times a partition of a non-leaf node was evicted from the cache.</p> <p>ft: nonleaf node partial evictions (bytes)</p> <p>The number of bytes freed by evicting partitions of non-leaf nodes from the cache.</p> <p>ft: leaf node partial evictions</p> <p>The number of times a partition of a leaf node was evicted from the cache.</p> <p>ft: leaf node partial evictions (bytes)</p> <p>The number of bytes freed by evicting partitions of leaf nodes from the cache.</p> <p>ft: leaf node full evictions</p> <p>The number of times a full leaf node was evicted from the cache.</p> <p>ft: leaf node full evictions (bytes)</p> <p>The number of bytes freed by evicting full leaf nodes from the cache.</p> <p>ft: nonleaf node full evictions (bytes)</p> <p>The number of bytes freed by evicting full non-leaf nodes from the cache.</p> <p>ft: nonleaf node full evictions</p> <p>The number of times a full non-leaf node was evicted from the cache.</p> <p>ft: leaf nodes created</p> <p>Number of created leaf nodes .</p> <p>ft: nonleaf nodes created</p> <p>Number of created non-leaf nodes.</p> <p>ft: leaf nodes destroyed</p> <p>Number of destroyed leaf nodes.</p> <p>ft: nonleaf nodes destroyed</p> <p>Number of destroyed non-leaf nodes.</p> <p>ft: bytes of messages injected at root (all trees)</p> <p>Amount of messages, in bytes, injected at root (for all trees).</p> <p>ft: bytes of messages flushed from h1 nodes to leaves</p> <p>Amount of messages, in bytes, flushed from <code>h1</code> nodes to leaves.</p> <p>ft: bytes of messages currently in trees (estimate)</p> <p>Amount of messages, in bytes, currently in trees (estimate).</p> <p>ft: messages injected at root</p> <p>Number of messages injected at root node of a tree.</p> <p>ft: broadcast messages injected at root</p> <p>Number of broadcast messages injected at root node of a tree.</p> <p>ft: basements decompressed as a target of a query</p> <p>Number of basement nodes decompressed for queries.</p> <p>ft: basements decompressed for prelocked range</p> <p>Number of basement nodes decompressed by queries aggressively.</p> <p>ft: basements decompressed for prefetch</p> <p>Number of basement nodes decompressed by a prefetch thread.</p> <p>ft: basements decompressed for write</p> <p>Number of basement nodes decompressed for writes.</p> <p>ft: buffers decompressed as a target of a query</p> <p>Number of buffers decompressed for queries.</p> <p>ft: buffers decompressed for prelocked range</p> <p>Number of buffers decompressed by queries aggressively.</p> <p>ft: buffers decompressed for prefetch</p> <p>Number of buffers decompressed by a prefetch thread.</p> <p>ft: buffers decompressed for write</p> <p>Number of buffers decompressed for writes.</p> <p>ft: pivots fetched for query</p> <p>Number of pivot nodes fetched for queries.</p> <p>ft: pivots fetched for query (bytes)</p> <p>Number of bytes of pivot nodes fetched for queries.</p> <p>ft: pivots fetched for query (seconds)</p> <p>Number of seconds waiting for I/O when fetching pivot nodes for queries.</p> <p>ft: pivots fetched for prefetch</p> <p>Number of pivot nodes fetched by a prefetch thread.</p> <p>ft: pivots fetched for prefetch (bytes)</p> <p>Number of bytes of pivot nodes fetched by a prefetch thread.</p> <p>ft: pivots fetched for prefetch (seconds)</p> <p>Number seconds waiting for I/O when fetching pivot nodes by a prefetch thread.</p> <p>ft: pivots fetched for write</p> <p>Number of pivot nodes fetched for writes.</p> <p>ft: pivots fetched for write (bytes)</p> <p>Number of bytes of pivot nodes fetched for writes.</p> <p>ft: pivots fetched for write (seconds)</p> <p>Number of seconds waiting for I/O when fetching pivot nodes for writes.</p> <p>ft: basements fetched as a target of a query</p> <p>Number of basement nodes fetched from disk for queries.</p> <p>ft: basements fetched as a target of a query (bytes)</p> <p>Number of basement node bytes fetched from disk for queries.</p> <p>ft: basements fetched as a target of a query (seconds)</p> <p>Number of seconds waiting for IO when fetching basement nodes from disk for queries.</p> <p>ft: basements fetched for prelocked range</p> <p>Number of basement nodes fetched from disk aggressively.</p> <p>ft: basements fetched for prelocked range (bytes)</p> <p>Number of basement node bytes fetched from disk aggressively.</p> <p>ft: basements fetched for prelocked range (seconds)</p> <p>Number of seconds waiting for I/O when fetching basement nodes from disk aggressively.</p> <p>ft: basements fetched for prefetch</p> <p>Number of basement nodes fetched from disk by a prefetch thread.</p> <p>ft: basements fetched for prefetch (bytes)</p> <p>Number of basement node bytes fetched from disk by a prefetch thread.</p> <p>ft: basements fetched for prefetch (seconds)</p> <p>Number of seconds waiting for I/O when fetching basement nodes from disk by a prefetch thread.</p> <p>ft: basements fetched for write</p> <p>Number of basement nodes fetched from disk for writes.</p> <p>ft: basements fetched for write (bytes)</p> <p>Number of basement node bytes fetched from disk for writes.</p> <p>ft: basements fetched for write (seconds)</p> <p>Number of seconds waiting for I/O when fetching basement nodes from disk for writes.</p> <p>ft: buffers fetched as a target of a query</p> <p>Number of buffers fetched from disk for queries.</p> <p>ft: buffers fetched as a target of a query (bytes)</p> <p>Number of buffer bytes fetched from disk for queries.</p> <p>ft: buffers fetched as a target of a query (seconds)</p> <p>Number of seconds waiting for I/O when fetching buffers from disk for queries.</p> <p>ft: buffers fetched for prelocked range</p> <p>Number of buffers fetched from disk aggressively.</p> <p>ft: buffers fetched for prelocked range (bytes)</p> <p>Number of buffer bytes fetched from disk aggressively.</p> <p>ft: buffers fetched for prelocked range (seconds)</p> <p>Number of seconds waiting for I/O when fetching buffers from disk aggressively.</p> <p>ft: buffers fetched for prefetch</p> <p>Number of buffers fetched from disk by a prefetch thread.</p> <p>ft: buffers fetched for prefetch (bytes)</p> <p>Number of buffer bytes fetched from disk by a prefetch thread.</p> <p>ft: buffers fetched for prefetch (seconds)</p> <p>Number of seconds waiting for I/O when fetching buffers from disk by a prefetch thread.</p> <p>ft: buffers fetched for write</p> <p>Number of buffers fetched from disk for writes.</p> <p>ft: buffers fetched for write (bytes)</p> <p>Number of buffer bytes fetched from disk for writes.</p> <p>ft: buffers fetched for write (seconds)</p> <p>Number of seconds waiting for I/O when fetching buffers from disk for writes.</p> <p>ft: leaf compression to memory (seconds)</p> <p>Total time, in seconds, spent compressing leaf nodes.</p> <p>ft: leaf serialization to memory (seconds)</p> <p>Total time, in seconds, spent serializing leaf nodes.</p> <p>ft: leaf decompression to memory (seconds)</p> <p>Total time, in seconds, spent decompressing leaf nodes.</p> <p>ft: leaf deserialization to memory (seconds)</p> <p>Total time, in seconds, spent deserializing leaf nodes.</p> <p>ft: nonleaf compression to memory (seconds)</p> <p>Total time, in seconds, spent compressing non leaf nodes.</p> <p>ft: nonleaf serialization to memory (seconds)</p> <p>Total time, in seconds, spent serializing non leaf nodes.</p> <p>ft: nonleaf decompression to memory (seconds)</p> <p>Total time, in seconds, spent decompressing non leaf nodes.</p> <p>ft: nonleaf deserialization to memory (seconds)</p> <p>Total time, in seconds, spent deserializing non leaf nodes.</p> <p>ft: promotion: roots split</p> <p>Number of times the root split during promotion.</p> <p>ft: promotion: leaf roots injected into</p> <p>Number of times a message stopped at a root with height <code>0</code>.</p> <p>ft: promotion: h1 roots injected into</p> <p>Number of times a message stopped at a root with height <code>1</code>.</p> <p>ft: promotion: injections at depth 0</p> <p>Number of times a message stopped at depth <code>0</code>.</p> <p>ft: promotion: injections at depth 1</p> <p>Number of times a message stopped at depth <code>1</code>.</p> <p>ft: promotion: injections at depth 2</p> <p>Number of times a message stopped at depth <code>2</code>.</p> <p>ft: promotion: injections at depth 3</p> <p>Number of times a message stopped at depth <code>3</code>.</p> <p>ft: promotion: injections lower than depth 3</p> <p>Number of times a message was promoted past depth <code>3</code>.</p> <p>ft: promotion: stopped because of a nonempty buffer</p> <p>Number of times a message stopped because it reached a nonempty buffer.</p> <p>ft: promotion: stopped at height 1</p> <p>Number of times a message stopped because it had reached height <code>1</code>.</p> <p>ft: promotion: stopped because the child was locked or not at all in memory</p> <p>Number of times promotion was stopped because the child node was locked or not at all in memory. This is a not a useful value for a regular user to use for any purpose.</p> <p>ft: promotion: stopped because the child was not fully in memory</p> <p>Number of times promotion was stopped because the child node was not at all in memory. This is a not a useful value for a normal user to use for any purpose.</p> <p>ft: promotion: stopped anyway, after locking the child</p> <p>Number of times a message stopped before a child which had been locked.</p> <p>ft: basement nodes deserialized with fixed-keysize</p> <p>The number of basement nodes deserialized where all keys had the same size, leaving the basement in a format that is optimal for in-memory workloads.</p> <p>ft: basement nodes deserialized with variable-keysize</p> <p>The number of basement nodes deserialized where all keys did not have the same size, and thus ineligible for an in-memory optimization.</p> <p>ft: promotion: succeeded in using the rightmost leaf shortcut</p> <p>Rightmost insertions used the rightmost-leaf pin path, meaning that the Fractal Tree index detected and properly optimized rightmost inserts.</p> <p>ft: promotion: tried the rightmost leaf shortcut but failed (out-of-bounds)</p> <p>Rightmost insertions did not use the rightmost-leaf pin path, due to the insert not actually being into the rightmost leaf node.</p> <p>ft: promotion: tried the rightmost leaf shortcut but failed (child reactive)</p> <p>Rightmost insertions did not use the rightmost-leaf pin path, due to the leaf being too large (needed to split).</p> <p>ft: cursor skipped deleted leaf entries</p> <p>Number of leaf entries skipped during search/scan because the result of message application and reconciliation of the leaf entry MVCC stack reveals that the leaf entry is deleted in the current transactions view. It is a good indicator that there might be excessive garbage in a tree if a range scan seems to take too long.</p> <p>ft flusher: total nodes potentially flushed by cleaner thread</p> <p>Total number of nodes whose buffers are potentially flushed by cleaner thread.</p> <p>ft flusher: height-one nodes flushed by cleaner thread</p> <p>Number of nodes of height one whose message buffers are flushed by cleaner thread.</p> <p>ft flusher: height-greater-than-one nodes flushed by cleaner thread</p> <p>Number of nodes of height &gt; 1 whose message buffers are flushed by cleaner thread.</p> <p>ft flusher: nodes cleaned which had empty buffers</p> <p>Number of nodes that are selected by cleaner, but whose buffers are empty.</p> <p>ft flusher: nodes dirtied by cleaner thread</p> <p>Number of nodes that are made dirty by the cleaner thread.</p> <p>ft flusher: max bytes in a buffer flushed by cleaner thread</p> <p>Max number of bytes in message buffer flushed by cleaner thread.</p> <p>ft flusher: min bytes in a buffer flushed by cleaner thread</p> <p>Min number of bytes in message buffer flushed by cleaner thread.</p> <p>ft flusher: total bytes in buffers flushed by cleaner thread</p> <p>Total number of bytes in message buffers flushed by cleaner thread.</p> <p>ft flusher: max workdone in a buffer flushed by cleaner thread</p> <p>Max workdone value of any message buffer flushed by cleaner thread.</p> <p>ft flusher: min workdone in a buffer flushed by cleaner thread</p> <p>Min workdone value of any message buffer flushed by cleaner thread.</p> <p>ft flusher: total workdone in buffers flushed by cleaner thread</p> <p>Total workdone value of message buffers flushed by cleaner thread.</p> <p>ft flusher: times cleaner thread tries to merge a leaf</p> <p>The number of times the cleaner thread tries to merge a leaf.</p> <p>ft flusher: cleaner thread leaf merges in progress</p> <p>The number of cleaner thread leaf merges in progress.</p> <p>ft flusher: cleaner thread leaf merges successful</p> <p>The number of times the cleaner thread successfully merges a leaf.</p> <p>ft flusher: nodes dirtied by cleaner thread leaf merges</p> <p>The number of nodes dirtied by the \u201cflush from root\u201d process to merge a leaf node.</p> <p>ft flusher: total number of flushes done by flusher threads or cleaner threads</p> <p>Total number of flushes done by flusher threads or cleaner threads.</p> <p>ft flusher: number of in memory flushes</p> <p>Number of in-memory flushes.</p> <p>ft flusher: number of flushes that read something off disk</p> <p>Number of flushes that had to read a child (or part) off disk.</p> <p>ft flusher: number of flushes that triggered another flush in child</p> <p>Number of flushes that triggered another flush in the child.</p> <p>ft flusher: number of flushes that triggered 1 cascading flush</p> <p>Number of flushes that triggered 1 cascading flush.</p> <p>ft flusher: number of flushes that triggered 2 cascading flushes</p> <p>Number of flushes that triggered 2 cascading flushes.</p> <p>ft flusher: number of flushes that triggered 3 cascading flushes</p> <p>Number of flushes that triggered 3 cascading flushes.</p> <p>ft flusher: number of flushes that triggered 4 cascading flushes</p> <p>Number of flushes that triggered 4 cascading flushes.</p> <p>ft flusher: number of flushes that triggered 5 cascading flushes</p> <p>Number of flushes that triggered 5 cascading flushes.</p> <p>ft flusher: number of flushes that triggered over 5 cascading flushes</p> <p>Number of flushes that triggered more than 5 cascading flushes.</p> <p>ft flusher: leaf node splits</p> <p>Number of leaf nodes split.</p> <p>ft flusher: nonleaf node splits</p> <p>Number of non-leaf nodes split.</p> <p>ft flusher: leaf node merges</p> <p>Number of times leaf nodes are merged.</p> <p>ft flusher: nonleaf node merges</p> <p>Number of times non-leaf nodes are merged.</p> <p>ft flusher: leaf node balances</p> <p>Number of times a leaf node is balanced.</p> <p>hot: operations ever started</p> <p>This variable shows the number of hot operations started (<code>OPTIMIZE TABLE</code>). This is a not a useful value for a regular user to use for any purpose.</p> <p>hot: operations successfully completed</p> <p>The number of hot operations that have successfully completed (<code>OPTIMIZE TABLE</code>). This is a not a useful value for a regular user to use for any purpose.</p> <p>hot: operations aborted</p> <p>The number of hot operations that have been aborted (<code>OPTIMIZE TABLE</code>). This is a not a useful value for a regular user to use for any purpose.</p> <p>hot: max number of flushes from root ever required to optimize a tree</p> <p>The maximum number of flushes from the root ever required to optimize a tree.</p> <p>txn: begin</p> <p>This is the number of transactions that have been started.</p> <p>txn: begin read only</p> <p>Number of read only transactions started.</p> <p>txn: successful commits</p> <p>This is the total number of transactions that have been committed.</p> <p>txn: aborts</p> <p>This is the total number of transactions that have been aborted.</p> <p>logger: next LSN</p> <p>This is the next unassigned Log Sequence Number. It will be assigned to the next entry in the recovery log.</p> <p>logger: writes</p> <p>Number of times the logger has written to disk.</p> <p>logger: writes (bytes)</p> <p>Number of bytes the logger has written to disk.</p> <p>logger: writes (uncompressed bytes)</p> <p>Number of uncompressed the logger has written to disk.</p> <p>logger: writes (seconds)</p> <p>Number of seconds waiting for I/O when writing logs to disk.</p> <p>logger: number of long logger write operations</p> <p>Number of times a logger write operation required 100ms or more.</p> <p>indexer: number of indexers successfully created</p> <p>This is the number of times one of our internal objects, a indexer, has been created.</p> <p>indexer: number of calls to toku_indexer_create_indexer() that failed</p> <p>This is the number of times a indexer was requested but could not be created.</p> <p>indexer: number of calls to indexer-&gt;build() succeeded</p> <p>This is the total number of times that indexes were created using a indexer.</p> <p>indexer: number of calls to indexer-&gt;build() failed</p> <p>This is the total number of times that indexes were unable to be created using a indexer</p> <p>indexer: number of calls to indexer-&gt;close() that succeeded</p> <p>This is the number of indexers that successfully created the requested index(es).</p> <p>indexer: number of calls to indexer-&gt;close() that failed</p> <p>This is the number of indexers that were unable to create the requested index(es).</p> <p>indexer: number of calls to indexer-&gt;abort()</p> <p>This is the number of indexers that were aborted.</p> <p>indexer: number of indexers currently in existence</p> <p>This is the number of indexers that currently exist.</p> <p>indexer: max number of indexers that ever existed simultaneously</p> <p>This is the maximum number of indexers that ever existed simultaneously.</p> <p>loader: number of loaders successfully created</p> <p>This is the number of times one of our internal objects, a loader, has been created.</p> <p>loader: number of calls to toku_loader_create_loader() that failed</p> <p>This is the number of times a loader was requested but could not be created.</p> <p>loader: number of calls to loader-&gt;put() succeeded</p> <p>This is the total number of rows that were inserted using a loader.</p> <p>loader: number of calls to loader-&gt;put() failed</p> <p>This is the total number of rows that were unable to be inserted using a loader.</p> <p>loader: number of calls to loader-&gt;close() that succeeded</p> <p>This is the number of loaders that successfully created the requested table.</p> <p>loader: number of calls to loader-&gt;close() that failed</p> <p>This is the number of loaders that were unable to create the requested table.</p> <p>loader: number of calls to loader-&gt;abort()</p> <p>This is the number of loaders that were aborted.</p> <p>loader: number of loaders currently in existence</p> <p>This is the number of loaders that currently exist.</p> <p>loader: max number of loaders that ever existed simultaneously</p> <p>This is the maximum number of loaders that ever existed simultaneously.</p> <p>memory: number of malloc operations</p> <p>Number of calls to <code>malloc()</code>.</p> <p>memory: number of free operations</p> <p>Number of calls to <code>free()</code>.</p> <p>memory: number of realloc operations</p> <p>Number of calls to <code>realloc()</code>.</p> <p>memory: number of malloc operations that failed</p> <p>Number of failed calls to <code>malloc()</code>.</p> <p>memory: number of realloc operations that failed</p> <p>Number of failed calls to <code>realloc()</code>.</p> <p>memory: number of bytes requested</p> <p>Total number of bytes requested from memory allocator library.</p> <p>memory: number of bytes freed</p> <p>Total number of bytes allocated from memory allocation library that have been freed (used - freed = bytes in use).</p> <p>memory: largest attempted allocation size</p> <p>Largest number of bytes in a single successful <code>malloc()</code> operation.</p> <p>memory: size of the last failed allocation attempt</p> <p>Largest number of bytes in a single failed <code>malloc()</code> operation.</p> <p>memory: number of bytes used (requested + overhead)</p> <p>Total number of bytes allocated by memory allocator library.</p> <p>memory: estimated maximum memory footprint</p> <p>Maximum memory footprint of the storage engine, the max value of (used - freed).</p> <p>memory: mallocator version</p> <p>Version string from in-use memory allocator.</p> <p>memory: mmap threshold</p> <p>The threshold for malloc to use mmap.</p> <p>filesystem: ENOSPC redzone state</p> <p>The state of how much disk space exists with respect to the red zone value. Redzone is space greater than tokudb_fs_reserve_percent and less than full disk.</p> <p>Valid values are:</p> 0 <p>Space is available</p> 1 <p>Warning, with 2x of redzone value. Operations are allowed, but engine status prints a warning.</p> 2 <p>In red zone, insert operations are blocked</p> 3 <p>All operations are blocked</p> <p>filesystem: threads currently blocked by full disk</p> <p>This is the number of threads that are currently blocked because they are attempting to write to a full disk. This is normally zero. If this value is non-zero, then a warning will appear in the \u201cdisk free space\u201d field.</p> <p>filesystem: number of operations rejected by enospc prevention (red zone)</p> <p>This is the number of database inserts that have been rejected because the amount of disk free space was less than the reserve.</p> <p>filesystem: most recent disk full</p> <p>This is the most recent time when the disk file system was entirely full. If the disk has never been full, then this value will be <code>Dec 31, 1969</code> on Linux hosts.</p> <p>filesystem: number of write operations that returned ENOSPC</p> <p>This is the number of times that an attempt to write to disk failed because the disk was full. If the disk is full, this number will continue increasing until space is available.</p> <p>filesystem: fsync time</p> <p>This the total time, in microseconds, used to fsync to disk.</p> <p>filesystem: fsync count</p> <p>This is the total number of times the database has flushed the operating system\u2019s file buffers to disk.</p> <p>filesystem: long fsync time</p> <p>This the total time, in microseconds, used to fsync to disk when the operation required more than 1 second.</p> <p>filesystem: long fsync count</p> <p>This is the total number of times the database has flushed the operating system\u2019s file buffers to disk and this operation required more than 1 second.</p> <p>context: tree traversals blocked by a full fetch</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of a full fetch.</p> <p>context: tree traversals blocked by a partial fetch</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of a partial fetch.</p> <p>context: tree traversals blocked by a full eviction</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of a full eviction.</p> <p>context: tree traversals blocked by a partial eviction</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of a partial eviction.</p> <p>context: tree traversals blocked by a message injection</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of message injection.</p> <p>context: tree traversals blocked by a message application</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of message application (applying fresh ancestors messages to a basement node).</p> <p>context: tree traversals blocked by a flush</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of a buffer flush from parent to child.</p> <p>context: tree traversals blocked by a the cleaner thread</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of a cleaner thread.</p> <p>context: tree traversals blocked by something uninstrumented</p> <p>Number of times node <code>rwlock</code> contention was observed while pinning nodes from root to leaf because of something uninstrumented.</p> <p>context: promotion blocked by a full fetch (should never happen)</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of a full fetch.</p> <p>context: promotion blocked by a partial fetch (should never happen)</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of a partial fetch.</p> <p>context: promotion blocked by a full eviction (should never happen)</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of a full eviction.</p> <p>context: promotion blocked by a partial eviction (should never happen)</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of a partial eviction.</p> <p>context: promotion blocked by a message injection</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of message injection.</p> <p>context: promotion blocked by a message application</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of message application (applying fresh ancestors messages to a basement node).</p> <p>context: promotion blocked by a flush</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of a buffer flush from parent to child.</p> <p>context: promotion blocked by the cleaner thread</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of a cleaner thread.</p> <p>context: promotion blocked by something uninstrumented</p> <p>Number of times node <code>rwlock</code> contention was observed within promotion (pinning nodes from root to the buffer to receive the message) because of something uninstrumented.</p> <p>context: something uninstrumented blocked by something uninstrumented</p> <p>Number of times node <code>rwlock</code> contention was observed for an uninstrumented process because of something uninstrumented.</p> <p>handlerton: primary key bytes inserted</p> <p>Total number of bytes inserted into all primary key indexes.</p>"},{"location":"tokudb-variables.html","title":"TokuDB variables","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p> <p>Like all storage engines, TokuDB has variables to tune performance and control behavior. Fractal Tree algorithms are designed for near optimal performance and TokuDB\u2019s default settings should work well in most situations, eliminating the need for complex and time consuming tuning in most cases.</p>"},{"location":"tokudb-variables.html#tokudb-server-variables","title":"TokuDB Server Variables","text":"Name Cmd-Line Option File Var Scope Dynamic tokudb_alter_print_error Yes Yes Session, Global Yes tokudb_analyze_delete_fraction Yes Yes Session, Global Yes tokudb_analyze_in_background Yes Yes Session, Global Yes tokudb_analyze_mode Yes Yes Session, Global Yes tokudb_analyze_throttle Yes Yes Session, Global Yes tokudb_analyze_time Yes Yes Session, Global Yes tokudb_auto_analyze Yes Yes Session, Global Yes tokudb_backup_allowed_prefix No Yes Global No tokudb_backup_dir No Yes Session No tokudb_backup_exclude Yes Yes Session, Global Yes tokudb_backup_last_error Yes Yes Session, Global Yes tokudb_backup_last_error_string Yes Yes Session, Global Yes tokudb_backup_plugin_version No No Global No tokudb_backup_throttle Yes Yes Session, Global Yes tokudb_backup_version No No Global No tokudb_block_size Yes Yes Session, Global Yes tokudb_bulk_fetch Yes Yes Session, Global Yes tokudb_cachetable_pool_threads Yes Yes Global No tokudb_cardinality_scale_percent Yes Yes Global Yes tokudb_check_jemalloc Yes Yes Global No tokudb_checkpoint_lock Yes Yes Global No tokudb_checkpoint_on_flush_logs Yes Yes Global Yes tokudb_checkpoint_pool_threads Yes Yes Global Yes tokudb_checkpointing_period Yes Yes Global Yes tokudb_cleaner_iterations Yes Yes Global Yes tokudb_cleaner_period Yes Yes Global Yes tokudb_client_pool_threads Yes Yes Global No tokudb_commit_sync Yes Yes Session, Global Yes [tokudb_compress_buffers_before_eviction](#tokudb_compress_buffers_before_eviction Yes Yes Global No tokudb_create_index_online Yes Yes Session, Global Yes tokudb_data_dir Yes Yes Global No tokudb_debug Yes Yes Global Yes tokudb_dir_per_db Yes Yes Global Yes tokudb_directio Yes Yes Global No tokudb_disable_hot_alter Yes Yes Session, Global Yes tokudb_disable_prefetching Yes Yes Session, Global Yes tokudb_disable_slow_alter Yes Yes Session, Global Yes tokudb_empty_scan Yes Yes Session, Global Yes tokudb_enable_fast_update Yes Yes Session, Global Yes tokudb_enable_fast_upsert Yes Yes Session, Global Yes tokudb_enable_partial_eviction Yes Yes Global No tokudb_fanout Yes Yes Session, Global Yes tokudb_fs_reserve_percent Yes Yes Global No tokudb_fsync_log_period Yes Yes Global Yes tokudb_hide_default_row_format Yes Yes Session, Global Yes tokudb_killed_time Yes Yes Session, Global Yes tokudb_last_lock_timeout Yes Yes Session, Global Yes tokudb_load_save_space Yes Yes Session, Global Yes tokudb_loader_memory_size Yes Yes Session, Global Yes tokudb_lock_timeout Yes Yes Session, Global Yes tokudb_lock_timeout_debug Yes Yes Session, Global Yes tokudb_log_dir Yes Yes Global No tokudb_max_lock_memory Yes Yes Global No tokudb_optimize_index_fraction Yes Yes Session, Global Yes tokudb_optimize_index_name Yes Yes Session, Global Yes tokudb_optimize_throttle Yes Yes Session, Global Yes tokudb_pk_insert_mode Yes Yes Session, Global Yes tokudb_prelock_empty Yes Yes Session, Global Yes tokudb_read_block_size Yes Yes Session, Global Yes tokudb_read_buf_size Yes Yes Session, Global Yes tokudb_read_status_frequency Yes Yes Global Yes tokudb_row_format Yes Yes Session, Global Yes tokudb_rpl_check_readonly Yes Yes Session, Global Yes tokudb_rpl_lookup_rows Yes Yes Session, Global Yes tokudb_rpl_lookup_rows_delay Yes Yes Session, Global Yes tokudb_rpl_unique_checks Yes Yes Session, Global Yes tokudb_rpl_unique_checks_delay Yes Yes Session, Global Yes tokudb_strip_frm_data Yes Yes Global No tokudb_support_xa Yes Yes Session, Global Yes tokudb_tmp_dir Yes Yes Global No tokudb_version No No Global No tokudb_write_status_frequency Yes Yes Global Yes"},{"location":"tokudb-variables.html#tokudb_alter_print_error","title":"<code>tokudb_alter_print_error</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Boolean Default OFF <p>When set to <code>ON</code> errors will be printed to the client during the <code>ALTER TABLE</code> operations on TokuDB tables.</p>"},{"location":"tokudb-variables.html#tokudb_analyze_delete_fraction","title":"<code>tokudb_analyze_delete_fraction</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Numeric Default 1.000000 Range 0.0 - 1.000000 <p>This variables controls whether or not deleted rows in the fractal tree are reported to the client and to the MySQL error log during an <code>ANALYZE TABLE</code> operation on a TokuDB table. When set to <code>1</code>, nothing is reported. When set to <code>0.1</code> and at least 10% of the rows scanned by <code>ANALYZE</code> were deleted rows that are not yet garbage collected, a report is returned to the client and the MySQL error log.</p>"},{"location":"tokudb-variables.html#tokudb_backup_allowed_prefix","title":"<code>tokudb_backup_allowed_prefix</code>","text":"Option Description Command-line No Config file Yes Scope Global Dynamic No Data type String Default NULL <p>This system-level variable restricts the location of the destination directory where the backups can be located. Attempts to backup to a location outside of the directory this variable points to or its children will result in an error.</p> <p>The default is NULL, backups have no restricted locations. This read only variable can be set in the <code>my.cnf</code> configuration file and displayed with the <code>SHOW VARIABLES</code> command when Percona TokuBackup plugin is loaded.</p> <pre><code>mysql&gt; SHOW VARIABLES LIKE 'tokudb_backup_allowed_prefix';\n</code></pre> <p>The output could be:</p> <pre><code>+------------------------------+-----------+\n| Variable_name                | Value     |\n+------------------------------+-----------+\n| tokudb_backup_allowed_prefix | /dumpdir  |\n+------------------------------+-----------+\n</code></pre>"},{"location":"tokudb-variables.html#tokudb_backup_dir","title":"<code>tokudb_backup_dir</code>","text":"Option Description Command-line No Config file No Scope Session Dynamic Yes Data type String Default NULL <p>When enabled, this session level variable serves two purposes, to point to the destination directory where the backups will be dumped and to kick off the backup as soon as it is set. For more information see Percona TokuBackup.</p>"},{"location":"tokudb-variables.html#tokudb_backup_exclude","title":"<code>tokudb_backup_exclude</code>","text":"Option Description Command-line No Config file No Scope Session Dynamic Yes Data type String Default (mysqld_safe.pid)+ <p>Use this variable to set a regular expression that defines source files excluded from backup. For example, to exclude all <code>lost+found</code> directories, use the following command:</p> <pre><code>mysql&gt; set tokudb_backup_exclude='/lost\\\\+found($|/)';\n</code></pre> <p>For more information see Percona TokuBackup.</p>"},{"location":"tokudb-variables.html#tokudb_backup_last_error","title":"<code>tokudb_backup_last_error</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 0 <p>This session variable will contain the error number from the last backup. <code>0</code> indicates success. For more information see Percona TokuBackup.</p>"},{"location":"tokudb-variables.html#tokudb_backup_last_error_string","title":"<code>tokudb_backup_last_error_string</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type String Default NULL <p>This session variable will contain the error string from the last backup. For more information see Percona TokuBackup.</p>"},{"location":"tokudb-variables.html#tokudb_backup_plugin_version","title":"<code>tokudb_backup_plugin_version</code>","text":"Option Description Command-line No Config file No Scope Global Dynamic No Data type String <p>This read-only server variable documents the version of the TokuBackup plugin. For more information see Percona TokuBackup.</p>"},{"location":"tokudb-variables.html#tokudb_backup_throttle","title":"<code>tokudb_backup_throttle</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 18446744073709551615 <p>This variable specifies the maximum number of bytes per second the copier of a hot backup process will consume. Lowering its value will cause the hot backup operation to take more time but consume less I/O on the server. The default value is <code>18446744073709551615</code> which means no throttling. For more information see Percona TokuBackup.</p>"},{"location":"tokudb-variables.html#tokudb_backup_version","title":"<code>tokudb_backup_version</code>","text":"Option Description Command-line No Config file No Scope Global Dynamic No Data type String <p>This read-only server variable documents the version of the hot backup library. For more information see Percona TokuBackup.</p>"},{"location":"tokudb-variables.html#tokudb_block_size","title":"<code>tokudb_block_size</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 512 MB Range 4096 - 4294967295 <p>This variable controls the maximum size of node in memory before messages must be flushed or node must be split.</p> <p>Changing the value of tokudb_block_size only affects subsequently created tables and indexes. The value of this variable cannot be changed for an existing table/index without a dump and reload.</p>"},{"location":"tokudb-variables.html#tokudb_bulk_fetch","title":"<code>tokudb_bulk_fetch</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>This variable determines if our bulk fetch algorithm is used for <code>SELECT</code> statements. <code>SELECT</code> statements include pure <code>SELECT ...</code> statements, as well as <code>INSERT INTO table-name ... SELECT ...</code>, <code>CREATE TABLE table-name ... SELECT ...</code>, <code>REPLACE INTO table-name ... SELECT ...</code>, <code>INSERT IGNORE INTO table-name ... SELECT ...</code>, and <code>INSERT INTO table-name ... SELECT ... ON DUPLICATE KEY UPDATE</code>.</p>"},{"location":"tokudb-variables.html#tokudb_cache_size","title":"<code>tokudb_cache_size</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Numeric <p>This variable configures the size in bytes of the TokuDB cache table. The default cache table size is \u00bd of physical memory. Percona highly recommends using the default setting if using buffered I/O, if using direct I/O then consider setting this parameter to 80% of available memory.</p> <p>Consider decreasing tokudb_cache_size if excessive swapping is causing performance problems. Swapping may occur when running multiple MySQL server instances or if other running applications use large amounts of physical memory.</p>"},{"location":"tokudb-variables.html#tokudb_cachetable_pool_threads","title":"<code>tokudb_cachetable_pool_threads</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 0 Range 0 - 1024 <p>This variable defines the number of threads for the cachetable worker thread pool. This pool is used to perform node prefetches, and to serialize, compress, and write nodes during cachetable eviction. The default value of 0 calculates the pool size to be num_cpu_threads * 2.</p>"},{"location":"tokudb-variables.html#tokudb_check_jemalloc","title":"<code>tokudb_check_jemalloc</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Boolean Default OFF <p>This variable enables/disables startup checking if jemalloc is linked and correct version and that transparent huge pages are disabled. Used for testing only.</p>"},{"location":"tokudb-variables.html#tokudb_checkpoint_lock","title":"<code>tokudb_checkpoint_lock</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default OFF <p>Disables checkpointing when true. Session variable but acts like a global, any session disabling checkpointing disables it globally. If a session sets this lock and disconnects or terminates for any reason, the lock will not be released. Special purpose only, do not use this in your application.</p>"},{"location":"tokudb-variables.html#tokudb_checkpoint_on_flush_logs","title":"<code>tokudb_checkpoint_on_flush_logs</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Boolean Default OFF <p>When enabled forces a checkpoint if we get a flush logs command from the server.</p>"},{"location":"tokudb-variables.html#tokudb_checkpoint_pool_threads","title":"<code>tokudb_checkpoint_pool_threads</code>","text":"Option Description Command-line Yes Config file Yes Scope Dynamic No Data type Numeric Default 0 Range 0 - 1024 <p>This defines the number of threads for the checkpoint worker thread pool. This pool is used to serialize, compress and write nodes cloned during checkpoint. Default of <code>0</code> uses old algorithm to set pool size to <code>num_cpu_threads/4</code>.</p>"},{"location":"tokudb-variables.html#tokudb_checkpointing_period","title":"<code>tokudb_checkpointing_period</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 60 Range 0 - 4294967295 <p>This variable specifies the time in seconds between the beginning of one checkpoint and the beginning of the next. The default time between TokuDB checkpoints is 60 seconds. We recommend leaving this variable unchanged.</p>"},{"location":"tokudb-variables.html#tokudb_cleaner_iterations","title":"<code>tokudb_cleaner_iterations</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 5 Range 0 - 18446744073709551615 <p>This variable specifies how many internal nodes get processed in each tokudb_cleaner_period period. The default value is <code>5</code>. Setting this variable to <code>0</code> turns off cleaner threads.</p>"},{"location":"tokudb-variables.html#tokudb_cleaner_period","title":"<code>tokudb_cleaner_period</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 1 Range 0 - 18446744073709551615 <p>This variable specifies how often in seconds the cleaner thread runs. The default value is <code>1</code>. Setting this variable to <code>0</code> turns off cleaner threads.</p>"},{"location":"tokudb-variables.html#tokudb_client_pool_threads","title":"<code>tokudb_client_pool_threads</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Numeric Default 0 Range 0 - 1024 <p>This variable defines the number of threads for the client operations thread pool. This pool is used to perform node maintenance on over/undersized nodes such as message flushing down the tree, node splits, and node merges. Default of <code>0</code> uses old algorithm to set pool size to <code>1 \\* num_cpu_threads</code>.</p>"},{"location":"tokudb-variables.html#tokudb_commit_sync","title":"<code>tokudb_commit_sync</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>Session variable tokudb_commit_sync controls whether or not the transaction log is flushed when a transaction commits. The default behavior is that the transaction log is flushed by the commit. Flushing the transaction log requires a disk write and may adversely affect the performance of your application.</p> <p>To disable synchronous flushing of the transaction log, disable the tokudb_commit_sync session variable as follows:</p> <pre><code>SET tokudb_commit_sync=OFF;\n</code></pre> <p>Disabling this variable may make the system run faster. However, transactions committed since the last checkpoint are not guaranteed to survive a crash.</p> <p>Warning</p> <p>By disabling this variable and/or setting the tokudb_fsync_log_period to non-zero value you have effectively downgraded the durability of the storage engine. If you were to have a crash in this same window, you would lose data. The same issue would also appear if you were using some kind of volume snapshot for backups.</p>"},{"location":"tokudb-variables.html#tokudb_compress_buffers_before_eviction","title":"<code>tokudb_compress_buffers_before_eviction</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Boolean Default ON <p>When this variable is enabled it allows the evictor to compress unused internal node partitions in order to reduce memory requirements as a first step of partial eviction before fully evicting the partition and eventually the entire node.</p>"},{"location":"tokudb-variables.html#tokudb_create_index_online","title":"<code>tokudb_create_index_online</code>","text":"<p>This variable controls whether indexes created with the <code>CREATE INDEX</code> command are hot (if enabled), or offline (if disabled). Hot index creation means that the table is available for inserts and queries while the index is being created. Offline index creation means that the table is not available for inserts and queries while the index is being created.</p> <p>Note</p> <p>Hot index creation is slower than offline index creation.</p>"},{"location":"tokudb-variables.html#tokudb_data_dir","title":"<code>tokudb_data_dir</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type String Default NULL <p>This variable configures the directory name where the TokuDB tables are stored. The default value is <code>NULL</code> which uses the location of the MySQL data directory. For more information check TokuDB files and file types and TokuDB file management.</p>"},{"location":"tokudb-variables.html#tokudb_debug","title":"<code>tokudb_debug</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 0 Range 0 - 18446744073709551615 <p>This variable enables mysqld debug printing to <code>STDERR</code> for TokuDB. Produces tremendous amounts of output that is nearly useless to anyone but a TokuDB developer, not recommended for any production use at all. It is a mask value <code>ULONG</code>:</p> <pre><code>#define TOKUDB_DEBUG_INIT                   (1&lt;&lt;0)\n#define TOKUDB_DEBUG_OPEN                   (1&lt;&lt;1)\n#define TOKUDB_DEBUG_ENTER                  (1&lt;&lt;2)\n#define TOKUDB_DEBUG_RETURN                 (1&lt;&lt;3)\n#define TOKUDB_DEBUG_ERROR                  (1&lt;&lt;4)\n#define TOKUDB_DEBUG_TXN                    (1&lt;&lt;5)\n#define TOKUDB_DEBUG_AUTO_INCREMENT         (1&lt;&lt;6)\n#define TOKUDB_DEBUG_INDEX_KEY              (1&lt;&lt;7)\n#define TOKUDB_DEBUG_LOCK                   (1&lt;&lt;8)\n#define TOKUDB_DEBUG_CHECK_KEY              (1&lt;&lt;9)\n#define TOKUDB_DEBUG_HIDE_DDL_LOCK_ERRORS   (1&lt;&lt;10)\n#define TOKUDB_DEBUG_ALTER_TABLE            (1&lt;&lt;11)\n#define TOKUDB_DEBUG_UPSERT                 (1&lt;&lt;12)\n#define TOKUDB_DEBUG_CHECK                  (1&lt;&lt;13)\n#define TOKUDB_DEBUG_ANALYZE                (1&lt;&lt;14)\n#define TOKUDB_DEBUG_XA                     (1&lt;&lt;15)\n#define TOKUDB_DEBUG_SHARE                  (1&lt;&lt;16)\n</code></pre>"},{"location":"tokudb-variables.html#tokudb_dir_per_db","title":"<code>tokudb_dir_per_db</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Boolean Default ON <p>When this variable is set to <code>ON</code> all new tables and indices will be placed within their corresponding database directory within the tokudb_data_dir or system datadir. Existing table files will not be automatically relocated to their corresponding database directory. If you rename a table, while this variable is enabled, the mapping in the Percona FT directory file will be updated and the files will be renamed on disk to reflect the new table name. For more information check TokuDB files and file types and TokuDB file management.</p>"},{"location":"tokudb-variables.html#tokudb_directio","title":"<code>tokudb_directio</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Boolean Default OFF <p>When enabled, TokuDB employs Direct I/O rather than Buffered I/O for writes. When using Direct I/O, consider increasing tokudb_cache_size from its default of \u00bd physical memory.</p>"},{"location":"tokudb-variables.html#tokudb_disable_hot_alter","title":"<code>tokudb_disable_hot_alter</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default OFF <p>This variable is used specifically for testing or to disable hot alter in case there are bugs. Not for use in production.</p>"},{"location":"tokudb-variables.html#tokudb_disable_prefetching","title":"<code>tokudb_disable_prefetching</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default OFF <p>TokuDB attempts to aggressively prefetch additional blocks of rows, which is helpful for most range queries but may create unnecessary I/O for range queries with <code>LIMIT</code> clauses. Prefetching is <code>ON</code> by default, with a value of <code>0</code>, it can be disabled by setting this variable to <code>1</code>.</p>"},{"location":"tokudb-variables.html#tokudb_disable_slow_alter","title":"<code>tokudb_disable_slow_alter</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default OFF <p>This variable is used specifically for testing or to disable hot alter in case there are bugs. Not for use in production. It controls whether slow alter tables are allowed. For example, the following command is slow because <code>HCADER</code> does not allow a mixture of column additions, deletions, or expansions:</p> <pre><code>ALTER TABLE table\nADD COLUMN column_a INT,\nDROP COLUMN column_b;\n</code></pre> <p>By default, tokudb_disable_slow_alter is disabled, and the engine reports back to MySQL that this is unsupported resulting in the following output:</p> <pre><code>ERROR 1112 (42000): Table 'test_slow' uses an extension that doesn't exist in this MySQL version\n</code></pre>"},{"location":"tokudb-variables.html#tokudb_empty_scan","title":"<code>tokudb_empty_scan</code>","text":"<p>Defines direction to be used to perform table scan to check for empty tables for bulk loader.</p>"},{"location":"tokudb-variables.html#tokudb_enable_fast_update","title":"<code>tokudb_enable_fast_update</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Boolean Default OFF <p>Toggles the fast updates feature ON/OFF for the <code>UPDATE</code> statement. Fast update involves queries optimization to avoid random reads during their execution.</p>"},{"location":"tokudb-variables.html#tokudb_enable_fast_upsert","title":"<code>tokudb_enable_fast_upsert</code>","text":"Option Description Command-line Yes Config file Yes Scope Global/Session Dynamic Yes Data type Boolean Default OFF <p>Toggles the fast updates feature ON/OFF for the <code>INSERT</code> statement. Fast update involves queries optimization to avoid random reads during their execution.</p>"},{"location":"tokudb-variables.html#tokudb_enable_partial_eviction","title":"<code>tokudb_enable_partial_eviction</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Boolean Default OFF <p>This variable is used to control if partial eviction of nodes is enabled or disabled.</p>"},{"location":"tokudb-variables.html#tokudb_fanout","title":"<code>tokudb_fanout</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 16 Range 2-16384 <p>This variable controls the Fractal Tree fanout. The fanout defines the number of pivot keys or child nodes for each internal tree node. Changing the value of tokudb_fanout only affects subsequently created tables and indexes. The value of this variable cannot be changed for an existing table/index without a dump and reload.</p>"},{"location":"tokudb-variables.html#tokudb_fs_reserve_percent","title":"<code>tokudb_fs_reserve_percent</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Numeric Default 5 Range 0-100 <p>This variable controls the percentage of the file system that must be available for inserts to be allowed. By default, this is set to <code>5</code>. We recommend that this reserve be at least half the size of your physical memory. See Full Disks for more information.</p>"},{"location":"tokudb-variables.html#tokudb_fsync_log_period","title":"<code>tokudb_fsync_log_period</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 0 Range 0-4294967295 <p>This variable controls the frequency, in milliseconds, for <code>fsync()</code> operations. If set to <code>0</code> then the <code>fsync()</code> behavior is only controlled by the tokudb_commit_sync, which can be <code>ON</code> or <code>OFF</code>.</p>"},{"location":"tokudb-variables.html#tokudb_hide_default_row_format","title":"<code>tokudb_hide_default_row_format</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>This variable is used to hide the <code>ROW_FORMAT</code> in <code>SHOW CREATE TABLE</code>. If <code>zlib</code> compression is used, row format will show as <code>DEFAULT</code>.</p>"},{"location":"tokudb-variables.html#tokudb_killed_time","title":"<code>tokudb_killed_time</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 4000 Range 0-18446744073709551615 <p>This variable is used to specify frequency in milliseconds for lock wait to check to see if the lock was killed.</p>"},{"location":"tokudb-variables.html#tokudb_last_lock_timeout","title":"<code>tokudb_last_lock_timeout</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type String Default NULL <p>This variable contains a JSON document that describes the last lock conflict seen by the current MySQL client. It gets set when a blocked lock request times out or a lock deadlock is detected.</p> <p>The tokudb_lock_timeout_debug session variable must have bit <code>0</code> set for this behavior, otherwise this session variable will be empty.</p>"},{"location":"tokudb-variables.html#tokudb_load_save_space","title":"<code>tokudb_load_save_space</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>This session variable changes the behavior of the bulk loader. When it is disabled the bulk loader stores intermediate data using uncompressed files (which consumes additional CPU), whereas <code>ON</code> compresses the intermediate files.</p> <p>Note</p> <p>The location of the temporary disk space used by the bulk loader may be specified with the tokudb_tmp_dir server variable.</p> <p>If a <code>LOAD DATA INFILE</code> statement fails with the error message <code>ERROR 1030 (HY000): Got error 1</code> from storage engine, then there may not be enough disk space for the optimized loader, so disable tokudb_prelock_empty and try again. More information is available in Known Issues.</p>"},{"location":"tokudb-variables.html#tokudb_loader_memory_size","title":"<code>tokudb_loader_memory_size</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 100000000 Range 0-18446744073709551615 <p>This variable limits the amount of memory (in bytes) that the TokuDB bulk loader will use for each loader instance. Increasing this value may provide a performance benefit when loading extremely large tables with several secondary indexes.</p> <p>Note</p> <p>Memory allocated to a loader is taken from the TokuDB cache, defined in tokudb_cache_size, and may impact the running workload\u2019s performance as existing cached data must be ejected for the loader to begin.</p>"},{"location":"tokudb-variables.html#tokudb_lock_timeout","title":"<code>tokudb_lock_timeout</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 4000 Range 0-18446744073709551615 <p>This variable controls the amount of time that a transaction will wait for a lock held by another transaction to be released. If the conflicting transaction does not release the lock within the lock timeout, the transaction that was waiting for the lock will get a lock timeout error. The units are milliseconds. A value of <code>0</code> disables lock waits. The default value is 4000 (four seconds).</p> <p>If your application gets a <code>lock wait timeout</code> error (-30994), then you may find that increasing the tokudb_lock_timeout may help. If your application gets a <code>deadlock found</code> error (-30995), then you need to abort the current transaction and retry it.</p>"},{"location":"tokudb-variables.html#tokudb_lock_timeout_debug","title":"<code>tokudb_lock_timeout_debug</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 1 Range 0-3 <p>The following values are available:</p> <ul> <li> <p><code>0</code>: No lock timeouts or lock deadlocks are reported.</p> </li> <li> <p><code>1</code>: A JSON document that describes the lock conflict is stored in the tokudb_last_lock_timeout session variable</p> </li> <li> <p><code>2</code>: A JSON document that describes the lock conflict is printed to the MySQL error log.</p> </li> </ul> <p>In addition to the JSON document describing the lock conflict, the following lines are printed to the MySQL error log:</p> <pre><code>* A line containing the blocked thread id and blocked SQL\n\n* A line containing the blocking thread id and the blocking SQL.\n</code></pre> <ul> <li><code>3</code>: A JSON document that describes the lock conflict is stored in the tokudb_last_lock_timeout session variable and is printed to the MySQL error log.</li> </ul> <p>In addition to the JSON document describing the lock conflict, the following lines are printed to the MySQL error log:</p> <pre><code>* A line containing the blocked thread id and blocked SQL\n\n* A line containing the blocking thread id and the blocking SQL.\n</code></pre>"},{"location":"tokudb-variables.html#tokudb_log_dir","title":"<code>tokudb_log_dir</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type String Default NULL <p>This variable specifies the directory where the TokuDB log files are stored. The default value is <code>NULL</code> which uses the location of the MySQL data directory. Configuring a separate log directory is somewhat involved. Please contact Percona support for more details. For more information check TokuDB files and file types and TokuDB file management.</p> <p>Warning</p> <p>After changing TokuDB log directory path, the old TokuDB recovery log file should be moved to new directory prior to start of MySQL server and log file\u2019s owner must be the <code>mysql</code> user. Otherwise server will fail to initialize the TokuDB store engine restart.</p>"},{"location":"tokudb-variables.html#tokudb_max_lock_memory","title":"<code>tokudb_max_lock_memory</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type Numeric Default 65560320 Range 0-18446744073709551615 <p>This variable specifies the maximum amount of memory for the PerconaFT lock table.</p>"},{"location":"tokudb-variables.html#tokudb_optimize_index_fraction","title":"<code>tokudb_optimize_index_fraction</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 1.000000 Range 0.000000 - 1.000000 <p>For patterns where the left side of the tree has many deletions (a common pattern with increasing id or date values), it may be useful to delete a percentage of the tree. In this case, it\u2019s possible to optimize a subset of a fractal tree starting at the left side. The tokudb_optimize_index_fraction session variable controls the size of the sub tree. Valid values are in the range [0.0,1.0] with default 1.0 (optimize the whole tree).</p>"},{"location":"tokudb-variables.html#tokudb_optimize_index_name","title":"<code>tokudb_optimize_index_name</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type String Default NULL <p>This variable can be used to optimize a single index in a table, it can be set to select the index by name.</p>"},{"location":"tokudb-variables.html#tokudb_optimize_throttle","title":"<code>tokudb_optimize_throttle</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 0 Range 0-18446744073709551615 <p>By default, table optimization will run with all available resources. To limit the amount of resources, it is possible to limit the speed of table optimization. This determines an upper bound on how many fractal tree leaf nodes per second are optimized. The default <code>0</code> imposes no limit.</p>"},{"location":"tokudb-variables.html#tokudb_pk_insert_mode","title":"<code>tokudb_pk_insert_mode</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 1 Range 0-3 <p>Note</p> <p>The tokudb_pk_insert_mode session variable was removed and the behavior is now that of the former tokudb_pk_insert_mode set to <code>1</code>. The optimization will be used where safe and not used where not safe.</p>"},{"location":"tokudb-variables.html#tokudb_prelock_empty","title":"<code>tokudb_prelock_empty</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>By default TokuDB preemptively grabs an entire table lock on empty tables. If one transaction is doing the loading, such as when the user is doing a table load into an empty table, this default provides a considerable speedup.</p> <p>However, if multiple transactions try to do concurrent operations on an empty table, all but one transaction will be locked out. Disabling tokudb_prelock_empty optimizes for this multi-transaction case by turning off preemptive pre-locking.</p> <p>Note</p> <p>If this variable is set to <code>OFF</code>, fast bulk loading is turned off as well.</p>"},{"location":"tokudb-variables.html#tokudb_read_block_size","title":"<code>tokudb_read_block_size</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 16384 (16KB) Range 4096 - 4294967295 <p>Fractal tree leaves are subdivided into read blocks, in order to speed up point queries. This variable controls the target uncompressed size of the read blocks. The units are bytes and the default is 64 KB. A smaller value favors read performance for point and small range scans over large range scans and higher compression. The minimum value of this variable is 4096 (4KB).</p> <p>Changing the value of tokudb_read_block_size only affects subsequently created tables. The value of this variable cannot be changed for an existing table without a dump and reload.</p>"},{"location":"tokudb-variables.html#tokudb_read_buf_size","title":"<code>tokudb_read_buf_size</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 131072 (128KB) Range 0 - 1048576 <p>This variable controls the size of the buffer used to store values that are bulk fetched as part of a large range query. Its unit is bytes and its default value is 131,072 (128 KB).</p> <p>A value of <code>0</code> turns off bulk fetching. Each client keeps a thread of this size, so it should be lowered if situations where there are a large number of clients simultaneously querying a table.</p>"},{"location":"tokudb-variables.html#tokudb_read_status_frequency","title":"<code>tokudb_read_status_frequency</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 10000 Range 0 - 4294967295 <p>This variable controls in how many reads the progress is measured to display <code>SHOW PROCESSLIST</code>. Reads are defined as <code>SELECT</code> queries.</p> <p>For slow queries, it can be helpful to set this variable and tokudb_write_status_frequency to <code>1</code>, and then run <code>SHOW PROCESSLIST</code> several times to understand what progress is being made.</p>"},{"location":"tokudb-variables.html#tokudb_row_format","title":"<code>tokudb_row_format</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type ENUM Default TOKUDB_QUICKLZ Range TOKUDB_DEFAULT, TOKUDB_FAST, TOKUDB_SMALL, TOKUDB_ZLIB, TOKUDB_QUICKLZ, TOKUDB_LZMA, TOKUDB_SNAPPY, TOKUDB_UNCOMPRESSED <p>This controls the default compression algorithm used to compress data. For more information on compression algorithms see Compression Details.</p>"},{"location":"tokudb-variables.html#tokudb_rpl_check_readonly","title":"<code>tokudb_rpl_check_readonly</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>The TokuDB replication code will run row events from the binary log with Read Free Replication when the replica is in read-only mode. This variable is used to disable the replica read only check in the TokuDB replication code.</p> <p>This allows Read-Free-Replication to run when the replica is NOT read-only. By default, tokudb_rpl_check_readonly is enabled (check that replica is read-only). Do NOT change this value unless you completely understand the implications!</p>"},{"location":"tokudb-variables.html#tokudb_rpl_lookup_rows","title":"<code>tokudb_rpl_lookup_rows</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>When disabled, TokuDB replication replicas skip row lookups for <code>delete row</code> log events and <code>update row</code> log events, which eliminates all associated read I/O for these operations.</p> <p>Warning</p> <p>TokuDB Read Free Replication will not propagate <code>UPDATE</code> and <code>DELETE</code> events reliably if TokuDB table is missing the primary key which will eventually lead to data inconsistency on the replica.</p> <p>Note</p> <p>Optimization is only enabled when read_only is set to <code>1</code> and binlog_format is <code>ROW</code>.</p>"},{"location":"tokudb-variables.html#tokudb_rpl_lookup_rows_delay","title":"<code>tokudb_rpl_lookup_rows_delay</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 0 Range 0 - 18446744073709551615 <p>This variable allows for simulation of long disk reads by sleeping for the given number of microseconds prior to the row lookup query, it should only be set to a non-zero value for testing.</p>"},{"location":"tokudb-variables.html#tokudb_rpl_unique_checks","title":"<code>tokudb_rpl_unique_checks</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>When disabled, TokuDB replication replicas skip uniqueness checks on inserts and updates, which eliminates all associated read I/O for these operations.</p> <p>Note</p> <p>Optimization is only enabled when read_only is set to <code>1</code> and binlog_format is <code>ROW</code>.</p>"},{"location":"tokudb-variables.html#tokudb_rpl_unique_checks_delay","title":"<code>tokudb_rpl_unique_checks_delay</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Numeric Default 0 Range 0 - 18446744073709551615 <p>This variable allows for simulation of long disk reads by sleeping for the given number of microseconds prior to the row lookup query, it should only be set to a non-zero value for testing.</p>"},{"location":"tokudb-variables.html#tokudb_strip_frm_data","title":"<code>tokudb_strip_frm_data</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Boolean Default OFF <p>When this variable is set to <code>ON</code> during the startup server will check all the status files and remove the embedded <code>.frm</code> metadata. This variable can be used to assist in TokuDB data recovery. </p> <p>Warning</p> <p>Use this variable only if you know what you\u2019re doing otherwise it could lead to data loss.</p>"},{"location":"tokudb-variables.html#tokudb_support_xa","title":"<code>tokudb_support_xa</code>","text":"Option Description Command-line Yes Config file Yes Scope Session, Global Dynamic Yes Data type Boolean Default ON <p>This variable defines whether or not the prepare phase of an XA transaction performs an <code>fsync()</code>.</p>"},{"location":"tokudb-variables.html#tokudb_tmp_dir","title":"<code>tokudb_tmp_dir</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic No Data type String <p>This variable specifies the directory where the TokuDB bulk loader stores temporary files. The bulk loader can create large temporary files while it is loading a table, so putting these temporary files on a disk separate from the data directory can be useful.</p> <p>For example, it can make sense to use a high-performance disk for the data directory and a very inexpensive disk for the temporary directory. The default location for TokuDB\u2019s temporary files is the MySQL data directory.</p> <p>tokudb_load_save_space determines whether the data is compressed or not. The error message <code>ERROR 1030 (HY000): Got error 1 from storage engine</code> could indicate that the disk has run out of space.</p> <p>For more information check TokuDB files and file types and TokuDB file management.</p>"},{"location":"tokudb-variables.html#tokudb_version","title":"<code>tokudb_version</code>","text":"Option Description Command-line No Config file No Scope Global Dynamic No Data type String <p>This read-only variable documents the version of the TokuDB storage engine.</p>"},{"location":"tokudb-variables.html#tokudb_write_status_frequency","title":"<code>tokudb_write_status_frequency</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type Numeric Default 1000 Range 0 - 4294967295 <p>This variable controls in how many writes the progress is measured to display <code>SHOW PROCESSLIST</code>. Writes are defined as <code>INSERT</code>, <code>UPDATE</code> and <code>DELETE</code> queries.</p> <p>For slow queries, it can be helpful to set this variable and tokudb_read_status_frequency to 1, and then run <code>SHOW PROCESSLIST</code> several times to understand what progress is being made.</p>"},{"location":"topic-index.html","title":"Topic index","text":"<ul> <li>Adaptive network buffers</li> <li>Advanced encryption key rotation</li> <li>Apt pinning the Percona Server for MySQL 8.0 packages</li> <li>Audit Log Filter compression and encryption</li> <li>Audit Log Filter file format overview</li> <li>Audit Log Filter format - JSON</li> <li>Audit Log Filter format - XML (new style)</li> <li>Audit Log Filter format - XML (old style)</li> <li>Audit Log Filter functions, options, and variables</li> <li>Audit Log Filter naming conventions</li> <li>Audit Log Filter overview</li> <li>Audit Log Filter restrictions</li> <li>Audit Log Filter security</li> <li>Audit log plugin</li> <li>Backup and restore overview</li> <li>Backup locks</li> <li>Binary logs and replication improvements</li> <li>Binary tarball file names available based on the Percona Server for MySQL version</li> <li>Build APT packages</li> <li>Compare the data masking component to the data masking plugin</li> <li>Compile Percona Server for MySQL 8.0 from source</li> <li>Compressed columns with dictionaries</li> <li>Copyright and licensing information</li> <li>Data at Rest encryption</li> <li>Data masking component functions</li> <li>Data masking overview</li> <li>Data masking plugin functions</li> <li>Development of Percona Server for MySQL</li> <li>Differences between Percona MyRocks and Facebook MyRocks</li> <li>Disable Audit Log Filter logging</li> <li>Docker environment variables</li> <li>Downgrade Percona Server for MySQL</li> <li>Encrypt Binary Log files and Relay Log files</li> <li>Encrypt doublewrite buffers</li> <li>Encrypt File-Per-Table Tablespace</li> <li>Encrypt schema or general tablespace</li> <li>Encrypt system tablespace</li> <li>Encrypt temporary files</li> <li>Encrypt the undo tablespace</li> <li>Encrypting the Redo Log data</li> <li>Encryption functions</li> <li>Enforcing storage engine</li> <li>Expanded fast index creation</li> <li>Extended mysqlbinlog</li> <li>Extended mysqldump</li> <li>Extended SELECT INTO OUTFILE/DUMPFILE</li> <li>Extended show engine InnoDB status</li> <li>Extended SHOW GRANTS</li> <li>Fast updates with TokuDB</li> <li>FIDO authentication plugin</li> <li>Files in the DEB package built for Percona Server for MySQL 8.0</li> <li>Files in the RPM package built for Percona Server for MySQL</li> <li>Filter the Audit Log Filter logs</li> <li>Frequently asked questions</li> <li>Gap locks detection</li> <li>Glossary</li> <li>Group replication system variables</li> <li>Handle corrupt tables</li> <li>Home</li> <li>Improved InnoDB I/O scalability</li> <li>Improved MEMORY storage engine</li> <li>Index of INFORMATION_SCHEMA tables</li> <li>InnoDB full-text search improvements</li> <li>InnoDB page fragmentation counters</li> <li>Install and remove the data masking plugin</li> <li>Install from Percona Software repository</li> <li>Install Percona Server for MySQL 8.0 from a binary tarball</li> <li>Install Percona Server for MySQL 8.0 using downloaded DEB packages</li> <li>Install Percona Server for MySQL from a source tarball</li> <li>Install Percona Server for MySQL using downloaded RPM packages</li> <li>Install Percona Server for MySQL</li> <li>Install the Audit Log Filter</li> <li>Install the data masking component</li> <li>Install using Docker</li> <li>Installing and configuring Percona Server for MySQL with ZenFS support</li> <li>Jemalloc memory allocation profiling</li> <li>Kill idle transactions</li> <li>LDAP authentication plugin system variables</li> <li>Limit the estimation of records in a Query</li> <li>Limiting the disk space used by binary log files</li> <li>List of features available in Percona Server for MySQL releases</li> <li>List of variables introduced in Percona Server for MySQL 8.0</li> <li>Manage group replication flow control</li> <li>Manage the Audit Log Filter files</li> <li>Migrate and remove the TokuDB storage engine</li> <li>Misc. INFORMATION_SCHEMA tables</li> <li>Multiple page asynchronous I/O requests</li> <li>MyRocks data loading</li> <li>MyRocks Information Schema tables</li> <li>MyRocks limitations</li> <li>MyRocks server variables</li> <li>MyRocks status variables</li> <li>PAM authentication plugin</li> <li>Percona MyRocks installation guide</li> <li>Percona MyRocks introduction</li> <li>Percona Server for MySQL feature comparison</li> <li>Percona Server for MySQL in-place upgrading guide: from 5.7 to 8.0</li> <li>Percona TokuBackup</li> <li>Percona Toolkit UDFs</li> <li>Post-installation</li> <li>Prefix index queries optimization</li> <li>Process list</li> <li>Quickstart guide for Percona Server for MySQL</li> <li>Reading Audit Log Filter files</li> <li>Release notes index</li> <li>Rotate the master key</li> <li>Run Percona Server for MySQL 8.0 after APT repository installation</li> <li>Run Percona Server for MySQL</li> <li>SEQUENCE_TABLE(n) function</li> <li>Show storage engines</li> <li>Slow query log rotation and expiration</li> <li>Slow query log</li> <li>SSL improvements</li> <li>Stack trace</li> <li>Start transaction with consistent snapshot</li> <li>Support for PROXY protocol</li> <li>The Percona XtraDB storage engine</li> <li>The ProcFS plugin</li> <li>The secure_log_path variable</li> <li>Thread based profiling</li> <li>Thread pool</li> <li>TokuDB background ANALYZE TABLE</li> <li>TokuDB file management</li> <li>TokuDB files and file types</li> <li>TokuDB fractal tree indexing</li> <li>TokuDB frequently asked questions</li> <li>TokuDB installation</li> <li>TokuDB introduction</li> <li>TokuDB Performance Schema integration</li> <li>TokuDB status variables</li> <li>TokuDB troubleshooting</li> <li>TokuDB variables</li> <li>Too many connections warning</li> <li>Trademark policy</li> <li>Trigger updates</li> <li>Understand version numbers</li> <li>Uninstall Audit Log Filter</li> <li>UNINSTALL COMPONENT</li> <li>Uninstall Percona Server for MySQL</li> <li>Uninstall Percona Server ro MySQL 8.0 using the APT package manager</li> <li>Uninstall the data masking component</li> <li>Updated supported features</li> <li>Upgrade from systems that use the MyRocks or TokuDB storage engine and partitioned tables</li> <li>Upgrade using Standalone Packages</li> <li>Upgrade using the Percona repositories</li> <li>Use an APT repository to install Percona Server for MySQL 8.0</li> <li>Use Percona Monitoring and Management (PMM) Advisors</li> <li>Use the Amazon Key Management Service (AWS KMS)</li> <li>Use the keyring component or keyring plugin</li> <li>Use TokuDB</li> <li>User statistics</li> <li>Using LDAP authentication plugins</li> <li>Using libcoredumper</li> <li>Using the Key Management Interoperability Protocol (KMIP)</li> <li>Utility user</li> <li>Verify the encryption for tables, tablespaces, and schemas</li> <li>Working with AppArmor</li> <li>Working with SELinux</li> <li>XtraDB changed page tracking</li> <li>XtraDB performance improvements for I/O-bound highly-concurrent workloads</li> </ul>"},{"location":"trademark-policy.html","title":"Trademark policy","text":"<p>This Trademark Policy is to ensure that users of Percona-branded products or services know that what they receive has really been developed, approved, tested, and maintained by Percona. Trademarks help to prevent confusion in the marketplace, by distinguishing one company\u2019s or person\u2019s products and services from another\u2019s.</p> <p>Percona owns a number of marks, including but not limited to Percona, XtraDB, Percona XtraDB, XtraBackup, Percona XtraBackup, Percona Server for MySQL, and Percona Live, plus the distinctive visual icons and logos associated with these marks. Both the unregistered and registered marks of Percona are protected.</p> <p>Use of any Percona trademark in the name, URL, or another identifying characteristic of any product, service, website, or other use is not permitted without Percona\u2019s written permission with the following three limited exceptions.</p> <p>First, you may use the appropriate Percona mark when making a nominative fair use reference to a bona fide Percona product.</p> <p>Second, when Percona has released a product under a version of the GNU General Public License (\u201cGPL\u201d), you may use the appropriate Percona mark when distributing a verbatim copy of that product in accordance with the terms and conditions of the GPL.</p> <p>Third, you may use the appropriate Percona mark to refer to a distribution of GPL-released  Percona software that has been modified with minor changes for the sole purpose of allowing the software to operate on an operating system or hardware platform for which Percona has not yet released the software, provided that those third party changes do not affect the behavior, functionality, features, design or performance of the software. Users who acquire this Percona-branded software receive substantially exact implementations of the Percona software.</p> <p>Percona reserves the right to revoke this authorization at any time in its sole discretion.  For example, if Percona believes that your modification is beyond the scope of the limited license granted in this Policy or that your use of the Percona mark is detrimental to Percona, Percona will revoke this authorization.  Upon revocation, you must immediately cease using the applicable Percona mark.  If you do not immediately cease using the Percona mark upon revocation, Percona may take action to protect its rights and interests in the Percona mark.  Percona does not grant any license to use any Percona mark for any other modified versions of Percona software; such use will require our prior written permission.</p> <p>Neither trademark law nor any of the exceptions set forth in this Trademark Policy permit you to truncate, modify, or otherwise use any Percona mark as part of your own brand.  For example, if XYZ creates a modified version of the Percona Server for MySQL, XYZ may not brand that modification as \u201cXYZ Percona Server\u201d or \u201cPercona XYZ Server\u201d, even if that modification otherwise complies with the third exception noted above.</p> <p>In all cases, you must comply with applicable law, the underlying license, and this Trademark Policy, as amended from time to time.  For instance, any mention of Percona trademarks should include the full trademarked name, with proper spelling and capitalization, along with attribution of ownership to Percona Inc.  For example, the full proper name for XtraBackup is Percona XtraBackup. However, it is acceptable to omit the word \u201cPercona\u201d for brevity on the second and subsequent uses, where such omission does not cause confusion.</p> <p>In the event of doubt as to any of the conditions or exceptions outlined in this Trademark Policy, please contact trademarks@percona.com for assistance and we will do our very best to be helpful.</p>"},{"location":"trigger-updates.html","title":"Trigger updates","text":"<p>Clients can issue simultaneous queries for a table. To avoid scalability problems, each thread-handling query has its own table instance. The server uses a special cache, called the Table Cache, which contains open table instanances. The use of the cache avoids paying the penalty in resources for opening and closing tables for each statement.</p> <p>The <code>table_open_cache</code> system variable sets soft limits on the cache size. This limit can be temporarily exceeded if the currently executing queries require more open tables than specified. However, when these queries complete, the server closes the unused table instances from this cache using the least recently used (LRU) algorithm.</p> <p>The <code>table_open_cache_instances</code> system variable shows the number of open tables cache instances.</p> <p>For more information, see How MySQL opens and closes tables.</p> <p>Opening a table with triggers in Table Cache also parses the trigger definitions and associates the open table instance with its own instances of the defined trigger bodies. When a connection executes a DML statement and must run a trigger, that connection gets its own instance of the trigger body for that specific open table instance. As a result of this approach, caching open table instances and also caching an associated trigger body for each trigger can consume a surprising amount of memory.</p>"},{"location":"trigger-updates.html#version-specific-information","title":"Version specific information","text":"<p>Percona Server for MySQL 8.0.34 adds the <code>open_tables_with_triggers</code> status variable.</p> <p>Percona Server for MySQL 8.0.31 adds the following abilities:</p> <ul> <li>Avoid using table instances with fully-loaded and parsed triggers by read-only queries</li> <li>Show trigger CREATE statements even if the statement is unparseable</li> </ul> <p>The additional system variable reduces the Table Cache memory consumption on the server when tables that contain trigger definitions also are part of a significant read-only workload.</p>"},{"location":"trigger-updates.html#system-variables","title":"System variables","text":""},{"location":"trigger-updates.html#table_open_cache_triggers","title":"table_open_cache_triggers","text":"Option Description Command-line <code>--table-open-cache-triggers</code> Dynamic Yes Scope Global Data type Integer Default 524288 Minimum value 1 Maximum value 524288 <p>This variable allows you to set a soft limit on the maximum of open tables in the Table Cache, which contains fully-loaded triggers. By default, the value is the maximum value to avoid existing users observing a change in behavior.</p> <p>If the number of open table instances with fully-loaded triggers exceeds the value, then unused table instances with fully-loaded triggers are removed. This operation uses the least recently used (LRU) method for managing storage areas.</p> <p>The value can be a start-up option or changed dynamically.</p>"},{"location":"trigger-updates.html#status-variables","title":"Status variables","text":"<p>The following status variables are available:</p> Variable name Description <code>Open_tables_with_triggers</code> The current number of TABLE instances with fully-loaded triggers in the <code>table_open_cache</code>. <code>table_open_cache_triggers_hits</code> A hit means the statement required an open table instance with fully-loaded triggers and was able to get one from the <code>table_open_cache</code>. <code>table_open_cache_triggers_misses</code> A miss means the statement requiring an open table instance with fully-loaded triggers was not found one in the <code>table_open_cache</code>. The statement may find a table instance without fully-loaded triggers and finalized their loading for it. <code>table_open_cache_triggers_overflows</code> An overflow indicates the number of unused table instances with triggers that were expelled from the <code>table_open_cache</code> due to the <code>table_open_cache_triggers</code> soft limit. This variable may demonstrate that the <code>table_open_cache_triggers</code> value should be increased."},{"location":"trigger-updates.html#show-create-trigger-statment-changes","title":"SHOW CREATE TRIGGER statment changes","text":"<p>The <code>SHOW CREATE TRIGGER</code> statement shows the CREATE statement used to create the trigger. The statement also shows definitions which can no longer be parsed. For example, you can show the definition of a trigger created before a server upgrade which changed the trigger syntax.</p>"},{"location":"udf-percona-toolkit.html","title":"Percona Toolkit UDFs","text":"<p>Three Percona Toolkit UDFs that provide faster checksums are provided:</p> <ul> <li> <p><code>libfnv1a_udf</code></p> </li> <li> <p><code>libfnv_udf</code></p> </li> <li> <p><code>libmurmur_udf</code></p> </li> </ul>"},{"location":"udf-percona-toolkit.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"udf-percona-toolkit.html#other-information","title":"Other information","text":"<ul> <li>Author/Origin: Baron Schwartz</li> </ul>"},{"location":"udf-percona-toolkit.html#installation","title":"Installation","text":"<p>These UDFs are part of the Percona Server for MySQL packages. To install one of the UDFs into the server, execute one of the following commands, depending on which UDF you want to install:</p> <pre><code>mysql -e \"CREATE FUNCTION fnv1a_64 RETURNS INTEGER SONAME 'libfnv1a_udf.so'\"\nmysql -e \"CREATE FUNCTION fnv_64 RETURNS INTEGER SONAME 'libfnv_udf.so'\"\nmysql -e \"CREATE FUNCTION murmur_hash RETURNS INTEGER SONAME 'libmurmur_udf.so'\"\n</code></pre> <p>Executing each of these commands will install its respective UDF into the server.</p>"},{"location":"udf-percona-toolkit.html#troubleshooting","title":"Troubleshooting","text":"<p>If you get the error:</p> Error message <pre><code>ERROR 1126 (HY000): Can't open shared library 'fnv_udf.so' (errno: 22 fnv_udf.so: cannot open shared object file: No such file or directory)\n</code></pre> <p>Then you may need to copy the .so file to another location in your system. Try both <code>/lib</code> and <code>/usr/lib</code>. Look at your environment\u2019s <code>$LD_LIBRARY_PATH</code> variable for clues. If none is set, and neither <code>/lib</code> nor <code>/usr/lib</code> works, you may need to set <code>LD_LIBRARY_PATH</code> to <code>/lib</code> or <code>/usr/lib</code>.</p>"},{"location":"udf-percona-toolkit.html#other-reading","title":"Other reading","text":"<ul> <li>Percona Toolkit documentation</li> </ul>"},{"location":"uninstall-audit-log-filter.html","title":"Uninstall Audit Log Filter","text":"<p>The feature is in tech preview.</p> <p>To remove the plugin, run the following:</p> <pre><code>mysql&gt; DROP TABLE IF EXISTS mysql.audit_log_user;\nmysql&gt; DROP TABLE IF EXISTS mysql.audit_log_filter;\nmysql&gt; UNINSTALL PLUGIN audit_log_filter;\n</code></pre>"},{"location":"uninstall-component.html","title":"UNINSTALL COMPONENT","text":"<p>The <code>UNINSTALL COMPONENT</code> does the following:</p> <ul> <li>Deactivates the component</li> <li>Uninstalls the component</li> </ul> <p>If the statement does not undo any persisted variables. </p> <p>If an error, such as a misspelled component name, occurs, the statement fails and nothing happens.</p> <p>You can uninstall multiple components at the same time.</p>"},{"location":"uninstall-component.html#required-privilege","title":"Required privilege","text":"<p>The statement requires the <code>DELETE</code> privilege for the <code>mysql.component</code> system table. Executing the statement removes the registration row from this table. </p>"},{"location":"uninstall-component.html#example","title":"Example","text":"<p>The following is an example of the <code>UNINSTALL COMPONENT</code> statement.</p> <pre><code>mysql &gt; UNINSTALL COMPONENT 'file://componentA' ;\n</code></pre>"},{"location":"uninstall-data-masking-component.html","title":"Uninstall the data masking component","text":"<p>The following steps uninstall the component:</p> <ol> <li>Uninstall the component with <code>UNINSTALL_COMPONENT</code> and the loadable functions.</li> </ol> <pre><code>mysql&gt; UNINSTALL COMPONENT 'file://component_masking_functions';\n</code></pre> <ol> <li>Drop <code>masking_dictionaries</code>.</li> </ol> <pre><code>mysql&gt; DROP TABLE mysql.masking_dictionaries;\n</code></pre>"},{"location":"uninstall-data-masking-component.html#useful-links","title":"Useful links","text":"<p>Install the data masking component</p> <p>Data masking component functions</p>"},{"location":"upgrading-guide.html","title":"Percona Server for MySQL in-place upgrading guide: from 5.7 to 8.0","text":"<p>An in-place upgrade is performed by using existing data on the server and involves the following actions:</p> <ul> <li> <p>Stopping the MySQL 5.7 server</p> </li> <li> <p>Replacing the old binaries with MySQL 8.0 binaries</p> </li> <li> <p>Starting the MySQL 8.0 server with the same data files.</p> </li> </ul> <p>While an in-place upgrade may not be suitable for all environments, especially those environments with many variables to consider, the upgrade should work in most cases.</p> <p>The following list summarizes a number of the changes in the 8.0 series and has useful guides that can help you perform a smooth upgrade. We strongly recommend reading this information:</p> <ul> <li> <p>Upgrading MySQL</p> </li> <li> <p>Before You Begin</p> </li> <li> <p>Upgrade Paths</p> </li> <li> <p>Changes in MySQL 8.0</p> </li> <li> <p>Preparing your Installation for Upgrade</p> </li> <li> <p>MySQL 8 Minor Version Upgrades Are ONE-WAY Only</p> </li> <li> <p>Percona Utilities That Make Major MySQL Version Upgrades Easier</p> </li> <li> <p>Percona Server for MySQL 8.0 Release notes</p> </li> <li> <p>Upgrade Troubleshooting</p> </li> <li> <p>Rebuilding or Repairing Tables or Indexes</p> </li> </ul> <p>Review other Percona blogs that contain upgrade information.</p> <p>Implemented in release Percona Server for MySQL 8.0.15-5, Percona Server for MySQL uses the upstream implementation of binary log file encryption and relay log file encryption.</p> <p>The encrypt-binlog variable is removed, and the related command-line option \u2013encrypt-binlog is not supported. It is important to remove the encrypt-binlog variable from your configuration file before you attempt to upgrade either from another release in the Percona Server for MySQL 8.0 series or from Percona Server for MySQL 5.7. Otherwise, a server boot error is generated and reports an unknown variable.</p> <p>The implemented binary log file encryption is compatible with the older format. The encrypted binary log file used in a previous version of MySQL 8.0 series or Percona Server for MySQL series is supported.</p> <p>Before you start the upgrade process, it is recommended to make a full backup of your database. Copy the database configuration file, for example, <code>my.cnf</code>, to another directory to save it.</p> <p>Warning</p> <p>Do not upgrade from 5.7 to 8.0 on a crashed instance. If the server instance has crashed, run the crash recovery before proceeding with the upgrade.</p> <p>You can select one of the following ways to upgrade Percona Server for MySQL from 5.7 to 8.0:</p> <ul> <li> <p>Upgrading using the Percona repositories</p> </li> <li> <p>Upgrading from Systems that Use the MyRocks or TokuDB Storage Engine and Partitioned Tables</p> </li> <li> <p>Upgrading using Standalone Packages</p> </li> </ul>"},{"location":"upgrading-tokudb-myrocks.html","title":"Upgrade from systems that use the MyRocks or TokuDB storage engine and partitioned tables","text":"<p>Due to the limitation imposed by MySQL, the storage engine provides support for partitioning. MySQL 8.0 only provides support for partitioned table for the InnoDB storage engine.</p> <p>If you use partitioned tables with the MyRocks or TokuDB storage engine, the upgrade may fail if you do not enable the native partitioning provided by the storage engine.</p> <p>TokuDB is deprecated. For more information, see TokuDB Introduction.</p> <p>Before you attempt the upgrade, check whether you have any tables that are not using the native partitioning.</p> <pre><code>$ mysqlcheck -u root --all-databases --check-upgrade\n</code></pre> <p>If tables are found, mysqlcheck issues a warning:</p> <p>Enable either the rocksdb_enable_native_partition variable or the tokudb_enable_native_partition variable depending on the storage engine and restart the server.</p> <p>Your next step is to alter the tables that are not using the native partitioning with the <code>UPGRADE PARTITIONING</code> clause:</p> <pre><code>ALTER TABLE &lt;table-name&gt; UPGRADE PARTITIONING\n</code></pre> <p>Complete these steps for each table that mysqlcheck list. Otherwise, the upgrade to 8.0 fails and your error log contains messages like the following:</p> <pre><code>2018-12-17T18:34:14.152660Z 2 [ERROR] [MY-013140] [Server] The 'partitioning' feature is not available; you need to remove '--skip-partition' or use MySQL built with '-DWITH_PARTITION_STORAGE_ENGINE=1'\n2018-12-17T18:34:14.152679Z 2 [ERROR] [MY-013140] [Server] Can't find file: './comp_test/t1_RocksDB_lz4.frm' (errno: 0 - Success)\n2018-12-17T18:34:14.152691Z 2 [ERROR] [MY-013137] [Server] Can't find file: './comp_test/t1_RocksDB_lz4.frm' (OS errno: 0 - Success)\n</code></pre>"},{"location":"upgrading-tokudb-myrocks.html#perform-a-distribution-upgrade-in-place-on-a-system-with-installed-percona-packages","title":"Perform a distribution upgrade in-place on a system with installed Percona packages","text":"<p>The following is the recommended process for performing a distribution upgrade on a system with the Percona packages installed:</p> <ol> <li> <p>Record the installed Percona packages.</p> </li> <li> <p>Back up the data and configurations.</p> </li> <li> <p>Uninstall the Percona packages without removing the configuration file or data.</p> </li> <li> <p>Perform the upgrade by following the distribution upgrade instructions</p> </li> <li> <p>Reboot the system.</p> </li> <li> <p>Install the Percona packages intended for the upgraded version of the distribution.</p> </li> </ol>"},{"location":"upgrading-using-percona-repos.html","title":"Upgrade using the Percona repositories","text":"<p>Upgrading using the Percona repositories is the easiest and recommended way.</p> <p>Find the instructions on how to enable the repositories in the following documents:</p> <ul> <li> <p>Percona APT Repository</p> </li> <li> <p>Percona RPM Repository</p> </li> </ul>"},{"location":"upgrading-using-percona-repos.html#deb-based-distributions","title":"DEB-based distributions","text":"<p>Run the following commands as root or by using the sudo command.</p> <ol> <li> <p>Make a full backup (or dump if possible) of your database. Move the database configuration file, <code>my.cnf</code>, to another direction to save it.</p> </li> <li> <p>Stop the server with <code>/etc/init.d/mysql stop</code>.</p> <p>Note</p> <p>If you are running Debian/Ubuntu system with systemd as the default system and service manager, you can invoke the above command with systemctlinstead of service. Currently, both are supported.</p> </li> <li> <p>Do the required modifications in the database configuration file <code>my.cnf</code>.</p> </li> <li> <p>Install Percona Server for MySQL:</p> <pre><code>$ sudo dpkg -i *.deb\n</code></pre> </li> <li> <p>Enable the repository:</p> <pre><code>$ percona-release enable ps-80 release\n$ apt-get update\n</code></pre> </li> <li> <p>Install the server package:</p> <pre><code>$ apt-get install percona-server-server\n</code></pre> </li> <li> <p>Install the storage engine packages.</p> <p>TokuDB is deprecated and removed in Percona Server for MySQL 8.0.28-19. For more information, see TokuDB Introduction. If you used the TokuDB storage engine in Percona Server for MySQL 5.7, install the <code>percona-server-tokudb</code> package:</p> <pre><code>$ apt install percona-server-tokudb\n</code></pre> <p>If you used the MyRocks storage engine in Percona Server for MySQL 5.7, install the <code>percona-server-rocksdb</code> package:</p> <pre><code>$ apt install percona-server-rocksdb\n</code></pre> </li> <li> <p>Running the upgrade:</p> <p>Starting with Percona Server for MySQL 8.0.16-7, the mysql_upgrade is deprecated. The functionality was moved to the mysqld binary which automatically runs the upgrade process if needed. If you attempt to run mysql_upgrade, no operation starts and the following message appears: \u201cThe mysql_upgrade client is now deprecated. The actions executed by the upgrade client are now done by the server.\u201d To find more information, see MySQL Upgrade Process Upgrades</p> <p>If you are upgrading to a Percona Server for MySQL version before 8.0.16-7, the installation script will NOT run automatically mysql_upgrade. You must run the mysql_upgrade manually.</p> <pre><code>$ mysql_upgrade\n</code></pre> Expected output <pre><code>Checking if update is needed.\nChecking server version.\nRunning queries to upgrade MySQL server.\nChecking system database.\nmysql.columns_priv                                 OK\nmysql.db                                           OK\nmysql.engine_cost                                  OK\n...\nUpgrade process completed successfully.\nChecking if update is needed.\n</code></pre> </li> <li> <p>Restart the service </p> <p><pre><code>$ sudo systemctl restart mysqld\n</code></pre> After the service has been successfully restarted you can use the new Percona Server for MySQL 8.0.</p> </li> </ol>"},{"location":"upgrading-using-percona-repos.html#rpm-based-distributions","title":"RPM-based distributions","text":"<p>Run the following commands as root or by using the sudo command.</p> <ol> <li> <p>Make a full backup (or dump if possible) of your database. Copy the database configuration file, for example, <code>my.cnf</code>, to another directory to save it.</p> </li> <li> <p>Stop the server with <code>/etc/init.d/mysql stop</code>.</p> <p>Note</p> <p>If you are running RHEL/CentOS system with systemd as the default system and service manager you can invoke the above command with systemctl instead of service. Currently, both are supported.</p> </li> <li> <p>Check your installed packages with <code>rpm -qa | grep Percona-Server</code>.</p> </li> <li> <p>Remove the packages without dependencies. This command only removes the specified packages and leaves any dependent packages. The command does not prompt for confirmation:</p> <pre><code>$ rpm -qa | grep Percona-Server | xargs rpm -e --nodeps\n</code></pre> <p>It is important to remove the packages without dependencies as many packages may depend on these (as they replace <code>mysql</code>) and will be removed if omitted.</p> <p>Substitute <code>grep \u2018^mysql-\u2018</code> for <code>grep \u2018Percona-Server\u2019</code> in the previous command and remove the listed packages.</p> </li> <li> <p>Install the <code>percona-server-server</code> package:</p> <pre><code>$ yum install percona-server-server\n</code></pre> </li> <li> <p>Install the storage engine packages.</p> <p>TokuDB is deprecated and removed in Percona Server for MySQL 8.0.28-19. For more information, see TokuDB Introduction. If you used TokuDB storage engine in Percona Server for MySQL 5.7, install the <code>percona-server-tokudb</code> package:</p> <pre><code>$ yum install percona-server-tokudb\n</code></pre> <p>If you used the MyRocks storage engine in Percona Server for MySQL 5.7, install the <code>percona-server-rocksdb</code> package:</p> <pre><code>$ apt-get install percona-server-rocksdb\n</code></pre> </li> <li> <p>Modify your configuration file, <code>my.cnf</code>, and reinstall the plugins if necessary.</p> <p>Note</p> <p>If you are using the TokuDB storage engine you must comment out all the TokuDB specific variables in your configuration file(s) before starting the server, otherwise, the server is not able to start. RHEL/CentOS  automatically creates a backup of the previous configuration file to <code>/etc/my.cnf.rpmsave</code> and installs the default <code>my.cnf</code>. After the upgrade/install process completes and after you have removed any unsupported system variables,  you can move the old configuration file back.</p> </li> <li> <p>Running the upgrade</p> <p>Starting with Percona Server 8.0.16-7, the mysql_upgrade is deprecated. The functionality was moved to the mysqld binary which automatically runs the upgrade process if needed. If you attempt to run mysql_upgrade, no operation happens and the following message appears: \u201cThe mysql_upgrade client is now deprecated. The actions executed by the upgrade client are now done by the server.\u201d To find more information, see MySQL Upgrade Process Upgrades</p> <p>If you are upgrading to a Percona Server for MySQL version before 8.0.16-7, you can start the mysql service using service mysql start. Use mysql_upgrade to migrate to the new grant tables. The mysql_upgrade rebuilds the required indexes and does the required modifications:</p> <pre><code>$ mysql_upgrade\n</code></pre> </li> <li> <p>Restart the service.</p> <pre><code>$ systemctl mysql restart`.\n</code></pre> </li> </ol> <p>After the service has been successfully restarted you can use the Percona Server for MySQL 8.0.</p>"},{"location":"upgrading-using-standalone-packages.html","title":"Upgrade using Standalone Packages","text":""},{"location":"upgrading-using-standalone-packages.html#deb-based-distributions","title":"DEB-based distributions","text":"<ol> <li> <p>Make a full backup (or dump if possible) of your database. Move the database configuration file, <code>my.cnf</code>, to another direction to save it.</p> </li> <li> <p>Stop the server with <code>/etc/init.d/mysql stop</code>.</p> </li> <li> <p>Remove the installed packages with their dependencies: <code>apt-get autoremove percona-server percona-client</code></p> </li> <li> <p>Do the required modifications in the database configuration file <code>my.cnf</code>.</p> </li> <li> <p>Download the following packages for your architecture:</p> <ul> <li> <p><code>percona-server-server</code></p> </li> <li> <p><code>percona-server-client</code></p> </li> <li> <p><code>percona-server-common</code></p> </li> <li> <p><code>libperconaserverclient21</code></p> </li> </ul> <p>The following example will download Percona Server for MySQL 8.0.29-21 release packages for Debian 11.0:</p> <pre><code>$ wget https://downloads.percona.com/downloads/Percona-Server-LATEST/Percona-Server-8.0.29-21/binary/debian/bullseye/x86_64/Percona-Server-8.0.29-21-rc59f87d2854-bullseye-x86_64-bundle.tar\n</code></pre> </li> <li> <p>Unpack the bundle to get the packages: <code>tar xvf Percona-Server-8.0.29-21-rc59f87d2854-bullseye-x86_64-bundle.tar</code></p> <p>After you unpack the bundle, you should see the following packages:</p> <pre><code>$ ls *.deb\n\nllibperconaserverclient21-dev_8.0.29-21-1.bullseye_amd64.deb  \npercona-server-dbg_8.0.29-21-1.bullseye_amd64.deb\nlibperconaserverclient21_8.0.29-21-1.bullseye_amd64.deb      \npercona-server-rocksdb_8.0.29-21-1.bullseye_amd64.deb\npercona-mysql-router_8.0.29-21-1.bullseye_amd64.deb\npercona-server-server_8.0.29-21-1.bullseye_amd64.deb\npercona-server-client_8.0.29-21-1.bullseye_amd64.deb     \npercona-server-source_8.0.29-21-1.bullseye_amd64.deb\npercona-server-common_8.0.29-21-1.bullseye_amd64.deb     \npercona-server-test_8.0.29-21-1.bullseye_amd64.deb\n</code></pre> </li> <li> <p>Install Percona Server for MySQL:</p> <pre><code>$ sudo dpkg -i *.deb\n</code></pre> <p>This will install all the packages from the bundle. Another option is to download/specify only the packages you need for running Percona Server for MySQL installation (<code>libperconaserverclient21_8.0.13-3.stretch_amd64.deb</code>, <code>percona-server-client-8.0.13-3.stretch_amd64.deb</code>, <code>percona-server-common-8.0.13-3.stretch_amd64.deb</code>, and <code>percona-server-server-8.0.13-3.stretch_amd64.deb</code>. Optionally you can install <code>percona-server-tokudb-8.0.13-3.stretch_amd64.deb</code> if you want TokuDB storage engine).</p> <p>Warning</p> <p>When installing packages manually, you must resolve all the dependencies and install missing packages yourself. At least the following packages should be installed before installing Percona Server for MySQL 8.0: * <code>libmecab2</code>, * <code>libjemalloc1</code>, * <code>zlib1g-dev</code>, * <code>libaio1</code>.</p> </li> <li> <p>Running the upgrade:</p> <p>Starting with Percona Server 8.0.16-7, the mysql_upgrade is deprecated. The functionality was moved to the mysqld binary which automatically runs the upgrade process, if needed. If you attempt to run mysql_upgrade, no operation happens and the following message appears: \u201cThe mysql_upgrade client is now deprecated. The actions executed by the upgrade client are now done by the server.\u201d To find more information, see MySQL Upgrade Process Upgrades</p> <p>If you are upgrading to a Percona Server for MySQL version before 8.0.16-7, the installation script will NOT run automatically mysql_upgrade. You must run the mysql_upgrade manually.</p> <pre><code>$ mysql_upgrade\n\nChecking if update is needed.\nChecking server version.\nRunning queries to upgrade MySQL server.\nChecking system database.\nmysql.columns_priv                                 OK\nmysql.db                                           OK\nmysql.engine_cost                                  OK\n...\nUpgrade process completed successfully.\nChecking if update is needed.\n</code></pre> </li> <li> <p>Restart the service with <code>service mysql restart</code>.</p> </li> </ol> <p>After the service has been successfully restarted you can use the new Percona Server for MySQL 8.0.</p>"},{"location":"upgrading-using-standalone-packages.html#rpm-based-distributions","title":"RPM-based distributions","text":"<ol> <li> <p>Make a full backup (or dump if possible) of your database. Move the database configuration file, <code>my.cnf</code>, to another direction to save it.</p> </li> <li> <p>Stop the server with <code>/etc/init.d/mysql stop</code>.</p> </li> <li> <p>Check the installed packages:</p> <pre><code>$ rpm -qa | grep percona-server\n</code></pre> Expected output <pre><code>percona-server-shared-8.0.29-21.1.el8.x86_64\npercona-server-shared-compat-8.0.29-21.1.el8.x86_64\npercona-server-client-8.0.29-21.1.el8.x86_64\npercona-server-server-8.0.29-21.1.el8.x86_64\n</code></pre> <p>You may have the <code>shared-compat</code> package, which is required for compatibility.</p> </li> <li> <p>Remove the packages without dependencies with <code>rpm -qa | grep percona-server | xargs rpm -e --nodeps</code>.</p> <p>It is important that you remove the packages without dependencies as many packages may depend on these (as they replace <code>mysql</code>) and will be removed if omitted.</p> <p>Substitute <code>grep \u2018^mysql-\u2018</code> for <code>grep \u2018Percona-Server\u2019</code> in the previous command and remove the listed packages.</p> </li> <li> <p>Download the packages of the desired series for your architecture from the download page. The easiest way is to download the bundle which contains all the packages. The following example will download Percona Server for MySQL 8.0.13-3 release packages for CentOS 7:</p> <pre><code>$ wget https://downloads.percona.com/downloads/Percona-Server-LATEST/Percona-Server-8.0.29-21/binary/redhat/8/x86_64/Percona-Server-8.0.29-21-rc59f87d2854-el8-x86_64-bundle.tar\n</code></pre> </li> <li> <p>Unpack the bundle to get the packages</p> <pre><code>$ tar xvf Percona-Server-8.0.29-21-rc59f87d2854-el8-x86_64-bundle.tar\n</code></pre> <p>After you unpack the bundle, you should see the following packages: <code>ls \\*.rpm</code></p> </li> <li> <p>Install Percona Server for MySQL:</p> <pre><code>$ rpm -ivh percona-server-server-8.0.29-21.1.el8.x86_64.rpm \\\n&gt; percona-server-client-8.0.29-21.1.el8.x86_64.rpm \\\n&gt; percona-server-shared-8.0.29-21.1.el8.x86_64.rpm \\\n&gt; percona-server-shared-compat-8.0.29-21.1.el8.x86_64.rpm\n</code></pre> <p>This command will install only packages required to run the Percona Server for MySQL 8.0. Optionally you can install the TokuDB storage engine by adding the <code>percona-server-tokudb-8.0.13-3.el7.x86_64.rpm</code> to the command above. You can find more information on how to install and enable the TokuDB storage in the TokuDB Installation guide.</p> </li> <li> <p>You can install all the packages (for debugging, testing, etc.) with <code>rpm -ivh \\*.rpm</code>.</p> <p>Note</p> <p>When manually installing packages, you must resolve all the dependencies and install missing ones.</p> </li> <li> <p>Modify your configuration file, <code>my.cnf</code>, and install the plugins if necessary. If you are using the TokuDB storage engine you must comment out all the TokuDB specific variables in your configuration file(s) before starting the server, otherwise, the server will not start. RHEL/CentOS 7 automatically backs up the previous configuration file to <code>/etc/my.cnf.rpmsave</code> and installs the default <code>my.cnf</code>. After the upgrade/install process completes you can move the old configuration file back (after you remove all the unsupported system variables).</p> </li> <li> <p>As the schema of the grant table has changed, the server must be started without reading them with <code>service mysql start</code>.</p> </li> <li> <p>Running the upgrade:</p> <p>Starting with Percona Server 8.0.16-7, the mysql_upgrade is deprecated. The functionality was moved to the mysqld binary which automatically runs the upgrade process if needed. If you attempt to run mysql_upgrade, no operation happens and the following message appears: \u201cThe mysql_upgrade client is now deprecated. The actions executed by the upgrade client are now done by the server.\u201d To find more information, see MySQL Upgrade Process Upgrades</p> <p>If you are upgrading to a Percona Server for MySQL version before 8.0.16-7, run mysql_upgrade to migrate to the new grant tables. mysql_upgrade will rebuild the required indexes and do the required modifications.</p> </li> <li> <p>Restart the server with <code>service mysql restart</code>.</p> <p>After the service has been successfully restarted you can use the new Percona Server for MySQL 8.0.</p> </li> </ol>"},{"location":"user-stats.html","title":"User statistics","text":"<p>This feature adds several <code>INFORMATION_SCHEMA</code> tables, several commands, and the userstat variable. The tables and commands can be used to understand the server activity better and identify the source of the load.</p> <p>The functionality is disabled by default and must be enabled by setting <code>userstat</code> to <code>ON</code>. It works by keeping several hash tables in memory. To avoid contention over global mutexes, each connection has its own local statistics, which are occasionally merged into the global statistics, and the local statistics are then reset to 0.</p>"},{"location":"user-stats.html#version-specific-information","title":"Version specific information","text":"<ul> <li>8.0.12-1: The feature was ported from Percona Server for MySQL 5.7.</li> </ul>"},{"location":"user-stats.html#other-information","title":"Other information","text":"<ul> <li>Author/Origin: Google; Percona added the <code>INFORMATION_SCHEMA</code> tables and the userstat variable.</li> </ul>"},{"location":"user-stats.html#system-variables","title":"System variables","text":""},{"location":"user-stats.html#userstat","title":"<code>userstat</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type BOOLEAN Default OFF Range ON/OFF <p>Enables or disables collection of statistics. The default is <code>OFF</code>, meaning no statistics are gathered. This is to ensure that the statistics collection doesn\u2019t cause any extra load on the server unless desired.</p>"},{"location":"user-stats.html#thread_statistics","title":"<code>thread_statistics</code>","text":"Option Description Command-line Yes Config file Yes Scope Global Dynamic Yes Data type BOOLEAN Default OFF Range ON/OFF <p>Enables or disables collection of thread statistics. The default is <code>OFF</code>, meaning no thread statistics are gathered. This is to ensure that the statistics collection doesn\u2019t cause any extra load on the server unless desired. The variable <code>userstat</code> must be enabled as well in order for thread statistics to be collected.</p>"},{"location":"user-stats.html#information_schema-tables","title":"INFORMATION_SCHEMA Tables","text":""},{"location":"user-stats.html#information_schemaclient_statistics","title":"<code>INFORMATION_SCHEMA.CLIENT_STATISTICS</code>","text":"Column Name Description \u2018CLIENT\u2019 \u2018The IP address or hostname from which the connection originated.\u2019 \u2018TOTAL_CONNECTIONS\u2019 \u2018The number of connections created for this client.\u2019 \u2018CONCURRENT_CONNECTIONS\u2019 \u2018The number of concurrent connections for this client.\u2019 \u2018CONNECTED_TIME\u2019 \u2018The cumulative number of seconds elapsed while there were connections from this client.\u2019 \u2018BUSY_TIME\u2019 \u2018The cumulative number of seconds there was activity on connections from this client.\u2019 \u2018CPU_TIME\u2019 \u2018The cumulative CPU time elapsed, in seconds, while servicing this client\u2019s connections.\u2019 \u2018BYTES_RECEIVED\u2019 \u2018The number of bytes received from this client\u2019s connections.\u2019 \u2018BYTES_SENT\u2019 \u2018The number of bytes sent to this client\u2019s connections.\u2019 \u2018BINLOG_BYTES_WRITTEN\u2019 \u2018The number of bytes written to the binary log from this client\u2019s connections.\u2019 \u2018ROWS_FETCHED\u2019 \u2018The number of rows fetched by this client\u2019s connections.\u2019 \u2018ROWS_UPDATED\u2019 \u2018The number of rows updated by this client\u2019s connections.\u2019 \u2018TABLE_ROWS_READ\u2019 \u2018The number of rows read from tables by this client\u2019s connections. (It may be different from ROWS_FETCHED.)\u2019 \u2018SELECT_COMMANDS\u2019 \u2018The number of SELECT commands executed from this client\u2019s connections.\u2019 \u2018UPDATE_COMMANDS\u2019 \u2018The number of UPDATE commands executed from this client\u2019s connections.\u2019 \u2018OTHER_COMMANDS\u2019 \u2018The number of other commands executed from this client\u2019s connections.\u2019 \u2018COMMIT_TRANSACTIONS\u2019 \u2018The number of COMMIT commands issued by this client\u2019s connections.\u2019 \u2018ROLLBACK_TRANSACTIONS\u2019 \u2018The number of ROLLBACK commands issued by this client\u2019s connections.\u2019 \u2018DENIED_CONNECTIONS\u2019 \u2018The number of connections denied to this client.\u2019 \u2018LOST_CONNECTIONS\u2019 \u2018The number of this client\u2019s connections that were terminated uncleanly.\u2019 \u2018ACCESS_DENIED\u2019 \u2018The number of times this client\u2019s connections issued commands that were denied.\u2019 \u2018EMPTY_QUERIES\u2019 \u2018The number of times this client\u2019s connections sent empty queries to the server.\u2019 <p>This table holds statistics about client connections. The Percona version of the feature restricts this table\u2019s visibility to users who have the <code>SUPER</code> or <code>PROCESS</code> privilege.</p> <p>For example:</p> <pre><code>mysql&gt;SELECT * FROM INFORMATION_SCHEMA.CLIENT_STATISTICS\\G\n</code></pre> Expected output <pre><code>*************************** 1. row ***************************\n                CLIENT: 10.1.12.30\n     TOTAL_CONNECTIONS: 20\nCONCURRENT_CONNECTIONS: 0\n        CONNECTED_TIME: 0\n             BUSY_TIME: 93\n              CPU_TIME: 48\n        BYTES_RECEIVED: 5031\n            BYTES_SENT: 276926\n   BINLOG_BYTES_WRITTEN: 217\n          ROWS_FETCHED: 81\n          ROWS_UPDATED: 0\n       TABLE_ROWS_READ: 52836023\n       SELECT_COMMANDS: 26\n       UPDATE_COMMANDS: 1\n        OTHER_COMMANDS: 145\n   COMMIT_TRANSACTIONS: 1\n ROLLBACK_TRANSACTIONS: 0\n    DENIED_CONNECTIONS: 0\n      LOST_CONNECTIONS: 0\n         ACCESS_DENIED: 0\n         EMPTY_QUERIES: 0\n</code></pre>"},{"location":"user-stats.html#information_schema-tables_1","title":"INFORMATION_SCHEMA tables","text":""},{"location":"user-stats.html#information_schemaindex_statistics","title":"<code>INFORMATION_SCHEMA.INDEX_STATISTICS</code>","text":"Column Name Description \u2018TABLE_SCHEMA\u2019 \u2018The schema (database) name.\u2019 \u2018TABLE_NAME\u2019 \u2018The table name.\u2019 \u2018INDEX_NAME\u2019 \u2018The index name (as visible in SHOW CREATE TABLE).\u2019 \u2018ROWS_READ\u2019 \u2018The number of rows read from this index.\u2019 <p>This table shows statistics on index usage. An older version of the feature contained a single column that had the <code>TABLE_SCHEMA</code>, <code>TABLE_NAME</code>, and <code>INDEX_NAME</code> columns concatenated together. The Percona version of the feature separates these into three columns. Users can see entries only for tables to which they have <code>SELECT</code> access.</p> <p>This table makes it possible to do many things that were difficult or impossible previously. For example, you can use it to find unused indexes and generate DROP commands to remove them.</p> <p>Example:</p> <pre><code>mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INDEX_STATISTICS WHERE TABLE_NAME='tables_priv';\n</code></pre> Expected output <pre><code>+--------------+-----------------------+--------------------+-----------+\n| TABLE_SCHEMA | TABLE_NAME            | INDEX_NAME         | ROWS_READ |\n+--------------+-----------------------+--------------------+-----------+\n| mysql        | tables_priv           | PRIMARY            |         2 |\n+--------------+-----------------------+--------------------+-----------+\n</code></pre> <p>Note</p> <p>The current implementation of index statistics doesn\u2019t support partitioned tables.</p>"},{"location":"user-stats.html#information_schematable_statistics","title":"<code>INFORMATION_SCHEMA.TABLE_STATISTICS</code>","text":"Column Name Description \u2018TABLE_SCHEMA\u2019 \u2018The schema (database) name.\u2019 \u2018TABLE_NAME\u2019 \u2018The table name.\u2019 \u2018ROWS_READ\u2019 \u2018The number of rows read from the table.\u2019 \u2018ROWS_CHANGED\u2019 \u2018The number of rows changed in the table.\u2019 \u2018ROWS_CHANGED_X_INDEXES\u2019 \u2018The number of rows changed in the table, multiplied by the number of indexes changed.\u2019 <p>This table is similar in function to the <code>INDEX_STATISTICS</code> table.</p> <p>For example:</p> <pre><code>mysql&gt; SELECT * FROM INFORMATION_SCHEMA.TABLE_STATISTICS WHERE TABLE_NAME=``tables_priv``;\n</code></pre> Expected output <pre><code>+--------------+-------------------------------+-----------+--------------+------------------------+\n| TABLE_SCHEMA | TABLE_NAME                    | ROWS_READ | ROWS_CHANGED | ROWS_CHANGED_X_INDEXES |\n+--------------+-------------------------------+-----------+--------------+------------------------+\n| mysql        | tables_priv                   |         2 |            0 |                      0 |\n+--------------+-------------------------------+-----------+--------------+------------------------+\n</code></pre> <p>Note</p> <p>The current implementation of table statistics doesn\u2019t support partitioned tables.</p>"},{"location":"user-stats.html#information_schemathread_statistics","title":"<code>INFORMATION_SCHEMA.THREAD_STATISTICS</code>","text":"Column Name Description \u2018THREAD_ID\u2019 \u2018Thread ID\u2019 \u2018TOTAL_CONNECTIONS\u2019 \u2018The number of connections created from this thread.\u2019 \u2018CONNECTED_TIME\u2019 \u2018The cumulative number of seconds elapsed while there were connections from this thread.\u2019 \u2018BUSY_TIME\u2019 \u2018The cumulative number of seconds there was activity from this thread.\u2019 \u2018CPU_TIME\u2019 \u2018The cumulative CPU time elapsed while servicing this thread.\u2019 \u2018BYTES_RECEIVED\u2019 \u2018The number of bytes received from this thread.\u2019 \u2018BYTES_SENT\u2019 \u2018The number of bytes sent to this thread.\u2019 \u2018BINLOG_BYTES_WRITTEN\u2019 \u2018The number of bytes written to the binary log from this thread.\u2019 \u2018ROWS_FETCHED\u2019 \u2018The number of rows fetched by this thread.\u2019 \u2018ROWS_UPDATED\u2019 \u2018The number of rows updated by this thread.\u2019 \u2018TABLE_ROWS_READ\u2019 \u2018The number of rows read from tables by this tread.\u2019 \u2018SELECT_COMMANDS\u2019 \u2018The number of SELECT commands executed from this thread.\u2019 \u2018UPDATE_COMMANDS\u2019 \u2018The number of UPDATE commands executed from this thread.\u2019 \u2018OTHER_COMMANDS\u2019 \u2018The number of other commands executed from this thread.\u2019 \u2018COMMIT_TRANSACTIONS\u2019 \u2018The number of COMMIT commands issued by this thread.\u2019 \u2018ROLLBACK_TRANSACTIONS\u2019 \u2018The number of ROLLBACK commands issued by this thread.\u2019 \u2018DENIED_CONNECTIONS\u2019 \u2018The number of connections denied to this thread.\u2019 \u2018LOST_CONNECTIONS\u2019 \u2018The number of thread connections that were terminated uncleanly.\u2019 \u2018ACCESS_DENIED\u2019 \u2018The number of times this thread issued commands that were denied.\u2019 \u2018EMPTY_QUERIES\u2019 \u2018The number of times this thread sent empty queries to the server.\u2019 \u2018TOTAL_SSL_CONNECTIONS\u2019 \u2018The number of thread connections that used SSL.\u2019 <p>In order for this table to be populated with statistics, the additional variable thread_statistics should be set to <code>ON</code>.</p>"},{"location":"user-stats.html#information_schemauser_statistics","title":"<code>INFORMATION_SCHEMA.USER_STATISTICS</code>","text":"Column Name Description \u2018USER\u2019 \u2018The username. The value #mysql_system_user# appears when there is no username (such as for the replica SQL thread).\u2019 \u2018TOTAL_CONNECTIONS\u2019 \u2018The number of connections created from this user.\u2019 \u2018CONCURRENT_CONNECTIONS\u2019 \u2018The number of concurrent connections for this user.\u2019 \u2018CONNECTED_TIME\u2019 \u2018The cumulative number of seconds elapsed while there were connections from this user.\u2019 \u2018BUSY_TIME\u2019 \u2018The cumulative number of seconds there was activity on connections from this user.\u2019 \u2018CPU_TIME\u2019 \u2018The cumulative CPU time elapsed, in seconds, while servicing this user\u2019s connections.\u2019 \u2018BYTES_RECEIVED\u2019 \u2018The number of bytes received from this user\u2019s connections.\u2019 \u2018BYTES_SENT\u2019 \u2018The number of bytes sent to this user\u2019s connections.\u2019 \u2018BINLOG_BYTES_WRITTEN\u2019 \u2018The number of bytes written to the binary log from this user\u2019s connections.\u2019 \u2018ROWS_FETCHED\u2019 \u2018The number of rows fetched by this user\u2019s connections.\u2019 \u2018ROWS_UPDATED\u2019 \u2018The number of rows updated by this user\u2019s connections.\u2019 \u2018TABLE_ROWS_READ\u2019 \u2018The number of rows read from tables by this user\u2019s connections. (It may be different from ROWS_FETCHED.)\u2019 \u2018SELECT_COMMANDS\u2019 \u2018The number of SELECT commands executed from this user\u2019s connections.\u2019 \u2018UPDATE_COMMANDS\u2019 \u2018The number of UPDATE commands executed from this user\u2019s connections.\u2019 \u2018OTHER_COMMANDS\u2019 \u2018The number of other commands executed from this user\u2019s connections.\u2019 \u2018COMMIT_TRANSACTIONS\u2019 \u2018The number of COMMIT commands issued by this user\u2019s connections.\u2019 \u2018ROLLBACK_TRANSACTIONS\u2019 \u2018The number of ROLLBACK commands issued by this user\u2019s connections.\u2019 \u2018DENIED_CONNECTIONS\u2019 \u2018The number of connections denied to this user.\u2019 \u2018LOST_CONNECTIONS\u2019 \u2018The number of this user\u2019s connections that were terminated uncleanly.\u2019 \u2018ACCESS_DENIED\u2019 \u2018The number of times this user\u2019s connections issued commands that were denied.\u2019 \u2018EMPTY_QUERIES\u2019 \u2018The number of times this user\u2019s connections sent empty queries to the server.\u2019 <p>This table contains information about user activity. The Percona version of the patch restricts this table\u2019s visibility to users who have the <code>SUPER</code> or <code>PROCESS</code> privilege.</p> <p>The table gives answers to questions such as which users cause the most load, and whether any users are being abusive. It also lets you measure how close to capacity the server may be. For example, you can use it to find out whether replication is likely to start falling behind.</p> <p>Example:</p> <pre><code>mysql&gt;SELECT * FROM INFORMATION_SCHEMA.USER_STATISTICS\\G\n</code></pre> Expected output <pre><code>*************************** 1. row ***************************\n                  USER: root\n     TOTAL_CONNECTIONS: 5592\n CONCURRENT_CONNECTIONS: 0\n         CONNECTED_TIME: 6844\n             BUSY_TIME: 179\n              CPU_TIME: 72\n        BYTES_RECEIVED: 603344\n            BYTES_SENT: 15663832\n  BINLOG_BYTES_WRITTEN: 217\n          ROWS_FETCHED: 9793\n          ROWS_UPDATED: 0\n       TABLE_ROWS_READ: 52836023\n       SELECT_COMMANDS: 9701\n       UPDATE_COMMANDS: 1\n        OTHER_COMMANDS: 2614\n   COMMIT_TRANSACTIONS: 1\n ROLLBACK_TRANSACTIONS: 0\n    DENIED_CONNECTIONS: 0\n      LOST_CONNECTIONS: 0\n         ACCESS_DENIED: 0\n         EMPTY_QUERIES: 0\n</code></pre>"},{"location":"user-stats.html#commands-provided","title":"Commands Provided","text":"<ul> <li> <p><code>FLUSH CLIENT_STATISTICS</code></p> </li> <li> <p><code>FLUSH INDEX_STATISTICS</code></p> </li> <li> <p><code>FLUSH TABLE_STATISTICS</code></p> </li> <li> <p><code>FLUSH THREAD_STATISTICS</code></p> </li> <li> <p><code>FLUSH USER_STATISTICS</code></p> </li> </ul> <p>These commands discard the specified type of stored statistical information.</p> <ul> <li> <p><code>SHOW CLIENT_STATISTICS</code></p> </li> <li> <p><code>SHOW INDEX_STATISTICS</code></p> </li> <li> <p><code>SHOW TABLE_STATISTICS</code></p> </li> <li> <p><code>SHOW THREAD_STATISTICS</code></p> </li> <li> <p><code>SHOW USER_STATISTICS</code></p> </li> </ul> <p>These commands are another way to display the information you can get from the <code>INFORMATION_SCHEMA</code> tables. The commands accept <code>WHERE</code> clauses. They also accept but ignore <code>LIKE</code> clauses.</p>"},{"location":"user-stats.html#status-variables","title":"Status Variables","text":""},{"location":"user-stats.html#com_show_client_statistics","title":"<code>Com_show_client_statistics</code>","text":"Option Description Scope Global/Session Data type numeric <p>The Com_show_client_statistics statement counter variable indicates the number of times the statement <code>SHOW CLIENT_STATISTICS</code> has been executed.</p>"},{"location":"user-stats.html#com_show_index_statistics","title":"<code>Com_show_index_statistics</code>","text":"Option Description Scope Global/Session Data type numeric <p>The Com_show_index_statistics statement counter variable indicates the number of times the statement <code>SHOW INDEX_STATISTICS</code> has been executed.</p>"},{"location":"user-stats.html#com_show_table_statistics","title":"<code>Com_show_table_statistics</code>","text":"Option Description Scope Global/Session Data type numeric <p>The Com_show_table_statistics statement counter variable indicates the number of times the statement <code>SHOW TABLE_STATISTICS</code> has been executed.</p>"},{"location":"user-stats.html#com_show_thread_statistics","title":"<code>Com_show_thread_statistics</code>","text":"Option Description Scope Global/Session Data type numeric <p>The Com_show_thread_statistics statement counter variable indicates the number of times the statement <code>SHOW THREAD_STATISTICS</code> has been executed.</p>"},{"location":"user-stats.html#com_show_user_statistics","title":"<code>Com_show_user_statistics</code>","text":"Option Description Scope Global/Session Data type numeric <p>The Com_show_user_statistics statement counter variable indicates the number of times the statement <code>SHOW USER_STATISTICS</code> has been executed.</p>"},{"location":"using-amz-kms.html","title":"Use the Amazon Key Management Service (AWS KMS)","text":"<p>As of Percona Server for MySQL 8.0.30-22, the <code>Amazon Key Management Service (AWS KMS)</code> feature is Generally Available (GA). </p> <p>Percona Server for MySQL 8.0.28-20 adds support for the Amazon Key Management Service (AWS KMS). Percona Server generates the keyring keys. Amazon Web Services (AWS) encrypts the keyring data.</p> <p>The AWS KMS lets you create and manage cryptographic keys across AWS services. For more information, see the AWS Key Management Service Documentation.</p> <p>To use the AWS KMS component, do the following:</p> <ul> <li> <p>Have an AWS user account. This account has an access key and a secret key.</p> </li> <li> <p>Create a KMS key ID. The KMS key can then be referenced in the configuration either by its ID, alias (the key can have any number of aliases), or ARN.</p> </li> </ul>"},{"location":"using-amz-kms.html#component-installation","title":"Component installation","text":"<p>You should only load the AWS KMS component with a manifest file. The server uses this manifest file and the component consults its configuration file during initialization.</p> <p>For more information, see Installing and Uninstalling Components</p> <p>You should create a global manifest file named <code>mysqld.my</code> in the installation directory and, optionally, create a local manifest file, also named <code>mysqld.my</code> in a data directory.</p> <p>To install a KMS component, do the following:</p> <ol> <li> <p>Write a manifest in a valid JSON format</p> </li> <li> <p>Write a configuration file</p> </li> </ol> <p>A manifest file indicates which component to load. The server does not load the component if the manifest file associated with the component does not exist. During startup, the server reads the global manifest file from the installation directory. The global manifest file can contain the required information or point to a local manifest file located in the data directory. If you have multiple server instances that use different keyring components, use a local manifest file in each data directory to load the correct keyring component for that instance.</p> <p>Note</p> <p>Enable only one keyring plugin or one keyring component at a time for each server instance. Enabling multiple keyring plugins or keyring components or mixing keyring plugins or keyring components is not supported and may result in data loss.</p> <p>The following example is a global manifest file that does not use local manifests:</p> <pre><code>{\n \"read_local_manifest\": false,\n \"components\": \"file:///component_keyring_kmip\"\n}\n</code></pre> <p>The following is an example of a global manifest file that points to a local manifest file:</p> <pre><code>{\n \"read_local_manifest\": true\n}\n</code></pre> <p>The following is an example of a local manifest file:</p> <pre><code>{\n \"components\": \"file:///component_keyring_kmip\"\n}\n</code></pre> <p>The configuration settings are either in a global configuration file or a local configuration file. The settings are the same.</p> <p>The KMS configuration file has the following options:</p> <ul> <li> <p>read_local_config</p> </li> <li> <p>path - the location of the JSON keyring database file.</p> </li> <li> <p>read_only - if true, the keyring cannot be modified.</p> </li> <li> <p>kms_key - the identifier of an AWS KMS master key. This key must be created by the user before creating the manifest file. The identifier can be one of the following:</p> <ul> <li> <p>UUID</p> </li> <li> <p>Alias</p> </li> <li> <p>ARN</p> </li> </ul> </li> </ul> <p>For more information, see Finding the key ID and key ARN.</p> <ul> <li> <p>region - the AWS where the KMS is stored. Any HTTP request connect to this region.</p> </li> <li> <p>auth_key - an AWS user authentication key. The user must have access to the KMS key.</p> </li> <li> <p>secret_access_key - the secret key (API \u201cpassword\u201d) for the AWS user.</p> </li> </ul> <p>Note</p> <p>The configuration file contains authentication information. Only the MySQL process should be able to read this file.</p> <p>The following JSON is an example of a configuration file:</p> <pre><code>{\n \"read_local_config\": \"true/false\",\n \"path\": \"/usr/local/mysql/keyring-mysql/aws-keyring-data\",\n \"region\": \"eu-central-1\",\n \"kms_key\": \"UUID, alias or ARN as displayed by the KMS console\",\n \"auth_key\": \"AWS user key\",\n \"secret_access_key\": \"AWS user secret key\"\n}\n</code></pre> <p>For more information, see Keyring Component installation</p>"},{"location":"using-keyring-plugin.html","title":"Use the keyring component or keyring plugin","text":"<p>The <code>keyring_vault</code> plugin can store the encryption keys inside the HashiCorp Vault.</p> <p>See also</p> <p>Hashicorp Documentation: Installing Vault Hashicorp Documentation: Production Hardening</p> <p>Percona Server for MySQL may use either of the following plugins:</p> <ul> <li> <p>keyring_file stores the keyring data locally</p> </li> <li> <p>keyring_vault provides an interface for the database with a HashiCorp Vault server to store key and secure encryption keys.</p> </li> </ul> <p>Note</p> <p>The <code>keyring_file</code> plugin should not be used for regulatory compliance.</p> <p>To install the plugin, follow the installing and uninstalling plugins instructions.</p>"},{"location":"using-keyring-plugin.html#load-the-keyring-plugin","title":"Load the keyring plugin","text":"<p>You should load the plugin at server startup with the <code>-early-plugin-load</code> option to enable keyrings.</p> <p>Warning</p> <p>Only one keyring plugin should be enabled at a time. Enabling multiple keyring plugins is not supported and may result in data loss.</p> <p>We recommend that you load the plugin in the configuration file to facilitate recovery for encrypted tables. Also, the redo log encryption and the undo log encryption cannot be used without <code>--early-plugin-load</code>. The normal plugin load happens too late in startup.</p> <p>Note</p> <p>The keyring_vault extension, \u201c.so\u201d and the file location for the vault configuration should be changed to match your operating system\u2019s extension and the file location in your operating system.</p> <p>To use the keyring_vault, you can add this option to your configuration file:</p> <pre><code>[mysqld]\nearly-plugin-load=\"keyring_vault=keyring_vault.so\"\nloose-keyring_vault_config=\"/home/mysql/keyring_vault.conf\"\n\nThe keyring_vault extension, \".so\" and the file location for the vault\nconfiguration should be changed to match your operating system's extension\nand operating system location.\n</code></pre> <p>You could also run the following command which loads the keyring_file plugin:</p> <pre><code>$ mysqld --early-plugin-load=\"keyring_file=keyring_file.so\"\n</code></pre> <p>Note</p> <p>If a server starts with different plugins loaded early, the <code>--early-plugin-load</code> option should contain the plugin names in a double-quoted list with each plugin name separated by a semicolon. The use of double quotes ensures the semicolons do not create issues when the list is executed in a script.</p> <p>Apart from installing the plugin you also must set the keyring_vault_config variable to point to the keyring_vault configuration file.</p> <p>The keyring_vault_config file has the following information:</p> <ul> <li> <p><code>vault_url</code> - the Vault server address</p> </li> <li> <p><code>secret_mount_point</code> - the mount point name where the keyring_vault stores the keys.</p> </li> <li> <p><code>secret_mount_point_version</code> - the <code>KV Secrets Engine version (kv or kv-v2)</code> used. Implemented in Percona Server for MySQL 8.0.23-14.</p> </li> <li> <p><code>token</code> - a token generated by the Vault server</p> </li> <li> <p><code>vault_ca [optional]</code> - if the machine does not trust the Vault\u2019s CA certificate, this variable points to the CA certificate used to sign the Vault\u2019s certificates</p> </li> </ul> <p>This is an example of a configuration file:</p> <pre><code>vault_url = https://vault.public.com:8202\nsecret_mount_point = secret\nsecret_mount_point_version = AUTO\ntoken = 58a20c08-8001-fd5f-5192-7498a48eaf20\nvault_ca = /data/keyring_vault_confs/vault_ca.crt\n</code></pre> <p>Warning</p> <p>Each <code>secret_mount_point</code> must be used by only one server. If multiple servers use the same secret_mount_point, the behavior is unpredictable.</p> <p>The first time a key is fetched from a keyring, the keyring_vault communicates with the Vault server to retrieve the key type and data.</p>"},{"location":"using-keyring-plugin.html#secret_mount_point_version-information","title":"secret_mount_point_version information","text":"<p>Implemented in Percona Server for MySQL 8.0.23-14, the <code>secret_mount_point_version</code> can be either a <code>1</code>, <code>2</code>, <code>AUTO</code>, or the <code>secret_mount_point_version</code> parameter is not listed in the configuration file.</p> Value Description 1 Works with <code>KV Secrets Engine - Version 1 (kv)</code>. When forming key operation URLs, the <code>secret_mount_point</code> is always used without any transformations. For example, to return a key named <code>skey</code>, the URL is /v1//skey 2 Works with <code>KV Secrets Engine - Version 2 (kv)</code> The initialization logic splits the <code>secret_mount_point</code> parameter into two parts:<ul><li>The <code>mount_point_path</code> - the mount path under which the Vault Server secret was created</li><li>The <code>directory_path</code> - a virtual directory suffix that can be used to create virtual namespaces with the same real mount point</li></ul> For example, both the <code>mount_point_path</code> and the <code>directory_path</code> are needed to form key access URLs: /v1/&lt;mount_point_path/data//skey AUTO An autodetection mechanism probes and determines if the secrets engine version is <code>kv</code> or <code>kv-v2</code> and based on the outcome will either use the <code>secret_mount_point</code> as is, or split the <code>secret_mount_point</code> into two parts. Not listed If the <code>secret_mount_point_version</code> is not listed in the configuration file, the behavior is the same as <code>AUTO</code>. <p>If you set the <code>secret_mount_point_version</code> to <code>2</code> but the path pointed by <code>secret_mount_point</code> is based on <code>KV Secrets Engine - Version 1 (kv)</code>, an error is reported and the plugin fails to initialize.</p> <p>If you set the <code>secret_mount_point_version</code> to <code>1</code> but the path pointed by <code>secret_mount_point</code> is based on <code>KV Secrets Engine - Version 2 (kv-v2)</code>, the plugin initialization succeeds but any MySQL keyring-related operations fail.</p>"},{"location":"using-keyring-plugin.html#upgrade-from-8022-13-or-earlier-to-8023-14-or-later","title":"Upgrade from 8.0.22-13 or earlier to 8.0.23-14 or later","text":"<p>The <code>keyring_vault</code> plugin configuration files created before Percona Server for MySQL 8.0.23-14 work only with <code>KV Secrets Engine - Version 1 (kv)</code> and do not have the <code>secret_mount_point_version</code> parameter. After the upgrade to 8.0.23-14 or later, the <code>secret_mount_point_version</code> is implicitly considered <code>AUTO</code> and the information is probed and the secrets engine version is determined to <code>1</code>.</p>"},{"location":"using-keyring-plugin.html#upgrade-from-vault-secrets-engine-version-1-to-version-2","title":"Upgrade from Vault Secrets Engine Version 1 to Version 2","text":"<p>You can upgrade from the Vault Secrets Engine Version 1 to Version 2. Use either of the following methods:</p> <ul> <li> <p>Set the <code>secret_mount_point_version</code> to <code>AUTO</code> or the variable is not set in the <code>keyring_vault</code> plugin configuration files in all Percona Servers. The <code>AUTO</code> value ensures the autodetection mechanism is invoked during the plugin initialization.</p> </li> <li> <p>Set the <code>secret_mount_point_version</code> to <code>2</code> to ensure that plugins do not initialize unless the <code>kv</code> to <code>kv-v2</code> upgrade completes.</p> </li> </ul> <p>Note</p> <p>The <code>keyring_vault</code> plugin that works with <code>kv-v2</code> secret engines does not use the built-in key versioning capabilities. The keyring key versions are encoded into key names.</p>"},{"location":"using-keyring-plugin.html#kv-secret-engine-considerations-for-upgrading-from-57-to-80","title":"KV Secret Engine considerations for upgrading from 5.7 to 8.0","text":"<p>When you upgrade from Percona Server for MySQL 5.7.32 or older, you can only use <code>KV Secrets Engine 1 (kv)</code>. You can upgrade to any version of Percona Server for MySQL 8.0. Both the old <code>keyring_vault</code> plugin and new <code>keyring_vault</code> plugin work correctly with the existing Vault Server data under the existing <code>keyring_vault</code> plugin configuration file.</p> <p>If you upgrade from Percona Server for MySQL 5.7.33 or newer, you have the following options:</p> <ul> <li> <p>If you are using <code>KV Secrets Engine 1 (kv)</code> you can upgrade with any version of Percona Server for MySQL 8.0.</p> </li> <li> <p>If you are using <code>KV Secrets Engine 2 (kv-v2)</code> you can upgrade with Percona Server for MySQL 8.0.23 or newer. Percona Server for MySQL 8.0.23.14 is the first version of the 8.0 series which has the <code>keyring_vault</code> plugin that supports <code>kv-v2</code>.</p> </li> </ul> <p>A user-created key deletion is only possible with the use of the keyring_udf plugin and deletes the key from the in-memory hash map and the Vault server. You cannot delete system keys, such as the master key.</p> <p>This plugin supports the SQL interface for keyring key management described in the General-Purpose Keyring Key-Management Functions manual.</p> <p>The plugin library contains keyring user-defined functions which allow access to the internal keyring service functions. To enable the functions, you must enable the <code>keyring_udf</code> plugin:</p> <pre><code>mysql&gt; INSTALL PLUGIN keyring_udf SONAME 'keyring_udf.so';\n</code></pre> <p>Note</p> <p>The <code>keyring_udf</code> plugin must be installed. Using the user-defined functions without the <code>keyring_udf</code> plugin generates an error.</p> <p>You must also create keyring encryption user-defined functions.</p>"},{"location":"using-keyring-plugin.html#use-the-keyring_file-component","title":"Use the keyring_file component","text":"<p>See keyring component installation for information on installing the component.</p> <p>Warning</p> <p>The <code>keyring_file</code> component should not be used for regulatory compliance. </p> <p>See also</p> <p>MySQL Documentation: Using the keyring_file component</p>"},{"location":"using-keyring-plugin.html#system-variables","title":"System variables","text":""},{"location":"using-keyring-plugin.html#keyring_vault_config","title":"<code>keyring_vault_config</code>","text":"Option Description Command-line \u2013keyring-vault-config Scope Global Dynamic Yes Data type Text Default <p>This variable defines the location of the keyring_vault_plugin configuration file.</p>"},{"location":"using-keyring-plugin.html#keyring_vault_timeout","title":"<code>keyring_vault_timeout</code>","text":"Option Description Command-line \u2013keyring-vault-timeout Scope Global Dynamic Yes Data type Numeric Default 15 <p>Set the duration in seconds for the Vault server connection timeout. The default value is <code>15</code>. The allowed range is from <code>0</code> to <code>86400</code>. The timeout can be also disabled to wait an infinite amount of time by setting this variable to <code>0</code>.</p>"},{"location":"using-kmip.html","title":"Using the Key Management Interoperability Protocol (KMIP)","text":"<p>As of Percona Server for MySQL 8.0.30-22, the <code>Key Management Interoperability Protocol (KMIP)</code> feature is Generally Available (GA). </p> <p>Percona Server for MySQL 8.0.27-18 adds support for the OASIS Key Management Interoperability Protocol (KMIP). This implementation was tested with the PyKMIP server and the HashiCorp Vault Enterprise KMIP Secrets Engine.</p> <p>KMIP enables communication between key management systems and the database server. The protocol can do the following:</p> <ul> <li> <p>Streamline encryption key management</p> </li> <li> <p>Eliminate redundant key management processes</p> </li> </ul>"},{"location":"using-kmip.html#component-installation","title":"Component installation","text":"<p>The KMIP component must be installed with a manifest. A keyring component is not loaded with the <code>--early-plugin-load</code> option on the server. The server uses a manifest and the component consults its configuration file during initialization. You should only load a keyring component with a manifest file. Do not use the <code>INSTALL_COMPONENT</code> statement, which loads the keyring components too late in the startup sequence of the server. For example, <code>InnoDB</code> requires the component, but because the components are registered in the <code>mysql.component</code> table, this table is loaded after <code>InnoDB</code> initialization.</p> <p>You should create a global manifest file named <code>mysqld.my</code> in the installation directory and, optionally, create a local manifest file, also named <code>mysqld.my</code> in a data directory.</p> <p>To install a keyring component, you must do the following:</p> <ol> <li> <p>Write a manifest in a valid JSON format</p> </li> <li> <p>Write a configuration file</p> </li> </ol> <p>A manifest file indicates which component to load. If the manifest file does not exist, the server does not load the component associated with that file. During startup, the server reads the global manifest file from the installation directory. The global manifest file can contain the required information or point to a local manifest file located in the data directory. If you have multiple server instances that use different keyring components use a local manifest file in each data directory to load the correct keyring component for that instance.</p> <p>Note</p> <p>Enable only one keyring plugin or one keyring component at a time for each server instance. Enabling multiple keyring plugins or keyring components or mixing keyring plugins or keyring components is not supported and may result in data loss.</p> <p>The following is an example of a global manifest file that does not use local manifests:</p> <pre><code>{\n \"read_local_manifest\": false,\n \"components\": \"file://component_keyring_kmip\"\n}\n</code></pre> <p>The following is an example of a global manifest file that points to a local manifest file:</p> <pre><code>{\n \"read_local_manifest\": true\n}\n</code></pre> <p>The following is an example of a local manifest file:</p> <pre><code>{\n \"components\": \"file://component_keyring_kmip\"\n}\n</code></pre> <p>The configuration settings are either in a global configuration file or a local configuration file. The settings are the same. The following JSON example of a configuration file.</p> <pre><code>{\n \"server_addr\": \"127.0.0.1\",\n \"server_port\": \"5696\",\n \"client_ca\": \"client_certificate.pem\",\n \"client_key\": \"client_key.pem\",\n \"server_ca\": \"root_certificate.pem\"\n}\n</code></pre> <p>For more information, see Keyring Component installation</p>"},{"location":"using-tokudb.html","title":"Use TokuDB","text":"<p>Important</p> <p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds.</p> <p>Starting with Percona Server for MySQL 8.0.26-16, the binary builds and packages include but disable the TokuDB storage engine plugins. The tokudb_enabled option and the tokudb_backup_enabled option control the state of the plugins and have a default setting of FALSE. The result of attempting to load the plugins are the plugins fail to initialize and print a deprecation message.</p> <p>We recommend Migrating the data to the MyRocks storage engine. To enable the plugins to migrate to another storage engine, set the tokudb_enabled and tokudb_backup_enabled options to TRUE in your my.cnf file and restart your server instance. Then, you can load the plugins.</p> <p>The TokuDB storage engine was declared as deprecated in Percona Server for MySQL 8.0. For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p>"},{"location":"using-tokudb.html#fast-insertions-and-richer-indexes","title":"Fast Insertions and Richer Indexes","text":"<p>TokuDB\u2019s fast indexing enables fast queries through the use of rich indexes, such as covering and clustering indexes. It\u2019s worth investing some time to optimize index definitions to get the best performance from MySQL and TokuDB. Here are some resources to get you started:</p> <ul> <li> <p>\u201cUnderstanding Indexing\u201d by Zardosht Kasheff (video)</p> </li> <li> <p>Rule of Thumb for Choosing Column Order in Indexes</p> </li> <li> <p>Covering Indexes: Orders-of-Magnitude Improvements</p> </li> <li> <p>Introducing Multiple Clustering Indexes</p> </li> <li> <p>Clustering Indexes vs. Covering Indexes</p> </li> <li> <p>How Clustering Indexes Sometimes Helps UPDATE and DELETE Performance</p> </li> <li> <p>High Performance MySQL, 3<sup>rd</sup> Edition by Baron Schwartz, Peter Zaitsev, Vadim Tkachenko, Copyright 2012, O\u2019Reilly Media. See Chapter 5, Indexing for High Performance.</p> </li> </ul>"},{"location":"using-tokudb.html#clustering-secondary-indexes","title":"Clustering Secondary Indexes","text":"<p>One of the keys to exploiting TokuDB\u2019s strength in indexing is to make use of clustering secondary indexes.</p> <p>TokuDB allows a secondary key to be defined as a clustering key. This means that all of the columns in the table are clustered with the secondary key. Percona Server for MySQL parser and query optimizer support Multiple Clustering Keys when TokuDB engine is used. This means that the query optimizer will avoid primary clustered index reads and replace them by secondary clustered index reads in certain scenarios.</p> <p>The parser has been extended to support following syntax:</p> <pre><code>CREATE TABLE ... ( ..., CLUSTERING KEY identifier (column list), ...\nCREATE TABLE ... ( ..., UNIQUE CLUSTERING KEY identifier (column list), ...\nCREATE TABLE ... ( ..., CLUSTERING UNIQUE KEY identifier (column list), ...\nCREATE TABLE ... ( ..., CONSTRAINT identifier UNIQUE CLUSTERING KEY identifier (column list), ...\nCREATE TABLE ... ( ..., CONSTRAINT identifier CLUSTERING UNIQUE KEY identifier (column list), ...\n\nCREATE TABLE ... (... column type CLUSTERING [UNIQUE] [KEY], ...)\nCREATE TABLE ... (... column type [UNIQUE] CLUSTERING [KEY], ...)\n\nALTER TABLE ..., ADD CLUSTERING INDEX identifier (column list), ...\nALTER TABLE ..., ADD UNIQUE CLUSTERING INDEX identifier (column list), ...\nALTER TABLE ..., ADD CLUSTERING UNIQUE INDEX identifier (column list), ...\nALTER TABLE ..., ADD CONSTRAINT identifier UNIQUE CLUSTERING INDEX identifier (column list), ...\nALTER TABLE ..., ADD CONSTRAINT identifier CLUSTERING UNIQUE INDEX identifier (column list), ...\n\nCREATE CLUSTERING INDEX identifier ON ...\n</code></pre> <p>To define a secondary index as clustering, simply add the word <code>CLUSTERING</code> before the key definition. For example:</p> <pre><code>CREATE TABLE foo (\n  column_a INT,\n  column_b INT,\n  column_c INT,\n  PRIMARY KEY index_a (column_a),\n  CLUSTERING KEY index_b (column_b)) ENGINE = TokuDB;\n</code></pre> <p>In the previous example, the primary table is indexed on column_a. Additionally, there is a secondary clustering index (named index_b) sorted on column_b. Unlike non-clustered indexes, clustering indexes include all the columns of a table and can be used as covering indexes. For example, the following query will run very fast using the clustering index_b:</p> <pre><code>SELECT column_c\n  FROM foo\n  WHERE column_b BETWEEN 10 AND 100;\n</code></pre> <p>This index is sorted on column_b, making the <code>WHERE</code> clause fast, and includes column_c, which avoids lookups in the primary table to satisfy the query.</p> <p>TokuDB makes clustering indexes feasible because of its excellent compression and very high indexing rates. For more information about using clustering indexes, see Introducing Multiple Clustering Indexes.</p>"},{"location":"using-tokudb.html#hot-index-creation","title":"Hot Index Creation","text":"<p>TokuDB enables you to add indexes to an existing table and still perform inserts and queries on that table while the index is being created.</p> <p>The <code>ONLINE</code> keyword is not used. Instead, the value of the tokudb_create_index_online client session variable is examined.</p> <p>Hot index creation is invoked using the <code>CREATE INDEX</code> command after setting tokudb_create_index_online to <code>on</code> as follows:</p> <pre><code>mysql&gt; SET tokudb_create_index_online=on;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; CREATE INDEX index ON foo (field_name);\n</code></pre> <p>Alternatively, using the <code>ALTER TABLE</code> command for creating an index will create the index offline (with the table unavailable for inserts or queries), regardless of the value of tokudb_create_index_online. The only way to hot create an index is to use the <code>CREATE INDEX</code> command.</p> <p>Hot creating an index will be slower than creating the index offline, and progress depends how busy the mysqld server is with other tasks. Progress of the index creation can be seen by using the <code>SHOW PROCESSLIST</code> command (in another client). Once the index creation completes, the new index will be used in future query plans.</p> <p>If more than one hot <code>CREATE INDEX</code> is issued for a particular table, the indexes will be created serially. An index creation that is waiting for another to complete will be shown as Locked in <code>SHOW PROCESSLIST</code>. We recommend that each <code>CREATE INDEX</code> be allowed to complete before the next one is started.</p>"},{"location":"using-tokudb.html#hot-column-add-delete-expand-and-rename-hcader","title":"Hot Column Add, Delete, Expand, and Rename (HCADER)","text":"<p>TokuDB enables you to add or delete columns in an existing table, expand <code>char</code>, <code>varchar</code>, <code>varbinary</code>, and <code>integer</code> type columns in an existing table, or rename an existing column in a table with little blocking of other updates and queries. HCADER typically blocks other queries with a table lock for no more than a few seconds. After that initial short-term table locking, the system modifies each row (when adding, deleting, or expanding columns) later, when the row is next brought into main memory from disk. For column rename, all the work is done during the seconds of downtime. On-disk rows need not be modified.</p> <p>To get good performance from HCADER, observe the following guidelines:</p> <ul> <li>The work of altering the table for column addition, deletion, or expansion is performed as subsequent operations touch parts of the Fractal Tree, both in the primary index and secondary indexes.</li> </ul> <p>You can force the column addition, deletion, or expansion work to be performed all at once using the standard syntax of <code>OPTIMIZE TABLE X</code>, when a column has been added to, deleted from, or expanded in table X. It is important to note that as of TokuDB version 7.1.0, <code>OPTIMIZE TABLE</code> is also hot, so that a table supports updates and queries without blocking while an <code>OPTIMIZE TABLE</code> is being performed. Also, a hot <code>OPTIMIZE TABLE</code> does not rebuild the indexes, since TokuDB indexes do not age. Rather, they flush all background work, such as that induced by a hot column addition, deletion, or expansion.</p> <ul> <li> <p>Each hot column addition, deletion, or expansion operation must be performed individually (with its own SQL statement). If you want to add, delete, or expand multiple columns use multiple statements.</p> </li> <li> <p>Avoid adding, deleting, or expanding a column at the same time as adding or dropping an index.</p> </li> <li> <p>The time that the table lock is held can vary. The table-locking time for HCADER is dominated by the time it takes to flush dirty pages, because MySQL closes the table after altering it. If a checkpoint has happened recently, this operation is fast (on the order of seconds). However, if the table has many dirty pages, then the flushing stage can take on the order of minutes.</p> </li> <li> <p>Avoid dropping a column that is part of an index. If a column to be dropped is part of an index, then dropping that column is slow. To drop a column that is part of an index, first drop the indexes that reference the column in one alter table statement, and then drop the column in another statement.</p> </li> <li> <p>Hot column expansion operations are only supported to <code>char</code>, <code>varchar</code>, <code>varbinary</code>, and <code>integer</code> data types. Hot column expansion is not supported if the given column is part of the primary key or any secondary keys.</p> </li> <li> <p>Rename only one column per statement. Renaming more than one column will revert to the standard MySQL blocking behavior. The proper syntax is as follows:</p> </li> </ul> <pre><code>ALTER TABLE table\n  CHANGE column_old column_new\n  DATA_TYPE REQUIRED_NESS DEFAULT\n</code></pre> <p>Here\u2019s an example of how that might look:</p> <pre><code>ALTER TABLE table\n  CHANGE column_old column_new\n  INT(10) NOT NULL;\n</code></pre> <p>Notice that all of the column attributes must be specified. <code>ALTER TABLE table CHANGE column_old column_new;</code> induces a slow, blocking column rename.</p> <ul> <li> <p>Hot column rename does not support the following data types: <code>TIME</code>, <code>ENUM</code>, <code>BLOB</code>, <code>TINYBLOB</code>, <code>MEDIUMBLOB</code>, <code>LONGBLOB</code>. Renaming columns of these types will revert to the standard MySQL blocking behavior.</p> </li> <li> <p>Temporary tables cannot take advantage of HCADER. Temporary tables are typically small anyway, so altering them using the standard method is usually fast.</p> </li> </ul>"},{"location":"using-tokudb.html#compression-details","title":"Compression Details","text":"<p>TokuDB offers different levels of compression, which trade off between the amount of CPU used and the compression achieved. Standard compression uses less CPU but generally compresses at a lower level, high compression uses more CPU and generally compresses at a higher level. We have seen compression up to 25x on customer data.</p> <p>Compression in TokuDB occurs on background threads, which means that high compression need not slow down your database. Indeed, in some settings, we\u2019ve seen higher overall database performance with high compression.</p> <p>Note</p> <p>We recommend that users use standard compression on machines with six or fewer cores, and high compression on machines with more than six cores.</p> <p>The ultimate choice depends on the particulars of how a database is used, and we recommend that users use the default settings unless they have profiled their system with high compression in place.</p> <p>The table is compressed using whichever row format is specified in the session variable tokudb_row_format. If no row format is set nor is tokudb_row_format, the <code>QUICKLZ</code> compression algorithm is used.</p> <p>The row_format and tokudb_row_format variables accept the following values:</p> Value Description TOKUDB_DEFAULT Sets the compression to the default behavior. As of TokuDB 7.1.0, the default behavior is to compress using the zlib library. In the future this behavior may change. TOKUDB_FAST Sets the compression to use the quicklz library. TOKUDB_SMALL Sets the compression to use the lzma library. TOKUDB_ZLIB Compress using the zlib library, which provides mid-range compression and CPU utilization. TOKUDB_QUICKLZ Compress using the quicklz library, which provides light compression and low CPU utilization. TOKUDB_LZMA Compress using the lzma library, which provides the highest compression and high CPU utilization. TOKUDB_SNAPPY This compression is using snappy library and aims for very high speeds and reasonable compression. TOKUDB_UNCOMPRESSED This setting turns off compression and is useful for tables with data that cannot be compressed."},{"location":"using-tokudb.html#read-free-replication","title":"Read Free Replication","text":"<p>TokuDB replicas can be configured to perform significantly less read IO in order to apply changes from the source. By utilizing the power of Fractal Tree indexes:</p> <ul> <li> <p>insert/update/delete operations can be configured to eliminate read-modify-write behavior and simply inject messages into the appropriate Fractal Tree indexes</p> </li> <li> <p>update/delete operations can be configured to eliminate the IO required for uniqueness checking</p> </li> </ul> <p>To enable Read Free Replication, the servers must be configured as follows:</p> <ul> <li> <p>On the replication source:</p> <ul> <li>Enable row based replication: set <code>BINLOG_FORMAT=ROW</code></li> </ul> </li> <li> <p>On the replication replica(s):</p> <ul> <li> <p>The replica must be in read-only mode: set <code>read_only=1</code></p> </li> <li> <p>Disable unique checks: set <code>tokudb_rpl_unique_checks=0</code></p> </li> <li> <p>Disable lookups (read-modify-write): set <code>tokudb_rpl_lookup_rows=0</code></p> </li> </ul> </li> </ul> <p>Note</p> <p>You can modify one or both behaviors on the replica(s).</p> <p>Note</p> <p>As long as the source is using row based replication, this optimization is available on a TokuDB replica. This means that it\u2019s available even if the source is using InnoDB or MyISAM tables, or running non-TokuDB binaries.</p> <p>Warning</p> <p>TokuDB Read Free Replication will not propagate <code>UPDATE</code> and <code>DELETE</code> events reliably if TokuDB table is missing the primary key which will eventually lead to data inconsistency on the replica.</p>"},{"location":"using-tokudb.html#transactions-and-acid-compliant-recovery","title":"Transactions and ACID-compliant Recovery","text":"<p>By default, TokuDB checkpoints all open tables regularly and logs all changes between checkpoints, so that after a power failure or system crash, TokuDB will restore all tables into their fully ACID-compliant state. That is, all committed transactions will be reflected in the tables, and any transaction not committed at the time of failure will be rolled back.</p> <p>The default checkpoint period is every 60 seconds, and this specifies the time from the beginning of one checkpoint to the beginning of the next. If a checkpoint requires more than the defined checkpoint period to complete, the next checkpoint begins immediately. It is also related to the frequency with which log files are trimmed, as described below. The user can induce a checkpoint at any time by issuing the <code>FLUSH LOGS</code> command. When a database is shut down normally it is also checkpointed and all open transactions are aborted. The logs are trimmed at startup.</p>"},{"location":"using-tokudb.html#managing-log-size","title":"Managing Log Size","text":"<p>TokuDB keeps log files back to the most recent checkpoint. Whenever a log file reaches 100 MB, a new log file is started. Whenever there is a checkpoint, all log files older than the checkpoint are discarded. If the checkpoint period is set to be a very large number, logs will get trimmed less frequently. This value is set to 60 seconds by default.</p> <p>TokuDB also keeps rollback logs for each open transaction. The size of each log is proportional to the amount of work done by its transaction and is stored compressed on disk. Rollback logs are trimmed when the associated transaction completes.</p>"},{"location":"using-tokudb.html#recovery","title":"Recovery","text":"<p>Recovery is fully automatic with TokuDB. TokuDB uses both the log files and rollback logs to recover from a crash. The time to recover from a crash is proportional to the combined size of the log files and uncompressed size of rollback logs. Thus, if there were no long-standing transactions open at the time of the most recent checkpoint, recovery will take less than a minute.</p>"},{"location":"using-tokudb.html#disabling-the-write-cache","title":"Disabling the Write Cache","text":"<p>When using any transaction-safe database, it is essential that you understand the write-caching characteristics of your hardware. TokuDB provides transaction safe (ACID compliant) data storage for MySQL. However, if the underlying operating system or hardware does not actually write data to disk when it says it did, the system can corrupt your database when the machine crashes. For example, TokuDB can not guarantee proper recovery if it is mounted on an NFS volume. It is always safe to disable the write cache, but you may be giving up some performance.</p> <p>For most configurations you must disable the write cache on your disk drives. On ATA/SATA drives, the following command should disable the write cache:</p> <pre><code>$ hdparm -W0 /dev/hda\n</code></pre> <p>There are some cases when you can keep the write cache, for example:</p> <ul> <li> <p>Write caching can remain enabled when using XFS, but only if XFS reports that disk write barriers work. If you see one of the following messages in /var/log/messages, then you must disable the write cache:</p> <ul> <li> <p><code>Disabling barriers, not supported with external log device</code></p> </li> <li> <p><code>Disabling barriers, not supported by the underlying device</code></p> </li> <li> <p><code>Disabling barriers, trial barrier write failed</code></p> </li> </ul> </li> </ul> <p>XFS write barriers appear to succeed for single disks (with no LVM), or for certain kernels such as that provided by Fedora 12.</p> <p>In the following cases, you must disable the write cache:</p> <ul> <li> <p>If you use the ext3 filesystem</p> </li> <li> <p>If you use LVM (although recent Linux kernels, such as Fedora 12, have fixed this problem)</p> </li> <li> <p>If you use Linux\u2019s software RAID</p> </li> <li> <p>If you use a RAID controller with battery-backed-up memory. This may seem counter-intuitive.</p> </li> </ul> <p>In summary, you should disable the write cache, unless you have a very specific reason not to do so.</p>"},{"location":"using-tokudb.html#progress-tracking","title":"Progress Tracking","text":"<p>TokuDB has a system for tracking progress of long running statements, thereby removing the need to define triggers to track statement execution, as follows:</p> <ul> <li> <p>Bulk Load: When loading large tables using <code>LOAD DATA INFILE</code> commands, doing a <code>SHOW PROCESSLIST</code> command in a separate client session shows progress. There are two progress stages. The first will state something like <code>Inserted about 1000000 rows</code>. After all rows are processed like this, the next stage tracks progress by showing what fraction of the work is done (e.g. <code>Loading of data about 45% done</code>)</p> </li> <li> <p>Adding Indexes: When adding indexes via <code>ALTER TABLE</code> or <code>CREATE INDEX</code>, the command <code>SHOW PROCESSLIST</code> shows progress. When adding indexes via <code>ALTER TABLE</code> or <code>CREATE INDEX</code>, the command <code>SHOW PROCESSLIST</code> will include an estimation of the number of rows processed. Use this information to verify progress is being made. Similar to bulk loading, the first stage shows how many rows have been processed, and the second stage shows progress with a fraction.</p> </li> <li> <p>Commits and Aborts: When committing or aborting a transaction, the command <code>SHOW PROCESSLIST</code> will include an estimate of the transactional operations processed.</p> </li> </ul>"},{"location":"using-tokudb.html#migrating-to-tokudb","title":"Migrating to TokuDB","text":"<p>To convert an existing table to use the TokuDB engine, run <code>ALTER TABLE... ENGINE=TokuDB</code>. If you wish to load from a file, use <code>LOAD DATA INFILE</code> and not <code>mysqldump</code>. Using <code>mysqldump</code> will be much slower. To create a file that can be loaded with <code>LOAD DATA INFILE</code>, refer to the <code>INTO OUTFILE</code> option of the SELECT Syntax.</p> <p>Note</p> <p>Creating this file does not save the schema of your table, so you may want to create a copy of that as well.</p>"},{"location":"utility-user.html","title":"Utility user","text":"<p>Percona Server for MySQL has implemented ability to have a MySQL user who has system access to do administrative tasks but limited access to user schema. This feature is especially useful to those operating MySQL As A Service.</p> <p>This user has a mixed and special scope of abilities and protection:</p> <ul> <li> <p>Utility user does not appear in the mysql.user table and can not be modified by any other user, including root.</p> </li> <li> <p>Utility user does not appear in INFORMATION_SCHEMA.USER_STATISTICS, INFORMATION_SCHEMA.CLIENT_STATISTICS or THREAD_STATISTICS tables or in any performance_schema tables.</p> </li> <li> <p>Utility user\u2019s queries may appear in the general and slow logs.</p> </li> <li> <p>Utility user does not have the ability create, modify, delete or see any schemas or data not specified, except for information_schema.</p> </li> <li> <p>Utility user may modify all visible, non-read-only system variables (see expanded_option_modifiers functionality).</p> </li> <li> <p>Utility user may see, create, modify and delete other system users only if given access to the mysql schema.</p> </li> <li> <p>Regular users may be granted proxy rights to the utility user but attempts to impersonate the utility user fail. The utility user may not be granted proxy rights on any regular user.</p> </li> </ul> <p>For example, <code>GRANT PROXY ON utility_user TO regular_user;</code> does not fail, but any actual attempt to impersonate as the utility user fails.</p> <p><code>GRANT PROXY ON regular_user TO utility_user;</code> fails when utility_user is an exact match or is more specific than than the utility user specified.</p> <p>At server start, the server notes in the log output that the utility user exists and the schemas that the utility user can access.</p>"},{"location":"utility-user.html#version-specific-information","title":"Version specific information","text":"<ul> <li> <p>The utility_user_dynamic_privileges variable was implemented in Percona Server for MySQL 8.0.20-11.</p> </li> <li> <p>Percona Server for MySQL 8.0.17-8: The feature was ported from Percona Server for MySQL 5.7.</p> </li> </ul>"},{"location":"utility-user.html#system-variables","title":"System variables","text":"<p>In order to have the ability for a special type of MySQL user, which will have a very limited and special amount of control over the system and can not be see or modified by any other user including the root user, three new options have been added.</p>"},{"location":"utility-user.html#utility_user","title":"<code>utility_user</code>","text":"Option Description Command Line: Yes Config file utility_user=&lt;user@host&gt; Scope: Global Dynamic: No Data type String Default NULL <p>Specifies a MySQL user that will be added to the internal list of users and recognized as the utility user.</p> <p>Option utility_user specifies the user which the system  creates and recognizes as the utility user. The host in the utility user specification follows conventions described in the MySQL manual. For example, the conventions allow wildcards and IP masks. Anonymous user names are not permitted to be used for the utility user name.</p> <p>This user must not be an exact match to any other user that exists in the mysql.user table. If the server detects that the user specified with this option exactly matches any user within the mysql.user table on start up, the server reports an error and exits gracefully.</p> <p>If host name wildcards are used and a more specific user specification is identified on start up, the server reports a warning and continues.</p> Error message <pre><code>utility_user=frank@% and [frank@localhost](mailto:frank@localhost) exists within the mysql.user table.\n</code></pre> <p>If a client attempts to create a MySQL user that matches this user specification exactly or if host name wildcards are used for the utility user and the user being created has the same name and a more specific host, the creation attempt fails with an error.</p> Error message <pre><code>utility_user=frank@% and CREATE USER [\u2018frank@localhost](mailto:'frank@localhost)\u2019;\n</code></pre> <p>As a result of these requirements, it is strongly recommended that a very unique user name and reasonably specific host be used. </p> <p>Verify the script or tools test they are running within the correct user by executing <code>SELECT CURRENT_USER()</code> and comparing the result against the known utility user.</p>"},{"location":"utility-user.html#utility_user_password","title":"<code>utility_user_password</code>","text":"Option Description Command Line: Yes Config file utility_user_password=password Scope: Global Dynamic: No Data type String Default NULL <p>Specifies the password required for the utility user.</p> <p>Option utility_user_password specifies the password for the utility user and must be specified or the server exits with an error.</p> Utility user password <pre><code>utility_user_password=Passw0rD\n</code></pre>"},{"location":"utility-user.html#utility_user_schema_access","title":"<code>utility_user_schema_access</code>","text":"Option Description Command Line: Yes Config file utility_user_schema_access=schema,schema,schema Scope: Global Dynamic: No Data type String Default NULL <p>Specifies the schemas that the utility user has access to in a comma delimited list.</p> <p>Option utility_user_schema_access specifies the name(s) of the schema(s) that the utility user will have access to read write and modify. If a particular schema named here does not exist on start up it will be ignored. If a schema by the name of any of those listed in this option is created after the server is started, the utility user will have full access to it.</p> Utility user schema access <pre><code>utility_user_schema_access=schema1,schema2,schema3\n</code></pre>"},{"location":"utility-user.html#utility_user_privileges","title":"<code>utility_user_privileges</code>","text":"Option Description Command Line: Yes Config file utility_user_privileges=privilege1,privilege2,privilege3 Scope: Global Dynamic: No Data type String Default NULL <p>This variable can be used to specify a comma-separated list of extra access privileges to grant to the utility user. Supported values for the privileges list are: <code>SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, FILE, GRANT, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, CREATE USER, EVENT, TRIGGER, CREATE TABLESPACE</code></p> <p>Option utility-user-privileges allows a comma-separated list of extra access privileges to grant to the utility user.</p> Utility user privileges <pre><code>utility-user-privileges =\u201dCREATE,DROP,LOCK TABLES\u201d;\n</code></pre>"},{"location":"utility-user.html#utility_user_dynamic_privileges","title":"<code>utility_user_dynamic_privileges</code>","text":"Option Description Command Line: Yes Config file utility_user_dynamic_privileges=privilege1,privilege2,privilege3 Scope: Global Dynamic: No Data type String Default NULL <p>This variable was implemented in Percona Server for MySQL 8.0.20-11.</p> <p>This variable allows a comma-separated list of extra access dynamic privileges to grant to the utility user. The supported values for the dynamic privileges are:</p> <ul> <li> <p>APPLICATION_PASSWORD_ADMIN</p> </li> <li> <p>AUDIT_ADMIN</p> </li> <li> <p>BACKUP_ADMIN</p> </li> <li> <p>BINLOG_ADMIN</p> </li> <li> <p>BINLOG_ENCRYPTION_ADMIN</p> </li> <li> <p>CLONE_ADMIN</p> </li> <li> <p>CONNECTION_ADMIN</p> </li> <li> <p>ENCRYPTION_KEY_ADMIN</p> </li> <li> <p>FIREWALL_ADMIN</p> </li> <li> <p>FIREWALL_USER</p> </li> <li> <p>GROUP_REPLICATION_ADMIN</p> </li> <li> <p>INNODB_REDO_LOG_ARCHIVE</p> </li> <li> <p>NDB_STORED_USER</p> </li> <li> <p>PERSIST_RO_VARIABLES_ADMIN</p> </li> <li> <p>REPLICATION_APPLIER</p> </li> <li> <p>REPLICATION_SLAVE_ADMIN</p> </li> <li> <p>RESOURCE_GROUP_ADMIN</p> </li> <li> <p>RESOURCE_GROUP_USER</p> </li> <li> <p>ROLE_ADMIN</p> </li> <li> <p>SESSION_VARIABLES_ADMIN</p> </li> <li> <p>SET_USER_ID</p> </li> <li> <p>SHOW_ROUTINE</p> </li> <li> <p>SYSTEM_USER</p> </li> <li> <p>SYSTEM_VARIABLES_ADMIN</p> </li> <li> <p>TABLE_ENCRYPTION_ADMIN</p> </li> <li> <p>VERSION_TOKEN_ADMIN</p> </li> <li> <p>XA_RECOVER_ADMIN</p> </li> </ul> <p>Other dynamic privileges may be defined by plugins.</p> <p>Option utility_user_dynamic_privileges allows a comma-separated list of extra-access dynamic privileges to grant to the utility user.</p> Utility user dynamic privileges <pre><code>utility_user_dynamic_privileges =\u201dSYSTEM_USER,AUDIT_ADMIN\u201d;\n</code></pre>"},{"location":"variables.html","title":"MyRocks server variables","text":"<p>The MyRocks server variables expose configuration of the underlying RocksDB engine. There several ways to set these variables:</p> <ul> <li> <p>For production deployments, you should have all variables defined in the configuration file.</p> </li> <li> <p>Dynamic variables can be changed at runtime using the <code>SET</code> statement.</p> </li> <li> <p>If you want to test things out, you can set some of the variables when starting <code>mysqld</code> using corresponding command-line options.</p> </li> </ul> <p>If a variable was not set in either the configuration file or as a command-line option, the default value is used.</p> <p>Also, all variables can exist in one or both of the following scopes:</p> <ul> <li> <p>Global scope defines how the variable affects overall server operation.</p> </li> <li> <p>Session scope defines how the variable affects operation for individual client connections.</p> </li> </ul> Variable Name <code>rocksdb_access_hint_on_compaction_start</code> <code>rocksdb_advise_random_on_open</code> <code>rocksdb_allow_concurrent_memtable_write</code> <code>rocksdb_allow_to_start_after_corruption</code> <code>rocksdb_allow_mmap_reads</code> <code>rocksdb_allow_mmap_writes</code> <code>rocksdb_allow_unsafe_alter</code> <code>rocksdb_alter_column_default_inplace</code> <code>rocksdb_alter_table_comment_inplace</code> <code>rocksdb_base_background_compactions</code> <code>rocksdb_blind_delete_primary_key</code> <code>rocksdb_block_cache_size</code> <code>rocksdb_bulk_load_fail_if_not_bottommost_level</code> <code>rocksdb_bulk_load_partial_index</code> <code>rocksdb_bulk_load_use_sst_partitioner</code> <code>rocksdb_block_restart_interval</code> <code>rocksdb_block_size</code> <code>rocksdb_block_size_deviation</code> <code>rocksdb_bulk_load</code> <code>rocksdb_bulk_load_allow_sk</code> <code>rocksdb_bulk_load_allow_unsorted</code> <code>rocksdb_bulk_load_size</code> <code>rocksdb_bytes_per_sync</code> <code>rocksdb_cache_dump</code> <code>rocksdb_cache_high_pri_pool_ratio</code> <code>rocksdb_cache_index_and_filter_blocks</code> <code>rocksdb_cache_index_and_filter_with_high_priority</code> <code>rocksdb_cancel_manual_compactions</code> <code>rocksdb_charge_memory</code> <code>rocksdb_checksums_pct</code> <code>rocksdb_collect_sst_properties</code> <code>rocksdb_column_default_value_as_expression</code> <code>rocksdb_commit_in_the_middle</code> <code>rocksdb_commit_time_batch_for_recovery</code> <code>rocksdb_compact_cf</code> <code>rocksdb_compaction_readahead_size</code> <code>rocksdb_compaction_sequential_deletes</code> <code>rocksdb_compaction_sequential_deletes_count_sd</code> <code>rocksdb_compaction_sequential_deletes_file_size</code> <code>rocksdb_compaction_sequential_deletes_window</code> <code>rocksdb_concurrent_prepare</code> <code>rocksdb_converter_record_cached_length</code> <code>rocksdb_corrupt_data_action</code> <code>rocksdb_create_checkpoint</code> <code>rocksdb_create_if_missing</code> <code>rocksdb_create_missing_column_families</code> <code>rocksdb_create_temporary_checkpoint</code> <code>rocksdb_datadir</code> <code>rocksdb_db_write_buffer_size</code> <code>rocksdb_deadlock_detect</code> <code>rocksdb_deadlock_detect_depth</code> <code>rocksdb_debug_cardinality_multipler</code> <code>rocksdb_debug_manual_compaction_delay</code> <code>rocksdb_debug_optimizer_no_zero_cardinality</code> <code>rocksdb_debug_ttl_ignore_pk</code> <code>rocksdb_debug_ttl_read_filter_ts</code> <code>rocksdb_debug_ttl_rec_ts</code> <code>rocksdb_debug_ttl_snapshot_ts</code> <code>rocksdb_default_cf_options</code> <code>rocksdb_delayed_write_rate</code> <code>rocksdb_delete_cf</code> <code>rocksdb_delete_obsolete_files_period_micros</code> <code>rocksdb_disable_file_deletions</code> <code>rocksdb_disable_instant_ddl</code> <code>rocksdb_enable_bulk_load_api</code> <code>rocksdb_enable_delete_range_for_drop_index</code> <code>rocksdb_enable_insert_with_update_caching</code> <code>rocksdb_enable_iterate_bounds</code> <code>rocksdb_enable_pipelined_write</code> <code>rocksdb_enable_remove_orphaned_dropped_cfs</code> <code>rocksdb_enable_ttl</code> <code>rocksdb_enable_ttl_read_filtering</code> <code>rocksdb_enable_thread_tracking</code> <code>rocksdb_enable_write_thread_adaptive_yield</code> <code>rocksdb_error_if_exists</code> <code>rocksdb_error_on_suboptimal_collation</code> <code>rocksdb_flush_log_at_trx_commit</code> <code>rocksdb_flush_memtable_on_analyze</code> <code>rocksdb_force_compute_memtable_stats</code> <code>rocksdb_force_compute_memtable_stats_cachetime</code> <code>rocksdb_force_flush_memtable_and_lzero_now</code> <code>rocksdb_force_flush_memtable_now</code> <code>rocksdb_force_index_records_in_range</code> <code>rocksdb_hash_index_allow_collision</code> <code>rocksdb_ignore_unknown_options</code> <code>rocksdb_index_type</code> <code>rocksdb_info_log_level</code> <code>rocksdb_is_fd_close_on_exec</code> <code>rocksdb_keep_log_file_num</code> <code>rocksdb_large_prefix</code> <code>rocksdb_lock_scanned_rows</code> <code>rocksdb_lock_wait_timeout</code> <code>rocksdb_log_file_time_to_roll</code> <code>rocksdb_manifest_preallocation_size</code> <code>rocksdb_manual_compaction_bottommost_level</code> <code>rocksdb_manual_compaction_threads</code> <code>rocksdb_manual_wal_flush</code> <code>rocksdb_master_skip_tx_api</code> <code>rocksdb_max_background_compactions</code> <code>rocksdb_max_background_flushes</code> <code>rocksdb_max_background_jobs</code> <code>rocksdb_max_bottom_pri_background_compactions</code> <code>rocksdb_max_compaction_history</code> <code>rocksdb_max_latest_deadlocks</code> <code>rocksdb_max_log_file_size</code> <code>rocksdb_max_manifest_file_size</code> <code>rocksdb_max_manual_compactions</code> <code>rocksdb_max_open_files</code> <code>rocksdb_max_row_locks</code> <code>rocksdb_max_subcompactions</code> <code>rocksdb_max_total_wal_size</code> <code>rocksdb_merge_buf_size</code> <code>rocksdb_merge_combine_read_size</code> <code>rocksdb_merge_tmp_file_removal_delay_ms</code> <code>rocksdb_new_table_reader_for_compaction_inputs</code> <code>rocksdb_no_block_cache</code> <code>rocksdb_no_create_column_family</code> <code>rocksdb_override_cf_options</code> <code>rocksdb_paranoid_checks</code> <code>rocksdb_partial_index_sort_max_mem</code> <code>rocksdb_pause_background_work</code> <code>rocksdb_partial_index_blind_delete</code> <code>rocksdb_perf_context_level</code> <code>rocksdb_persistent_cache_path</code> <code>rocksdb_persistent_cache_size_mb</code> <code>rocksdb_pin_l0_filter_and_index_blocks_in_cache</code> <code>rocksdb_print_snapshot_conflict_queries</code> <code>rocksdb_protection_bytes_per_key</code> <code>rocksdb_rate_limiter_bytes_per_sec</code> <code>rocksdb_read_free_rpl</code> <code>rocksdb_read_free_rpl_tables</code> <code>rocksdb_records_in_range</code> <code>rocksdb_reset_stats</code> <code>rocksdb_rollback_on_timeout</code> <code>rocksdb_rpl_skip_tx_api</code> <code>rocksdb_seconds_between_stat_computes</code> <code>rocksdb_signal_drop_index_thread</code> <code>rocksdb_sim_cache_size</code> <code>rocksdb_skip_bloom_filter_on_read</code> <code>rocksdb_skip_fill_cache</code> <code>rocksdb_skip_locks_if_skip_unique_check</code> <code>rocksdb_sst_mgr_rate_bytes_per_sec</code> <code>rocksdb_stats_dump_period_sec</code> <code>rocksdb_stats_level</code> <code>rocksdb_stats_recalc_rate</code> <code>rocksdb_store_row_debug_checksums</code> <code>rocksdb_strict_collation_check</code> <code>rocksdb_strict_collation_exceptions</code> <code>rocksdb_table_cache_numshardbits</code> <code>rocksdb_table_stats_background_thread_nice_value</code> <code>rocksdb_table_stats_max_num_rows_scanned</code> <code>rocksdb_table_stats_recalc_threshold_count</code> <code>rocksdb_table_stats_recalc_threshold_pct</code> <code>rocksdb_table_stats_sampling_pct</code> <code>rocksdb_table_stats_use_table_scan</code> <code>rocksdb_tmpdir</code> <code>rocksdb_two_write_queues</code> <code>rocksdb_trace_block_cache_access</code> <code>rocksdb_trace_queries</code> <code>rocksdb_trace_sst_api</code> <code>rocksdb_track_and_verify_wals_in_manifest</code> <code>rocksdb_unsafe_for_binlog</code> <code>rocksdb_update_cf_options</code> <code>rocksdb_use_adaptive_mutex</code> <code>rocksdb_use_default_sk_cf</code> <code>rocksdb_use_direct_io_for_flush_and_compaction</code> <code>rocksdb_use_direct_reads</code> <code>rocksdb_use_fsync</code> <code>rocksdb_use_hyper_clock_cache</code> <code>rocksdb_use_write_buffer_manager</code> <code>rocksdb_validate_tables</code> <code>rocksdb_verify_row_debug_checksums</code> <code>rocksdb_wal_bytes_per_sync</code> <code>rocksdb_wal_dir</code> <code>rocksdb_wal_recovery_mode</code> <code>rocksdb_wal_size_limit_mb</code> <code>rocksdb_wal_ttl_seconds</code> <code>rocksdb_whole_key_filtering</code> <code>rocksdb_write_batch_flush_threshold</code> <code>rocksdb_write_batch_max_bytes</code> <code>rocksdb_write_disable_wal</code> <code>rocksdb_write_ignore_missing_column_families</code> <code>rocksdb_write_policy</code>"},{"location":"variables.html#rocksdb_access_hint_on_compaction_start","title":"<code>rocksdb_access_hint_on_compaction_start</code>","text":"Option Description Command-line \u2013rocksdb-access-hint-on-compaction-start Dynamic No Scope Global Data type String or numeric Default NORMAL or 1 <p>Specifies the file access pattern once a compaction is started, applied to all input files of a compaction. Possible values are:</p> <ul> <li> <p><code>0</code> = <code>NONE</code></p> </li> <li> <p><code>1</code> = <code>NORMAL</code> (default)</p> </li> <li> <p><code>2</code> = <code>SEQUENTIAL</code></p> </li> <li> <p><code>3</code> = <code>WILLNEED</code></p> </li> </ul>"},{"location":"variables.html#rocksdb_advise_random_on_open","title":"<code>rocksdb_advise_random_on_open</code>","text":"Option Description Command-line \u2013rocksdb-advise-random-on-open Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether to hint the underlying file system that the file access pattern is random, when a data file is opened. Enabled by default.</p>"},{"location":"variables.html#rocksdb_allow_concurrent_memtable_write","title":"<code>rocksdb_allow_concurrent_memtable_write</code>","text":"Option Description Command-line \u2013rocksdb-allow-concurrent-memtable-write Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to allow multiple writers to update memtables in parallel. Disabled by default.</p>"},{"location":"variables.html#rocksdb_allow_to_start_after_corruption","title":"<code>rocksdb_allow_to_start_after_corruption</code>","text":"Option Description Command-line \u2013rocksdb_allow_to_start_after_corruption Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to allow server to restart once MyRocks reported data corruption. Disabled by default.</p> <p>Once corruption is detected server writes marker file (named ROCKSDB_CORRUPTED) in the data directory and aborts. If marker file exists, then mysqld exits on startup with an error message. The restart failure will continue until the problem is solved or until mysqld is started with this variable turned on in the command line.</p> <p>Note</p> <p>Not all memtables support concurrent writes.</p>"},{"location":"variables.html#rocksdb_allow_mmap_reads","title":"<code>rocksdb_allow_mmap_reads</code>","text":"Option Description Command-line \u2013rocksdb-allow-mmap-reads Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to allow the OS to map a data file into memory for reads. Disabled by default. If you enable this, make sure that rocksdb_use_direct_reads is disabled.</p>"},{"location":"variables.html#rocksdb_allow_mmap_writes","title":"<code>rocksdb_allow_mmap_writes</code>","text":"Option Description Command-line \u2013rocksdb-allow-mmap-writes Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to allow the OS to map a data file into memory for writes. Disabled by default.</p>"},{"location":"variables.html#rocksdb_allow_unsafe_alter","title":"<code>rocksdb_allow_unsafe_alter</code>","text":"Option Description Command-line \u2013rocksdb-allow-unsafe-alter Dynamic No Scope Global Data type Boolean Default OFF <p>Enables crash unsafe INPLACE ADD|DROP partition.</p>"},{"location":"variables.html#rocksdb_alter_column_default_inplace","title":"<code>rocksdb_alter_column_default_inplace</code>","text":"Option Description Command-line \u2013rocksdb-alter-column-default-inplace Dynamic Yes Scope Global Data type Boolean Default ON <p>Allows an inplace alter for the <code>ALTER COLUMN</code> default operation.</p>"},{"location":"variables.html#rocksdb_alter_table_comment_inplace","title":"<code>rocksdb_alter_table_comment_inplace</code>","text":"Option Description Command-line \u2013rocksdb_alter_table_comment_inplace Dynamic Yes Scope Global Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>Allows changing <code>ALTER TABLE COMMENT</code> inplace.</p> <p>This variable is disabled (OFF) by default.</p>"},{"location":"variables.html#rocksdb_base_background_compactions","title":"<code>rocksdb_base_background_compactions</code>","text":"Option Description Command-line \u2013rocksdb-base-background-compactions Dynamic No Scope Global Data type Numeric Default 1 <p>Specifies the suggested number of concurrent background compaction jobs, submitted to the default LOW priority thread pool in RocksDB. The default is <code>1</code>. The allowed range of values is from <code>-1</code> to <code>64</code>. The maximum value depends on the rocksdb_max_background_compactions variable. This variable was replaced with rocksdb_max_background_jobs, which automatically decides how many threads to allocate toward flush/compaction.</p>"},{"location":"variables.html#rocksdb_blind_delete_primary_key","title":"<code>rocksdb_blind_delete_primary_key</code>","text":"Option Description Command-line \u2013rocksdb-blind-delete-primary-key Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Skips verifying if rows exists before executing deletes. The following conditions must be met:</p> <ul> <li> <p>The variable is enabled</p> </li> <li> <p>Only a single table listed in the <code>DELETE</code> statement</p> </li> <li> <p>The table has only a primary key with no secondary keys</p> </li> </ul>"},{"location":"variables.html#rocksdb_block_cache_size","title":"<code>rocksdb_block_cache_size</code>","text":"Option Description Command-line \u2013rocksdb-block-cache-size Dynamic No Scope Global Data type Numeric Default 536870912 <p>Specifies the size of the LRU block cache for RocksDB. This memory is reserved for the block cache, which is in addition to any filesystem caching that may occur.</p> <p>Minimum value is <code>1024</code>, because that\u2019s the size of one block.</p> <p>Default value is <code>536870912</code>.</p> <p>Maximum value is <code>9223372036854775807</code>.</p>"},{"location":"variables.html#rocksdb_bulk_load_fail_if_not_bottommost_level","title":"<code>rocksdb_bulk_load_fail_if_not_bottommost_level</code>","text":"Option Description Command-line \u2013rocksdb_bulk_load_fail_if_not_bottommost_level Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>When this variable is enabled, the bulk load fails if an sst file created during bulk load cannot be placed to the bottommost level in the rocksdb. </p> <p>This variable can be enabled or disabled only when the <code>rocksdb_bulk_load</code> is <code>OFF</code>.</p> <p>This variable is disabled (OFF) by default.</p> <p>Warning</p> <p>When <code>rocksdb_bulk_load_fail_if_not_bottommost_level</code> is disabled, it may cause severe performance impact.</p>"},{"location":"variables.html#rocksdb_block_restart_interval","title":"<code>rocksdb_block_restart_interval</code>","text":"Option Description Command-line \u2013rocksdb-block-restart-interval Dynamic No Scope Global Data type Numeric Default 16 <p>Specifies the number of keys for each set of delta encoded data. Default value is <code>16</code>. Allowed range is from <code>1</code> to <code>2147483647</code>.</p>"},{"location":"variables.html#rocksdb_block_size","title":"<code>rocksdb_block_size</code>","text":"Option Description Command-line \u2013rocksdb-block-size Dynamic No Scope Global Data type Numeric Default 16 KB <p>Specifies the size of the data block for reading RocksDB data files. The default value is <code>16 KB</code>. The allowed range is from <code>1024</code> to <code>18446744073709551615</code> bytes.</p>"},{"location":"variables.html#rocksdb_block_size_deviation","title":"<code>rocksdb_block_size_deviation</code>","text":"Option Description Command-line \u2013rocksdb-block-size-deviation Dynamic No Scope Global Data type Numeric Default 10 <p>Specifies the threshold for free space allowed in a data block (see rocksdb_block_size). If there is less space remaining, close the block (and write to new block). Default value is <code>10</code>, meaning that the block is not closed until there is less than 10 bits of free space remaining.</p> <p>Allowed range is from <code>1</code> to <code>2147483647</code>.</p>"},{"location":"variables.html#rocksdb_bulk_load_allow_sk","title":"<code>rocksdb_bulk_load_allow_sk</code>","text":"Option Description Command-line \u2013rocksdb-bulk-load-allow-sk Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Enabling this variable allows secondary keys to be added using the bulk loading feature. This variable can be enabled or disabled only when the rocksdb_bulk_load is <code>OFF</code>.</p>"},{"location":"variables.html#rocksdb_bulk_load_allow_unsorted","title":"<code>rocksdb_bulk_load_allow_unsorted</code>","text":"Option Description Command-line \u2013rocksdb-bulk-load-allow-unsorted Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>By default, the bulk loader requires its input to be sorted in the primary key order. If enabled, unsorted inputs are allowed too, which are then sorted by the bulkloader itself, at a performance penalty.</p>"},{"location":"variables.html#rocksdb_bulk_load","title":"<code>rocksdb_bulk_load</code>","text":"Option Description Command-line \u2013rocksdb-bulk-load Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether to use bulk load: MyRocks will ignore checking keys for uniqueness or acquiring locks during transactions. Disabled by default. Enable this only if you are certain that there are no row conflicts, for example, when setting up a new MyRocks instance from a MySQL dump.</p> <p>When the rocksdb_bulk_load variable is enabled, it behaves as if the variable rocksdb_commit_in_the_middle is enabled, even if the variable rocksdb_commit_in_the_middle is disabled.</p>"},{"location":"variables.html#rocksdb_bulk_load_partial_index","title":"<code>rocksdb_bulk_load_partial_index</code>","text":"Option Description Command-line \u2013rocksdb-bulk-load-partial-index Dynamic Yes Scope Local Data type Boolean Default ON <p>The variable was implemented in Percona Server for MySQL 8.0.27-18. Materializes partial index during bulk load instead of leaving the index empty.</p>"},{"location":"variables.html#rocksdb_bulk_load_use_sst_partitioner","title":"<code>rocksdb_bulk_load_use_sst_partitioner</code>","text":"Option Description Command-line \u2013rocksdb_bulk_load_use_sst_partitioner Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>If enabled, this variable uses sst partitioner to split sst files to ensure bulk load sst files can be ingested to bottommost level.</p> <p>This variable is disabled (OFF) by default.</p>"},{"location":"variables.html#rocksdb_bulk_load_size","title":"<code>rocksdb_bulk_load_size</code>","text":"Option Description Command-line \u2013rocksdb-bulk-load-size Dynamic Yes Scope Global, Session Data type Numeric Default 1000 <p>Specifies the number of keys to accumulate before committing them to the storage engine when bulk load is enabled (see rocksdb_bulk_load). Default value is <code>1000</code>, which means that a batch can contain up to 1000 records before they are implicitly committed. Allowed range is from <code>1</code> to <code>1073741824</code>.</p>"},{"location":"variables.html#rocksdb_bytes_per_sync","title":"<code>rocksdb_bytes_per_sync</code>","text":"Option Description Command-line \u2013rocksdb-bytes-per-sync Dynamic Yes Scope Global Data type Numeric Default 0 <p>Specifies how often should the OS sync files to disk as they are being written, asynchronously, in the background. This operation can be used to smooth out write I/O over time. Default value is <code>0</code> meaning that files are never synced. Allowed range is up to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_cache_dump","title":"<code>rocksdb_cache_dump</code>","text":"Option Description Command-line \u2013rocksdb-cache-dump Dynamic No Scope Global Data type Boolean Default ON <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Includes RocksDB block cache content in core dump. This variable is enabled by default.</p>"},{"location":"variables.html#rocksdb_cache_high_pri_pool_ratio","title":"<code>rocksdb_cache_high_pri_pool_ratio</code>","text":"Option Description Command-line \u2013rocksdb-cache-high-pri-pool-ratio Dynamic No Scope Global Data type Double Default 0.0 <p>This variable specifies the size of the block cache high-pri pool. The default value and minimum value is 0.0. The maximum value is 1.0.</p>"},{"location":"variables.html#rocksdb_cache_index_and_filter_blocks","title":"<code>rocksdb_cache_index_and_filter_blocks</code>","text":"Option Description Command-line \u2013rocksdb-cache-index-and-filter-blocks Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether RocksDB should use the block cache for caching the index and bloomfilter data blocks from each data file. Enabled by default. If you disable this feature, RocksDB allocates additional memory to maintain these data blocks.</p>"},{"location":"variables.html#rocksdb_cache_index_and_filter_with_high_priority","title":"<code>rocksdb_cache_index_and_filter_with_high_priority</code>","text":"Option Description Command-line \u2013rocksdb-cache-index-and-filter-with-high-priority Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether RocksDB should use the block cache with high priority for caching the index and bloomfilter data blocks from each data file. Enabled by default. If you disable this feature, RocksDB allocates additional memory to maintain these data blocks.</p>"},{"location":"variables.html#rocksdb_cancel_manual_compactions","title":"<code>rocksdb_cancel_manual_compactions</code>","text":"Option Description Command-line \u2013rocksdb-cancel-manual-compactions Dynamic Yes Scope Global Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.27-18. Cancels all ongoing manual compactions.</p>"},{"location":"variables.html#rocksdb_charge_memory","title":"<code>rocksdb_charge_memory</code>","text":"Option Description Command-line \u2013rocksdb_charge_memory Dynamic No Scope Global Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>This variable is tech preview and may be removed in the future releases.</p> <p>Turns on RocksDB memory-charging related features (BlockBasedTableOptions::cache_usage_options.options.charged) from <code>cnf</code> files. This variable is related to <code>rocksdb_use_write_buffer_manager</code>.</p> <p>This variable is disabled (OFF) by default.</p>"},{"location":"variables.html#rocksdb_checksums_pct","title":"<code>rocksdb_checksums_pct</code>","text":"Option Description Command-line \u2013rocksdb-checksums-pct Dynamic Yes Scope Global, Session Data type Numeric Default 100 <p>Specifies the percentage of rows to be checksummed. Default value is <code>100</code> (checksum all rows). Allowed range is from <code>0</code> to <code>100</code>.</p>"},{"location":"variables.html#rocksdb_collect_sst_properties","title":"<code>rocksdb_collect_sst_properties</code>","text":"Option Description Command-line \u2013rocksdb-collect-sst-properties Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether to collect statistics on each data file to improve optimizer behavior. Enabled by default.</p>"},{"location":"variables.html#rocksdb_column_default_value_as_expression","title":"<code>rocksdb_column_default_value_as_expression</code>","text":"Option Description Command-line \u2013rocksdb_column_default_value_as_expression Dynamic Yes Scope Global Data type Boolean Default ON <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>Allows to set a function as the default value for a column.</p> <p>This variable is enabled (ON) by default.</p>"},{"location":"variables.html#rocksdb_commit_in_the_middle","title":"<code>rocksdb_commit_in_the_middle</code>","text":"Option Description Command-line \u2013rocksdb-commit-in-the-middle Dynamic Yes Scope Global Data type Boolean Default OFF <p>Specifies whether to commit rows implicitly when a batch contains more than the value of rocksdb_bulk_load_size.</p> <p>This option should only be enabled at the time of data import because it may cause locking errors.</p> <p>This variable is disabled by default. When the rocksdb_bulk_load variable is enabled, it behaves as if the variable rocksdb_commit_in_the_middle is enabled, even if the variable rocksdb_commit_in_the_middle is disabled.</p>"},{"location":"variables.html#rocksdb_commit_time_batch_for_recovery","title":"<code>rocksdb_commit_time_batch_for_recovery</code>","text":"Option Description Command-line \u2013rocksdb-commit-time-batch-for-recovery Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether to write the commit time write batch into the database or not.</p> <p>Note</p> <p>If the commit time write batch is only useful for recovery, then writing to WAL is enough.</p>"},{"location":"variables.html#rocksdb_compact_cf","title":"<code>rocksdb_compact_cf</code>","text":"Option Description Command-line \u2013rocksdb-compact-cf Dynamic Yes Scope Global Data type String Default <p>Specifies the name of the column family to compact.</p>"},{"location":"variables.html#rocksdb_compaction_readahead_size","title":"<code>rocksdb_compaction_readahead_size</code>","text":"Option Description Command-line \u2013rocksdb-compaction-readahead-size Dynamic Yes Scope Global Data type Numeric Default 0 <p>Specifies the size of reads to perform ahead of compaction. Default value is <code>0</code>. Set this to at least 2 megabytes (<code>16777216</code>) when using MyRocks with spinning disks to ensure sequential reads instead of random. Maximum allowed value is <code>18446744073709551615</code>.</p> <p>Note</p> <p>If you set this variable to a non-zero value, rocksdb_new_table_reader_for_compaction_inputs is enabled.</p>"},{"location":"variables.html#rocksdb_compaction_sequential_deletes","title":"<code>rocksdb_compaction_sequential_deletes</code>","text":"Option Description Command-line \u2013rocksdb-compaction-sequential-deletes Dynamic Yes Scope Global Data type Numeric Default 0 <p>Specifies the threshold to trigger compaction on a file if it has more than this number of sequential delete markers. Default value is <code>0</code> meaning that compaction is not triggered regardless of the number of delete markers. Maximum allowed value is <code>2000000</code> (two million delete markers).</p> <p>Note</p> <p>Depending on workload patterns, MyRocks can potentially maintain large numbers of delete markers, which increases latency of queries.  This compaction feature will reduce latency, but may also increase the MyRocks write rate.  Use this variable together with rocksdb_compaction_sequential_deletes_file_size to only perform compaction on large files.</p>"},{"location":"variables.html#rocksdb_compaction_sequential_deletes_count_sd","title":"<code>rocksdb_compaction_sequential_deletes_count_sd</code>","text":"Option Description Command-line \u2013rocksdb-compaction-sequential-deletes-count-sd Dynamic Yes Scope Global Data type Boolean Default OFF <p>Specifies whether to count single deletes as delete markers recognized by rocksdb_compaction_sequential_deletes. Disabled by default.</p>"},{"location":"variables.html#rocksdb_compaction_sequential_deletes_file_size","title":"<code>rocksdb_compaction_sequential_deletes_file_size</code>","text":"Option Description Command-line \u2013rocksdb-compaction-sequential-deletes-file-size Dynamic Yes Scope Global Data type Numeric Default 0 <p>Specifies the minimum file size required to trigger compaction on it by rocksdb_compaction_sequential_deletes. Default value is <code>0</code>, meaning that compaction is triggered regardless of file size. Allowed range is from <code>-1</code> to <code>9223372036854775807</code>.</p>"},{"location":"variables.html#rocksdb_compaction_sequential_deletes_window","title":"<code>rocksdb_compaction_sequential_deletes_window</code>","text":"Option Description Command-line \u2013rocksdb-compaction-sequential-deletes-window Dynamic Yes Scope Global Data type Numeric Default 0 <p>Specifies the size of the window for counting delete markers by rocksdb_compaction_sequential_deletes. Default value is <code>0</code>. Allowed range is up to <code>2000000</code> (two million).</p>"},{"location":"variables.html#rocksdb_concurrent_prepare","title":"<code>rocksdb_concurrent_prepare</code>","text":"Option Description Command-line \u2013rocksdb-concurrent_prepare Dynamic No Scope Global Data type Boolean Default ON <p>When enabled this variable allows/encourages threads that are using two-phase commit to <code>prepare</code> in parallel. This variable was renamed in upstream to rocksdb_two_write_queues.</p>"},{"location":"variables.html#rocksdb_corrupt_data_action","title":"<code>rocksdb_corrupt_data_action</code>","text":"Option Description Command-line \u2013rocksdb_corrupt_data_action Dynamic Yes Scope Global Data type enum { ERROR = 0, ABORT_SERVER, WARNING }; Default ERROR <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>This variable controls the behavior when hitting the data corruption in MyRocks. </p> <p>You can select one of the following actions:</p> <ul> <li> <p><code>ERROR</code> - fail the query with the error <code>HA_ERR_ROCKSDB_CORRUPT_DATA</code></p> </li> <li> <p><code>ABORT_SERVER</code> - crash the server</p> </li> <li> <p><code>WARNING</code> - pass the query with warning</p> </li> </ul> <p>The default value is <code>ERROR</code> that means the query fails with the error <code>HA_ERR_ROCKSDB_CORRUPT_DATA</code>.</p>"},{"location":"variables.html#rocksdb_converter_record_cached_length","title":"<code>rocksdb_converter_record_cached_length</code>","text":"Option Description Command-line \u2013rocksdb_converter_record_cached_length Dynamic Yes Scope Global Data type Numeric Default 0 <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>Specifies the maximum number of bytes to cache on table handler for encoding table record data. </p> <p>If the used memory exceeds <code>rocksdb_converter_record_cached_length</code>, the memory is released when the handler is returned to the table handler cache.</p> <p>The minimum value is <code>0</code> (zero) that means there is no limit. The maximum value is <code>UINT64_MAX (0xffffffffffffffff)</code>.</p> <p>The default value is <code>0</code>(zero) that means there is no limit.</p>"},{"location":"variables.html#rocksdb_create_checkpoint","title":"<code>rocksdb_create_checkpoint</code>","text":"Option Description Command-line \u2013rocksdb-create-checkpoint Dynamic Yes Scope Global Data type String Default <p>Specifies the directory where MyRocks should create a checkpoint. Empty by default.</p>"},{"location":"variables.html#rocksdb_create_if_missing","title":"<code>rocksdb_create_if_missing</code>","text":"Option Description Command-line \u2013rocksdb-create-if-missing Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether MyRocks should create its database if it does not exist. Enabled by default.</p>"},{"location":"variables.html#rocksdb_create_missing_column_families","title":"<code>rocksdb_create_missing_column_families</code>","text":"Option Description Command-line \u2013rocksdb-create-missing-column-families Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether MyRocks should create new column families if they do not exist. Disabled by default.</p>"},{"location":"variables.html#rocksdb_create_temporary_checkpoint","title":"<code>rocksdb_create_temporary_checkpoint</code>","text":"Option Description Command-line \u2013rocksdb-create-temporary-checkpoint Dynamic Yes Scope Session Data type String <p>This variable has been implemented in Percona Server for MySQL 8.0.15-6. When specified it will create a temporary RocksDB \u2018checkpoint\u2019 or \u2018snapshot\u2019 in the datadir. If the session ends with an existing checkpoint, or if the variable is reset to another value, the checkpoint will get removed. This variable should be used by backup tools. Prolonged use or other misuse can have serious side effects to the server instance.</p>"},{"location":"variables.html#rocksdb_datadir","title":"<code>rocksdb_datadir</code>","text":"Option Description Command-line \u2013rocksdb-datadir Dynamic No Scope Global Data type String Default <code>./.rocksdb</code> <p>Specifies the location of the MyRocks data directory. By default, it is created in the current working directory.</p>"},{"location":"variables.html#rocksdb_db_write_buffer_size","title":"<code>rocksdb_db_write_buffer_size</code>","text":"Option Description Command-line \u2013rocksdb-db-write-buffer-size Dynamic No Scope Global Data type Numeric Default 0 <p>Specifies the maximum size of all memtables used to store writes in MyRocks across all column families. When this size is reached, the data is flushed to persistent media. The default value is <code>0</code>. The allowed range is up to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_deadlock_detect","title":"<code>rocksdb_deadlock_detect</code>","text":"Option Description Command-line \u2013rocksdb-deadlock-detect Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether MyRocks should detect deadlocks. Disabled by default.</p>"},{"location":"variables.html#rocksdb_deadlock_detect_depth","title":"<code>rocksdb_deadlock_detect_depth</code>","text":"Option Description Command-line \u2013rocksdb-deadlock-detect-depth Dynamic Yes Scope Global, Session Data type Numeric Default 50 <p>Specifies the number of transactions deadlock detection will traverse through before assuming deadlock.</p>"},{"location":"variables.html#rocksdb_debug_cardinality_multiplier","title":"<code>rocksdb_debug_cardinality_multiplier</code>","text":"Option Description Command-line \u2013rocksdb-debug-cardinality-multiplier Dynamic Yes Scope Global Data type UINT Default 2 <p>The cardinality multiplier used in tests. The minimum value is 0. The maxium value is 2147483647 (INT_MAX).</p>"},{"location":"variables.html#rocksdb_debug_manual_compaction_delay","title":"<code>rocksdb_debug_manual_compaction_delay</code>","text":"Option Description Command-line \u2013rocksdb-debug-manual-compaction-delay Dynamic Yes Scope Global Data type UINT Default 0 <p>Only use this variable when debugging.</p> <p>This variable specifies a sleep, in seconds, to simulate long-running compactions. The minimum value is 0. The maximum value is 4292967295 (UINT_MAX).</p>"},{"location":"variables.html#rocksdb_debug_optimizer_no_zero_cardinality","title":"<code>rocksdb_debug_optimizer_no_zero_cardinality</code>","text":"Option Description Command-line \u2013rocksdb-debug-optimizer-no-zero-cardinality Dynamic Yes Scope Global Data type Boolean Default ON <p>Specifies whether MyRocks should prevent zero cardinality by always overriding it with some value.</p>"},{"location":"variables.html#rocksdb_debug_ttl_ignore_pk","title":"<code>rocksdb_debug_ttl_ignore_pk</code>","text":"Option Description Command-line \u2013rocksdb-debug-ttl-ignore-pk Dynamic Yes Scope Global Data type Boolean Default OFF <p>For debugging purposes only. If true, compaction filtering will not occur on Primary Key TTL data. This variable is a no-op in non-debug builds.</p>"},{"location":"variables.html#rocksdb_debug_ttl_read_filter_ts","title":"<code>rocksdb_debug_ttl_read_filter_ts</code>","text":"Option Description Command-line \u2013rocksdb_debug-ttl-read-filter-ts Dynamic Yes Scope Global Data type Numeric Default 0 <p>For debugging purposes only.  Overrides the TTL read filtering time to time + debug_ttl_read_filter_ts. A value of <code>0</code> denotes that the variable is not set. This variable is a no-op in non-debug builds.</p>"},{"location":"variables.html#rocksdb_debug_ttl_rec_ts","title":"<code>rocksdb_debug_ttl_rec_ts</code>","text":"Option Description Command-line \u2013rocksdb-debug-ttl-rec-ts Dynamic Yes Scope Global Data type Numeric Default 0 <p>For debugging purposes only.  Overrides the TTL of records to <code>now()</code> + debug_ttl_rec_ts. The value can be \u00b1 to simulate a record inserted in the past vs a record inserted in the  future . A value of <code>0</code> denotes that the variable is not set. This variable is a no-op in non-debug builds.</p>"},{"location":"variables.html#rocksdb_debug_ttl_snapshot_ts","title":"<code>rocksdb_debug_ttl_snapshot_ts</code>","text":"Option Description Command-line \u2013rocksdb-debug-ttl-snapshot-ts Dynamic Yes Scope Global Data type Numeric Default 0 <p>For debugging purposes only. Sets the snapshot during compaction to <code>now()</code> + rocksdb_debug_set_ttl_snapshot_ts.</p> <p>The value can be \u00b1 to simulate a snapshot in the past vs a snapshot created in the  future . A value of <code>0</code> denotes that the variable is not set. This variable is a no-op in non-debug builds.</p>"},{"location":"variables.html#rocksdb_default_cf_options","title":"<code>rocksdb_default_cf_options</code>","text":"Option Description Command-line \u2013rocksdb-default-cf-options Dynamic No Scope Global Data type String <p>The dafault value is:</p> <p>block_based_table_factory= {cache_index_and_filter_blocks=1;filter_policy=bloomfilter:10:false;whole_key_filtering=1};level_compaction_dynamic_level_bytes=true;optimize_filters_for_hits=true;compaction_pri=kMinOverlappingRatio;compression=kLZ4Compression;bottommost_compression=kLZ4Compression;Specifies the default column family options for MyRocks. On startup, the server applies this option to all existing column families. This option is read-only at runtime.</p>"},{"location":"variables.html#rocksdb_delayed_write_rate","title":"<code>rocksdb_delayed_write_rate</code>","text":"Option Description Command-line \u2013rocksdb-delayed-write-rate Dynamic Yes Scope Global Data type Numeric Default 16777216 <p>Specifies the write rate in bytes per second, which should be used if MyRocks hits a soft limit or threshold for writes. Default value is <code>16777216</code> (16 MB/sec). Allowed range is from <code>0</code> to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_delete_cf","title":"<code>rocksdb_delete_cf</code>","text":"Option Description Command-line \u2013rocksdb-delete-cf Dynamic Yes Scope Global Data type String Default \u201c\u201d <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Deletes the column family by name. The default value is \u201c\u201d , an empty string.</p> <p>For example:</p> <pre><code>SET @@global.ROCKSDB_DELETE_CF = 'cf_primary_key';\n</code></pre>"},{"location":"variables.html#rocksdb_delete_obsolete_files_period_micros","title":"<code>rocksdb_delete_obsolete_files_period_micros</code>","text":"Option Description Command-line \u2013rocksdb-delete-obsolete-files-period-micros Dynamic No Scope Global Data type Numeric Default 21600000000 <p>Specifies the period in microseconds to delete obsolete files regardless of files removed during compaction. Default value is <code>21600000000</code> (6 hours). Allowed range is up to <code>9223372036854775807</code>.</p>"},{"location":"variables.html#rocksdb_disable_file_deletions","title":"<code>rocksdb_disable_file_deletions</code>","text":"Option Description Command-line \u2013rocksdb-disable-file-deletions Dynamic Yes Scope Session Data type Boolean Default OFF <p>This variable has been implemented in Percona Server for MySQL 8.0.15-6. It allows a client to temporarily disable RocksDB deletion of old <code>WAL</code> and <code>.sst</code> files for the purposes of making a consistent backup. If the client session terminates for any reason after disabling deletions and has not re-enabled deletions, they will be explicitly re-enabled. This variable should be used by backup tools. Prolonged use or other misuse can have serious side effects to the server instance.</p>"},{"location":"variables.html#rocksdb_disable_instant_ddl","title":"<code>rocksdb_disable_instant_ddl</code>","text":"Option Description Command-line \u2013rocksdb_disable_instant_ddl Dynamic Yes Scope Global Data type Boolean Default ON <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>Disables instant DDL during <code>ALTER TABLE</code> operations.</p> <p>This variable is enabled (ON) by default.</p>"},{"location":"variables.html#rocksdb_enable_bulk_load_api","title":"<code>rocksdb_enable_bulk_load_api</code>","text":"Option Description Command-line \u2013rocksdb-enable-bulk-load-api Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether to use the <code>SSTFileWriter</code> feature for bulk loading, This feature bypasses the memtable, but requires keys to be inserted into the table in either ascending or descending order. Enabled by default. If disabled, bulk loading uses the normal write path via the memtable and does not require keys to be inserted in any order.</p>"},{"location":"variables.html#rocksdb_enable_delete_range_for_drop_index","title":"<code>rocksdb_enable_delete_range_for_drop_index</code>","text":"Option Description Command-line \u2013rocksdb_enable_delete_range_for_drop_index Dynamic Yes Scope Global Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>Enables drop table / index by calling the DeleteRange.</p> <p>This option is disabled (OFF) by default.</p>"},{"location":"variables.html#rocksdb_enable_insert_with_update_caching","title":"<code>rocksdb_enable_insert_with_update_caching</code>","text":"Option Description Command-line \u2013rocksdb-enable-insert-with-update-caching Dynamic Yes Scope Global Data type Boolean Default ON <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Specifies whether to enable optimization where the read is cached from a failed insertion attempt in INSERT ON DUPLICATE KEY UPDATE.</p>"},{"location":"variables.html#rocksdb_enable_iterate_bounds","title":"<code>rocksdb_enable_iterate_bounds</code>","text":"Option Description Command-line \u2013rocksdb-enable-iterate-bounds Dynamic Yes Scope Global, Local Data type Boolean Default TRUE <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Enables the rocksdb iterator upper bounds and lower bounds in read options.</p>"},{"location":"variables.html#rocksdb_enable_pipelined_write","title":"<code>rocksdb_enable_pipelined_write</code>","text":"Option Description Command-line \u2013rocksdb-enable-pipelined-write Dynamic No Scope Global Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.25-15.</p> <p>DBOptions::enable_pipelined_write for RocksDB.</p> <p>If <code>enable_pipelined_write</code> is <code>ON</code>, a separate write thread is maintained for WAL write and memtable write. A write thread first enters the WAL writer queue and then the memtable writer queue. A pending thread on the WAL writer queue only waits for the previous WAL write operations but does not wait for memtable write operations. Enabling the feature may improve write throughput and reduce latency of the prepare phase of a two-phase commit.</p>"},{"location":"variables.html#rocksdb_enable_remove_orphaned_dropped_cfs","title":"<code>rocksdb_enable_remove_orphaned_dropped_cfs</code>","text":"Option Description Command-line \u2013rocksdb-enable-remove-orphaned-dropped-cfs Dynamic Yes Scope Global Data type Boolean Default TRUE <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Enables the removal of dropped column families (cfs) from metadata if the cfs do not exist in the cf manager.</p> <p>The default value is <code>TRUE</code>.</p>"},{"location":"variables.html#rocksdb_enable_ttl","title":"<code>rocksdb_enable_ttl</code>","text":"Option Description Command-line \u2013rocksdb-enable-ttl Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether to keep expired TTL records during compaction. Enabled by default. If disabled, expired TTL records will be dropped during compaction.</p>"},{"location":"variables.html#rocksdb_enable_ttl_read_filtering","title":"<code>rocksdb_enable_ttl_read_filtering</code>","text":"Option Description Command-line \u2013rocksdb-enable-ttl-read-filtering Dynamic Yes Scope Global Data type Boolean Default ON <p>For tables with TTL, expired records are skipped/filtered out during processing and in query results. Disabling this will allow these records to be seen, but as a result rows may disappear in the middle of transactions as they are dropped during compaction. Use with caution.</p>"},{"location":"variables.html#rocksdb_enable_thread_tracking","title":"<code>rocksdb_enable_thread_tracking</code>","text":"Option Description Command-line \u2013rocksdb-enable-thread-tracking Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to enable tracking the status of threads accessing the database. Disabled by default. If enabled, thread status will be available via <code>GetThreadList()</code>.</p>"},{"location":"variables.html#rocksdb_enable_write_thread_adaptive_yield","title":"<code>rocksdb_enable_write_thread_adaptive_yield</code>","text":"Option Description Command-line \u2013rocksdb-enable-write-thread-adaptive-yield Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether the MyRocks write batch group leader should wait up to the maximum allowed time before blocking on a mutex. Disabled by default. Enable it to increase throughput for concurrent workloads.</p>"},{"location":"variables.html#rocksdb_error_if_exists","title":"<code>rocksdb_error_if_exists</code>","text":"Option Description Command-line \u2013rocksdb-error-if-exists Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to report an error when a database already exists. Disabled by default.</p>"},{"location":"variables.html#rocksdb_error_on_suboptimal_collation","title":"<code>rocksdb_error_on_suboptimal_collation</code>","text":"Option Description Command-line \u2013rocksdb-error-on-suboptimal-collation Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether to report an error instead of a warning if an index is created on a char field where the table has a sub-optimal collation (case insensitive). Enabled by default.</p>"},{"location":"variables.html#rocksdb_flush_log_at_trx_commit","title":"<code>rocksdb_flush_log_at_trx_commit</code>","text":"Option Description Command-line \u2013rocksdb-flush-log-at-trx-commit Dynamic Yes Scope Global, Session Data type Numeric Default 1 <p>Specifies whether to sync on every transaction commit, similar to innodb_flush_log_at_trx_commit. Enabled by default, which ensures ACID compliance.</p> <p>Possible values:</p> <ul> <li> <p><code>0</code>: Do not sync on transaction commit. This provides better performance, but may lead to data inconsistency in case of a crash.</p> </li> <li> <p><code>1</code>: Sync on every transaction commit. This is set by default and recommended as it ensures data consistency, but reduces performance.</p> </li> <li> <p><code>2</code>: Sync every second.</p> </li> </ul>"},{"location":"variables.html#rocksdb_flush_memtable_on_analyze","title":"<code>rocksdb_flush_memtable_on_analyze</code>","text":"Option Description Command-line \u2013rocksdb-flush-memtable-on-analyze Dynamic Yes Scope Global, Session Data type Boolean Default ON <p>Specifies whether to flush the memtable when running <code>ANALYZE</code> on a table. Enabled by default. This ensures accurate cardinality by including data in the memtable for calculating stats.</p>"},{"location":"variables.html#rocksdb_force_compute_memtable_stats","title":"<code>rocksdb_force_compute_memtable_stats</code>","text":"Option Description Command-line \u2013rocksdb-force-compute-memtable-stats Dynamic Yes Scope Global Data type Boolean Default ON <p>Specifies whether data in the memtables should be included for calculating index statistics used by the query optimizer. Enabled by default. This provides better accuracy, but may reduce performance.</p>"},{"location":"variables.html#rocksdb_force_compute_memtable_stats_cachetime","title":"<code>rocksdb_force_compute_memtable_stats_cachetime</code>","text":"Option Description Command-line \u2013rocksdb-force-compute-memtable-stats-cachetime Dynamic Yes Scope Global Data type Numeric Default 60000000 <p>Specifies for how long the cached value of memtable statistics should be used instead of computing it every time during the query plan analysis.</p>"},{"location":"variables.html#rocksdb_force_flush_memtable_and_lzero_now","title":"<code>rocksdb_force_flush_memtable_and_lzero_now</code>","text":"Option Description Command-line \u2013rocksdb-force-flush-memtable-and-lzero-now Dynamic Yes Scope Global Data type Boolean Default OFF <p>Works similar to rocksdb_force_flush_memtable_now but also flushes all L0 files.</p>"},{"location":"variables.html#rocksdb_force_flush_memtable_now","title":"<code>rocksdb_force_flush_memtable_now</code>","text":"Option Description Command-line \u2013rocksdb-force-flush-memtable-now Dynamic Yes Scope Global Data type Boolean Default OFF <p>Forces MyRocks to immediately flush all memtables out to data files.</p> <p>Warning</p> <p>Use with caution! Write requests will be blocked until all memtables are flushed.</p>"},{"location":"variables.html#rocksdb_force_index_records_in_range","title":"<code>rocksdb_force_index_records_in_range</code>","text":"Option Description Command-line \u2013rocksdb-force-index-records-in-range Dynamic Yes Scope Global, Session Data type Numeric Default 1 <p>Specifies the value used to override the number of rows returned to query optimizer when <code>FORCE INDEX</code> is used. Default value is <code>1</code>. Allowed range is from <code>0</code> to <code>2147483647</code>. Set to <code>0</code> if you do not want to override the returned value.</p>"},{"location":"variables.html#rocksdb_hash_index_allow_collision","title":"<code>rocksdb_hash_index_allow_collision</code>","text":"Option Description Command-line \u2013rocksdb-hash-index-allow-collision Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether hash collisions are allowed. Enabled by default, which uses less memory. If disabled, full prefix is stored to prevent hash collisions.</p>"},{"location":"variables.html#rocksdb_ignore_unknown_options","title":"<code>rocksdb_ignore_unknown_options</code>","text":"Option Description Command-line Dynamic No Scope Global Data type Boolean Default ON <p>When enabled, it allows RocksDB to receive unknown options and not exit.</p>"},{"location":"variables.html#rocksdb_index_type","title":"<code>rocksdb_index_type</code>","text":"Option Description Command-line \u2013rocksdb-index-type Dynamic No Scope Global Data type Enum Default kBinarySearch <p>Specifies the type of indexing used by MyRocks:</p> <ul> <li> <p><code>kBinarySearch</code>: Binary search (default).</p> </li> <li> <p><code>kHashSearch</code>: Hash search.</p> </li> </ul>"},{"location":"variables.html#rocksdb_info_log_level","title":"<code>rocksdb_info_log_level</code>","text":"Option Description Command-line \u2013rocksdb-info-log-level Dynamic Yes Scope Global Data type Enum Default error_level <p>Specifies the level for filtering messages written by MyRocks to the <code>mysqld</code> log.</p> <ul> <li> <p><code>debug_level</code>: Maximum logging (everything including debugging log messages)</p> </li> <li> <p><code>info_level</code></p> </li> <li> <p><code>warn_level</code></p> </li> <li> <p><code>error_level</code> (default)</p> </li> <li> <p><code>fatal_level</code>: Minimum logging (only fatal error messages logged)</p> </li> </ul>"},{"location":"variables.html#rocksdb_is_fd_close_on_exec","title":"<code>rocksdb_is_fd_close_on_exec</code>","text":"Option Description Command-line \u2013rocksdb-is-fd-close-on-exec Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether child processes should inherit open file jandles. Enabled by default.</p>"},{"location":"variables.html#rocksdb_large_prefix","title":"<code>rocksdb_large_prefix</code>","text":"Option Description Command-line \u2013rocksdb-large-prefix Dynamic Yes Scope Global Data type Boolean Default TRUE <p>When enabled, this option allows index key prefixes longer than 767 bytes (up to 3072 bytes). The values for rocksdb_large_prefix should be the same between source and replica.</p> <p>Note</p> <p>In version Percona Server for MySQL 8.0.16-7 and later, the default value is changed to <code>TRUE</code>.</p>"},{"location":"variables.html#rocksdb_keep_log_file_num","title":"<code>rocksdb_keep_log_file_num</code>","text":"Option Description Command-line \u2013rocksdb-keep-log-file-num Dynamic No Scope Global Data type Numeric Default 1000 <p>Specifies the maximum number of info log files to keep. Default value is <code>1000</code>. Allowed range is from <code>1</code> to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_lock_scanned_rows","title":"<code>rocksdb_lock_scanned_rows</code>","text":"Option Description Command-line \u2013rocksdb-lock-scanned-rows Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether to hold the lock on rows that are scanned during <code>UPDATE</code> and not actually updated. Disabled by default.</p>"},{"location":"variables.html#rocksdb_lock_wait_timeout","title":"<code>rocksdb_lock_wait_timeout</code>","text":"Option Description Command-line \u2013rocksdb-lock-wait-timeout Dynamic Yes Scope Global, Session Data type Numeric Default 1 <p>Specifies the number of seconds MyRocks should wait to acquire a row lock before aborting the request. Default value is <code>1</code>. Allowed range is up to <code>1073741824</code>.</p>"},{"location":"variables.html#rocksdb_log_file_time_to_roll","title":"<code>rocksdb_log_file_time_to_roll</code>","text":"Option Description Command-line \u2013rocksdb-log-file-time-to-roll Dynamic No Scope Global Data type Numeric Default 0 <p>Specifies the period (in seconds) for rotating the info log files. Default value is <code>0</code>, meaning that the log file is not rotated. Allowed range is up to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_manifest_preallocation_size","title":"<code>rocksdb_manifest_preallocation_size</code>","text":"Option Description Command-line \u2013rocksdb-manifest-preallocation-size Dynamic No Scope Global Data type Numeric Default 0 <p>Specifies the number of bytes to preallocate for the MANIFEST file used by MyRocks to store information about column families, levels, active files, etc. Default value is <code>0</code>. Allowed range is up to <code>18446744073709551615</code>.</p> <p>Note</p> <p>A value of <code>4194304</code> (4 MB) is reasonable to reduce random I/O on XFS.</p>"},{"location":"variables.html#rocksdb_manual_compaction_bottommost_level","title":"<code>rocksdb_manual_compaction_bottommost_level</code>","text":"Option Description Command-line \u2013rocksdb-manual-compaction-bottommost-level Dynamic Yes Scope Local Data type Enum Default kForceOptimized <p>Option for bottommost level compaction during manual compaction:</p> <ul> <li> <p>kSkip - Skip bottommost level compaction</p> </li> <li> <p>kIfHaveCompactionFilter - Only compact bottommost level if there is a compaction filter</p> </li> <li> <p>kForce - Always compact bottommost level</p> </li> <li> <p>kForceOptimized -  Always compact bottommost level but in bottommost level avoid double-compacting files created in the same compaction</p> </li> </ul>"},{"location":"variables.html#rocksdb_manual_compaction_threads","title":"rocksdb_manual_compaction_threads","text":"Option Description Command-line \u2013rocksdb-manual-compaction-threads Dynamic Yes Scope Local Data type INT Default 0 <p>The variable defines the number of RocksDB threads to run for a manual compaction. The minimum value is 0. The maximum value is 120. </p>"},{"location":"variables.html#rocksdb_manual_wal_flush","title":"<code>rocksdb_manual_wal_flush</code>","text":"Option Description Command-line \u2013rocksdb-manual-wal-flush Dynamic No Scope Global Data type Boolean Default ON <p>This variable can be used to disable automatic/timed WAL flushing and instead rely on the application to do the flushing.</p>"},{"location":"variables.html#rocksdb_master_skip_tx_api","title":"<code>rocksdb_master_skip_tx_api</code>","text":"Option Description Command-line Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. When enabled, uses the WriteBatch API, which is faster. The session does not hold any lock on row access. This variable is not effective on replica.</p> <p>Note</p> <p>Due to the disabled row locks, improper use of the variable can cause data corruption or inconsistency.</p>"},{"location":"variables.html#rocksdb_max_background_compactions","title":"<code>rocksdb_max_background_compactions</code>","text":"Option Description Command-line \u2013rocksdb-max-background-compactions Dynamic Yes Scope Global Data type Numeric Default -1 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11.</p> <p>Sets DBOptions:: max_background_compactions for RocksDB. The default value is <code>-1</code> The allowed range is <code>-1</code> to <code>64</code>. This variable was replaced by rocksdb_max_background_jobs, which automatically decides how many threads to allocate towards flush/compaction. This variable was re-implemented in Percona Server for MySQL 8.0.20-11.</p>"},{"location":"variables.html#rocksdb_max_background_flushes","title":"<code>rocksdb_max_background_flushes</code>","text":"Option Description Command-line \u2013rocksdb-max-background-flushes Dynamic No Scope Global Data type Numeric Default -1 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11.</p> <p>Sets DBOptions:: max_background_flushes for RocksDB. The default value is <code>-1</code>. The allowed range is <code>-1</code> to <code>64</code>. This variable has been replaced by rocksdb_max_background_jobs, which automatically decides how many threads to allocate towards flush/compaction.</p>"},{"location":"variables.html#rocksdb_max_background_jobs","title":"<code>rocksdb_max_background_jobs</code>","text":"Option Description Command-line \u2013rocksdb-max-background-jobs Dynamic Yes Scope Global Data type Numeric Default 2 <p>This variable replaced rocksdb_base_background_compactions, rocksdb_max_background_compactions, and rocksdb_max_background_flushes variables. This variable specifies the maximum number of background jobs. It automatically decides how many threads to allocate towards flush/compaction. It was implemented to reduce the number of (confusing) options users and can tweak and push the responsibility down to RocksDB level.</p>"},{"location":"variables.html#rocksdb_max_bottom_pri_background_compactions","title":"<code>rocksdb_max_bottom_pri_background_compactions</code>","text":"Option Description Command-line \u2013rocksdb_max_bottom_pri_background_compactions Dynamic No Data type Unsigned integer Default 0 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Creates a specified number of threads, sets a lower CPU priority, and letting compactions use them. The maximum compaction concurrency is capped by <code>rocksdb_max_background_compactions</code> or <code>rocksdb_max_background_jobs</code></p> <p>The minimum value is <code>0</code> and the maximum value is <code>64</code>.</p>"},{"location":"variables.html#rocksdb_max_compaction_history","title":"<code>rocksdb_max_compaction_history</code>","text":"Option Description Command-line \u2013rocksdb-max-compaction-history Dynamic Yes Scope Global Data type Unsigned integer Default 64 <p>The minimum value is <code>0</code> and the maximum value is <code>UINT64_MAX</code>.</p> <p>Tracks the history for at most <code>rockdb_mx_compaction_history</code> completed compactions. The history is in the INFORMATION_SCHEMA.ROCKSDB_COMPACTION_HISTORY table.</p>"},{"location":"variables.html#rocksdb_max_latest_deadlocks","title":"<code>rocksdb_max_latest_deadlocks</code>","text":"Option Description Command-line \u2013rocksdb-max-latest-deadlocks Dynamic Yes Scope Global Data type Numeric Default 5 <p>Specifies the maximum number of recent deadlocks to store.</p>"},{"location":"variables.html#rocksdb_max_log_file_size","title":"<code>rocksdb_max_log_file_size</code>","text":"Option Description Command-line \u2013rocksdb-max-log-file-size Dynamic No Scope Global Data type Numeric Default 0 <p>Specifies the maximum size for info log files, after which the log is rotated. Default value is <code>0</code>, meaning that only one log file is used. Allowed range is up to <code>18446744073709551615</code>.</p> <p>Also see rocksdb_log_file_time_to_roll.</p>"},{"location":"variables.html#rocksdb_max_manifest_file_size","title":"<code>rocksdb_max_manifest_file_size</code>","text":"Option Description Command-line \u2013rocksdb-manifest-log-file-size Dynamic No Scope Global Data type Numeric Default 18446744073709551615 <p>Specifies the maximum size of the MANIFEST data file, after which it is rotated. Default value is also the maximum, making it practically unlimited: only one manifest file is used.</p>"},{"location":"variables.html#rocksdb_max_manual_compactions","title":"<code>rocksdb_max_manual_compactions</code>","text":"Option Description Command-line \u2013rocksdb-max-manual-compactions Dynamic Yes Scope Global Data type UINT Default 10 <p>The variable defines the maximum number of pending plus ongoing manual compactions. The default value and the minimum value is 0. The maximum value is 4294967295 (UNIT_MAX).</p>"},{"location":"variables.html#rocksdb_max_open_files","title":"<code>rocksdb_max_open_files</code>","text":"Option Description Command-line \u2013rocksdb-max-open-files Dynamic No Scope Global Data type Numeric Default 1000 <p>Specifies the maximum number of file handles opened by MyRocks. Values in the range between <code>0</code> and <code>open_files_limit</code> are taken as they are. If rocksdb_max_open_files value is greater than <code>open_files_limit</code>, it will be reset to \u00bd of <code>open_files_limit</code>, and a warning will be emitted to the <code>mysqld</code> error log. A value of <code>-2</code> denotes auto tuning: just sets rocksdb_max_open_files value to \u00bd of <code>open_files_limit</code>. Finally, <code>-1</code> means no limit, i.e. an infinite number of file handles.</p> <p>Warning</p> <p>Setting rocksdb_max_open_files to <code>-1</code> is dangerous, as the server may quickly run out of file handles in this case.</p>"},{"location":"variables.html#rocksdb_max_row_locks","title":"<code>rocksdb_max_row_locks</code>","text":"Option Description Command-line \u2013rocksdb-max-row-locks Dynamic Yes Scope Global Data type Numeric Default 1048576 <p>Specifies the limit on the maximum number of row locks a transaction can have before it fails. Default value is also the maximum, making it practically unlimited: transactions never fail due to row locks.</p>"},{"location":"variables.html#rocksdb_max_subcompactions","title":"<code>rocksdb_max_subcompactions</code>","text":"Option Description Command-line \u2013rocksdb-max-subcompactions Dynamic No Scope Global Data type Numeric Default 1 <p>Specifies the maximum number of threads allowed for each compaction job. Default value of <code>1</code> means no subcompactions (one thread per compaction job). Allowed range is up to <code>64</code>.</p>"},{"location":"variables.html#rocksdb_max_total_wal_size","title":"<code>rocksdb_max_total_wal_size</code>","text":"Option Description Command-line \u2013rocksdb-max-total-wal-size Dynamic No Scope Global Data type Numeric Default 2 GB <p>Specifies the maximum total size of WAL (write-ahead log) files, after which memtables are flushed. Default value is <code>2 GB</code> The allowed range is up to <code>9223372036854775807</code>.</p>"},{"location":"variables.html#rocksdb_merge_buf_size","title":"<code>rocksdb_merge_buf_size</code>","text":"Option Description Command-line \u2013rocksdb-merge-buf-size Dynamic Yes Scope Global Data type Numeric Default 67108864 <p>Specifies the size (in bytes) of the merge-sort buffers used to accumulate data during secondary key creation. New entries are written directly to the lowest level in the database, instead of updating indexes through the memtable and L0. These values are sorted using merge-sort, with buffers set to 64 MB by default (<code>67108864</code>). Allowed range is from <code>100</code> to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_merge_combine_read_size","title":"<code>rocksdb_merge_combine_read_size</code>","text":"Option Description Command-line \u2013rocksdb-merge-combine-read-size Dynamic Yes Scope Global Data type Numeric Default 1073741824 <p>Specifies the size (in bytes) of the merge-combine buffer used for the merge-sort algorithm as described in rocksdb_merge_buf_size. Default size is 1 GB (<code>1073741824</code>). Allowed range is from <code>100</code> to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_merge_tmp_file_removal_delay_ms","title":"<code>rocksdb_merge_tmp_file_removal_delay_ms</code>","text":"Option Description Command-line \u2013rocksdb_merge_tmp_file_removal_delay_ms Dynamic Yes Scope Global, Session Data type Numeric Default 0 <p>Fast secondary index creation creates merge files when needed. After finishing secondary index creation, merge files are removed. By default, the file removal is done without any sleep, so removing GBs of merge files within &lt;1s may happen, which will cause trim stalls on Flash. This variable can be used to rate limit the delay in milliseconds.</p>"},{"location":"variables.html#rocksdb_new_table_reader_for_compaction_inputs","title":"<code>rocksdb_new_table_reader_for_compaction_inputs</code>","text":"Option Description Command-line \u2013rocksdb-new-table-reader-for-compaction-inputs Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether MyRocks should create a new file descriptor and table reader for each compaction input. Disabled by default. Enabling this may increase memory consumption, but will also allow pre-fetch options to be specified for compaction input files without impacting table readers used for user queries.</p>"},{"location":"variables.html#rocksdb_no_block_cache","title":"<code>rocksdb_no_block_cache</code>","text":"Option Description Command-line \u2013rocksdb-no-block-cache Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to disable the block cache for column families. Variable is disabled by default, meaning that using the block cache is allowed.</p>"},{"location":"variables.html#rocksdb_no_create_column_family","title":"<code>rocksdb_no_create_column_family</code>","text":"Option Description Command-line \u2013rocksdb-no-create-column-family Dynamic No Scope Global Data type Boolean Default ON <p>Controls the processing of the column family name given in the <code>COMMENT</code> clause in the <code>CREATE TABLE</code> or <code>ALTER TABLE</code> statement in case the column family name does not refer to an existing column family.</p> <p>If rocksdb_no_create_column_family is set to NO, a new column family will be created and the new index will be placed into it.</p> <p>If rocksdb_no_create_column_family is set to YES, no new column family will be created and the index will be placed into the default column family. A warning is issued in this case informing that the specified column family does not exist and cannot be created.</p>"},{"location":"variables.html#rocksdb_override_cf_options","title":"<code>rocksdb_override_cf_options</code>","text":"Option Description Command-line \u2013rocksdb-override-cf-options Dynamic No Scope Global Data type String Default <p>Specifies option overrides for each column family. Empty by default.</p>"},{"location":"variables.html#rocksdb_paranoid_checks","title":"<code>rocksdb_paranoid_checks</code>","text":"Option Description Command-line \u2013rocksdb-paranoid-checks Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether MyRocks should re-read the data file as soon as it is created to verify correctness. Enabled by default.</p>"},{"location":"variables.html#rocksdb_partial_index_sort_max_mem","title":"<code>rocksdb_partial_index_sort_max_mem</code>","text":"Option Description Command-line \u2013rocksdb-partial-index-sort-max-mem Dynamic Yes Scope Local Data type Unsigned Integer Default 0 <p>The variable was implemented in Percona Server for MySQL 8.0.27-18. Maximum memory to use when sorting an unmaterialized group for partial indexes. The 0(zero) value is defined as no limit.</p>"},{"location":"variables.html#rocksdb_pause_background_work","title":"<code>rocksdb_pause_background_work</code>","text":"Option Description Command-line \u2013rocksdb-pause-background-work Dynamic Yes Scope Global Data type Boolean Default OFF <p>Specifies whether MyRocks should pause all background operations. Disabled by default. There is no practical reason for a user to ever use this variable because it is intended as a test synchronization tool for the MyRocks MTR test suites.</p> <p>Warning</p> <p>If someone were to set a rocksdb_force_flush_memtable_now to <code>1</code> while rocksdb_pause_background_work is set to <code>1</code>, the client that issued the <code>rocksdb_force_flush_memtable_now=1</code> will be blocked indefinitely until rocksdb_pause_background_work is set to <code>0</code>.</p>"},{"location":"variables.html#rocksdb_partial_index_blind_delete","title":"<code>rocksdb_partial_index_blind_delete</code>","text":"Option Description Command-line \u2013rocksdb_partial_index_blind_delete Dynamic Yes Scope Global Data type Boolean Default ON <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>If enabled, the server does not read from the partial index to check if the key exists before  deleting the partial index and the delete marker is unconditionally written.</p> <p>If the variable is disabled (OFF), the server always reads from partial index to check if key exists before  deleting the partial index. </p> <p>This variable is enabled (ON) by default.</p>"},{"location":"variables.html#rocksdb_perf_context_level","title":"<code>rocksdb_perf_context_level</code>","text":"Option Description Command-line \u2013rocksdb-perf-context-level Dynamic Yes Scope Global, Session Data type Numeric Default 0 <p>Specifies the level of information to capture with the Perf Context plugins. The default value is <code>0</code>. The allowed range is up to <code>5</code>.</p> Value Description 1 Disable perf stats 2 Enable only count stats 3 Enable count stats and time stats except for mutexes 4 Enable count stats and time stats, except for wall time or CPU time for mutexes 5 Enable all count stats and time stats"},{"location":"variables.html#rocksdb_persistent_cache_path","title":"<code>rocksdb_persistent_cache_path</code>","text":"Option Description Command-line \u2013rocksdb-persistent-cache-path Dynamic No Scope Global Data type String Default <p>Specifies the path to the persistent cache. Set this together with rocksdb_persistent_cache_size_mb.</p>"},{"location":"variables.html#rocksdb_persistent_cache_size_mb","title":"<code>rocksdb_persistent_cache_size_mb</code>","text":"Option Description Command-line \u2013rocksdb-persistent-cache-size-mb Dynamic No Scope Global Data type Numeric Default 0 <p>Specifies the size of the persisten cache in megabytes. Default is <code>0</code> (persistent cache disabled). Allowed range is up to <code>18446744073709551615</code>. Set this together with rocksdb_persistent_cache_path.</p>"},{"location":"variables.html#rocksdb_pin_l0_filter_and_index_blocks_in_cache","title":"<code>rocksdb_pin_l0_filter_and_index_blocks_in_cache</code>","text":"Option Description Command-line \u2013rocksdb-pin-l0-filter-and-index-blocks-in-cache Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether MyRocks pins the filter and index blocks in the cache if rocksdb_cache_index_and_filter_blocks is enabled. Enabled by default.</p>"},{"location":"variables.html#rocksdb_print_snapshot_conflict_queries","title":"<code>rocksdb_print_snapshot_conflict_queries</code>","text":"Option Description Command-line \u2013rocksdb-print-snapshot-conflict-queries Dynamic Yes Scope Global Data type Boolean Default OFF <p>Specifies whether queries that generate snapshot conflicts should be logged to the error log. Disabled by default.</p>"},{"location":"variables.html#rocksdb_protection_bytes_per_key","title":"<code>rocksdb_protection_bytes_per_key</code>","text":"Option Description Command-line \u2013rocksdb_protection_bytes_per_key Dynamic Yes Scope Global, Session Data type Numeric Default 0 <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>This variable is used to configure <code>WriteOptions::protection_bytes_per_key</code>. The default value is 0 (disabled). When this variable is set to 1, 2, 4, or 8, it uses that number of bytes per key value to protect entries in the WriteBatch.</p> <p>The minimum value is <code>0</code>.</p> <p>The maximum value is <code>ULONG_MAX (0xFFFFFFFF)</code>.</p>"},{"location":"variables.html#rocksdb_rate_limiter_bytes_per_sec","title":"<code>rocksdb_rate_limiter_bytes_per_sec</code>","text":"Option Description Command-line \u2013rocksdb-rate-limiter-bytes-per-sec Dynamic Yes Scope Global Data type Numeric Default 0 <p>Specifies the maximum rate at which MyRocks can write to media via memtable flushes and compaction. Default value is <code>0</code> (write rate is not limited). Allowed range is up to <code>9223372036854775807</code>.</p>"},{"location":"variables.html#rocksdb_read_free_rpl","title":"<code>rocksdb_read_free_rpl</code>","text":"Option Description Command-line \u2013rocksdb-read-free-rpl Dynamic Yes Scope Global Data type Enum Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Uses read-free replication, which allows no row lookup during replication, on the replica.</p> <p>The options are the following:</p> <ul> <li> <p>OFF - Disables the variable</p> </li> <li> <p>PK_SK - Enables the variable on all tables with a primary key</p> </li> <li> <p>PK_ONLY - Enables the variable on tables where the only key is the primary key</p> </li> </ul>"},{"location":"variables.html#rocksdb_read_free_rpl_tables","title":"<code>rocksdb_read_free_rpl_tables</code>","text":"Option Description Command-line \u2013rocksdb-read-free-rpl-tables Dynamic Yes Scope Global, Session Data type String Default <p>The variable was disabled in Percona Server for MySQL 8.0.20-11. We recommend that you use <code>rocksdb_read_free_rpl</code> instead of this variable.</p> <p>This variable lists tables (as a regular expression) that should use read-free replication on the replica (that is, replication without row lookups). Empty by default.</p>"},{"location":"variables.html#rocksdb_records_in_range","title":"<code>rocksdb_records_in_range</code>","text":"Option Description Command-line \u2013rocksdb-records-in-range Dynamic Yes Scope Global, Session Data type Numeric Default 0 <p>Specifies the value to override the result of <code>records_in_range()</code>. Default value is <code>0</code>. Allowed range is up to <code>2147483647</code>.</p>"},{"location":"variables.html#rocksdb_reset_stats","title":"<code>rocksdb_reset_stats</code>","text":"Option Description Command-line \u2013rocksdb-reset-stats Dynamic Yes Scope Global Data type Boolean Default OFF <p>Resets MyRocks internal statistics dynamically (without restarting the server).</p>"},{"location":"variables.html#rocksdb_rollback_on_timeout","title":"<code>rocksdb_rollback_on_timeout</code>","text":"Option Description Command-line \u2013rocksdb-rollback-on-timeout Dynamic Yes Scope Global Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. By default, only the last statement on a transaction is rolled back. If <code>--rocksdb-rollback-on-timeout=ON</code>, a transaction timeout causes a rollback of the entire transaction.</p>"},{"location":"variables.html#rocksdb_rpl_skip_tx_api","title":"<code>rocksdb_rpl_skip_tx_api</code>","text":"Option Description Command-line \u2013rocksdb-rpl-skip-tx-api Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether write batches should be used for replication thread instead of the transaction API. Disabled by default.</p> <p>There are two conditions which are necessary to use it: row replication format and replica operating in super read only mode.</p>"},{"location":"variables.html#rocksdb_seconds_between_stat_computes","title":"<code>rocksdb_seconds_between_stat_computes</code>","text":"Option Description Command-line \u2013rocksdb-seconds-between-stat-computes Dynamic Yes Scope Global Data type Numeric Default 3600 <p>Specifies the number of seconds to wait between recomputation of table statistics for the optimizer. During that time, only changed indexes are updated. Default value is <code>3600</code>. Allowed is from <code>0</code> to <code>4294967295</code>.</p>"},{"location":"variables.html#rocksdb_signal_drop_index_thread","title":"<code>rocksdb_signal_drop_index_thread</code>","text":"Option Description Command-line \u2013rocksdb-signal-drop-index-thread Dynamic Yes Scope Global Data type Boolean Default OFF <p>Signals the MyRocks drop index thread to wake up.</p>"},{"location":"variables.html#rocksdb_sim_cache_size","title":"<code>rocksdb_sim_cache_size</code>","text":"Option Description Command-line \u2013rocksdb-sim-cache-size Dynamic No Scope Global Data type Numeric Default 0 <p>Enables the simulated cache, which allows us to figure out the hit/miss rate with a specific cache size without changing the real block cache.</p>"},{"location":"variables.html#rocksdb_skip_bloom_filter_on_read","title":"<code>rocksdb_skip_bloom_filter_on_read</code>","text":"Option Description Command-line \u2013rocksdb-skip-bloom-filter-on_read Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether bloom filters should be skipped on reads. Disabled by default (bloom filters are not skipped).</p>"},{"location":"variables.html#rocksdb_skip_fill_cache","title":"<code>rocksdb_skip_fill_cache</code>","text":"Option Description Command-line \u2013rocksdb-skip-fill-cache Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether to skip caching data on read requests. Disabled by default (caching is not skipped).</p>"},{"location":"variables.html#rocksdb_skip_locks_if_skip_unique_check","title":"<code>rocksdb_skip_locks_if_skip_unique_check</code>","text":"Option Description Command-line rocksdb_skip_locks_if_skip_unique_check Dynamic Yes Scope Global Data type Boolean Default OFF <p>Skip row locking when unique checks are disabled.</p>"},{"location":"variables.html#rocksdb_sst_mgr_rate_bytes_per_sec","title":"<code>rocksdb_sst_mgr_rate_bytes_per_sec</code>","text":"Option Description Command-line \u2013rocksdb-sst-mgr-rate-bytes-per-sec Dynamic Yes Scope Global, Session Data type Numeric Default 0 <p>Specifies the maximum rate for writing to data files. Default value is <code>0</code>. This option is not effective on HDD. Allowed range is from <code>0</code> to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_stats_dump_period_sec","title":"<code>rocksdb_stats_dump_period_sec</code>","text":"Option Description Command-line \u2013rocksdb-stats-dump-period-sec Dynamic No Scope Global Data type Numeric Default 600 <p>Specifies the period in seconds for performing a dump of the MyRocks statistics to the info log. Default value is <code>600</code>. Allowed range is up to <code>2147483647</code>.</p>"},{"location":"variables.html#rocksdb_stats_level","title":"<code>rocksdb_stats_level</code>","text":"Option Description Command-line \u2013rocksdb-stats-level Dynamic Yes Scope Global Data type Numeric Default 0 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Controls the RocksDB statistics level. The default value is \u201c0\u201d (kExceptHistogramOrTimers), which is the fastest level. The maximum value is \u201c4\u201d.</p>"},{"location":"variables.html#rocksdb_stats_recalc_rate","title":"<code>rocksdb_stats_recalc_rate</code>","text":"Option Description Command-line \u2013rocksdb-stats-recalc-rate Dynamic No Scope Global Data type Numeric Default 0 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Specifies the number of indexes to recalculate per second. Recalculating index statistics periodically ensures it to match the actual sum from SST files. Default value is <code>0</code>. Allowed range is up to <code>4294967295</code>.</p>"},{"location":"variables.html#rocksdb_store_row_debug_checksums","title":"<code>rocksdb_store_row_debug_checksums</code>","text":"Option Description Command-line \u2013rocksdb-store-row-debug-checksums Dynamic Yes Scope Global Data type Boolean Default OFF <p>Specifies whether to include checksums when writing index or table records. Disabled by default.</p>"},{"location":"variables.html#rocksdb_strict_collation_check","title":"<code>rocksdb_strict_collation_check</code>","text":"Option Description Command-line \u2013rocksdb-strict-collation-check Dynamic Yes Scope Global Data type Boolean Default ON <p>This variable is considered deprecated in version 8.0.23-14.</p> <p>Specifies whether to check and verify that table indexes have proper collation settings. Enabled by default.</p>"},{"location":"variables.html#rocksdb_strict_collation_exceptions","title":"<code>rocksdb_strict_collation_exceptions</code>","text":"Option Description Command-line \u2013rocksdb-strict-collation-exceptions Dynamic Yes Scope Global Data type String Default <p>This variable is considered deprecated in version 8.0.23-14.</p> <p>Lists tables (as a regular expression) that should be excluded from verifying case-sensitive collation enforced by rocksdb_strict_collation_check. Empty by default.</p>"},{"location":"variables.html#rocksdb_table_cache_numshardbits","title":"<code>rocksdb_table_cache_numshardbits</code>","text":"Option Description Command-line \u2013rocksdb-table-cache-numshardbits Dynamic No Scope Global Data type Numeric Default 6 <p>Specifies the number if table caches. The default value is <code>6</code>. The allowed range is from <code>0</code> to <code>19</code>.</p>"},{"location":"variables.html#rocksdb_table_stats_background_thread_nice_value","title":"<code>rocksdb_table_stats_background_thread_nice_value</code>","text":"Option Description Command-line \u2013rocksdb-table-stats-background-thread-nice-value Dynamic Yes Scope Global Data type Numeric Default 19 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11.</p> <p>The nice value for index stats. The minimum = -20 (THREAD_PRIO_MIN) The maximum = 19 (THREAD_PRIO_MAX)</p>"},{"location":"variables.html#rocksdb_table_stats_max_num_rows_scanned","title":"<code>rocksdb_table_stats_max_num_rows_scanned</code>","text":"Option Description Command-line \u2013rocksdb-table-stats-max-num-rows-scanned Dynamic Yes Scope Global Data type Numeric Default 0 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11.</p> <p>The maximum number of rows to scan in a table scan based on a cardinality calculation. The minimum is <code>0</code> (every modification triggers a stats recalculation). The maximum is <code>18,446,744,073,709,551,615</code>.</p>"},{"location":"variables.html#rocksdb_table_stats_recalc_threshold_count","title":"<code>rocksdb_table_stats_recalc_threshold_count</code>","text":"Option Description Command-line \u2013rocksdb-table-stats-recalc-threshold-count Dynamic Yes Scope Global Data type Numeric Default 100 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11.</p> <p>The number of modified rows to trigger a stats recalculation. This is a dependent variable for stats recalculation. The minimum is <code>0</code>. The maximum is <code>18,446,744,073,709,551,615</code>.</p>"},{"location":"variables.html#rocksdb_table_stats_recalc_threshold_pct","title":"<code>rocksdb_table_stats_recalc_threshold_pct</code>","text":"Option Description Command-line \u2013rocksdb-table-stats-recalc-threshold-pct Dynamic Yes Scope Global Data type Numeric Default 10 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11.</p> <p>The percentage of the number of modified rows over the total number of rows to trigger stats recalculations. This is a dependent variable for stats recalculation. The minimum value is <code>0</code> The maximum value is <code>100</code> (RDB_TBL_STATS_RECALC_THRESHOLD_PCT_MAX).</p>"},{"location":"variables.html#rocksdb_table_stats_sampling_pct","title":"<code>rocksdb_table_stats_sampling_pct</code>","text":"Option Description Command-line \u2013rocksdb-table-stats-sampling-pct Dynamic Yes Scope Global Data type Numeric Default 10 <p>Specifies the percentage of entries to sample when collecting statistics about table properties. Default value is <code>10</code>. Allowed range is from <code>0</code> to <code>100</code>.</p>"},{"location":"variables.html#rocksdb_table_stats_use_table_scan","title":"<code>rocksdb_table_stats_use_table_scan</code>","text":"Option Description Command-line \u2013rocksdb-table-stats-use-table-scan Dynamic Yes Scope Global Data type Boolean Default FALSE <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Enables table-scan-based index calculations. The default value is <code>FALSE</code>.</p>"},{"location":"variables.html#rocksdb_tmpdir","title":"<code>rocksdb_tmpdir</code>","text":"Option Description Command-line \u2013rocksdb-tmpdir Dynamic Yes Scope Global, Session Data type String Default <p>Specifies the path to the directory for temporary files during DDL operations.</p>"},{"location":"variables.html#rocksdb_trace_block_cache_access","title":"<code>rocksdb_trace_block_cache_access</code>","text":"Option Description Command-line \u2013rocksdb-trace-block-cache-access Dynamic Yes Scope Global Data type String Default \"\" <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Defines the block cache trace option string. The format is sampling frequency: max_trace_file_size:trace_file_name. The sampling frequency value and max_trace_file_size value are positive integers. The block accesses are saved to the <code>rocksdb_datadir/block_cache_traces/trace_file_name</code>. The default value is an empty string.</p>"},{"location":"variables.html#rocksdb_trace_queries","title":"<code>rocksdb_trace_queries</code>","text":"Option Description Command-line \u2013rocksdb-trace-queries Dynamic Yes Scope Global Data type String Default \"\" <p>This variable is a trace option string. The format is sampling_frequency:max_trace_file_size:trace_file_name. The sampling_frequency and max_trace_file_size are positive integers. The queries are saved to the rocksdb_datadir/queries_traces/trace_file_name.</p>"},{"location":"variables.html#rocksdb_trace_sst_api","title":"<code>rocksdb_trace_sst_api</code>","text":"Option Description Command-line \u2013rocksdb-trace-sst-api Dynamic Yes Scope Global Data type Boolean Default OFF <p>Specifies whether to generate trace output in the log for each call to <code>SstFileWriter</code>. Disabled by default.</p>"},{"location":"variables.html#rocksdb_track_and_verify_wals_in_manifest","title":"<code>rocksdb_track_and_verify_wals_in_manifest</code>","text":"Option Description Command-line \u2013rocksdb-track-and-verify-wals-in-manifest Dynamic No Scope Global Data type Boolean Default ON <p>DBOptions::track_and_verify_wals_in_manifest for RocksDB.</p>"},{"location":"variables.html#rocksdb_two_write_queues","title":"<code>rocksdb_two_write_queues</code>","text":"Option Description Command-line \u2013rocksdb-track-and-verify-wals-in-manifest Dynamic No Scope Global Data type Boolean Default ON <p>When enabled this variable allows/encourages threads that are using two-phase commit to <code>prepare</code> in parallel.</p>"},{"location":"variables.html#rocksdb_unsafe_for_binlog","title":"<code>rocksdb_unsafe_for_binlog</code>","text":"Option Description Command-line \u2013rocksdb-unsafe-for-binlog Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether to allow statement-based binary logging which may break consistency. Disabled by default.</p>"},{"location":"variables.html#rocksdb_update_cf_options","title":"<code>rocksdb_update_cf_options</code>","text":"Option Description Command-line \u2013rocksdb-update-cf-options Dynamic No Scope Global Data type String Default <p>Specifies option updates for each column family. Empty by default.</p>"},{"location":"variables.html#rocksdb_use_adaptive_mutex","title":"<code>rocksdb_use_adaptive_mutex</code>","text":"Option Description Command-line \u2013rocksdb-use-adaptive-mutex Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to use adaptive mutex which spins in user space before resorting to the kernel. Disabled by default.</p>"},{"location":"variables.html#rocksdb_use_default_sk_cf","title":"<code>rocksdb_use_default_sk_cf</code>","text":"Option Description Command-line \u2013rocksdb-use-default-sk-cf Dynamic No Scope Global Data type Boolean Default OFF <p>Use <code>default_sk</code> column family for secondary keys.</p>"},{"location":"variables.html#rocksdb_use_direct_io_for_flush_and_compaction","title":"<code>rocksdb_use_direct_io_for_flush_and_compaction</code>","text":"Option Description Command-line \u2013rocksdb-use-direct-io-for-flush-and-compaction Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to write to data files directly, without caches or buffers. Disabled by default.</p>"},{"location":"variables.html#rocksdb_use_direct_reads","title":"<code>rocksdb_use_direct_reads</code>","text":"Option Description Command-line \u2013rocksdb-use-direct-reads Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether to read data files directly, without caches or buffers. Disabled by default. If you enable this, make sure that rocksdb_allow_mmap_reads is disabled.</p>"},{"location":"variables.html#rocksdb_use_fsync","title":"<code>rocksdb_use_fsync</code>","text":"Option Description Command-line \u2013rocksdb-use-fsync Dynamic No Scope Global Data type Boolean Default OFF <p>Specifies whether MyRocks should use <code>fsync</code> instead of <code>fdatasync</code> when requesting a sync of a data file. Disabled by default.</p>"},{"location":"variables.html#rocksdb_use_hyper_clock_cache","title":"<code>rocksdb_use_hyper_clock_cache</code>","text":"Option Description Command-line \u2013rocksdb_use_hyper_clock_cache Dynamic No Scope Global Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>If enabled, this variable uses HyperClockCache instead of default LRUCache for RocksDB.</p> <p>This variable is disabled (OFF) by default.</p>"},{"location":"variables.html#rocksdb_use_write_buffer_manager","title":"<code>rocksdb_use_write_buffer_manager</code>","text":"Option Description Command-line \u2013rocksdb_use_write_buffer_manager Dynamic No Scope Global Data type Boolean Default OFF <p>The variable was implemented in Percona Server for MySQL 8.0.33-25.</p> <p>This variable is tech preview and may be removed in the future releases.</p> <p>Allows to turn on the write buffer manager (WriteBufferManager) from <code>cnf</code> files. This variable is related to <code>rocksdb_charge_memory</code>.</p>"},{"location":"variables.html#rocksdb_validate_tables","title":"<code>rocksdb_validate_tables</code>","text":"Option Description Command-line \u2013rocksdb-validate-tables Dynamic No Scope Global Data type Numeric Default 1 <p>The variable was implemented in Percona Server for MySQL 8.0.20-11. Specifies whether to verify that MySQL data dictionary is equal to the MyRocks data dictionary.</p> <ul> <li> <p><code>0</code>: do not verify.</p> </li> <li> <p><code>1</code>: verify and fail on error (default).</p> </li> <li> <p><code>2</code>: verify and continue with error.</p> </li> </ul>"},{"location":"variables.html#rocksdb_verify_row_debug_checksums","title":"<code>rocksdb_verify_row_debug_checksums</code>","text":"Option Description Command-line \u2013rocksdb-verify-row-debug-checksums Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether to verify checksums when reading index or table records. Disabled by default.</p>"},{"location":"variables.html#rocksdb_wal_bytes_per_sync","title":"<code>rocksdb_wal_bytes_per_sync</code>","text":"Option Description Command-line \u2013rocksdb-wal-bytes-per-sync Dynamic Yes Scope Global Data type Numeric Default 0 <p>Specifies how often should the OS sync WAL (write-ahead log) files to disk as they are being written, asynchronously, in the background. This operation can be used to smooth out write I/O over time. Default value is <code>0</code>, meaning that files are never synced. Allowed range is up to <code>18446744073709551615</code>.</p>"},{"location":"variables.html#rocksdb_wal_dir","title":"<code>rocksdb_wal_dir</code>","text":"Option Description Command-line \u2013rocksdb-wal-dir Dynamic No Scope Global Data type String Default <p>Specifies the path to the directory where MyRocks stores WAL files.</p>"},{"location":"variables.html#rocksdb_wal_recovery_mode","title":"<code>rocksdb_wal_recovery_mode</code>","text":"Option Description Command-line \u2013rocksdb-wal-recovery-mode Dynamic Yes Scope Global Data type Numeric Default 2 <p>Note</p> <p>In version Percona Server for MySQL 8.0.20-11 and later, the default is changed from <code>1</code> to <code>2</code>.</p> <p>Specifies the level of tolerance when recovering write-ahead logs (WAL) files after a system crash.</p> <p>The following are the options:</p> <ul> <li> <p><code>0</code>: if the last WAL entry is corrupted, truncate the entry and either start the server normally or refuse to start.</p> </li> <li> <p><code>1</code>: if a WAL entry is corrupted, the server fails to   start and does not recover from the crash.</p> </li> <li> <p><code>2</code> (default): if a corrupted WAL entry is detected, truncate all entries after the detected corrupted entry. You can select this setting for replication replicas.</p> </li> <li> <p><code>3</code>: If a corrupted WAL entry is detected, skip only the corrupted entry and continue the apply WAL entries. This option can be dangerous.</p> </li> </ul>"},{"location":"variables.html#rocksdb_wal_size_limit_mb","title":"<code>rocksdb_wal_size_limit_mb</code>","text":"Option Description Command-line \u2013rocksdb-wal-size-limit-mb Dynamic No Scope Global Data type Numeric Default 0 <p>Specifies the maximum size of all WAL files in megabytes before attempting to flush memtables and delete the oldest files. Default value is <code>0</code> (never rotated). Allowed range is up to <code>9223372036854775807</code>.</p>"},{"location":"variables.html#rocksdb_wal_ttl_seconds","title":"<code>rocksdb_wal_ttl_seconds</code>","text":"Option Description Command-line \u2013rocksdb-wal-ttl-seconds Dynamic No Scope Global Data type Numeric Default 0 <p>Specifies the timeout in seconds before deleting archived WAL files. Default is <code>0</code> (archived WAL files are never deleted). Allowed range is up to <code>9223372036854775807</code>.</p>"},{"location":"variables.html#rocksdb_whole_key_filtering","title":"<code>rocksdb_whole_key_filtering</code>","text":"Option Description Command-line \u2013rocksdb-whole-key-filtering Dynamic No Scope Global Data type Boolean Default ON <p>Specifies whether the bloomfilter should use the whole key for filtering instead of just the prefix. Enabled by default. Make sure that lookups use the whole key for matching.</p>"},{"location":"variables.html#rocksdb_write_batch_flush_threshold","title":"<code>rocksdb_write_batch_flush_threshold</code>","text":"Option Description Command-line \u2013rocksdb-write-batch-flush-threshold Dynamic Yes Scope Local Data type Integer Default 0 <p>This variable specifies the maximum size of the write batch in bytes before flushing. Only valid if <code>rockdb_write_policy</code> is WRITE_UNPREPARED. There is no limit if the variable is set to the default setting.</p>"},{"location":"variables.html#rocksdb_write_batch_max_bytes","title":"<code>rocksdb_write_batch_max_bytes</code>","text":"Option Description Command-line \u2013rocksdb-write-batch-max-bytes Dynamic Yes Scope Global Data type Numeric Default 0 <p>Specifies the maximum size of a RocksDB write batch in bytes. <code>0</code> means no limit. In case user exceeds the limit following error will be shown: <code>ERROR HY000: Status error 10 received from RocksDB: Operation aborted: Memory limit reached</code>.</p>"},{"location":"variables.html#rocksdb_write_disable_wal","title":"<code>rocksdb_write_disable_wal</code>","text":"Option Description Command-line \u2013rocksdb-write-disable-wal Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Lets you temporarily disable writes to WAL files, which can be useful for bulk loading.</p>"},{"location":"variables.html#rocksdb_write_ignore_missing_column_families","title":"<code>rocksdb_write_ignore_missing_column_families</code>","text":"Option Description Command-line \u2013rocksdb-write-ignore-missing-column-families Dynamic Yes Scope Global, Session Data type Boolean Default OFF <p>Specifies whether to ignore writes to column families that do not exist. Disabled by default (writes to non-existent column families are not ignored).</p>"},{"location":"variables.html#rocksdb_write_policy","title":"<code>rocksdb_write_policy</code>","text":"Option Description Command-line \u2013rocksdb-write-policy Dynamic No Scope Global Data type String Default write_committed <p>Specifies when two-phase commit data are written into the database. Allowed values are <code>write_committed</code>, <code>write_prepared</code>, and <code>write_unprepared</code>.</p> Value Description <code>write_committed</code> Data written at commit time <code>write_prepared</code> Data written after the prepare phase of a two-phase transaction <code>write_unprepared</code> Data written before the prepare phase of a two-phase transaction"},{"location":"verifying-encryption.html","title":"Verify the encryption for tables, tablespaces, and schemas","text":"<p>If a general tablespace contains tables, check the table information to see if the table is encrypted. When the general tablespace contains no tables, you may verify if the tablespace is encrypted or not.</p> <p>For single tablespaces, verify the ENCRYPTION option using INFORMATION_SCHEMA.TABLES and the CREATE OPTIONS settings.</p> <pre><code>mysql&gt; SELECT TABLE_SCHEMA, TABLE_NAME, CREATE_OPTIONS FROM\n       INFORMATION_SCHEMA.TABLES WHERE CREATE_OPTIONS LIKE '%ENCRYPTION%';\n</code></pre> Expected output <pre><code>+----------------------+-------------------+------------------------------+\n| TABLE_SCHEMA         | TABLE_NAME        | CREATE_OPTIONS               |\n+----------------------+-------------------+------------------------------+\n|sample                | t1                | ENCRYPTION=\"Y\"               |\n+----------------------+-------------------+------------------------------+\n</code></pre> <p>A <code>flag</code> field in the <code>INFORMATION_SCHEMA.INNODB_TABLESPACES</code> has bit number 13 set if the tablespace is encrypted. This bit can be checked with the <code>flag &amp; 8192</code> expression in the following way:</p> <pre><code>SELECT space, name, flag, (flag &amp; 8192) != 0 AS encrypted FROM\nINFORMATION_SCHEMA.INNODB_TABLESPACES WHERE name in ('foo', 'test/t2', 'bar',\n'noencrypt');\n</code></pre> <p>The encrypted table metadata is contained in the INFORMATION_SCHEMA.INNODB_TABLESPACES_ENCRYPTION table. You must have the <code>Process</code> privilege to view the table information.</p> <p>Note</p> <p>This table is in tech preview and may change in future releases.</p> <pre><code>   mysql&gt; DESCRIBE INNODB_TABLESPACES_ENCRYPTION;\n</code></pre> Expected output <pre><code>+-----------------------------+--------------------+-----+----+--------+------+\n| Field                       | Type               | Null| Key| Default| Extra|\n+-----------------------------+--------------------+-----+----+--------+------+\n| SPACE                       | int(11) unsigned   | NO  |    |        |      |\n| NAME                        | varchar(655)       | YES |    |        |      |\n| ENCRYPTION_SCHEME           | int(11) unsigned   | NO  |    |        |      |\n| KEYSERVER_REQUESTS          | int(11) unsigned   | NO  |    |        |      |\n| MIN_KEY_VERSION             | int(11) unsigned   | NO  |    |        |      |\n| CURRENT_KEY_VERSION         | int(11) unsigned   | NO  |    |        |      |\n| KEY_ROTATION_PAGE_NUMBER    | bigint(21) unsigned| YES |    |        |      |\n| KEY_ROTATION_MAX_PAGE_NUMBER| bigint(21) unsigned| YES |    |        |      |\n| CURRENT_KEY_ID              | int(11) unsigned   | NO  |    |        |      |\n| ROTATING_OR_FLUSHING        | int(1) unsigned    | NO  |    |        |      |\n+-----------------------------+--------------------+-----+----+--------+------+\n</code></pre> <p>To identify encryption-enabled schemas, query the INFORMATION_SCHEMA.SCHEMATA table:</p> <pre><code>mysql&gt; SELECT SCHEMA_NAME, DEFAULT_ENCRYPTION FROM\nINFORMATION_SCHEMA.SCHEMATA WHERE DEFAULT_ENCRYPTION='YES';\n</code></pre> Expected output <pre><code>+------------------------------+---------------------------------+\n| SCHEMA_NAME                  | DEFAULT_ENCRYPTION              |\n+------------------------------+---------------------------------+\n| samples                      | YES                             |\n+------------------------------+---------------------------------+\n</code></pre> <p>Note</p> <p>The <code>SHOW CREATE SCHEMA</code> statement returns the <code>DEFAULT ENCRYPTION</code> clause.</p>"},{"location":"xtradb-performance-improvements-io-bound-highly-concurrent-workloads.html","title":"XtraDB performance improvements for I/O-bound highly-concurrent workloads","text":""},{"location":"xtradb-performance-improvements-io-bound-highly-concurrent-workloads.html#priority-refill-for-the-buffer-pool-free-list","title":"Priority refill for the buffer pool free list","text":"<p>In highly-concurrent I/O-bound workloads the following situation may happen:</p> <ul> <li> <p>Buffer pool free lists are used faster than they are refilled by the LRU cleaner thread.</p> </li> <li> <p>Buffer pool free lists become empty and more and more query and utility (i.e., purge) threads stall, checking whether a buffer pool free list has became non-empty, sleeping, performing single-page LRU flushes.</p> </li> <li> <p>The number of buffer pool free list mutex waiters increases.</p> </li> <li> <p>When the LRU manager thread (or a single page LRU flush by a query thread) finally produces a free page, it is starved from putting it on the buffer pool free list as it must acquire the buffer pool free list mutex too. However, being one thread in up to hundreds, the chances of a prompt acquisition are low.</p> </li> </ul> <p>This is addressed by delegating all the LRU flushes to the to the LRU manager thread, never attempting to evict a page or perform a LRU single page flush by a query thread, and introducing a backoff algorithm to reduce buffer pool free list mutex pressure on empty buffer pool free lists. This is controlled through a new system variable innodb_empty_free_list_algorithm.</p>"},{"location":"xtradb-performance-improvements-io-bound-highly-concurrent-workloads.html#innodb_empty_free_list_algorithm","title":"<code>innodb_empty_free_list_algorithm</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: Yes Data type: legacy, backoff Default legacy <p>When <code>legacy</code> option is set, server will use the upstream algorithm and when the <code>backoff</code> is selected, Percona implementation will be used.</p>"},{"location":"xtradb-performance-improvements-io-bound-highly-concurrent-workloads.html#multi-threaded-lru-flusher","title":"Multi-threaded LRU flusher","text":"<p>Percona Server for MySQL features a true multi-threaded LRU flushing. In this scheme, each buffer pool instance has its own dedicated LRU manager thread that is tasked with performing LRU flushes and evictions to refill the free list of that buffer pool instance. Existing multi-threaded flusher no longer does any LRU flushing and is tasked with flush list flushing only.</p> <ul> <li> <p>All threads still synchronize on each coordinator thread iteration. If a particular flushing job is stuck on one of the worker threads, the rest will idle until the stuck one completes.</p> </li> <li> <p>The coordinator thread heuristics focus on flush list adaptive flushing without considering the state of free lists, which might be in need of urgent refill for a subset of buffer pool instances on a loaded server.</p> </li> <li> <p>LRU flushing is serialized with flush list flushing for each buffer pool instance, introducing the risk that the right flushing mode will not happen for a particular instance because it is being flushed in the other mode.</p> </li> </ul> <p>The following InnoDB metrics are no longer accounted, as their semantics do not make sense under the current LRU flushing design: <code>buffer_LRU_batch_flush_avg_time_slot</code>, <code>buffer_LRU_batch_flush_avg_pass</code>, <code>buffer_LRU_batch_flush_avg_time_thread</code>, <code>buffer_LRU_batch_flush_avg_time_est</code>.</p> <p>The need for InnoDB recovery thread writer threads is also removed, consequently all associated code is deleted.</p>"},{"location":"xtradb-performance-improvements-io-bound-highly-concurrent-workloads.html#doublewrite-buffer","title":"Doublewrite buffer","text":"<p>As of Percona Server for MySQL 8.0.20-11, the parallel doublewrite buffer is replaced with the MySQL implementation.</p>"},{"location":"xtradb-performance-improvements-io-bound-highly-concurrent-workloads.html#innodb_parallel_doublewrite_path","title":"<code>innodb_parallel_doublewrite_path</code>","text":"Option Description Command-line: Yes Scope: Global Dynamic: No Data type: String Default <code>xb_doublewrite</code> <p>As of Percona Server for MySQL 8.0.20-11, this variable is considered deprecated and has no effect. You should use innodb_doublewrite_dir.</p> <p>This variable is used to specify the location of the parallel doublewrite file. It accepts both absolute and relative paths. In the latter case they are treated as relative to the data directory.</p> <p>Percona Server for MySQL has introduced several options, only available in builds compiled with <code>UNIV_PERF_DEBUG</code> C preprocessor define.</p>"},{"location":"xtradb-performance-improvements-io-bound-highly-concurrent-workloads.html#innodb_sched_priority_master","title":"<code>innodb_sched_priority_master</code>","text":"Option Description Command-line: Yes Config file: Yes Scope: Global Dynamic: Yes Data type: Boolean <p>This variable can be added to the configuration file.</p>"},{"location":"xtradb-performance-improvements-io-bound-highly-concurrent-workloads.html#other-reading","title":"Other reading","text":"<ul> <li> <p>Bug #74637 - make dirty page flushing more adaptive</p> </li> <li> <p>Bug #67808 - in innodb engine, double write and multi-buffer pool instance reduce concurrency</p> </li> <li> <p>Bug #69232 - buf_dblwr-&gt;mutex can be splited into two</p> </li> </ul>"},{"location":"yum-download-rpm.html","title":"Install Percona Server for MySQL using downloaded RPM packages","text":"<p>Download the packages from Percona Product Downloads. If needed, Instructions for the Percona Product Download are available.</p> <p>The following example downloads Percona Server for MySQL 8.0.29-21 release packages for RHEL 8.</p> <ol> <li> <p>Use <code>wget</code> to download the tar file.</p> <pre><code>$ wget https://downloads.percona.com/downloads/Percona-Server-LATEST/Percona-Server-8.0.29-21/binary/redhat/8/x86_64/Percona-Server-8.0.29-21-rc59f87d2854-el8-x86_64-bundle.tar\n</code></pre> </li> <li> <p>Unpack the bundle to get the packages: <code>tar xvf Percona-Server-8.0.29-21-rc59f87d2854-el8-x86_64-bundle.tar</code></p> </li> <li> <p>To view a list of packages, run the following command:</p> <p><pre><code>$ ls *.rpm\n</code></pre> The output should look like the following:</p> Expected output <pre><code>percona-icu-data-files-8.0.29-21.1.el8.x86_64.rpm\npercona-mysql-router-8.0.29-21.1.el8.x86_64.rpm\npercona-mysql-router-debuginfo-8.0.29-21.1.el8.x86_64.rpm\npercona-server-client-8.0.29-21.1.el8.x86_64.rpm\npercona-server-client-debuginfo-8.0.29-21.1.el8.x86_64.rpm\npercona-server-debuginfo-8.0.29-21.1.el8.x86_64.rpm\npercona-server-debugsource-8.0.29-21.1.el8.x86_64.rpm\npercona-server-devel-8.0.29-21.1.el8.x86_64.rpm\npercona-server-rocksdb-8.0.29-21.1.el8.x86_64.rpm\npercona-server-rocksdb-debuginfo-8.0.29-21.1.el8.x86_64.rpm\npercona-server-server-8.0.29-21.1.el8.x86_64.rpm\npercona-server-server-debuginfo-8.0.29-21.1.el8.x86_64.rpm\npercona-server-shared-8.0.29-21.1.el8.x86_64.rpm\npercona-server-shared-compat-8.0.29-21.1.el8.x86_64.rpm\npercona-server-shared-debuginfo-8.0.29-21.1.el8.x86_64.rpm\npercona-server-test-8.0.29-21.1.el8.x86_64.rpm\npercona-server-test-debuginfo-8.0.29-21.1.el8.x86_64.rpm\n</code></pre> </li> <li> <p>Install <code>jemalloc</code> with the following command, if needed:</p> <pre><code>$ wget https://repo.percona.com/yum/release/8/RPMS/x86_64/jemalloc-3.6.0-1.el8.x86_64.rpm\n</code></pre> </li> <li> <p>An EL8-based RHEL distribution or derivatives package installation requires the mysql module to be disabled before installing the packages:</p> <pre><code>$ sudo yum module disable mysql\n</code></pre> </li> <li> <p>Install all the packages (for debugging, testing, etc.) with the following command:</p> <pre><code>$ sudo rpm -ivh *.rpm\n</code></pre> <p>Note</p> <p>When installing packages manually, you must make sure to resolve all dependencies and install any missing packages yourself.</p> </li> </ol>"},{"location":"yum-files.html","title":"Files in the RPM package built for Percona Server for MySQL 8.0","text":"<p>Each of the Percona Server for MySQL RPM packages has a particular purpose.</p> Package Contains percona-server-server Server itself (the mysqld binary) percona-server-debuginfo Debug symbols for the server percona-server-client Command line client percona-server-devel Header files needed to compile software using the client library. percona-server-shared Client shared library. percona-server-shared-compat Shared libraries for software compiled against older versions of the client library. The following libraries are included in this package: libmysqlclient.so.12, libmysqlclient.so.14, libmysqlclient.so.15, libmysqlclient.so.16, and libmysqlclient.so.18.   This package is not included in downloads for Red Hat Enterprise Linux 9 and derivatives. percona-server-test Includes the test suite for Percona Server for MySQL."},{"location":"yum-repo.html","title":"Install from Percona Software repository","text":"<p>Ready-to-use packages are available from the Percona Server for MySQL software repositories and the download page. The Percona yum repository supports popular RPM-based operating systems. The easiest way to install the Percona RPM repository is to install an RPM that configures yum and installs the Percona GPG key.</p>"},{"location":"yum-repo.html#supported-platforms","title":"Supported platforms","text":"<p>Specific information on the supported platforms, products, and versions are described in Percona Software and Platform Lifecycle.</p>"},{"location":"yum-repo.html#red-hat-certified","title":"Red Hat Certified","text":"<p>Percona Server for MySQL is certified for Red Hat Enterprise Linux 8. This certification is based on common and secure best practices and successful interoperability with the operating system. Percona Server is listed in the Red Hat Ecosystem Catalog.</p>"},{"location":"yum-repo.html#limitations","title":"Limitations","text":"<p>The RPM packages for Red Hat Enterprise Linux 7 and the compatible derivatives do not support TLSv1.3, as it requires OpenSSL 1.1.1, which is currently not available on this platform.</p>"},{"location":"yum-repo.html#install","title":"Install","text":"<p>Install from Percona Software Repository For more information on the Percona Software repositories and configuring Percona Repositories with percona-release, see the Percona Software Repositories Documentation. Run the following commands as a <code>root</code> user or with sudo.</p> Install on Red Hat 7Install on Red Hat 8 or later <pre><code>$ sudo yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm\n$ sudo percona-release enable-only ps-80 release\n$ sudo percona-release enable tools release\n$ sudo yum install percona-server-server\n</code></pre> <pre><code>$ sudo yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm\n$ sudo percona-release setup ps-80\n$ sudo yum install percona-server-server\n</code></pre>"},{"location":"yum-repo.html#available-storage-engines","title":"Available storage engines","text":"<p>Percona Server for MySQL 8.0 comes with the TokuDB storage engine and MyRocks storage engine. These storage engines are installed as plugins.</p> <p>Starting with Percona Server for MySQL 8.0.28-19 (2022-05-12), the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and disabled the storage engine in our binary builds. For more information, see TokuDB Introduction.</p> <p>For information on how to install and configure TokuDB, refer to the TokuDB Installation guide.</p> <p>For information on how to install and configure MyRocks, refer to the Percona MyRocks Installation Guide.</p>"},{"location":"yum-repo.html#percona-yum-testing-repository","title":"Percona yum Testing repository","text":"<p>Percona offers pre-release builds from our testing repository. To subscribe to the testing repository, you enable the testing repository in <code>/etc/yum.repos.d/percona-release.repo</code>. To do so, set both <code>percona-testing-$basearch</code> and <code>percona-testing-noarch</code> to <code>enabled = 1</code> (Note that there are three sections in this file: release, testing, and experimental - in this case, it is the second section that requires updating).</p> <p>You must install the Percona repository first if the installation has not been done already.</p>"},{"location":"yum-run.html","title":"Run Percona Server for MySQL","text":"<p>Percona Server for MySQL stores the data files in <code>/var/lib/mysql/</code> by default. The configuration file used to manage Percona Server for MySQL is the <code>/etc/my.cnf</code>.</p> <p>The following commands start, provide the server status, stop the server, and restart the server.</p> <p>Note</p> <p>The RHEL distributions and derivatives come with systemd as the default system and service manager so you can invoke all of the commands with <code>sytemctl</code> instead of <code>service</code>. Currently, both options are supported.</p> <ol> <li> <p>Percona Server for MySQL is not started automatically on the RHEL distributions and derivatives after installation. Start the server with the following command:</p> <pre><code>$ sudo service mysql start\n</code></pre> </li> <li> <p>Review the service status with the following command:</p> <pre><code>$ sudo service mysql status\n</code></pre> </li> <li> <p>Stop the service with the following command:</p> <pre><code>$ sudo service mysql stop\n</code></pre> </li> <li> <p>Restart the service with the following command:</p> <pre><code>$ sudo service mysql restart\n</code></pre> </li> </ol>"},{"location":"yum-run.html#selinux-and-security-considerations","title":"SELinux and security considerations","text":"<p>For information on working with SELinux, see Working with SELinux.</p> <p>The RHEL 8 distributions and derivatives have added system-wide cryptographic policies component. This component allows the configuration of cryptographic subsystems.</p>"},{"location":"yum-uninstall.html","title":"Uninstall Percona Server for MySQL","text":"<p>To completely uninstall Percona Server for MySQL, remove all the installed packages and data files.</p> <ol> <li> <p>Stop the Percona Server for MySQL service:</p> <pre><code>$ sudo service mysql stop\n</code></pre> </li> <li> <p>Remove the packages:</p> <pre><code>$ sudo yum remove percona-server*\n</code></pre> </li> <li> <p>Remove the data and configuration files:</p> <p>Warning</p> <p>This step removes all the packages and deletes all the data files (databases, tables, logs, etc.). Take a backup before doing this in case you need the data.</p> <pre><code>$ rm -rf /var/lib/mysql\n$ rm -f /etc/my.cnf\n</code></pre> </li> </ol>"},{"location":"zenfs.html","title":"Installing and configuring Percona Server for MySQL with ZenFS support","text":"<p>Implemented in Percona Server for MySQL 8.0.26-16.</p> <p>A solid state drive (SSD) does not overwrite data like a magnetic hard disk drive. Data must be written to an empty page. An SSD issue is <code>write amplification</code>. This issue is when the same data is written multiple times.</p> <p>An SSD is organized in pages and blocks. Data is written in pages and erased in blocks. If, for example, you have 8KB data on a page. The application updates one sector (512 Bytes) of that page. The controller reads the page in RAM, marks the old page as <code>stale</code>, updates the sector, and then writes a new page with this 8KB of data. The process is efficient use of the storage space but also shortens the SSD lifespan because the SSD parts do wear out.</p> <p>Garbage collection can also cause large-scale write amplification. The <code>stale</code> data is erased in blocks, which can consist of hundreds of pages. The SSD controller searches for pages that are marked stale. Pages that are not stale but are stored in that block are moved to another block before the block is erased and marked ready for use.</p> <p>The zone storage model organizes the SSD into a set of zones that are uniform in size and uses the Zoned Namespaces (ZNS) technology. ZNS is optimized for an SSD and exposes this zoned block storage interface between the host and SSD. ZNS enables smart data placement. Writes are sequential within a zone.</p> <p>ZenFS is a file system plugin for RocksDB which uses the RocksDB file system to place files into zones on a raw zoned block device (ZBD). The plugin adds native support for ZNS, avoids on device garbage collection, and minimizes write amplification. File data is stored in a set of extents. Within a zone, extents are a contiguous part of the address space. Garbage collection is an option, but this selection can cause write amplification.</p> <p>ZenFS depends on the <code>libzbd</code> user library and requires a Linux kernel implementation that supports NVMe Zoned Namespaces. The kernel must be configured with zone block device support enabled.</p> <p>Read the Western Digital and Percona deliver Utrastar DC ZN540 Zoned Namespace SSD support for Percona Server for MySQL PDF for more information.</p> <p>The following procedure installs Percona Server for MySQL and then configures <code>--rocksdb-fs-uri=zenfs://dev:&lt;short_block_device_name&gt;</code> for data storage.</p> <p>Note</p> <p>The  can have a short name designation which is the . For example, if the  is <code>/dev/nvme0n2</code> remove the <code>/dev/</code> portion and the  is <code>nvme0n2</code>. The block device name and short block device name must be substituted with the appropriate name from your system. To indicate that such a substitution is needed in statements, we use  and . <p>For the moment, the ZenFS plugin can be enabled in following distributions:</p> Distribution Name Notes Debian 11.1 Able to run the ZenFS plugin Ubuntu 20.04.3 Requires the 5.11 HWE kernel patched with the <code>allow blk-zoned ioctls without CAPT_SYS_ADMIN</code> patch <p>If the ZenFS functionality is not enabled on Ubuntu 20.04, the binaries with ZenFS support can run on the standard 5.4 kernel.</p> <p>Other Linux distributions are adding support for ZenFS, but Percona does not provide installation packages for those distributions.</p>"},{"location":"zenfs.html#installation","title":"Installation","text":"<p>Start with the installation of Percona Server for MySQL.</p> <ol> <li> <p>The steps are listed here for convenience, for an explanation, see Installing Percona Server for MySQL from Percona apt repository.</p> <pre><code>$ wget https://repo.percona.com/apt/percona-release_latest.$(lsb_release -sc)_all.deb\n$ sudo apt install gnupg2 lsb-release ./percona-release_latest.*_all.deb\n$ sudo percona-release setup ps80\n</code></pre> </li> <li> <p>Install Percona Server for MySQL with MyRocks and the ZenFS plugin package. The binaries are listed in the Installing Percona Server for MySQL from a Binary Tarball section of the Percona Server for MySQL installation instructions.</p> <pre><code>$ sudo apt install percona-server-server\n</code></pre> </li> <li> <p>Install the RocksDB plugin package. This package copies <code>ha_rocksdb.so</code> into a predefined location. The RocksDB storage engine is not enabled.</p> <pre><code>$ sudo apt install percona-server-rocksdb\n</code></pre> </li> </ol>"},{"location":"zenfs.html#configuration","title":"Configuration","text":"<ol> <li> <p>Identify your ZBD device, , with lsblk. Add the <code>-o</code> option and specify which columns to print. <p>In the example, the <code>NAME</code> column returns the block device name, the <code>SIZE</code> column returns the size of the device, and the <code>ZONED</code> column returns information if the device uses the zone model. The value, <code>host-managed</code>, identifies a ZBD model.</p> <pre><code>lsblk -o NAME,SIZE,ZONED\nNAME                    SIZE  ZONED\nsda                       247.9G  none\n|-sda1                    230.9G  none\n|-sda2                        1G  none\n|-sda3                       16G  none\n&lt;short_block_device_name&gt;   7.2T  host-managed\n</code></pre> <li> <p>Change the ownership of  to the <code>mysql:mysql</code> user account. <pre><code>$ sudo chown mysql:mysql &lt;block_device_name&gt;\n</code></pre> <li> <p>Change the permissions so that the user or owner can read and write and the MySQL group can read, in case they must take a backup, for . <pre><code>$ sudo chmod 640 &lt;block_device_name&gt;\n</code></pre> <li> <p>Change the scheduler  to <code>mq_deadline</code> with a <code>udev</code> rule. Create <code>/etc/udev/rules.d/60-scheduler.rules</code> if the file does not exist, and add the following rule:</p> <pre><code>ACTION==\"add|change\", KERNEL==\"&lt;short_block_device_name&gt;\", ATTR{queue/scheduler}=\"mq-deadline\"\n</code></pre> </li> <li> <p>Restart the machine to apply the rule.</p> </li> <li> <p>Verify if the rule was applied correctly by running the following line:</p> <pre><code>$ cat /sys/block/&lt;short_block_device_name&gt;/queue/scheduler\n</code></pre> </li> <li> <p>Review that the output of the previous command matches:</p> <pre><code>[mq-deadline] none\n</code></pre> </li> <li> <p>Create an auxiliary directory for ZenFS. For example <code>/var/lib/mysql_aux_nvme0n2</code>.</p> <p>The ZenFS auxiliary directory is a regular (POSIX) file directory used internally to resolve file locks and shared access. There are no strict requirements for the location but the directory must be write accessible for the mysql:mysql UNIX system user account. Each ZBD must have an individual auxiliary directory. This directory is recommended to be at the same level as \u201c/var/lib/mysql\u201d, which is the default Percona Server for MySQL directory.</p> <p>Note</p> <p>AppArmor is enabled by default in Debian 11. If your AppArmor mode is set to <code>enforce</code>, you must edit the profile to allow access to these locations. Add the following rules to <code>usr.sbin.mysqld</code>:</p> <pre><code>/var/lib/mysql_aux_*/ r,\n/var/lib/mysql_aux_*/** rwk,\n</code></pre> <p>Don\u2019t forget to reload the policy if you make edits:</p> <pre><code>$ sudo service apparmor reload\n</code></pre> <p>For more information, see Working with AppArmor.</p> <p>Note</p> <p>If you must configure ZenFS to use a directory inside <code>/var/lib</code> (owned by <code>root:root</code> without write permissions for other user accounts), edit your AppArmor profile (described in an earlier step), if needed, and do the following steps manually:</p> <ul> <li>Create the <code>aux_path</code> for : <pre><code>$ sudo mkdir /var/lib/mysql_aux_&lt;short_block_device_name&gt;\n</code></pre> <ul> <li>Change the ownership of the <code>aux_path</code>:</li> </ul> <pre><code>$ sudo chown mysql:mysql /var/lib/mysql_aux_&lt;short_block_device_name&gt;\n</code></pre> <ul> <li>Set the permissions for the <code>aux_path</code> for : <pre><code>$ sudo chmod 750 /var/lib/mysql_aux_&lt;short_block_device_name&gt;\n</code></pre> <li> <p>Change the ownership of . <pre><code>$ sudo chown mysql:mysql &lt;block_device_name&gt;\n</code></pre> <li> <p>Initialize ZenFS on . <pre><code>$ sudo -H -u mysql zenfs mkfs --zbd=&lt;short_block_device_name&gt; --aux_path=/var/lib/mysql_aux_&lt;short_block_device_name&gt; --finish_threshold=0 --force\n</code></pre> <li> <p>Stop Percona Server for MySQL:</p> <pre><code>$ sudo service mysql stop\n</code></pre> </li> <li> <p>Edit my.cnf. Add the following line to the \u201c[mysqld]\u201d section:</p> <pre><code>[mysqld]\n...\nloose-rocksdb-fs-uri=zenfs://dev:&lt;short_block_device_name&gt;\n...\n</code></pre> <p>Note</p> <p>The \u201cloose-\u201d prefix is important.</p> </li> <li> <p>Start Percona Server for MySQL:</p> <pre><code>$ sudo service mysql start\n</code></pre> </li> <li> <p>Enable <code>RocksDB</code>:</p> <pre><code>$ sudo ps-admin --enable-rocksdb -u root -p\n</code></pre> </li> <li> <p>Enter the MyRocks password.</p> <p>Alternatively, enable RocksDB by adding the following lines to the my.cnf file:</p> <pre><code>      [mysqld]\n...\nplugin-load-add=rocksdb=ha_rocksdb.so\ndefault-storage-engine=rocksdb\n...\n</code></pre> </li> <li> <p>Verify that the \u201c.rocksdb\u201d directory in the default data directory has only \u201cLOG*\u201d files:</p> <pre><code>$ sudo ls -la /var/lib/mysql/.rocksdb\n</code></pre> </li> <li> <p>Verify that ZenFS is created on \u201crocksdb\u201d and has the RocksDB data files:</p> <pre><code>      $ sudo -H -u mysql zenfs list --zbd=&lt;short_block_device_name&gt; --path=./.rocksdb\n#OR\n      $ sudo -H -u mysql zenfs dump --zbd=&lt;short_block_device_name&gt;\n</code></pre> </li> <li> <p>You can verify if the ZenFS was successfully created with the following command:</p> <pre><code>$ sudo -H -u mysql zenfs ls-uuid\n...\n13e421af-1967-435c-ab15-faf4529710b6    &lt;short_block_device_name&gt;\n...\n</code></pre> </li> <li> <p>You can check the available storage with the following command:</p> <pre><code>$ sudo -H -u mysql zenfs df --zbd=&lt;short_block_device_name&gt;\nFree: 971453 MB\nUsed: 0 MB\nReclaimable: 0 MB\nSpace amplification: 0%\n</code></pre> </li>"},{"location":"zenfs.html#backup-and-restore","title":"Backup and restore","text":"<p>Shut down the server and use the following command to backup a ZenFS file system, including metadata files, to a local filesystem. The <code>zenfs</code> backup and restore utility must have exclusive access to the ZenFS filesystem to take a consistent snapshot. The backup command only takes logical backups.</p> <p>The following command backs up everything from the root of the ZenFS drive:</p> <pre><code>$ zenfs backup --zbd=${NULLB} --path=\"/home/user/bkp\" --backup_path=/\n</code></pre> <p>The options are the following:</p> <ul> <li> <p>The <code>--path</code> can be either an absolute path or a relative path. The backup command creates the directory in the <code>--path</code> if it does not exist.</p> </li> <li> <p>The <code>--backup_path</code> option can use any of the following path values based on the location.</p> </li> </ul> <p>If the backup is for the ZenFS root drive, use any of the values in the following table:</p>"},{"location":"zenfs.html#back-up-from-the-zenfs-root-drive","title":"Back up from the ZenFS root drive","text":"Value Description Empty string / A forward slash . A single period ./ A single period with a forward slash <p>If the backup is for a non-root ZenFS path, use any of the values in the following table:</p>"},{"location":"zenfs.html#back-up-from-a-non-root-zenfs-path","title":"Back up from a non-root ZenFS path","text":"Value Description &lt;directory&gt; Only the directory name /&lt;directory&gt; A forward slash with the directory name ./&lt;directory&gt; A single period with a forward slash and the directory name &lt;directory&gt;/ The directory name with a forward slash /&lt;directory&gt;/ A forward slash with the directory name and an ending forward slash ./&lt;directory&gt;/ A single period, a forward slash, the directory name, and an ending forward slash <p>Use the following command to restore a backup into the root of the ZenFS drive:</p> <pre><code>$ zenfs restore --zbd=${NULLB} --path=\"/home/user/bkp/\" --restore_path=/\n</code></pre> <ul> <li> <p>The <code>--path</code> can be either an absolute path or a relative path. The backup command creates the directory in the <code>--path</code> if it does not exist.</p> </li> <li> <p>The <code>--restore_path</code> option can use any of the following path values based on the location.</p> <p>If the restore is for the ZenFS root drive, use any of the values in the following tables:</p>"},{"location":"zenfs.html#restore-to-the-zenfs-root-drive","title":"Restore to the ZenFS root drive","text":"Value Description Empty string / A forward slash . A single period ./ A single period with a forward slash <p>If the restore is for a non-root ZenFS path, use any of the values in the following table:</p>"},{"location":"zenfs.html#restore-to-a-non-root-zenfs-path","title":"Restore to a non-root ZenFS path","text":"Value Description &lt;directory&gt; Only the directory name /&lt;directory&gt; A forward slash with the directory name ./&lt;directory&gt; A single period with a forward slash and the directory name &lt;directory&gt;/ The directory name with a forward slash /&lt;directory&gt;/ A forward slash with the directory name and an ending forward slash ./&lt;directory&gt;/ A single period, a forward slash, the directory name, and an ending forward slash"},{"location":"zenfs.html#known-limitations","title":"Known limitations","text":"<p>After a reboot the NVME ZBD configuration (\u201c/dev/nvme02\u201d in our examples) can disappear. The issue is OS-dependent and can be managed by the system administrators. One or more of the following events may have occurred:</p> <ul> <li>A reboot changes the active \u201cscheduler\u201d from \u201c[mq-deadline]\u201d. The following steps reset the disk scheduler in RedHat using udev rules. For Ubuntu, see Input/output schedulers.</li> </ul> <p>See also</p> <p>For more information, review Change I/O scheduler.</p> <ul> <li>A reboot resets the device permissions from \u201c640/mysql:mysql\u201d to \u201c660/root:disk\u201d.</li> </ul>"},{"location":"release-notes/8.0.29-21.html","title":"Percona Server for MySQL 8.0.29-21 (2022-08-08)","text":"<p>Percona Server for MySQL 8.0.29-21 includes all the features and bug fixes available in the MySQL 8.0.29 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a free, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers more value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups, and increased visibility. Commercial support contracts are available.</p>"},{"location":"release-notes/8.0.29-21.html#release-highlights","title":"Release highlights","text":"<p>Improvements and bug fixes introduced by Oracle for MySQL 8.0.29 and included in Percona Server for MySQL are the following:</p> <ul> <li> <p>The Performance Schema tracks if a query was processed on the PRIMARY engine, InnoDB, or a SECONDARY engine, HeatWave. An EXECUTION_ENGINE column, which indicates the engine used, was added to the Performance Schema statement event tables and the sys.processlist and the sys.x$processlist views.</p> </li> <li> <p>Added support for the IF NOT EXISTS option for the CREATE FUNCTION, CREATE PROCEDURE, and CREATE TRIGGER statements.</p> </li> <li> <p>Added support for ALTER TABLE \u2026 DROP COLUMN ALGORITHM=INSTANT.</p> </li> <li> <p>An anonymous user with the PROCESS privilege was unable to select processlist table rows.</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.29 Release Notes.</p> <p>Note</p> <p>Percona Server for MySQL has changed the default for supported DDL column operations to ALGORITHM=INPLACE. This fixes the corruption issue with the INSTANT ADD/DROP COLUMNS (find more details in PS-8292.)</p> <p>In MySQL 8.0.29, the default setting for supported DDL operations is ALGORITHM=INSTANT. You can explicitly specify ALGORITHM=INSTANT in DDL column operations.</p>"},{"location":"release-notes/8.0.29-21.html#improvements","title":"Improvements","text":"<ul> <li>PS-8258: Percona Server for MySQL can be built on the MacOS with RocksDB enabled.</li> </ul>"},{"location":"release-notes/8.0.29-21.html#bugs-fixed","title":"Bugs fixed","text":"<ul> <li> <p>PS-8291: An unexpected MySQL 8.0.29 server exit when executing ALTER TABLE \u2026 DROP COLUMN ALGORITHM=INSTANT. (Upstream #107613)</p> </li> <li> <p>PS-8292: MySQL 8.0.29 failed to perform crash recovery.</p> </li> <li> <p>PS-8303: A MySQL 8.0.29 server exit on ALTER TABLE created an assertion failure: dict0mem.h:2498:pos &lt; n_def.</p> </li> <li> <p>PS-8116: Executing ALTER TABLE IMPORT TABLESPACE with a different data directory failed. (Thanks to Sami Ahlroos for reporting this issue)</p> </li> <li> <p>PS-8273: A MyRocks exit when inserting into a table with a unique key and TTL setting.</p> </li> </ul>"},{"location":"release-notes/8.0.29-21.html#packaging-notes","title":"Packaging notes","text":"<p>Debian 9 is no longer supported.</p>"},{"location":"release-notes/8.0.29-21.html#useful-links","title":"Useful links","text":"<ul> <li> <p>The Percona Server for MySQL installation instructions</p> </li> <li> <p>Download Percona Server for MySQL 8.0</p> </li> <li> <p>The Percona Server for MySQL GitHub location</p> </li> <li> <p>To contribute to the documentation, review the Documentation Contribution Guide</p> </li> </ul>"},{"location":"release-notes/8.0.30-22.html","title":"Percona Server for MySQL 8.0.30-22 (2022-11-21)","text":"Release date November 21, 2022 Install instructions Install Percona Server for MySQL Download this version Percona Server for MySQL <p>Percona Server for MySQL 8.0.30-22 includes all the features and bug fixes available in the MySQL 8.0.30 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a free, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers more value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups, and increased visibility. </p> <p>For training, contact Percona Training - Start learning now</p>"},{"location":"release-notes/8.0.30-22.html#release-highlights","title":"Release highlights","text":"<p>The following features are Generally Available (GA):</p> <ul> <li> <p>Amazon Key Management Service</p> </li> <li> <p>Key Management Interoperability Protocol</p> </li> </ul> <p>The following features, variables, or options are available only in tech preview:</p> <ul> <li> <p>SASL-based LDAP plugin</p> </li> <li> <p>SASL-based LDAP variables</p> </li> <li> <p>Fallback server variables for simple LDAP and SASL-based LDAP</p> </li> <li> <p>FIDO authentication plugin</p> </li> <li> <p>Group Replication options</p> </li> </ul> <p>Improvements and bug fixes introduced by Oracle for MySQL 8.0.30 and included in Percona Server for MySQL are the following:</p> <ul> <li> <p>Supports Generated Invisible Primary Keys(GIPK). This feature automatically adds a primary key to InnoDB tables without a primary key. The generated key is always named <code>my_row_id</code>. The GIPK feature is not enabled by default. Enable the feature by setting <code>sql_generate_invisible_primary_key</code> to ON.</p> </li> <li> <p>The InnoDB_doublewrite system has two new settings:</p> </li> <li> <p><code>DETECT_ONLY</code>. This setting allows only metadata to be written to the doublewrite buffer. Database page content is not written to the buffer. Recovery does not use the buffer to fix incomplete page writes. Use this setting only when you need to detect incomplete page writes.</p> </li> <li> <p><code>DETECT_AND_RECOVER</code>. This setting is equivalent to the current ON setting. The doublewrite buffer is enabled. Database page content is written to the buffer and the buffer is accessed to fix incomplete page writes during recovery.</p> </li> <li> <p>The <code>-skip_host_cache</code> server option is deprecated and will be removed in a future release. Use <code>SET GLOBAL host_cache_size</code>= 0 or set <code>host_cache_size</code> = 0.</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.30 Release Notes.</p>"},{"location":"release-notes/8.0.30-22.html#new-features","title":"New features","text":"<ul> <li> <p>PS-8255: Added support to enable users to authenticate using FIDO authentication.</p> </li> <li> <p>PS-6002: Added the global variable <code>--replica-enable-event</code> to maintain the create/alter event state on replicas.</p> </li> <li> <p>PS-7980: Added the global system variables <code>--authentication_ldap_simple_group_role_mapping</code> and <code>--authentication_ldap_sasl_group_role_mapping</code>. When a user logs in with LDAP authentication, the server checks if the LDAP user is a member of any group specified in this variable. If the check is successful, the matching MySQL roles are automatically granted to the user.</p> </li> <li> <p>PS-8275: Implements the ability to eject a cluster node when the node exceeds the flow control threshold by adding a <code>MAJORITY</code> mode to <code>group_replication_flow_control_mode</code> and a global system variable <code>group_replication_auto_evict_timeout</code>.</p> </li> </ul>"},{"location":"release-notes/8.0.30-22.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-8385: Adds the ability to call user-defined functions to register a redo log consumer. A consumer reading the redo log blocks files from being deleted or purged.</p> </li> <li> <p>PS-8169: Adds the ability to use Simple Authentication and Security Layer (SASL) to send secure messages within the LDAP protocol with the SASL-based LDAP authentication. The <code>authentication_ldap_sasl</code> plugin performs the SASL-based LDAP authentication on the server. The client must use the <code>authentication_ldap_sasl_client</code> plugin.</p> </li> <li> <p>PS-8155: Implements support for multiple LDAP server for the simple LDAP authentication plugin and the SASL-based LDAP authentication plugin. If the appropriate system variable is set, and if the primary server is unavailable, the authentication plugin attempts to connect and authenticate using a fallback server. A user can also specify multiple fallback servers. The following global system variables are:</p> </li> <li> <p><code>authentication_ldap_simple_fallback_server_host</code></p> </li> <li> <p><code>authentication_ldap_simple_fallback_server_port</code></p> </li> <li> <p><code>authentication_ldap_sasl_fallback_server_host</code></p> </li> <li> <p><code>authentication_ldap_sasl_fallback_server_port</code></p> </li> </ul>"},{"location":"release-notes/8.0.30-22.html#bug-fixes","title":"Bug fixes","text":"<ul> <li> <p>PS-8204: A fix for when the <code>audit_log_format</code> was set to XML and the logged queries were truncated after a newline character.</p> </li> <li> <p>PS-8246: Adapted the Encryption UDF MTR test cases to OpenSL 3.0.x. The tests failed because OpenSSL 3.0.x has a different default set of hash functions and PEM reading and writing routines generate different error messages.</p> </li> <li> <p>PS-8351: The <code>SHOW ENGINE INNODB STATUS</code> would output unreadable UTF characters.</p> </li> <li> <p>PS-8364: When using Docker, the data directory for ICU regular expressions was missing.</p> </li> <li> <p>PS-8175: While a thread executes <code>fil_io_set_encryption()</code>, another thread may change the <code>space-&gt;encryption_type</code>. If this happens, an assertion in <code>fil_io_set_encryption()</code> caused an unexpected server exit.</p> </li> <li> <p>PS-8428: A fix for an unexpected server exit when <code>--innodb_encrypt_online_alter_logs</code>=ON and <code>ALTER TABLE &lt;tablename&gt; ADD FULLTEXT</code> was executed.</p> </li> </ul>"},{"location":"release-notes/8.0.30-22.html#platform-support","title":"Platform support","text":"<ul> <li> <p>Percona Server for MySQL 8.0.30 supports Oracle Linux/Red Hat Enterprise Linux 9.</p> </li> <li> <p>Percona Server for MySQL 8.0.30 supports Ubuntu 22.04.</p> </li> </ul>"},{"location":"release-notes/8.0.30-22.html#useful-links","title":"Useful links","text":"<p>The Percona Server for MySQL GitHub location</p> <p>Contribute to the documentation</p>"},{"location":"release-notes/8.0.30-22.upd.html","title":"Percona Server for MySQL 8.0.30-22 Update (2022-11-21)","text":"Release date November 21, 2022 Install instructions Install Percona Server for MySQL Download this version Percona Server for MySQL <p>Percona Server for MySQL 8.0.30-22 includes all the features and bug fixes available in the MySQL 8.0.30 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a free, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers more value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups, and increased visibility. </p> <p>For training, contact Percona Training - Start learning now</p> <p>This update to the release notes adds the Deprecation and removal section.</p>"},{"location":"release-notes/8.0.30-22.upd.html#release-highlights","title":"Release highlights","text":"<p>The following features are Generally Available (GA):</p> <ul> <li> <p>Amazon Key Management Service</p> </li> <li> <p>Key Management Interoperability Protocol</p> </li> </ul> <p>The following features, variables, or options are available only in tech preview:</p> <ul> <li> <p>SASL-based LDAP plugin</p> </li> <li> <p>SASL-based LDAP variables</p> </li> <li> <p>Fallback server variables for simple LDAP and SASL-based LDAP</p> </li> <li> <p>FIDO authentication plugin</p> </li> <li> <p>Group Replication options</p> </li> </ul> <p>Improvements and bug fixes introduced by Oracle for MySQL 8.0.30 and included in Percona Server for MySQL are the following:</p> <ul> <li> <p>Supports Generated Invisible Primary Keys(GIPK). This feature automatically adds a primary key to InnoDB tables without a primary key. The generated key is always named <code>my_row_id</code>. The GIPK feature is not enabled by default. Enable the feature by setting <code>sql_generate_invisible_primary_key</code> to ON.</p> </li> <li> <p>The InnoDB_doublewrite system has two new settings:</p> </li> <li> <p><code>DETECT_ONLY</code>. This setting allows only metadata to be written to the doublewrite buffer. Database page content is not written to the buffer. Recovery does not use the buffer to fix incomplete page writes. Use this setting only when you need to detect incomplete page writes.</p> </li> <li> <p><code>DETECT_AND_RECOVER</code>. This setting is equivalent to the current ON setting. The doublewrite buffer is enabled. Database page content is written to the buffer and the buffer is accessed to fix incomplete page writes during recovery.</p> </li> <li> <p>The <code>-skip_host_cache</code> server option is deprecated and will be removed in a future release. Use <code>SET GLOBAL host_cache_size</code>= 0 or set <code>host_cache_size</code> = 0.</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.30 Release Notes.</p>"},{"location":"release-notes/8.0.30-22.upd.html#new-features","title":"New features","text":"<ul> <li> <p>PS-8255: Added support to enable users to authenticate using FIDO authentication.</p> </li> <li> <p>PS-6002: Added the global variable <code>--replica-enable-event</code> to maintain the create/alter event state on replicas.</p> </li> <li> <p>PS-7980: Added the global system variables <code>--authentication_ldap_simple_group_role_mapping</code> and <code>--authentication_ldap_sasl_group_role_mapping</code>. When a user logs in with LDAP authentication, the server checks if the LDAP user is a member of any group specified in this variable. If the check is successful, the matching MySQL roles are automatically granted to the user.</p> </li> <li> <p>PS-8275: Implements the ability to eject a cluster node when the node exceeds the flow control threshold by adding a <code>MAJORITY</code> mode to <code>group_replication_flow_control_mode</code> and a global system variable <code>group_replication_auto_evict_timeout</code>.</p> </li> </ul>"},{"location":"release-notes/8.0.30-22.upd.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-8385: Adds the ability to call user-defined functions to register a redo log consumer. A consumer reading the redo log blocks files from being deleted or purged.</p> </li> <li> <p>PS-8169: Adds the ability to use Simple Authentication and Security Layer (SASL) to send secure messages within the LDAP protocol with the SASL-based LDAP authentication. The <code>authentication_ldap_sasl</code> plugin performs the SASL-based LDAP authentication on the server. The client must use the <code>authentication_ldap_sasl_client</code> plugin.</p> </li> <li> <p>PS-8155: Implements support for multiple LDAP server for the simple LDAP authentication plugin and the SASL-based LDAP authentication plugin. If the appropriate system variable is set, and if the primary server is unavailable, the authentication plugin attempts to connect and authenticate using a fallback server. A user can also specify multiple fallback servers. The following global system variables are:</p> </li> <li> <p><code>authentication_ldap_simple_fallback_server_host</code></p> </li> <li> <p><code>authentication_ldap_simple_fallback_server_port</code></p> </li> <li> <p><code>authentication_ldap_sasl_fallback_server_host</code></p> </li> <li> <p><code>authentication_ldap_sasl_fallback_server_port</code></p> </li> </ul>"},{"location":"release-notes/8.0.30-22.upd.html#bug-fixes","title":"Bug fixes","text":"<ul> <li> <p>PS-8204: A fix for when the <code>audit_log_format</code> was set to XML and the logged queries were truncated after a newline character.</p> </li> <li> <p>PS-8246: Adapted the Encryption UDF MTR test cases to OpenSL 3.0.x. The tests failed because OpenSSL 3.0.x has a different default set of hash functions and PEM reading and writing routines generate different error messages.</p> </li> <li> <p>PS-8351: The <code>SHOW ENGINE INNODB STATUS</code> would output unreadable UTF characters.</p> </li> <li> <p>PS-8364: When using Docker, the data directory for ICU regular expressions was missing.</p> </li> <li> <p>PS-8175: While a thread executes <code>fil_io_set_encryption()</code>, another thread may change the <code>space-&gt;encryption_type</code>. If this happens, an assertion in <code>fil_io_set_encryption()</code> caused an unexpected server exit.</p> </li> <li> <p>PS-8428: A fix for an unexpected server exit when <code>--innodb_encrypt_online_alter_logs</code>=ON and <code>ALTER TABLE &lt;tablename&gt; ADD FULLTEXT</code> was executed.</p> </li> </ul>"},{"location":"release-notes/8.0.30-22.upd.html#platform-support","title":"Platform support","text":"<ul> <li> <p>Percona Server for MySQL 8.0.30 supports Oracle Linux/Red Hat Enterprise Linux 9.</p> </li> <li> <p>Percona Server for MySQL 8.0.30 supports Ubuntu 22.04.</p> </li> </ul>"},{"location":"release-notes/8.0.30-22.upd.html#deprecation-and-removal","title":"Deprecation and removal","text":"<p>This release removes the Data Scrubbing feature.</p> <p>The <code>master_key</code> and <code>keyring_key</code> options are removed in the <code>innodb_redo_log_encrypt</code> variable. The data type is changed to Boolean.</p>"},{"location":"release-notes/8.0.30-22.upd.html#useful-links","title":"Useful links","text":"<p>The Percona Server for MySQL GitHub location</p> <p>Contribute to the documentation</p>"},{"location":"release-notes/8.0.31-23.html","title":"Percona Server for MySQL 8.0.31-23 (2023-02-09)","text":"Release date February 9, 2023 Install instructions Install Percona Server for MySQL Download this version Percona Server for MySQL <p>Percona Server for MySQL 8.0.31-23 includes all the features and bug fixes available in the MySQL 8.0.31 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a free, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers more value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups, and increased visibility. </p> <p>For training, contact Percona Training - Start learning now.</p>"},{"location":"release-notes/8.0.31-23.html#release-highlights","title":"Release highlights","text":"<p>Improvements and bug fixes introduced by Oracle for MySQL 8.0.31 and included in Percona Server for MySQL are the following:</p> <ul> <li> <p>MySQL adds support for the SQL standard <code>INTERSECT</code> and <code>EXCEPT</code> table operators.</p> </li> <li> <p>InnoDB supports parallel index builds. This improves index build performance. The sorted index entries are loaded into a B-tree in a multithread. In previous releases, this action was performed by a single thread.</p> </li> <li> <p>The Performance and sys schemas show metrics for the global and session memory limits introduced in MySQL 8.0.28.</p> <p>The following columns have been added to the Performance Schema tables:</p> Performance Schema tables Columns SETUP_INSTRUMENTS FLAGS THREADS CONTROLLED_MEMORY, MAX_CONTROLLED_MEMORY, TOTAL_MEMORY, MAX_TOTAL_MEMORY EVENTS_STATEMENTS_CURRENT, EVENTS_STATEMENTS_HISTORY, EVENTS_STATEMENTS_HISTORY_LONG MAX_CONTROLLED_MEMORY, MAX_TOTAL_MEMORY Statement Summary Tables MAX_CONTROLLED_MEMORY, MAX_TOTAL_MEMORY Performance Schema Connection Tables MAX_SESSION_CONTROLLED_MEMORY, MAX_SESSION_TOTAL_MEMORY PREPARED_STATEMENTS_INSTANCES MAX_CONTROLLED_MEMORY, MAX_TOTAL_MEMORY <p>The following columns have been added to the sys schema <code>STATEMENT_ANALYSIS</code> and <code>X$STATEMENT_ANALYSIS</code> views:</p> <ul> <li> <p>MAX_CONTROLLED_MEMORY</p> </li> <li> <p>MAX_TOTAL_MEMORY</p> </li> </ul> <p>The <code>controlled_by_default</code> flag has been added to the <code>PROPERTIES</code> column of the <code>SETUP_INSTRUMENTS</code> table.</p> <p>Now, you can add and remove non-global memory instruments to the set of controlled-memory instruments. To do this, set the value of the <code>FLAGS</code> column of <code>SETUP_INSTRUMENTS</code>.</p> <pre><code>SQL&gt; UPDATE PERFORMANCE_SCHEMA.SETUP_INTRUMENTS SET FLAGS=\"controlled\" \nWHERE NAME='memory/sql/NET::buff';\n</code></pre> </li> <li> <p>The <code>audit_log_flush</code> variable has been deprecated and will be removed in future releases.</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.31 Release Notes.</p>"},{"location":"release-notes/8.0.31-23.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-7963: The trigger definitions are not cached in the table cache when using SELECT statements. This improvement adds the following variables:</p> <ul> <li> <p><code>table_open_cache_triggers</code> system variable</p> </li> <li> <p><code>table_open_cache_triggers_hits</code>, <code>table_open_cache_triggers_misses</code>, and <code>table_open_cache_triggers_overflows</code> status variables</p> </li> </ul> </li> <li> <p>PS-8433: Reduces memory spent when caching triggers by replacing a fixed-size error buffer with a variable-size error buffer.</p> </li> <li> <p>PS-8593: The binary tarballs compiled in the <code>RelWithDebInfo</code> configuration include full <code>(\"-g\")</code> rather than minimal <code>(\"-g1\")</code> debug information.</p> </li> <li> <p>PS-8553: The Oracle Linux 9 RPM packages are now built with ZenFS enabled.</p> </li> </ul>"},{"location":"release-notes/8.0.31-23.html#bug-fixes","title":"Bug fixes","text":"<ul> <li> <p>PS-1098: Manually rotating the log files by calling <code>audit_log_flush</code> multiple times resulted in using a wrong log file.</p> </li> <li> <p>PS-7923: Assertion <code>owned_gtids.is_owned_by(thd-&gt;owned_gtid, thd-&gt;thread_id())</code> failed.</p> </li> <li> <p>PS-8106: MySQL exited when the replication was stopped on replicating a <code>CREATE TABLE AS</code> statement.</p> </li> <li> <p>PS-8128: An in-place upgrade of views that refer to <code>performance_schema</code> tables failed.</p> </li> <li> <p>PS-8328: MySQL 8.0 exited when using <code>group_concat</code> with <code>group by with rollup</code>.</p> </li> <li> <p>PS-8503: <code>checkpoint_age</code> related status had no value. (Thanks to Huang Zhiyong for reporting this issue.)</p> </li> <li> <p>PS-8547: Added a space after the binary name to count all active processes, including processes started by the binary. (Thanks to user Elbandi for reporting this issue.)</p> </li> <li> <p>PS-8589: The replica crashed with fatal signal 11.</p> </li> <li> <p>PS-8327: The usage of <code>ALTER TABLE ... CHECK PARTITION</code> inside stored procedure failed.</p> </li> <li> <p>PS-8442: A fix for a crash in <code>buf_pool_invalidate_instance()</code>. </p> </li> </ul>"},{"location":"release-notes/8.0.31-23.html#deprecated-and-removed","title":"Deprecated and removed","text":"<p>This release removes the following features, system variables, status variables, and options:</p> <ul> <li> <p><code>innodb_encryption_redo_key_version</code></p> </li> <li> <p><code>innodb_encryption_rotation_pages_read_from_cache</code></p> </li> <li> <p><code>innodb_encryption_rotation_pages_read_from_disk</code></p> </li> <li> <p><code>innodb_encryption_rotation_pages_modified</code></p> </li> <li> <p><code>innodb_encryption_rotation_pages_flushed</code></p> </li> <li> <p><code>innodb_encryption_rotation_estimated_iops</code></p> </li> <li> <p><code>innodb_encryption_rotation_list_length</code></p> </li> <li> <p><code>innodb_num_pages_encrypted</code></p> </li> <li> <p><code>innodb_num_pages_decrypted</code></p> </li> <li> <p><code>innodb_encryption_threads</code></p> </li> <li> <p><code>innodb_encryption_rotate_key_age</code></p> </li> <li> <p><code>innodb_encryption_rotation_loops</code></p> </li> <li> <p><code>innodb_default_encryption_key_id</code></p> </li> <li> <p><code>rotate_system_key</code> and any dependencies</p> </li> </ul> <p>This release changes the following system variable options:</p> <ul> <li> <p><code>ONLINE_TO_KEYRING</code> and <code>ONLINE_FROM_KEYRING_TO_UNENCRYPTED</code> options are removed in the <code>default_table_encryption</code> variable. </p> </li> <li> <p>The <code>innodb_sys_tablespace_encrypt</code> variable data type is changed to <code>Boolean</code>.</p> </li> </ul>"},{"location":"release-notes/8.0.31-23.html#useful-links","title":"Useful links","text":"<p>The Percona Server for MySQL GitHub location</p> <p>Contribute to the documentation</p>"},{"location":"release-notes/8.0.32-24.html","title":"Percona Server for MySQL 8.0.32-24 (2023-03-20)","text":"Release date March 20, 2023 Install instructions Install Percona Server for MySQL Upgrade instructions Percona Server for MySQL in-place upgrading guide: from 5.7 to 8.0 <p>Percona Server for MySQL 8.0.32-24 includes all the features and bug fixes available in the MySQL 8.0.32 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a free, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers more value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups, and increased visibility.</p>"},{"location":"release-notes/8.0.32-24.html#release-highlights","title":"Release highlights","text":"<ul> <li> <p>Percona reverts the following MySQL bug fix:</p> <p>The data and the GTIDs backed up by mysqldump were inconsistent when the options \u2013single-transaction and \u2013set-gtid-purged=ON were both used. It was because in between the transaction started by mysqldump and the fetching of GTID_EXECUTED, GTIDs on the server could have increased already. With this fixed, a FLUSH TABLES WITH READ LOCK is performed before the fetching of GTID_EXECUTED to ensure its value is consistent with the snapshot taken by mysqldump.</p> <p>The MySQL fix also added a requirement when using \u2013single-transaction and executing FLUSH TABLES WITH READ LOCK for the RELOAD privilege. (MySQL bug #109701, MySQL bug #105761)</p> <p>The Percona Server version of the <code>mysqldump</code> utility, in some modes, can be used with MySQL Server. This utility provides a temporary workaround for the \u201cadditional RELOAD privilege\u201d limitation introduced by Oracle MySQL Server 8.0.32. </p> <p>For more information, see the Percona Performance Blog A Workaround for the \u201cRELOAD/FLUSH_TABLES privilege required\u201d Problem When Using Oracle mysqldump 8.0.32.</p> </li> <li> <p>In Percona Server for MySQL 8.0.29-21, the default ALTER TABLE algorithm was deliberately changed from <code>INSTANT</code> to <code>INPLACE</code> for safety reasons (find more details in Percona XtraBackup 8.0.29 and INSTANT ADD/DROP Columns blog post.) Since Oracle fixed the most critical bugs related to <code>ALGORITHM=INSTANT</code> in MySQL 8.0.32, Percona Server for MySQL 8.0.32-24 returns the original (upstream) behavior. Now, the default ALTER TABLE algorithm for supported DDL column operations is <code>INSTANT</code>.  </p> </li> </ul> <p>Improvements and bug fixes introduced by Oracle for MySQL 8.0.32 and included in Percona Server for MySQL are the following:</p> <ul> <li> <p>A replica can add a Generated Invisible Primary Keys(GIPK) to any InnoDB table. To achieve this behavior, the GENERATE value is added as a possible value for the CHANGE REPLICATION SOURCE TO statement\u2019s REQUIRE_TABLE_PRIMARY_KEY_CHECK option.</p> </li> <li> <p>The <code>REQUIRE_TABLE_PRIMARY_KEY_CHECK = GENERATE</code> option can be used on a per-channel basis.</p> </li> <li> <p>Setting <code>sql_generate_invisible_primary_key</code> on the source is ignored by a replica because this variable is not replicated. This behavior is inherited from the previous releases.</p> </li> <li> <p>An upgrade from 8.0.28 caused undetectable problems, such as server exit and corruption.</p> </li> <li> <p>A fix for after an upgrade, all columns added with ALGORITHM=INSTANT materialized and have version=0 for any new row inserted. Now, a column added with ALGORITHM=INSTANT fails if the maximum possible size of a row exceeds the row size limit, so that all new rows with materialized ALGORITHM=INSTANT columns are within row size limit. (Bug #34558510)</p> </li> <li> <p>After a drop, adding a specific column using the INSTANT algorithm could cause a data error and a server exit. (Bug #34122122)</p> </li> <li> <p>An online rebuild DDL no longer crashes after a column is added with ALGORITHM=INSTANT. Thank you Qingda Hu for reporting this bug. (Bug #33788578, Bug #106279)</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.32 Release Notes.</p>"},{"location":"release-notes/8.0.32-24.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-8450 : Replication: Transactions are stalled when the Certifier reconciles a transaction.</p> </li> <li> <p>PS-8626 : Inserting JSON data with <code>LOAD DATA INFILE</code> now shows the failed record number.</p> </li> </ul>"},{"location":"release-notes/8.0.32-24.html#bug-fixes","title":"Bug fixes","text":"<ul> <li> <p>PS-8073 : Replication: Updating a table with a stored generated field in the primary key caused a replication crash.</p> </li> <li> <p>PS-8577 : When the auto_increment column is modified after the table creation, the <code>ALTER TABLE ... auto_increment=1</code> did not produce the expected result.</p> </li> <li> <p>PS-7538 : With <code>innodb_optimize_fulltext_only</code> enabled, running OPTIMIZE TABLE on a table with an FTS index caused a server exit.</p> </li> <li> <p>PS-8627 : Unexpected server exit because <code>NO_SUCH_TABLE</code> leads to <code>m_opened_table=0x0</code>.</p> </li> <li> <p>PS-8660 : Queries to the INFORMATION_SCHEMA or PERFORMANCE_SCHEMA would stall while connections are in the authentication phase.</p> </li> <li> <p>PS-8635 : Remove the Percona implementation of <code>build-id</code>.</p> </li> <li> <p>PS-7934 : Assertion <code>owned_gtids.is_owned_by(thd-&gt;owned_gtid, thd-&gt;thread_id())</code> failed.</p> </li> <li> <p>PS-8613 : Fixed a noticeable performance regression when authenticating.</p> </li> </ul>"},{"location":"release-notes/8.0.32-24.html#useful-links","title":"Useful links","text":"<p>The Percona Server for MySQL GitHub location</p> <p>Contribute to the documentation</p> <p>For training, contact Percona Training - Start learning now</p>"},{"location":"release-notes/8.0.33-25.html","title":"Percona Server for MySQL 8.0.33-25 (2023-06-15)","text":"Release date June 15, 2023 Install instructions Install Percona Server for MySQL Upgrade instructions Percona Server for MySQL in-place upgrading guide: from 5.7 to 8.0 <p>Percona Server for MySQL 8.0.33-25 includes all the features and bug fixes available in the MySQL 8.0.33 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a freely available, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior and optimized performance, greater scalability, and availability, enhanced backups, increased visibility and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads.</p>"},{"location":"release-notes/8.0.33-25.html#release-highlights","title":"Release highlights","text":"<ul> <li> <p>This release adds the following MyRocks variables:</p> </li> <li> <p><code>rocksdb_bulk_load_use_sst_partitioner</code></p> </li> <li> <p><code>rocksdb_use_hyper_clock_cache</code></p> </li> <li> <p><code>rocksdb_converter_record_cached_length</code></p> </li> <li> <p><code>rocksdb_alter_table_comment_inplace</code></p> </li> <li> <p><code>rocksdb_charge_memory</code></p> </li> <li> <p><code>rocksdb_column_default_value_as_expression</code></p> </li> <li> <p><code>rocksdb_corrupt_data_action</code></p> </li> <li> <p><code>rocksdb_disable_instant_ddl</code></p> </li> <li> <p><code>rocksdb_enable_delete_range_for_drop_index</code></p> </li> <li> <p><code>rocksdb_partial_index_blind_delete</code></p> </li> <li> <p><code>rocksdb_protection_bytes_per_key</code></p> </li> <li> <p><code>rocksdb_use_write_buffer_manager</code></p> </li> <li> <p>This release adds a new MyRocks Information Schema Table <code>ROCKSDB_LIVE_FILES_METADATA</code>.</p> </li> <li> <p>This release removes <code>rocksdb_instant_ddl</code> variable. Use <code>rocksdb_disable_instant_ddl</code> instead. </p> </li> <li> <p>This merge fixes the following issues:</p> </li> <li> <p>PS-8477: The offline-mode persisted when doing <code>dba.rebootClusterFromCompleteOutage</code>. </p> </li> <li> <p>PS-8699: <code>ALTER INSTANCE RELOAD TLS</code> hung with many concurrent connection attempts. We have included the upstream fix and added our fix for this issue, which significantly reduces the chances that the issue will reoccur.</p> </li> </ul> <p>Improvements and bug fixes introduced by Oracle for MySQL 8.0.33 and included in Percona Server for MySQL are the following:</p> <ul> <li> <p>The <code>INSTALL COMPONENT</code> includes the <code>SET</code> clause. The <code>SET</code> clause sets the values of component system variables when installing one or several components. This reduces the inconvenience and limitations associated with assigning variable values in other ways.</p> </li> <li> <p>The mysqlbinlog <code>--start-position</code> accepts values up to <code>18446744073709551615</code>. If the <code>--read-from-remote-server</code> or <code>--read-from-remote-source</code> option is used, the maximum is <code>4294967295</code>. (Bug #77818, Bug #21498994)</p> </li> <li> <p>Using a generated column with <code>DEFAULT(col_name)</code> to specify the default value for a named column is not allowed and throws an error message. (Bug #34463652, Bug #34369580)</p> </li> <li> <p>Not all possible error states were reported during the binary log recovery process. (Bug #33658850)</p> </li> <li> <p>User-defined collations are deprecated. The usage of the following user-defined collations causes a warning that is written to the log:</p> </li> <li> <p>When <code>COLLATE</code> is followed by the name of a user-defined collation in an SQL statement.</p> </li> <li> <p>When the name of a user-defined collation is used as the value of <code>collation_server</code>, <code>collation_database</code>, or <code>collation_connection</code>.</p> </li> </ul> <p>The support for user-defined collations will be removed in a future releases of MySQL.</p> <p>Find the full list of bug fixes and changes in the MySQL 8.0.33 Release Notes.</p>"},{"location":"release-notes/8.0.33-25.html#new-features","title":"New features","text":"<ul> <li>PS-8188: Adds the <code>clone_exclude_plugins_list</code> variable. By default, the list of installed plugins on the donor and recipient must match. The <code>clone_exclude_plugins_list</code> variable allows for specifying the list of plugin exceptions.</li> </ul>"},{"location":"release-notes/8.0.33-25.html#bug-fixes","title":"Bug fixes","text":"<ul> <li> <p>PS-8647: <code>tmp_table_size=51200</code> caused server exit.</p> </li> <li> <p>PS-8683: Concurrent execution of <code>FLUSH STATUS</code>, <code>COM_CHANGE_USER</code>, and <code>SELECT FROM I_S.PROCESSLIST</code> led to deadlock. The deadlock affected connections executing the mentioned commands and other connections and made it impossible to shut down the server properly.</p> </li> <li> <p>PS-8713: <code>mysql_binlog_xxx()</code> symbols were not exported in <code>lybmysqlclient.so</code>.</p> </li> <li> <p>PS-8719: Audit log plugin stalled on flush.</p> </li> <li> <p>PS-8747: When Federated SE internal proxy-server connection timeout occured, <code>Got an error writing communication packets</code> was reported back to the user while the actual operation was successful.</p> </li> </ul>"},{"location":"release-notes/8.0.33-25.html#useful-links","title":"Useful links","text":"<p>The Percona Server for MySQL GitHub location</p> <p>Download product binaries, packages, and tarballs at Percona Product Downloads</p> <p>Contribute to the documentation</p> <p>For training, contact Percona Training - Start learning now</p>"},{"location":"release-notes/8.0.33-25.upd.html","title":"Percona Server for MySQL 8.0.33-25 Update (2023-08-02)","text":"<p>Percona Server for MySQL is a freely available, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior and optimized performance, greater scalability, and availability, enhanced backups, increased visibility and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads.</p> <p>This update to the release of Percona Server for MySQL 8.0.33-25 includes the fix to the security vulnerability in <code>mysql-shell</code> CVE-2023-38325.</p>"},{"location":"release-notes/8.0.33-25.upd.html#useful-links","title":"Useful links","text":"<p>Install Percona Server for MySQL 8.0</p> <p>Upgrade Percona Server for MySQL from 5.7 to 8.0</p> <p>The Percona Server for MySQL GitHub location</p> <p>Download product binaries, packages, and tarballs at Percona Product Downloads</p> <p>Contribute to the documentation</p> <p>For training, contact Percona Training - Start learning now</p>"},{"location":"release-notes/8.0.34-26.html","title":"Percona Server for MySQL 8.0.34-26 (2023-09-26)","text":"<p>Get started with Quickstart Guide for Percona Server for MySQL.</p> <p>Percona Server for MySQL 8.0.34-26 includes all the features and bug fixes available in the MySQL 8.0.34 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a freely available, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior and optimized performance, greater scalability, and availability, enhanced backups, increased visibility and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads.</p>"},{"location":"release-notes/8.0.34-26.html#release-highlights","title":"Release highlights","text":"<ul> <li> <p>Percona Server for MySQL 8.0.34-26 implements the Audit Log Filter plugin. The plugin provides a set of features that you can use to monitor user activity on the selected server:</p> <ul> <li>Filter audit events based on user/connection, accessed database/table name, query content, etc. Filtering rules are in JSON format.</li> <li>Dynamically enable/disable the auditing. A server restart is not required to add or adjust existing filtering rules.</li> <li>Use filtering rules to remove sensitive data from SQL statements written to log files.</li> <li>Use filtering rules to block events matching specific criteria (for example, database/table name, user name).</li> <li>Configure filtering rules to write to audit log extra information provided via Query Attributes with each query.</li> <li>Encrypt the audit log files using AES-256 encryption. The plugin keeps a set of encryption passwords used to encrypt existing log files. External applications may use these passwords to access encrypted logs.</li> <li>Compress audit log files to reduce the storage space used by log files.</li> <li>Configure an automatic rotation and removal of log files. You can remove outdated log files based either on storage space used by log files or the age of log files.</li> </ul> </li> <li> <p>Percona Server for MySQL 8.0.34-26 implements the data masking component, an improved and enchanced version of data masking plugin. The data masking component adds the following features:</p> <ul> <li>Support for multibyte character sets for random generation/masking functions</li> <li>New masking functions for IBAN, UUID, Canada SIN, and UK NIN</li> <li>New random generation functions for BAN, UUID, Canada SIN, and UK NIN</li> <li>The ability to store substitution dictionaries in the database</li> <li>The dynamic privilege <code>MASKING_DICTIONARIES_ADMIN</code> that is required for dictionary manipulation operations</li> <li>The automated loadable-function registration/unregistration during component installation/uninstallation</li> </ul> </li> </ul> <p>This merge fixes the following issue:</p> <ul> <li>PS-8770: The <code>INSTANT DDL</code> caused Percona Server 8.0.32 exit after upgrading from 5.7.41.</li> </ul> <p>Improvements and bug fixes introduced by Oracle for MySQL 8.0.34 and included in Percona Server for MySQL are the following:</p> <ul> <li>MySQL 8.0.33 added support for the <code>audit_log plugin</code> to choose which database to use to store JSON filter tables. Now, you can specify an alternative to the default system database, mysql, when running the plugin installation script. For example:</li> </ul> <pre><code>$&gt; mysql -u root -D database_name -p &lt; audit_log_filter_linux_install.sql\n</code></pre> <ul> <li> <p>Adds <code>mysql_binlog_open()</code>, <code>mysql_binlog_fetch()</code>, and <code>mysql_binlog_close()</code> functions to the libmysqlclient.so shared library. These functions enable developers to access a MySQL server binary log.</p> </li> <li> <p>For platforms on which OpenSSL libraries are bundled, the linked OpenSSL library for MySQL Server is updated from OpenSSL 1.1.1 to OpenSSL 3.0.9.</p> </li> </ul>"},{"location":"release-notes/8.0.34-26.html#deprecations-and-removals","title":"Deprecations and removals","text":"<ul> <li> <p>The <code>mysqlpump</code> client utility program is deprecated. The use of this program causes a warning. The <code>mysqlpump</code> client may be removed in future releases. The applications that depend on <code>mysqlpump</code> will use <code>mysqldump</code> or <code>MySQL Shell Utilities</code>.</p> </li> <li> <p>The <code>sync_relay_log_info</code> server system variable is deprecated. Using this variable or its equivalent startup <code>--sync-relay-log-info</code> option causes a warning. This variable may be removed in future releases. The applications that use this variable should be rewritten not to depend on it before the variable is removed.</p> </li> <li> <p>The <code>binlog_format</code> server system variable is deprecated and may be removed in future releases. The functionality associated with this variable, which changes the binary logging format, is also deprecated. </p> <p>When <code>binlog_format</code> is removed, MySQL server supports only row-based binary logging. Thus, new installations should use only row-based binary logging. Migrate the existing installations that use the statement-based or mixed logging format to the row-based format.</p> <p>The system variables <code>log_bin_trust_function_creators</code> and <code>log_statements_unsafe_for_binlog</code> used in the context of statement-based logging are also deprecated and may be removed in future releases.</p> <p>Setting or selecting the values of deprecated variables causes a warning.</p> </li> <li> <p>The <code>mysql_native_password</code> authentication plugin is deprecated and may be removed in future releases. Using <code>CREATE USER</code>, <code>ALTER USER</code>, and <code>SET PASSWORD</code> operations, insert a deprecation warning into the server error log if an account attempts to authenticate using <code>mysql_native_password</code> as an authentication method.</p> </li> <li> <p>The legacy filtering mode is deprecated. New deprecation warnings are emitted for legacy audit log filtering system variables. The deprecated variables are either read-only or dynamic.</p> <p>The <code>audit_log_policy</code> read-only variable writes a warning message to the MySQL server error log during server startup when its value is set to any value except <code>ALL</code> (default value).</p> <p>The <code>audit_log_include_accounts</code>, <code>audit_log_exclude_accounts</code>, <code>audit_log_statement_policy</code>, and <code>audit_log_connection_policy</code> are dynamic variables. Dynamic variables print a warning message based on usage:</p> <ul> <li> <p>Passing in a <code>non-NULL</code> value to <code>audit_log_include_accounts</code> or <code>audit_log_exclude_accounts</code> during MySQL server startup writes a warning message to the server error log.</p> </li> <li> <p>Passing in a <code>non-default</code> value to <code>audit_log_statement_policy</code> or <code>audit_log_connection_policy</code> during MySQL server startup now writes a warning message to the server error log. <code>ALL</code> is the default value for both variables.</p> </li> <li> <p>Changing an existing value using <code>SET</code> syntax during a MySQL client session writes a warning message to the client log.</p> </li> <li> <p>Persisting a variable using <code>SET PERSIST</code> syntax during a MySQL client session writes a warning message to the client log.</p> </li> </ul> </li> <li> <p>The <code>keyring_file</code> and <code>keyring_encrypted_file</code> plugins are deprecated. These keyring plugins are replaced with the <code>component_keyring_file</code> and <code>component_keyring_encrypted_file</code> components.</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.34 Release Notes.</p>"},{"location":"release-notes/8.0.34-26.html#new-features","title":"New features","text":"<ul> <li> <p>PS-8848: Increases verbosity of the connection control plugin.</p> </li> <li> <p>PS-8728: Adds the data masking component to align Percona Data Masking functionality with Oracle 8.0.33.</p> </li> <li> <p>PS-8042: Implements the Audit Log Filter plugin.</p> </li> </ul> <p>The following features and improvements were added by imlementing the Audit Log Filter plugin feature:</p> <ul> <li> <p>PS-3874: Adds options to the Audit Plugin to allow multiple configurations.</p> </li> <li> <p>PS-5164: Adds <code>Rows_sent</code> and <code>Rows_examined</code> fields to the Audit Log plugin.</p> </li> <li> <p>PS-5814: Allows the audit log to be rotated when MySQL starts.</p> </li> <li> <p>PS-236: Prepared statements are now logged in the audit plugin.</p> </li> <li> <p>PS-2480: Adds diagnostics when audit log does synchronous writes in ASYNC mode.</p> </li> <li> <p>PS-7331: Sets the default value of <code>audit_log_rotations</code> options to rotate.</p> </li> <li> <p>PS-5945: Adds the MySQL server host name to <code>audit_log</code> details when writing to the SYSLOG.</p> </li> </ul>"},{"location":"release-notes/8.0.34-26.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-8624: Exposes the number of TABLE objects with triggers in the Table Cache.</p> </li> <li> <p>PS-8742: Adds the <code>audit_log_filter_database</code> system variable.</p> </li> <li> <p>PS-3942: Adds the <code>audit_log</code> MTR test to make sure <code>PING_CMD</code> has correct <code>command_class</code>.</p> </li> </ul>"},{"location":"release-notes/8.0.34-26.html#bug-fixes","title":"Bug fixes","text":"<ul> <li> <p>PS-8504: Setting a large value of <code>audit_log_filter_buffer_size</code> caused the server exit.</p> </li> <li> <p>PS-8772: The instance was completely stalled when using <code>INSERT (...) SELECT</code>.</p> </li> <li> <p>PS-8797: The audit log plugin installation caused the server exit.</p> </li> <li> <p>PS-8810: The <code>FEDERATED</code> update on table could fail without notifications when the table contained <code>DOUBLE</code> columns.</p> </li> <li> <p>PS-8869: The semi-sync master waited for ack when semi-sync replica was down and when was replaced with async.</p> </li> <li> <p>PS-8871: The RESOURCE GROUP hint failed when it was used within a prepared statement.</p> </li> <li> <p>PS-8877: The server exited when selecting from <code>performance_schema.innodb_redo_log_files</code>.</p> </li> <li> <p>PS-8785: The metrics were not incremented for the 1<sup>st</sup> iteration in <code>buf_LRU_free_from_common_LRU_list</code>.</p> </li> <li> <p>PS-8907: When sending a SIGTERM signal to MySQL with connections from the x plugin, it terminated MySQL instead of shutting it down.</p> </li> <li> <p>PS-8882: Performing <code>CREATE TABLE SELECT</code> was unsuccessful if you ran it when the Data-dictionary Table object Cache was full. The issue occurred after running <code>RENAME TABLES</code>, which renamed a number of tables that was more significant than the Data-dictionary Table object Cache capacity (equal to <code>--max_connections</code>).</p> </li> <li> <p>PS-8836: An UPDATE failed after an INSERT. When the same UPDATE was retried, it would succeed.</p> </li> <li> <p>PS-8592: XCom connection stalled forever in the <code>read()</code> syscall over the network. This issue prevented nodes from re-joining the cluster.</p> </li> </ul> <p>The following bugs were fixed by imlementing the Audit Log Filter plugin:</p> <ul> <li> <p>PS-5784: The default <code>audit_log_format</code> parameter value for MySQL 8 was NEW but the default value for the Percona Server for MySQL Audit log plugin was OLD.</p> </li> <li> <p>PS-6863: The <code>audit_log</code> plugin did not handle the application messages from the <code>audit_api_message_emit</code> component.</p> </li> </ul>"},{"location":"release-notes/8.0.34-26.html#packaging-notes","title":"Packaging notes","text":"<p>Percona Server for MySQL 8.0.34-26 supports Debian 12.</p>"},{"location":"release-notes/8.0.34-26.html#useful-links","title":"Useful links","text":"<p>Install Percona Server for MySQL 8.0</p> <p>Upgrade Percona Server for MySQL from 5.7 to 8.0</p> <p>The Percona Server for MySQL GitHub location</p> <p>Download product binaries, packages, and tarballs at Percona Product Downloads</p> <p>Contribute to the documentation</p> <p>For training, contact Percona Training - Start learning now</p>"},{"location":"release-notes/Percona-Server-8.0.12-2rc1.html","title":"Percona Server for MySQL 8.0.12-2rc1","text":"<p>Following the alpha release announced earlier, Percona announces the release candidate of Percona Server for MySQL 8.0.12-2rc1 on October 31, 2018. Download the latest version from the Percona web site or the Percona Software Repositories.</p> <p>This release is based on MySQL 8.0.12 and includes all bug fixes in it. It is a Release Candidate quality release and it is not intended for production. If you want a high quality, Generally Available release, use the current Stable version (the most recent stable release at the time of writing in the 5.7 series is 5.7.23-23).</p> <p>Percona provides completely open-source and free software.</p>"},{"location":"release-notes/Percona-Server-8.0.12-2rc1.html#installation","title":"Installation","text":"<p>As this is a release candidate, installation is performed by enabling the testing repository and installing the software via your package manager.  For Debian based distributions, see apt installation instructions; for RPM based distributions. see yum installation instructions. Note that in both cases after installing the current percona-release package, you\u2019ll need to enable the testing repository in order to install Percona Server for MySQL for MySQL 8.0.12-2rc1.  For manual installations, you can download from the testing repository directly through our website.</p>"},{"location":"release-notes/Percona-Server-8.0.12-2rc1.html#new-features","title":"New Features","text":"<ul> <li> <p>#4550: Native Partitioning support for MyRocks storage engine</p> </li> <li> <p>#3911: Native Partitioning support for TokuDB storage engine</p> </li> <li> <p>#4946: Add an option to prevent implicit creation of column family in MyRocks</p> </li> <li> <p>#4839: Better default configuration for MyRocks and TokuDB</p> </li> <li> <p>InnoDB changed page tracking has been rewritten to account for redo logging changes in MySQL 8.0.11.  This fixes fast incremental backups for PS 8.0</p> </li> <li> <p>#4434: TokuDB ROW_FORMAT clause has been removed, compression may be set by using the session variable <code>tokudb_row_format</code> instead.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.12-2rc1.html#improvements","title":"Improvements","text":"<ul> <li>Several packaging changes to bring Percona packages more in line with upstream, including split repositories. As you\u2019ll note from our instructions above we now ship a tool with our release packages to help manage this.</li> </ul>"},{"location":"release-notes/Percona-Server-8.0.12-2rc1.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>#4785: Setting version_suffix to NULL could lead to handle_fatal_signal (sig=11) in Sys_var_version::global_value_ptr</p> </li> <li> <p>#4788: Setting log_slow_verbosity and enabling the slow_query_log could lead to a server crash</p> </li> <li> <p>#4937: Any index comment generated a new column family in MyRocks</p> </li> <li> <p>#1107: Binlog could be corrupted when tmpdir got full</p> </li> <li> <p>#1549: Server side prepared statements lead to a potential off-by-second timestamp on slaves</p> </li> <li> <p>#4937: <code>rocksdb_update_cf_options</code> was useless when specified in my.cnf or on command line.</p> </li> <li> <p>#4705: The server could crash on snapshot size check in RocksDB</p> </li> <li> <p>#4791: SQL injection on slave due to non-quoting in binlogged <code>ROLLBACK TO SAVEPOINT</code></p> </li> <li> <p>#4953: rocksdb.truncate_table3 was unstable</p> </li> </ul> <p>Other bugs fixed:</p> <ul> <li> <p>#4811: 5.7 Merge and fixup for old DB-937 introduces possible regression</p> </li> <li> <p>#4885: <code>Using ALTER ... ROW_FORMAT=TOKUDB_QUICKLZ</code> lead to InnoDB: Assertion failure: <code>ha_innodb.cc:12198:m_form-&gt;s-&gt;row_type == m_create_info-&gt;row_type</code></p> </li> <li> <p>Numerous testsuite failures/crashes</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.12-2rc1.html#upcoming-features","title":"Upcoming Features","text":"<ul> <li> <p>New encryption features in Percona Server for MySQL 5.7 will be ported forward to Percona Server for MySQL 8.0</p> </li> <li> <p>Adding back in column compression with custom data dictionaries and expanded fast index creation.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.13-3.html","title":"Percona Server for MySQL 8.0.13-3","text":"<p>Percona announces the GA release of Percona Server for MySQL 8.0.13-3 on December 21, 2018 (downloads are available here and from the Percona SoftwareRepositories). This release merges changes of MySQL 8.0.13, including all the bug fixes in it. Percona Server for MySQL 8.0.13-3 is now the current GA release in the 8.0 series. All of Percona\u2019s software is open-source and free.</p> <p>Percona Server for MySQL 8.0 includes all the features available in MySQL 8.0 Community Edition in addition to enterprise-grade features developed by Percona.  For a list of highlighted features from both MySQL 8.0 and Percona Server for MySQL 8.0, please see the GA release announcement.</p> <p>NOTE: If you are upgrading from 5.7 to 8.0, please ensure that you read the upgrade guide and the document Changed in Percona Server for MySQL 8.0.</p>"},{"location":"release-notes/Percona-Server-8.0.13-3.html#features-removed-in-percona-server-for-mysql-80","title":"Features Removed in Percona Server for MySQL 8.0","text":"<ul> <li> <p>Slow Query Log Rotation and Expiration: Not widely used, can be accomplished using <code>logrotate</code></p> </li> <li> <p>CSV engine mode for standard-compliant quote and comma parsing</p> </li> <li> <p>Expanded program option modifiers</p> </li> <li> <p>The <code>ALL_O_DIRECT</code> InnoDB flush method: it is not compatible with the new redo logging implementation</p> </li> <li> <p><code>XTRADB_RSEG</code> table from <code>INFORMATION_SCHEMA</code></p> </li> <li> <p>InnoDB memory size information from <code>SHOW ENGINE INNODB STATUS;</code> the same information is available from Performance Schema memory summary tables</p> </li> <li> <p>Query cache enhancements: The query cache is no longer present in MySQL 8.0</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.13-3.html#features-being-deprecated-in-percona-server-for-mysql-80","title":"Features Being Deprecated in Percona Server for MySQL 8.0","text":"<ul> <li>TokuDB Storage Engine: TokuDB will be supported throughout the Percona Server for MySQL 8.0 release series, but will not be available in the next major release. Percona encourages TokuDB users to explore the MyRocks Storage Engine which provides similar benefits for the majority of workloads and has better optimized support for modern hardware.</li> </ul>"},{"location":"release-notes/Percona-Server-8.0.13-3.html#issues-resolved-in-percona-server-for-mysql-8013-3","title":"Issues Resolved in Percona Server for MySQL 8.0.13-3","text":""},{"location":"release-notes/Percona-Server-8.0.13-3.html#improvements","title":"Improvements","text":"<ul> <li> <p>#5014: Update Percona Backup Locks feature to use the new <code>BACKUP_ADMIN</code> privilege in MySQL 8.0</p> </li> <li> <p>#4805: Re-Implemented Compressed Columns with Dictionaries feature in PS 8.0</p> </li> <li> <p>#4790: Improved accuracy of User Statistics feature</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.13-3.html#bugs-fixed-since-8012-rc1","title":"Bugs Fixed Since 8.0.12-rc1","text":"<ul> <li> <p>Fixed a crash in <code>mysqldump</code> in the <code>--innodb-optimize-keys</code> functionality #4972</p> </li> <li> <p>Fixed a crash that can occur when system tables are locked by the user due to a <code>lock_wait_timeout</code> #5134</p> </li> <li> <p>Fixed a crash that can occur when system tables are locked by the user from a <code>SELECT FOR UPDATE</code> statement #5027</p> </li> <li> <p>Fixed a bug that caused <code>innodb_buffer_pool_size</code> to be uninitialized after a restart if it was set using <code>SET PERSIST</code> #5069</p> </li> <li> <p>Fixed a crash in TokuDB that can occur when a temporary table experiences an autoincrement rollover #5056</p> </li> <li> <p>Fixed a bug where marking an index as invisible would cause a table rebuild in TokuDB and also in MyRocks #5031</p> </li> <li> <p>Fixed a bug where audit logs could get corrupted if the <code>audit_log_rotations</code> was changed during runtime. #4950</p> </li> <li> <p>Fixed a bug where <code>LOCK INSTANCE FOR BACKUP</code> and <code>STOP SLAVE SQL_THREAD</code> would cause replication to be blocked and unable to be restarted. #4758 (Upstream #93649)</p> </li> </ul> <p>Other Bugs Fixed:</p> <p>#5155, #5139, #5057, #5049, #4999, #4971, #4943, #4918, #4917, #4898, and #4744.</p>"},{"location":"release-notes/Percona-Server-8.0.13-3.html#known-issues","title":"Known Issues","text":"<p>We have a few features and issues outstanding that should be resolved in the next release.</p>"},{"location":"release-notes/Percona-Server-8.0.13-3.html#pending-feature-re-implementations-and-improvements","title":"Pending Feature Re-Implementations and Improvements","text":"<ul> <li> <p>#4892: Re-Implement Expanded Fast Index Creation feature.</p> </li> <li> <p>#5216: Re-Implement Utility User feature.</p> </li> <li> <p>#5143: Identify Percona features which can make use of dynamic privileges instead of <code>SUPER</code></p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.13-3.html#notable-issues-in-features","title":"Notable Issues in Features","text":"<ul> <li> <p>#5148: Regression in Compressed Columns Feature when using <code>innodb-force-recovery</code></p> </li> <li> <p>#4996: Regression in User Statistics feature where <code>TOTAL_CONNECTIONS</code> field report incorrect data</p> </li> <li> <p>#4933: Regression in  Slow Query Logging Extensions feature where incorrect transaction idaccounting can cause an assert during certain DDLs.</p> </li> <li> <p>#5206: TokuDB: A crash can occur in TokuDB when using Native Partioning and the optimizer has <code>index_merge_union</code> enabled. Workaround by using <code>SET SESSION optimizer_switch=\"index_merge_union=off\";</code></p> </li> <li> <p>#5174: MyRocks: Attempting to use unsupported features against MyRocks can lead to a crash rather than an error.</p> </li> <li> <p>#5024: MyRocks: Queries can return the wrong results on tables with no primary key, non-unique <code>CHAR</code>/<code>VARCHAR</code> rows, and <code>UTF8MB4</code> charset.</p> </li> <li> <p>#5045: MyRocks: Altering a column or table comment cause the table to be rebuilt</p> </li> </ul> <p>Find the release notes for Percona Server for MySQL 8.0.13-3 in our online documentation. Report bugs in the Jira bug tracker.</p>"},{"location":"release-notes/Percona-Server-8.0.13-4.html","title":"Percona Server for MySQL 8.0.13-4","text":"<p>Percona announces the release of Percona Server for MySQL 8.0.13-4 on January 17, 2019 (downloads are available here and from the Percona Software Repositories). This release contains a fix for a critical bug that prevented Percona Server for MySQL 5.7.24-26 from being upgraded to version 8.0.13-3 if there were more than around 1000 tables, or if the maximum allocated InnoDB table ID was around 1000. Percona Server for MySQL 8.0.13-4 is now the current GA release in the 8.0 series. All of Percona\u2019s software is open-source and free.</p> <p>Percona Server for MySQL 8.0 includes all the features available in MySQL 8.0 Community Edition in addition to enterprise-grade features developed by Percona.  For a list of highlighted features from both MySQL 8.0 and Percona Server for MySQL 8.0, please see the GA release announcement.</p> <p>NOTE: If you are upgrading from 5.7 to 8.0, please ensure that you read the upgrade guide and the document Changed in Percona Server for MySQL 8.0.</p>"},{"location":"release-notes/Percona-Server-8.0.13-4.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>It was not possible to upgrade from MySQL 5.7.24-26 to 8.0.13-3 if there were more than around 1000 tables, or if the maximum allocated InnoDB table ID was around 1000. Bug fixed #5245.</p> </li> <li> <p><code>SHOW BINLOG EVENTS FROM &lt;bad offset&gt;</code> is not diagnosed inside <code>Format_description_log_events</code>. Bug fixed #5126 (Upstream #93544).</p> </li> <li> <p>There was a typo in mysqld_safe.sh: trottling was replaced with throttling. Bug fixed #240. Thanks to Michael Coburn for the patch.</p> </li> <li> <p>Percona Server for MySQL 8.0 could crash with the \u201cAssertion failure: dict0dict.cc:7451:space_id != SPACE_UNKNOWN\u201d exception during an upgrade from Percona Server for MySQL 5.7.23 to Percona Server for MySQL 8.0.13-3 with <code>--innodb_file_per_table=OFF</code>. Bug fixed #5222.</p> </li> <li> <p>On Debian or Ubuntu, a conflict was reported on the <code>/usr/bin/innochecksum</code> file when attempting to install Percona Server for MySQL 8 over the MySQL 8. Bug fixed #5225.</p> </li> <li> <p>An out-of-bound read exception could occur on debug builds in the compressed columns with dictionaries feature. Bug fixed #5311:.</p> </li> <li> <p>The <code>innodb_data_pending_reads</code> server status variable contained an incorrect value. Bug fixed #5264:. Thanks to Fangxin Lou for the patch.</p> </li> <li> <p>A memory leak and needless allocation in compression dictionaries</p> <p>could happen in <code>mysqldump</code>. Bug fixed #5307.</p> </li> <li> <p>A compression-related memory leak could happen in <code>mysqlbinlog</code>. Bug fixed #5308:.</p> </li> </ul> <p>Other bugs fixed: #4797:, #5209, #5268, #5270:, #5306, #5309:</p>"},{"location":"release-notes/Percona-Server-8.0.14.html","title":"Percona Server for MySQL 8.0.14","text":"<p>Due to a critical fix, MySQL Community Server 8.0.15 was released shortly (11 days later) after MySQL Community Server 8.0.14. Percona has skipped the release of Percona Server for MySQL 8.0.14. The next release of Percona Server for MySQL is Percona Server for MySQL 8.0.15-5 which contains all bug fixes and contents of both MySQL Community Server 8.0.14 and MySQL Community Server 8.0.15.</p> <p>Percona Server for MySQL 8.0 includes all the features available in MySQL 8.0 Community Edition in addition to enterprise-grade features developed by Percona.  For a list of highlighted features from both MySQL 8.0 and Percona Server for MySQL 8.0, please see the GA release announcement.</p> <p>Note</p> <p>If you are upgrading from 5.7 to 8.0, please ensure that you read the upgrade guide and the document Changed in Percona Server for MySQL 8.0.</p>"},{"location":"release-notes/Percona-Server-8.0.15-5.html","title":"Percona Server for MySQL 8.0.15-5","text":"<p>Percona announces the release of Percona Server for MySQL 8.0.15-5 on March 15, 2019 (downloads are available here and from the Percona Software Repositories).</p> <p>This release includes fixes to bugs found in previous releases of Percona Server for MySQL 8.0.</p> <p>Starting from the release <code>8.0.15-5</code> , Percona Server for MySQL uses the upstream implementation of binary log encryption. The variable <code>encrypt_binlog</code> is removed and the related command line option <code>--encrypt_binlog</code> is not supported. It is important that you remove the <code>encrypt_binlog</code> variable from your configuration file before you attempt to upgrade from either another release in the Percona Server for MySQL 8.0 series or Percona Server for MySQL 5.7. Otherwise, a server boot error reports an unknown variable. The implemented binary log encryption is compatible with the old format: the binary log encrypted in a previous version of MySQL 8.0 series or Percona Server for MySQL are supported.</p> <p>This release is based on MySQL 8.0.14 and 8.0.15. It includes all bug fixes in these releases. Percona Server for MySQL Percona Server for MySQL 8.0.14 was skipped.</p> <p>Percona Server for MySQL 8.0.15-5 is now the current GA release in the 8.0 series. All of Percona\u2019s software is open-source and free.</p> <p>Percona Server for MySQL 8.0 includes all the features available in MySQL 8.0 Community Edition in addition to enterprise-grade features developed by Percona.  For a list of highlighted features from both MySQL 8.0 and Percona Server for MySQL 8.0, please see the GA release announcement.</p> <p>NOTE: If you are upgrading from 5.7 to 8.0, please ensure that you read the upgrade guide and the document Changed in Percona Server for MySQL 8.0.</p>"},{"location":"release-notes/Percona-Server-8.0.15-5.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>The audit log produced time stamps inconsistent with the ISO8601 standard. Bug fixed #226.</p> </li> <li> <p>FLUSH commands written to the binary log could cause errors in case of replication. Bug fixed #1827 (upstream #88720).</p> </li> <li> <p>When audit_plugin was enabled, the server could use a lot of memory when handling large queries.  Bug fixed #5395.</p> </li> <li> <p>The page cleaner could sleep for long time when the system clock was adjusted to an earlier point in time. Bug fixed #5221 (upstream #93708).</p> </li> <li> <p>In some cases, the MyRocks storage engine could crash without triggering the crash recovery. Bug fixed #5366.</p> </li> <li> <p>In some cases, when it failed to read from a file, InnoDB did not inform the name of the file in the related error message. Bug fixed #2455 (upstream #76020).</p> </li> <li> <p>The <code>ACCESS_DENIED</code> field of the <code>information_schema.user_statistics</code> table was not updated correctly. Bugs fixed #3956, #4996.</p> </li> <li> <p><code>MyRocks</code> could crash while running <code>START TRANSACTION WITH CONSISTENT SNAPSHOT</code> if other transactions were in specific states. Bug fixed #4705.</p> </li> <li> <p>In some cases, the server using the the <code>MyRocks</code> storage engine could crash when TTL (Time to Live) was defined on a table. Bug fixed #4911.</p> </li> <li> <p>MyRocks incorrectly processed transactions in which multiple statements had to be rolled back. Bug fixed #5219.</p> </li> <li> <p>A stack buffer overrun could happen if the redo log encryption with key rotation was enabled. Bug fixed #5305.</p> </li> <li> <p>The TokuDB storage engine would assert on load when used with jemalloc 5.x. Bug fixed #5406.</p> </li> </ul> <p>Other bugs fixed: #4106, #4107, #4108, #4121, #4474, #4640, #5055, #5218, #5328, #5369.</p>"},{"location":"release-notes/Percona-Server-8.0.15-6.html","title":"Percona Server for MySQL 8.0.15-6","text":"<p>Percona announces the release of Percona Server for MySQL 8.0.15-6 on May 07, 2019 (downloads are available here and from the Percona Software Repositories).</p> <p>This release includes fixes to bugs found in previous releases of Percona Server for MySQL 8.0.</p> <p>Percona Server for MySQL 8.0.15-6 is now the current GA release in the 8.0 series. All of Percona\u2019s software is open-source and free.</p> <p>Percona Server for MySQL 8.0 includes all the features available in MySQL 8.0 Community Edition in addition to enterprise-grade features developed by Percona.  For a list of highlighted features from both MySQL 8.0 and Percona Server for MySQL 8.0, please see the GA release announcement.</p> <p>Note</p> <p>If you are upgrading from 5.7 to 8.0, please ensure that you read the upgrade guide and the document Changed in Percona Server for MySQL 8.0.</p>"},{"location":"release-notes/Percona-Server-8.0.15-6.html#new-features","title":"New Features","text":"<ul> <li> <p>The server part of MyRocks cross-engine consistent physical backups has been implemented by introducing rocksdb_disable_file_deletions and rocksdb_create_temporary_checkpoint session variables. These variables are intended to be used by backup tools. Prolonged use or other misuse can have serious side effects to the server instance.</p> </li> <li> <p>RocksDB WAL file information can now be seen in the performance_schema.log_status table.</p> </li> <li> <p>New Audit_log_buffer_size_overflow status variable has been implemented to track when an Audit Log Plugin entry was either dropped or written directly to the file due to its size being bigger than audit_log_buffer_size variable.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.15-6.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>TokuDB and MyRocks native partitioning handler objects were allocated from a wrong memory allocator. Memory was released only on shutdown and concurrent access to global memory allocator caused memory corruptions and therefore crashes. Bug fixed #5508.</p> </li> <li> <p>using TokuDB or MyRocks native partitioning and <code>index_merge</code> could lead to a server crash. Bugs fixed #5206, #5562.</p> </li> <li> <p>upgrade from Percona Server for MySQL 5.7.24 to Percona Server for MySQL 8.0.13-3 wasn\u2019t working with encrypted undo tablespaces. Bug fixed #5223.</p> </li> <li> <p>keyring_vault_plugin couldn\u2019t be initialized on Ubuntu Cosmic 17.10. Bug fixed #5453.</p> </li> <li> <p>rotated key encryption did not register <code>encryption_key_id</code> as a valid table option. Bug fixed #5482.</p> </li> <li> <p>INFORMATION_SCHEMA.GLOBAL_TEMPORARY_TABLES queries could crash if online <code>ALTER TABLE</code> was running in parallel. Bug fixed #5566.</p> </li> <li> <p>setting the log_slow_verbosity to include <code>innodb</code> value and enabling the slow_query_log could lead to a server crash. Bug fixed #4933.</p> </li> <li> <p>compression_dictionary operations were not allowed under innodb-force-recovery. Now they work correctly when innodb_force_recovery is &lt;= <code>2</code>, and are forbidden when innodb_force_recovery is &gt;= <code>3</code>. Bug fixed #5148.</p> </li> <li> <p><code>BLOB</code> entries in the binary log could become corrupted in case when a database with <code>Blackhole</code> tables served as an intermediate binary log server in a replication chain. Bug fixed #5353.</p> </li> <li> <p><code>FLUSH CHANGED_PAGE_BITMAPS</code> would leave gaps between the last written bitmap LSN and the InnoDB checkpoint LSN. Bug fixed #5446.</p> </li> <li> <p>XtraDB changed page tracking was missing pages changed by the in-place DDL. Bug fixed #5447.</p> </li> <li> <p><code>innodb_system</code> tablespace information was missing from the INFORMATION_SCHEMA.innodb_tablespaces view. Bug fixed #5473.</p> </li> <li> <p>undo log tablespace encryption status is now available through INFORMATION_SCHEMA.innodb_tablespaces view. Bug fixed #5485 (upstream #94665).</p> </li> <li> <p>enabling temporay tablespace encryption didn\u2019t mark the <code>innodb_temporary</code> tablespace with the encryption flag. Bug fixed #5490.</p> </li> <li> <p>server would crash during bootstrap if innodb_encrypt_tables was set to <code>1</code>. Bug fixed #5492.</p> </li> <li> <p>fixed intermittent shutdown crashes that were happening if Thread Pool was enabled. Bug fixed #5510.</p> </li> <li> <p>compression dictionary <code>INFORMATION_SCHEMA</code> views were missing when datadir was upgraded from 8.0.13 to 8.0.15. Bug fixed #5529.</p> </li> <li> <p>innodb_encrypt_tables variable accepted <code>FORCE</code> option only as a string. Bug fixed #5538.</p> </li> <li> <p><code>ibd2sdi</code> utility was missing in Debian/Ubuntu packages. Bug fixed #5549.</p> </li> <li> <p>Docker image is now ignoring password that is set in the configuration file when first initializing. Bug fixed #5573.</p> </li> <li> <p>long running <code>ALTER TABLE ADD INDEX</code> could cause a <code>semaphore wait &gt; 600</code> assertion. Bug fixed #3410 (upstream #82940).</p> </li> <li> <p>system keyring keys initialization wasn\u2019t thread safe. Bugs fixed #5554.</p> </li> <li> <p>Backup Locks was blocking DML for RocksDB. Bug fixed #5583.</p> </li> <li> <p>PerconaFT <code>locktree</code> library was re-licensed to Apache v2 license. Bug fixed #5501.</p> </li> </ul> <p>Other bugs fixed: #5243, #5484, #5512, #5523, #5536, #5550, #5570, #5578, #5441, #5442, #5456, #5462, #5487, #5489, #5520, and #5560.</p>"},{"location":"release-notes/Percona-Server-8.0.16-7.html","title":"Percona Server for MySQL 8.0.16-7","text":"<p>Percona announces the release of Percona Server for MySQL 8.0.16-7 on August 15, 2019 (downloads are available here and from the Percona Software Repositories). This release includes fixes to bugs found in previous releases of Percona Server for MySQL 8.0. Percona Server for MySQL 8.0.16-7 is now the current GA release in the 8.0 series. All of Percona\u2019s software is open-source and free.</p> <p>Percona Server for MySQL 8.0 includes all the features and bug fixes available in MySQL 8.0.16 Community Edition in addition to enterprise-grade features developed by Percona.</p>"},{"location":"release-notes/Percona-Server-8.0.16-7.html#encryption-features-general-availability-ga","title":"Encryption Features General Availability (GA)","text":"<ul> <li> <p>Encrypting Temporary Files</p> </li> <li> <p>Encrypting the Undo Tablespace</p> </li> <li> <p>Encrypting the System Tablespace</p> </li> <li> <p>default_table_encryption =OFF/ON</p> </li> <li> <p><code>table_encryption_privilege_check</code>=OFF/ON</p> </li> <li> <p>Encrypting the Redo Log files for master key encryption only</p> </li> <li> <p>Merge-sort-encryption</p> </li> <li> <p>Encrypting Doublewrite Buffers</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.16-7.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>Parallel doublewrite buffer writes must crash the server on an I/O error occurs. Bug fixed #5678.</p> </li> <li> <p>After resetting the innodb_temp_tablespace_encrypt to <code>OFF</code> during runtime the subsequent file-per-table temporary tables continue to be encrypted. Bug fixed #5734.</p> </li> <li> <p>Setting the encryption to <code>ON</code> for the system tablespace generates an encryption key and encrypts system temporary tablespace pages. Resetting the encryption to <code>OFF</code>, all subsequent pages are written to the temporary tablespace without encryption. To allow any encrypted tables to be decrypted, the generated keys are not erased. Modifying the innodb_temp_tablespace_encrypt does not affect file-per-table temporary tables. This type of table is encrypted if <code>ENCRYPTION</code> =\u2019Y\u2019 is set during table creation. Bug fixed #5736.</p> </li> <li> <p>An instance started with the default values but setting the redo-log without specifying the keyring plugin parameters does not fail or throw an error. Bug fixed #5476.</p> </li> <li> <p>The rocksdb_large_prefix allows index key prefixes up to 3072 bytes. The default value is changed to <code>TRUE</code> to match the behavior of the innodb_large_prefix. #5655.</p> </li> <li> <p>On a server with a large number of tables, a shutdown may take a measurable length of time. Bug fixed #5639.</p> </li> <li> <p>The changed page tracking uses the LOG flag during read operations. The redo log encryption may attempt to decrypt pages with a specific bit set and fail. This failure generates error messages. A NO_ENCRYPTION flag lets the read process safely disable decryption errors in this case. Bug fixed #5541.</p> </li> <li> <p>If large pages are enabled on MySQL side, the maximum size for innodb_buffer_pool_chunk_size is effectively limited to 4GB. Bug fixed #5517. (Upstream 94747)</p> </li> <li> <p>The TokuDB hot backup library continually dumps TRACE information to the server error log. The user cannot enable or disable the dump of this information. Bug fixed #4850.</p> </li> </ul> <p>Other bugs fixed: #5688, #5723, #5695, #5749, #5752, #5610, #5689, #5645, #5734, #5772, #5753, #5129, #5102, #5681, #5686, #5681, #5310, #5713, #5007, #5102, #5129, #5130, #5149, #5696, #3845, #5149, #5581, #5652, #5662, #5697, #5775, #5668, #5752, #5782, #5767, #5669, #5753, #5696, #5803, #5804, #5820, #5827, #5835, #5724, #5767, #5782, #5794, #5796, #5746 and, #5748.</p>"},{"location":"release-notes/Percona-Server-8.0.16-7.html#known-issues","title":"Known Issues","text":"<ul> <li>#5865: Percona Server for MySQL 8.0.16-7 does not support encryption for the MyRocks storage engine. An attempt to move any table from InnoDB to MyRocks fails as MyRocks currently sees all InnoDB tables as being encrypted.</li> </ul>"},{"location":"release-notes/Percona-Server-8.0.17-8.html","title":"Percona Server for MySQL 8.0.17-8","text":"<p>Percona announces the release of Percona Server for MySQL 8.0.17-8 on October 30, 2019 (downloads are available here and from the Percona Software Repositories).</p> <p>This release includes fixes to bugs found in previous releases of Percona Server for MySQL 8.0.</p> <p>Percona Server for MySQL 8.0.17-8 is now the current GA release in the 8.0 series. All of Percona\u2019s software is open-source and free.</p> <p>Percona Server for MySQL 8.0 includes all the features available in MySQL 8.0.17 Community Edition in addition to enterprise-grade features developed by Percona.</p>"},{"location":"release-notes/Percona-Server-8.0.17-8.html#new-features","title":"New Features","text":"<p>Percona Server for MySQL has implemented the ability to have a MySQL Utility user who has system access to do administrative tasks but limited access to user schemas. The user is invisible to other users. This feature is especially useful to those who are operating MySQL as a Service. This feature has the same functionality as the utility user in earlier versions and has been delay-ported to version 8.0.</p> <p>Percona Server for MySQL has implemented data masking .</p>"},{"location":"release-notes/Percona-Server-8.0.17-8.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>Changed the default of innodb_empty_free_list_algorithm to <code>backoff</code>. Bugs fixed #5881</p> </li> <li> <p>When the Adaptive Hash Index (AHI) was enabled or disabled, there was an AHI overhead during DDL operations. Bugs fixed #5747.</p> </li> <li> <p>An upgrade to Percona Server for MySQL 8.0.16-7 with encrypted tablespace fails on innodb_dynamic_metadata. Bugs fixed #5874.</p> </li> <li> <p>The <code>rocksdb.ttl_primary</code> test case sometimes fails. Bugs fixed #5722 (Louis Hust)</p> </li> <li> <p>The <code>rocksdb.ns_snapshot_read_committed</code> test case sometimes fails. Bugs fixed #5798 (Louis Hust).</p> </li> <li> <p>During a binlogging replication event, if the master crashes after the multi-threaded slave has begun copying to the slave\u2019s relay log and before the process has completed, a <code>STOP SLAVE</code> on the slave takes longer than expected. Bugs fixed #5824.</p> </li> <li> <p>The purpose of the sql_require_primary_key option is to avoid replication performance issues. Temporary tables are not replicated. The option cannot be used with temporary tables. Bugs fixed #5931.</p> </li> <li> <p>When using <code>skip-innodb_doublewrite</code> in my.cnf, a parallel doublewrite buffer is still created. Bugs fixed #3411.</p> </li> <li> <p>The metadata for every InnoDB table contains encryption information, either a \u2018Y\u2019 or an \u2018N\u2019 value based on the ENCRYPTION clause or the default_table_encryption value. You are unable to switch the storage engine from InnoDB to MyRocks because MyRocks does not support the ENCRYPTION clause. Bugs fixed #5865.</p> </li> <li> <p>MyRocks does not allow index condition pushdown optimization for specific data types, such as <code>varchar</code>.  Bugs fixed #5024.</p> </li> </ul> <p>Other bugs fixed: #5880, #5838, #5682, #5979, #5793, #6020, #5327, #5839, #5933, #5939, #5659, #5924, #5926, #5925, #5875, #5533, #5867, #5864, #5760, #5909, #5985, #5941, #5954, #5790, and #5593.</p>"},{"location":"release-notes/Percona-Server-8.0.18-9.html","title":"Percona Server for MySQL 8.0.18-9","text":"<p>Percona announces the release of Percona Server for MySQL 8.0.18-9 on December 11, 2019 (downloads are available here and from the Percona Software Repositories).</p> <p>This release includes fixes to bugs found in previous releases of Percona Server for MySQL 8.0.</p> <p>Percona Server for MySQL 8.0.18-9 is now the current GA release in the 8.0 series. All of Percona\u2019s software is open-source and free.</p> <p>Percona Server for MySQL 8.0 includes all the features available in MySQL 8.0.18 Community Edition in addition to enterprise-grade features developed by Percona.</p>"},{"location":"release-notes/Percona-Server-8.0.18-9.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>Setting the <code>none</code> value for slow_query_log_use_global_control generates an error. Bugs fixed #5813.</p> </li> <li> <p>If pam_krb5 allows the user to change their password, and the password expired, a new password may cause a server exit. Bug fixed #6023.</p> </li> <li> <p>An incorrect assertion was triggered if any temporary tables should be logged to binlog. This event may cause a server exit. Bug fixed #5181.</p> </li> <li> <p>The Handler failed to trigger on Error 1049, SQLSTATE 42000, or plain sqlexception. Bug fixed #6094. (Upstream #97682)</p> </li> <li> <p>When executing <code>SHOW GLOBAL STATUS</code>, the variables may return incorrect values. Bug fixed #5966.</p> </li> <li> <p>The memory storage engine detected an incorrect <code>full</code> condition even though the space contained reusable memory chunks released by deleted records and the space could be reused. Bug fixed #1469.</p> </li> </ul> <p>Other bugs fixed:</p> <p>#6051, #5876, #5996, #6021, #6052, #4775, #5836 (Upstream #96449), #6123, #5819, #5836, #6054, #6056, #6058, #6078, #6057, #6111, and #6073.</p>"},{"location":"release-notes/Percona-Server-8.0.19-10.html","title":"Percona Server for MySQL 8.0.19-10 (2020-03-23)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.19-10 includes all the features and bug fixes available in MySQL 8.0.19 Community Edition in addition to enterprise-grade features developed by Percona.</p>"},{"location":"release-notes/Percona-Server-8.0.19-10.html#new-features","title":"New Features","text":"<ul> <li> <p>PS-5729: Added server\u2019s UUID to Percona system keys.</p> </li> <li> <p>PS-5917: Added Simplified LDAP authentication plugin.</p> </li> <li> <p>PS-4464: Exposed the last global transaction identifier (GTID) executed for a CONSISTENT SNAPSHOT.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.19-10.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-6775: Removed the KEYRING_ON option from default_table_encryption.</p> </li> <li> <p>PS-6733: Added binary search to the Data masking plugin.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.19-10.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>PS-6811: Service failed to start asserting ACL_PROXY_USER::check_validity if \u2013skip-name-resolve=1 and there is a Proxy user. (Upstream #98908)</p> </li> <li> <p>PS-6112: Inconsistent <code>Binlog_snapshot_gtid</code> when mysqldump was used with \u2013single-transaction.</p> </li> <li> <p>PS-5923: \u201cSELECT \u2026 INTO var_name FOR UPDATE\u201d was not working in MySQL 8.0. (Upstream #96677)</p> </li> <li> <p>PS-6150: The execution of SHOW ENGINE INNODB STATUS to show locked mutexes could cause a server exit.</p> </li> <li> <p>PS-5379: Slow startup after an upgrade from MySQL 5.7 to MySQL 8. (Upstream #96340)</p> </li> <li> <p>PS-6750: The installation of client packages could cause a file conflict in Red Hat Enterprise Linux 8.</p> </li> <li> <p>PS-5675: Concurrent INSERT \u2026 ON DUPLICATE KEY UPDATE statements could cause a failure with a unique index violation. (Upstream #96578)</p> </li> <li> <p>PS-6857: New package naming broke dbdeployer.</p> </li> <li> <p>PS-6767: The execution of a stored function in a WHERE clause was skipped. (Upstream #98160)</p> </li> <li> <p>PS-5421: MyRocks: Corrected documentation for rocksdb_db_write_buffer_size.</p> </li> <li> <p>PS-6761: MacOS error in threadpool_unix.cc: there was no matching member function for call to \u2018compare_exchange_weak\u2019.</p> </li> <li> <p>PS-6900: The test big-test required re-recording after explicit_encryption was re-added.</p> </li> <li> <p>PS-6897: The main.udf_myisam test and main.transactional_acl_tables test failed on trunk.</p> </li> <li> <p>PS-6106: ALTER TABLE without ENCRYPTION clause caused tables to be encrypted.</p> </li> <li> <p>PS-6093: The execution of SHOW ENGINE INNODB STATUS to show locked mutexes with simultaneous access to a compressed table could cause a server exit.</p> </li> <li> <p>PS-5552: Assertion \u2018m_idx &gt;= 0\u2019 failed in plan_idx QEP_share d::idx() const. (Upstream #98258)</p> </li> <li> <p>PS-6899: The tests, main.events_bugs and main.events_1, failed because 2020-01-01 was considered a future time. (Upstream #98860)</p> </li> <li> <p>PS-6881: Documented that mysql 8.0 does not require mysql_upgrade.</p> </li> <li> <p>PS-6796: The test, percona_changed_page_bmp_shutdown_thread, was unstable.</p> </li> <li> <p>PS-6773: A conditional jump or move depended on uninitialized value(s) in sha256_password_authenticate. (Upstream #98223)</p> </li> <li> <p>PS-6125: MyRocks: To set rocksdb_update_cf_options with a nonexistent column family created a partially-defined column family which could cause a server exit.</p> </li> <li> <p>PS-6037: When Extra Packages Enterprise Linux (EPEL) 8 repo was enabled on CentOS/RHEL 8, jemalloc v5 was installed.</p> </li> <li> <p>PS-5956: Root session could kill Utility user session.</p> </li> <li> <p>PS-5952: Utility user was visible in performance_schema.threads.</p> </li> <li> <p>PS-5843: A memory leak could occur after \u201cgroup_replication.gr_majority_loss_restart\u201d. (Upstream #96471)</p> </li> <li> <p>PS-5642: The page tracker thread did not exit if the startup failed.</p> </li> <li> <p>PS-5325: A conditional jump or move depended on uninitialized value on innodb_zip.wl5522_zip or innodb.alter_missing_tablespace.</p> </li> <li> <p>PS-4678: MyRocks: Documented the generated columns limitation.</p> </li> <li> <p>PS-4649: TokuDB: Documented PerconaFT (fractal tree indexing).</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.20-11.html","title":"Percona Server for MySQL 8.0.20-11 (2020-07-21)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.20-11 includes all the features and bug fixes available in MySQL 8.0.20 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>As of 8.0.20-11, the Percona Parallel Doublewrite buffer implementation has been removed and has been replaced with the Oracle MySQL implementation.</p>"},{"location":"release-notes/Percona-Server-8.0.20-11.html#new-features","title":"New Features","text":"<ul> <li> <p>PS-7128: Add RocksDB variables: rocksdb_max_background_compactions, rocksdb_max_background_flushes, and rocksdb_max_bottom_pri_background_compactions</p> </li> <li> <p>PS-7039: Add RocksDB variable: rocksdb_validate_tables</p> </li> <li> <p>PS-6951: Add RocksDB variables: rocksdb_delete_cf, rocksdb_enable_iterate_bounds, and rocksdb_enable_remove_orphaned_dropped_cfs</p> </li> <li> <p>PS-6926: Add RocksDB variables: rocksdb_table_stats_recalc_threshold_pct, rocksdb_table_stats_recalc_threshold_count, rocksdb_table_stats_background_thread_nice_value, rocksdb_table_stats_max_num_rows_scanned, rocksdb_table_stats_use_table_scan.</p> </li> <li> <p>PS-6910: Add RocksDB variable: rocksdb_stats_level.</p> </li> <li> <p>PS-6902: Add RocksDB variable: rocksdb_enable_insert_with_update_caching.</p> </li> <li> <p>PS-6901: Add RocksDB variable: rocksdb_read_free_rpl.</p> </li> <li> <p>PS-6891: Add RocksDB variable: rocksdb_master_skip_tx_api.</p> </li> <li> <p>PS-6890: Add RocksDB variable: rocksdb_blind_delete_primary_key.</p> </li> <li> <p>PS-6886: Add RocksDB variable: rocksdb_cache_dump.</p> </li> <li> <p>PS-6885: Add RocksDB variable: rocksdb_rollback_on_timeout.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.20-11.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-6994: Implement rocksdb_validate_tables functionality in Percona Server 8.X</p> </li> <li> <p>PS-6984: Update the zstd submodule to v1.4.4.</p> </li> <li> <p>PS-5764: Introduce SEQUENCE_TABLE() table-level SQL function</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.20-11.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>PS-7019: Correct query results for LEFT JOIN with GROUP BY (Upstream #99398)</p> </li> <li> <p>PS-6979: Modify the processing to call clean up functions to remove CREATE USER statement from the processlist after the statement has completed (Upstream #99200)</p> </li> <li> <p>PS-6860: Merge innodb_buffer_pool_pages_LRU_flushed into buf_get_total_stat()</p> </li> <li> <p>PS-7038: Set innodb-parallel-read_threads=1 to prevent kill process from hanging (Thanks to user wavelet123 for reporting this issue)</p> </li> <li> <p>PS-6945: Correct tokubackup plugin process exported API to allow large file backups. (Thanks to user prohaska7 for reporting this issue)</p> </li> <li> <p>PS-7000: Fix newer collations for proper space padding in MyRocks</p> </li> <li> <p>PS-6991: Modify package to include missing development files (Thanks to user larrabee for reporting this issue)</p> </li> <li> <p>PS-6946: Correct tokubackup processing to free memory use from the address and thread sanitizers (Thanks to user prohaska7 for reporting this issue)</p> </li> <li> <p>PS-5893: Add support for running multiple instances with systemD on Debian. (Thanks to user sasha for reporting this issue)</p> </li> <li> <p>PS-5620: Modify Docker image to support supplying custom TLS certificates (Thanks to user agarner for reporting this issue)</p> </li> <li> <p>PS-7168: Determine if file per tablespace using table flags to prevent assertion</p> </li> <li> <p>PS-7161: Fixed \u2018CreateTempFile\u2019 gunit test to support both \u2018HAVE_O_TMPFILE\u2019-style</p> </li> <li> <p>PS-7142: Set \u2018KEYRING_VAULT_PLUGIN_OPT\u2019 value when required</p> </li> <li> <p>PS-7138: Correct file reference for ps-admin broken in tar.gz package</p> </li> <li> <p>PS-7127: Provide mechanism to grant dynamic privilege to the utility user.</p> </li> <li> <p>PS-7118: Add ability to set LOWER_CASE_TABLE_NAMES option before initializing data directory</p> </li> <li> <p>PS-7116: Port MyRocks fix of Index Condition Pushdown (ICP)</p> </li> <li> <p>PS-7075: Provide binary tarball with shared libs and glibc suffix</p> </li> <li> <p>PS-6974: Correct instability in the rocksdb.drop_cf_* tests</p> </li> <li> <p>PS-6969: Correct instability in the rocksdb.index_stats_large_table</p> </li> <li> <p>PS-6105: Modify innodb.mysqld_core_dump_without_buffer_pool_dynamic test to move assertion to correct location</p> </li> <li> <p>PS-5735: Correct package to install the charsets on CentOS 7</p> </li> <li> <p>PS-4757: Remove CHECK_IF_CURL_DEPENDS_ON_RTMP to build keyring_vault for unconditional test</p> </li> <li> <p>PS-7131: Improve resume_encryption_cond conditional variable handling to avoid missed signals</p> </li> <li> <p>PS-7100: Fix rocksdb_read_free_rpl test to properly count rows corresponding to broken index entries</p> </li> <li> <p>PS-7082: Correct link displayed on help client command</p> </li> <li> <p>PS-7169: Set rocksdb_validate_tables to disabled RocksDB while upgrading the server from 5.7 to 8.0.20</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.21-12.html","title":"Percona Server for MySQL 8.0.21-12 (2020-10-13)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.21-12 includes all the features and bug fixes available in MySQL 8.0.21 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>This release fixes the security vulnerability CVE-2020-26542.</p>"},{"location":"release-notes/Percona-Server-8.0.21-12.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-7132: Make default value of rocksdb_wal_recovery_mode compatible with InnoDB</p> </li> <li> <p>PS-7245: Block enable/disable redo log with lock tables for backup</p> </li> <li> <p>PS-5730: Change SELECT rotate_system_key to ALTER INSTANCE for percona system key rotation.</p> </li> <li> <p>PS-7297: Modify MTR test to prevent proxy_protocol_admin_port test failure on 8.0.21</p> </li> <li> <p>PS-7114: Enhance crash artifacts (core dumps and stack traces) to provide additional information to the operator</p> </li> <li> <p>PS-5635: Introduce crypt_schema 2 for better error checking in encryption threads.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.21-12.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>PS-7203: Fix audit plugin memory leak on replicas when opening tables</p> </li> <li> <p>PS-6067: Provide a fix for upstream bug #97001 in Percona Server (Upstream #97001)</p> </li> <li> <p>PS-7325: Modify SELECT to correct situation when data is missing from MyRocks table when GROUP BY is used</p> </li> <li> <p>PS-7275: Add variable Innodb_checkpoint_max_age</p> </li> <li> <p>PS-7232: Modified Multithreaded Replica to correct the exhausted slave_transaction_retries when replica has slave_preserve_commit_order enabled (Upstream #99440)</p> </li> <li> <p>PS-7231: Modify Slave_transaction::retry_transaction() to call mysql_errno() only when thd-&gt;is_error() is true</p> </li> <li> <p>PS-7221: Modify get_int_sort_key_for_item_inline to return UTC string (Upstream #100402)</p> </li> <li> <p>PS-7143: Suppress deadlock check for ACL Cache MDL lock to prevent server freeze</p> </li> <li> <p>PS-7076: Modify to not update Cardinality after setting tokudb_cardinality_scale_percent</p> </li> <li> <p>PS-7025: Fix reading ahead of insert buffer pages by dispatching of buffered AIO transfers (Upstream #100086)</p> </li> <li> <p>PS-7010: Modify to Lock buffer blocks before sanity check in btr_cur_latch_leaves</p> </li> <li> <p>PS-6995: Introduce a new optimizer switch to allow the user to reduce the cost of a range scan to determine best execution plan for Primary Key lookup</p> </li> <li> <p>PS-7279: Modify to notify when BuildID: Not Available in case the server has been compiled with \u2013build-id=none</p> </li> <li> <p>PS-7220: Fix activity counter update in purge coordinator and workers</p> </li> <li> <p>PS-7169: Set rocksdb_validate_tables to disabled RocksDB while upgrading the server from 5.7 to 8.0.20</p> </li> <li> <p>PS-5741: Correct format for use of memset_s in keyring_vault</p> </li> <li> <p>PS-5323: Align Keyring encryption with Master Key encryption</p> </li> <li> <p>PS-7363: Modify to release locks on failure to prevent deadlock with LTFB + DROP UNDO TABLESPACE</p> </li> <li> <p>PS-7360: Modify clang-4.0 compilation to correct failure from \u2018-Winconsistent-missing-destructor-override\u2019</p> </li> <li> <p>PS-7359: Stabilize innodb.check_ibd_filesize_16k MTR test</p> </li> <li> <p>PS-7353: Modify LDAP connection to server to be static to prevent connection failures which will lock mysqld</p> </li> <li> <p>PS-7352: Correct typo in authentication_ldap_simple_ca_path to correct crash of mysqld</p> </li> <li> <p>PS-7340: Add validation of default_table_encryption to confirm keyring plugin is loaded before changing modes</p> </li> <li> <p>PS-7338: Set set crypt_data based on encryption status of destination table</p> </li> <li> <p>PS-7328: Block create/alter/drop/undo truncation while backup lock is available and hold lock until operation is completed</p> </li> <li> <p>PS-7322: Modify the right mask length calculation to handle up to string length for Data Masking</p> </li> <li> <p>PS-7321: Correct Random Number Generator to create only 15 or 16 digit number in Data Masking</p> </li> <li> <p>PS-7309: Modify gen_range() to support negative numbers in Data Masking</p> </li> <li> <p>PS-7308: Modify limit gen_dictionary_load() to load files only from the secure-file-priv dir when secure-file-priv dir is set in Data Masking</p> </li> <li> <p>PS-7307: Modify Data masking UDFs to display output using Latin1 character set</p> </li> <li> <p>PS-7296: Fix online log tracking initialization to properly process existing bitmap files</p> </li> <li> <p>PS-7289: Restrict innodb encryption threads to 255 and add min/max values</p> </li> <li> <p>PS-7270: Fix admin_port to accept non-proxied connections when proxy_protocol_networks=\u2019*\u2019</p> </li> <li> <p>PS-7234: Modify PS minimal tarballs to remove COPYING.AGPLv3</p> </li> <li> <p>PS-7226: Modify LDAP Plugin to enhance logging and test cases</p> </li> <li> <p>PS-7191: Correct documentation for PS variable default_table_encryption</p> </li> <li> <p>PS-7147: Modified Relay_log_info::cannot_safely_rollback() to handle null pointer</p> </li> <li> <p>PS-7140: Correct processing to apply crypt redo logs</p> </li> <li> <p>PS-7120: Handle doublewrite buffer encryption for keyring key tablespaces</p> </li> <li> <p>PS-7119: Correct Tests of encryption.innodb_encryption_aborted_rotation* to prevent failure</p> </li> <li> <p>PS-6987: Modify to allow value of default_table_encryption to be changed only when encryption_threads are off</p> </li> <li> <p>PS-7284: Fix failing test innodb.percona_changed_page_bmp_requests_debug</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.22-13.html","title":"Percona Server for MySQL 8.0.22-13 (2020-12-14)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.22-13 includes all the features and bug fixes available in MySQL 8.0.22 Community Edition in addition to enterprise-grade features developed by Percona.</p>"},{"location":"release-notes/Percona-Server-8.0.22-13.html#new-features","title":"New Features","text":"<ul> <li>PS-7162: Implement user-defined functions for Point-in-time Recovery in PXC operator</li> </ul>"},{"location":"release-notes/Percona-Server-8.0.22-13.html#improvements","title":"Improvements","text":"<ul> <li>PS-7348: Create a set of C++ classes/macros that would simplify the creation of new user-defined functions</li> </ul>"},{"location":"release-notes/Percona-Server-8.0.22-13.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>PS-7346: Correct the buffer calculation for the audit plugin used when large queries are executed(PS-5395).</p> </li> <li> <p>PS-7300: Modify Session temporary tablespace truncation on connection disconnect to reduce high CPU usage (Upstream #98869)</p> </li> <li> <p>PS-7304: Correct package to include coredumper.a as a dependency of libperconaserverclient20-dev (Thanks to user Martin for reporting this issue)</p> </li> <li> <p>PS-7236: Correct grouping by GROUP BY processing with timezone (Thanks to user larrabee for reporting this issue) (Upstream #101105)</p> </li> <li> <p>PS-7286: Modify to check for boundaries for encryption_key_id</p> </li> <li> <p>PS-7317: Add explicit_default_counter=10000 to innodb.table_encrypt_* MTR tests</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.23-14.html","title":"Percona Server for MySQL 8.0.23-14 (2021-05-12)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.23-14 includes all the features and bug fixes available in MySQL 8.0.23 Community Edition in addition to enterprise-grade features developed by Percona.</p>"},{"location":"release-notes/Percona-Server-8.0.23-14.html#new-features","title":"New Features","text":"<ul> <li> <p>PS-7364: The net_buffer_length status variable shows the buffer size of the current connection. Specify SHOW GLOBAL to see cumulative buffer size for all connections. For more information, see Adaptive Network Buffers.</p> </li> <li> <p>PS-5364: Update the keyring_vault plugin to support KV Secrets Engine Version 2 (kv-v2) (Thanks to Andrey Prokofyev for reporting this issue)</p> </li> <li> <p>PS-4894: Users can add calculated/virtual columns + index for the MyRocks storage engine.</p> </li> <li> <p>PS-7125: Users can reconfigure the TLS certificate at runtime and reload the certificate to the X Plugin (Upstream #99895)</p> </li> <li> <p>PS-7442: Add documentation for the MyRocks Information Schema Tables ROCKSDB_ACTIVE_COMPACTION_STATS and ROCKSDB_COMPACTION_HISTORY.</p> </li> <li> <p>PS-7441: Add documentation for the RocksDB variable rocksdb_max_compaction_history and deprecated the strict_collation_check variable.</p> </li> <li> <p>PS-7049: Update the SELinux profile and the AppArmor Policy, making these security features easier to implement for organizations.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.23-14.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-5846: Add support for the default value clause for the MyRocks storage engine. (Thanks to user denji for reporting this issue)</p> </li> <li> <p>PS-6780: Optimize support for collations other than latin1/utf8 in MyRocks. This support allows MyRocks to reconstruct and return data directly from an index read.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.23-14.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>PS-1956: Update specific data types to 64-bit to make slow query logs more efficient.</p> </li> <li> <p>PS-7593: If a transaction has executed, changing the tx-isolation level in a session is not honored and may cause service failure.</p> </li> <li> <p>PS-7578: Fix the replication failure on Update when a replica server has a primary key and the source server does not.</p> </li> <li> <p>PS-7498: Prevent the replication coordinator thread from being stuck due to the MASTER_DELAY while handling the partial relay log transactions. (Upstream #102647)</p> </li> <li> <p>PS-7474: ROCKSDB: Row not retrieved when using character sets that do not support Secondary Key index-only scans.</p> </li> <li> <p>PS-7618: Added the libmysqlclient.so.21(libmysqlclient_21)(64bit) to the PS80 Repository(Thanks to user Mark Frost for reporting this issue).</p> </li> <li> <p>PS-7098: MyRocks: ICP fails with character sets that do not support Secondary Key index-only scans, for example, utf8mb4. (Thanks to user denis for reporting this issue)</p> </li> <li> <p>PS-4497: Incorrect option error message for mysqlbinlog.</p> </li> <li> <p>PS-7617: In the Grant tables, the Timestamp column displays when the last change occurred to a user. In specific tables, the Timestamp column may be set to NULL.</p> </li> <li> <p>PS-7566: Correct version matching in RPM spec changelog for PS packages</p> </li> <li> <p>PS-7499: Improve the error log when MyRocks fails with rocksdb_validate_tables=1</p> </li> <li> <p>PS-7495: Block Tablespace DDL with LOCK TABLES FOR BACKUP (Upstream #102175)</p> </li> <li> <p>PS-7291: Run a variable value check when setting it with \u2018set persist_only\u2019</p> </li> <li> <p>PS-7492: Update slow log formatting for tmp tables related stats</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.23-14.html#known-issues","title":"Known Issues","text":"<ul> <li>PS-7683: If you are upgrading MyRocks from 8.0.22 to 8.0.23, you must run the following commands to add the ROCKSDB_COMPACTION_HISTORY and ROCKSDB_COMPACTION_STATS tables:</li> </ul> <pre><code>INSTALL PLUGIN ROCKSDB_COMPACTION_HISTORY SONAME 'ha_rocksdb.so';\nINSTALL PLUGIN ROCKSDB_COMPACTION_STATS SONAME 'ha_rocksdb.so';\n</code></pre>"},{"location":"release-notes/Percona-Server-8.0.25-15.html","title":"Percona Server for MySQL 8.0.25-15 (2021-07-13)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.25-15 includes all the features and bug fixes available in the MySQL 8.0.24 Community Edition and the MySQL 8.0.25 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>NOTE: The TokuDB Storage Engine was declared as deprecated in Percona Server for MySQL 8.0 and will be disabled in upcoming 8.0 versions.</p> <p>We recommend migrating to the MyRocks Storage Engine.</p> <p>For more information, see the Percona blog post: Heads-Up: TokuDB Support Changes and Future Removal from Percona Server for MySQL 8.0.</p>"},{"location":"release-notes/Percona-Server-8.0.25-15.html#new-features","title":"New Features","text":"<ul> <li> <p>PS-7182: Create functionality to expose defined data from procfs for agentless environment</p> </li> <li> <p>PS-7671: Add rocksdb_allow_unsafe_alter to enable crash unsafe INPLACE ADD|DROP partition</p> </li> <li> <p>PS-7327: INPLACE ADD|DROP partitions in MyRocks</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.25-15.html#improvements","title":"Improvements","text":"<ul> <li>PS-7366: Add jemalloc memory allocation profiling on PS 8.0</li> </ul>"},{"location":"release-notes/Percona-Server-8.0.25-15.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>PS-7722: Multiple-Column Index using Column Prefix Key Parts fails with Index Condition Pushdown in MyRocks</p> </li> <li> <p>PS-7665: The <code>performance_schema.metadata_locks m_column_name_length</code> is uninitialized for MDL_key::FOREIGN_KEY (Upstream #103532)</p> </li> <li> <p>PS-7695: The <code>Boost</code> download is no longer available. Using the -DDOWNLOAD_BOOST option with CMake (Thanks to user Benjamin Kuen for reporting this issue).</p> </li> <li> <p>PS-6802: Configure fails with make-4.3 with CMake Error at storage/rocksdb/CMakeLists.txt:152 (STRING) (Thanks to user Thomas Deutschmann for reporting this issue).</p> </li> <li> <p>PS-7648: Optimizer switch \u201cfavor_range_scan\u201d is not documented</p> </li> <li> <p>PS-7595: Same version upgrade from PS-&gt;PXC needs mysql_upgrade</p> </li> <li> <p>PS-7657: A server exit caused with an update query on a partition table with a compressed column</p> </li> <li> <p>PS-7557: Mysql server version 8.0.22-13 executing the Data Masking plugin causes a server exit (Thanks to user Alfonso Luciano for reporting this issue).</p> </li> <li> <p>PS-1116: LP #1719506: Audit plugin reports \u201ccommand_class=error\u201d for server-side prepared statements.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.25-15.html#known-issues","title":"Known issues","text":"<ul> <li> <p>PS-7787: Default values for the procfs_files_spec contains entries blocks by SELinux.</p> </li> <li> <p>PS-7788: Wildcard globbing in procfs_files_spec does not work.</p> </li> <li> <p>PS-7790: ProcFS access boundary to /proc and /sys can be bypassed with \u2026</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.26-16.html","title":"Percona Server for MySQL 8.0.26-16 (2021-10-20)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.26-16 includes all the features and bug fixes available in the MySQL 8.0.26 Community Edition. in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL\u00ae is a free, fully compatible, enhanced and open source drop-in replacement for any MySQL database. It provides superior performance, scalability and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads, and delivers greater value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups and increased visibility. Commercial support contracts are available.</p>"},{"location":"release-notes/Percona-Server-8.0.26-16.html#release-highlights","title":"Release Highlights","text":"<p>We have integrated a ZenFS RocksDB plugin to Percona Server for MySQL. This plugin places files on a raw zoned block device (ZBD) using the MyRocks File System interface. For more information, see Installing and configuring Percona Server for MySQL with ZenFS support.</p> <p>The following list are some of the bug fixes for MySQL 8.0.26, provided by Oracle, and included in Percona Server for MySQL:</p> <ul> <li> <p>#104575: In the PERFORMANCE_SCHEMA.Threads table, the <code>srv_purge_thread</code> and <code>srv_worker_thread</code> values are duplicated.</p> </li> <li> <p>#104387: When using REGEX comparison, a CHARACTER_SET_MISMATCH error is thrown.</p> </li> <li> <p>#104576: Accessing the second index in a partition table with many columns can create a high CPU load.</p> </li> </ul> <p>Find the full list of bug fixes and changes in MySQL 8.0.26 Release Notes.</p>"},{"location":"release-notes/Percona-Server-8.0.26-16.html#new-features","title":"New Features","text":"<ul> <li> <p>PS-7757: Integrate ZenFS RocksDB plugin into Percona Server</p> </li> <li> <p>PS-7777: Document RocksDB variable <code>rocksdb_manual_compaction_bottommost_level</code>.</p> </li> <li> <p>PS-7765: Document RocksDB variable <code>rocksdb_fault_injection_options</code></p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.26-16.html#deprecated-features","title":"Deprecated Features","text":"<p>The TokuDB Storage Engine was declared deprecated for Percona Server for MySQL. Starting with Percona Server 8.0.26-16, the plugins are available in the binary builds and packages but are disabled. The plugins will be removed from the binary builds and packages in a future version.</p> <p>New options have been added to enable the plugins if they are needed to migrate the data to another storage engine.</p> <p>The instructions on how to enable the plugins and more information are available at the beginning of each TokuDB topic.</p>"},{"location":"release-notes/Percona-Server-8.0.26-16.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-7526: Fix the unexpected quoting and dropping of comments in DROP TABLE commands</p> </li> <li> <p>PS-7706: Add options to explicitly enable TokuDB and TokuDB Backup that are <code>FALSE</code> by default.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.26-16.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>PS-1344: LP #1160436: Fix if the <code>log_slow_statement</code> is called unconditionally</p> </li> <li> <p>PS-1346: LP #1163232: Fix an anomaly with the <code>opt_log_slow_slave_statements</code>.</p> </li> <li> <p>PS-7500: Fix the <code>SELECT COUNT(\\*)</code> is slow in MyRocks.</p> </li> <li> <p>PS-7742: Fix when enabling binary log encryption breaks the basic replication setup on Percona Server for MySQL.</p> </li> <li> <p>PS-7746: Fix for a possible double call to free_share() in ha_innobase::open()</p> </li> <li> <p>PS-7778: Fix for denied commands when triggers with <code>DEFINER</code> are used.</p> </li> <li> <p>PS-1955: LP #1088529: Update the <code>log_slow_verbosity</code> help text to add the missing the \u201cminimal\u201d, \u201cstandard\u201d, and \u201cfull\u201d options</p> </li> <li> <p>PS-2433: LP #1234346: Include a timestamp in the slow query log file when initializing a new file</p> </li> <li> <p>PS-7790: Fix that disallows certain roles the ability to bypass the ProcFS access boundary with .. instead of <code>/proc</code> or <code>/sys</code>.</p> </li> <li> <p>PS-7784: Fix that reset the status variables <code>procfs_access_violations</code> and <code>procfs_queries</code></p> </li> <li> <p>PS-7785: Fix that reset the default value for <code>procfs_files_spec</code> which had the same value.</p> </li> <li> <p>PS-7788: Fix improves wildcard globbing in <code>proc_files_spec</code>.</p> </li> <li> <p>PS-7917: Fix for installing the TokuDB storage engine with ps-admin.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.26-17.html","title":"Percona Server for MySQL 8.0.26-17 (2022-01-26)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.26-17 includes all the features and bug fixes available in the MySQL 8.0.26 Community Edition. in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL 8.0.26-17 is now the current GA release in the 8.0 series.</p> <p>Percona Server for MySQL\u00ae is a free, fully-compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers a greater value to MySQL server users with optimized performance, greater performance scalability, and availability, enhanced backups and increased visibility. Commercial support contracts are available.</p>"},{"location":"release-notes/Percona-Server-8.0.26-17.html#release-highlights","title":"Release Highlights","text":"<p>Percona integrates a ZenFS RocksDB plugin to Percona Server for MySQL. This plugin places files on a raw zoned block device (ZBD) using the MyRocks File System interface. Percona provides a binary release for Debian 11.1. Other Linux distributions are adding support for ZenFS, but Percona does not offer installation packages for those distributions yet. The <code>libzbd</code> package is now linked statically to the RocksDB storage engine.</p> <p>The following dependency libraries are updated to newer versions:</p> <ul> <li> <p>ZenFS v1.0.0</p> </li> <li> <p>libzbd v2.0.1</p> </li> </ul> <p>For more information, see Installing and configuring Percona Server for MySQL with ZenFS support.</p> <p>The following list has a number of the bug fixes for MySQL 8.0.26, provided by Oracle, and included in Percona Server for MySQL:</p> <ul> <li> <p>#104575: Fix for when, in the PERFORMANCE_SCHEMA.Threads table, the <code>srv_purge_thread</code> and <code>srv_worker_thread</code> values are duplicated.</p> </li> <li> <p>#104387: Fix for when using a REGEX comparison, a CHARACTER_SET_MISMATCH error is thrown.</p> </li> <li> <p>#104576: Fix for a high CPU load being created when accessing the second index in a partition table with many columns.</p> </li> </ul> <p>Find the full list of bug fixes and changes in MySQL 8.0.26 Release Notes.</p>"},{"location":"release-notes/Percona-Server-8.0.26-17.html#deprecated-features","title":"Deprecated Features","text":"<p>The TokuDB Storage Engine was declared deprecated for Percona Server for MySQL. Starting with Percona Server 8.0.26-16, the plugins are available in binary builds and packages but are disabled. The plugins will be removed from the binary builds and packages in a future version.</p> <p>New options have been added to enable the plugins if they are needed to migrate the data to another storage engine.</p> <p>The instructions on enabling the plugins and more information are available at the beginning of each TokuDB topic in the Percona Server fo MySQL documentation.</p>"},{"location":"release-notes/Percona-Server-8.0.26-17.html#bugs-fixed","title":"Bugs Fixed","text":"<ul> <li> <p>The <code>libzbd</code> user library is statically linked into <code>ha_rocksdb.so</code>. This linking allows the creation of a single binary package and requires the 5.9 kernel and higher.</p> </li> <li> <p>Fix for ZenFS issues with <code>sysbench</code> using either Debian 11 or the latest <code>libzbd</code> user library.</p> </li> <li> <p>Fix a sporadic aborting on BG write error assertion in rocksdb.bloomfilter3.</p> </li> <li> <p>Fix when the <code>WITH_ZENFS_UTILITY</code> CMake option is set to <code>ON</code>. Added logic to the RocksDB CMakeLists.txt to ensure the <code>libgflags</code> library is installed on the system.</p> </li> <li> <p>Fix for the tests that rely on the <code>du</code> system utility. The <code>du</code> utility results must be converted to computations based on the <code>zenfs</code> list output.</p> </li> <li> <p>Fix for the zenfs <code>mkfs</code> to allow the command to accept a pre-existing aux_path.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.27-18.html","title":"Percona Server for MySQL 8.0.27-18 (2022-03-02)","text":"<ul> <li>Installation Installing Percona Server for MySQL</li> </ul> <p>Percona Server for MySQL 8.0.27-18 includes all the features and bug fixes available in the MySQL 8.0.27 Community Edition. in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a free, fully compatible, enhanced and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads, and delivers greater value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups and increased visibility. Commercial support contracts are available.</p>"},{"location":"release-notes/Percona-Server-8.0.27-18.html#release-highlights","title":"Release highlights","text":"<p>The following lists a number of the bug fixes for MySQL 8.0.27, provided by Oracle, and included in Percona Server for MySQL:</p> <ul> <li> <p>The <code>default_authentication_plugin</code> is deprecated. Support for this plugin may be removed in future versions. Use the <code>authentication_policy</code> variable.</p> </li> <li> <p>The <code>binary</code> operator is deprecated. Support for this operator may be removed in future versions. Use <code>CAST(... AS BINARY)</code>.</p> </li> <li> <p>Fix for when a parent table initiates a cascading <code>SET NULL</code> operation on the child table, the virtual column can be set to NULL instead of the value derived from the parent table.</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.27 Release Notes.</p>"},{"location":"release-notes/Percona-Server-8.0.27-18.html#new-features","title":"New features","text":"<ul> <li> <p>PS-7960: Documented the <code>rocksdb_partial_index_sort_max_mem</code> variable, the <code>rocksdb_bulk_load_partial_index</code> variable, and the <code>rocksdb_cancel_manual_compactions</code> variable.</p> </li> <li> <p>PS-2346: LP #720547: Implemented an option to allow queries with specific error codes to add entries to the Slow Query Log.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.27-18.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-7955: Enabled ZenFS functionality on standard Percona Server packages on Debian 11 and Ubuntu 20.04.</p> </li> <li> <p>PS-7931: Implemented a Slow Query Log Rotation and Expiration in Percona Server for MySQL 8.0.</p> </li> <li> <p>PS-6730: The \u2018Last_errno:\u2019 field in the Slow Query Log contains only error information.</p> </li> <li> <p>PS-8076: Added a deprecation warning when using XtraDB changed page tracking.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.27-18.html#bugs-fixed","title":"Bugs fixed","text":"<ul> <li> <p>PS-7883: An <code>ALTER</code> query caused a server exit when <code>--rocksdb_write_disable_wal</code> was enabled.</p> </li> <li> <p>PS-8007: Percona Server for MySQL can fail to start if the server starts before the network mounts the datadir or a local mount of the datadir.</p> </li> <li> <p>PS-7977: The AppArmor profile is broken after an 8.0.22-13 to 8.0.23-14 upgrade. (Thanks to Alex Kompel for reporting this issue)</p> </li> <li> <p>PS-7958: A <code>SELECT</code> statement using a Full-Text Search index with a special character caused a server exit.</p> </li> <li> <p>PS-7940: The initialization of a virtual column template if a child table had a virtual column caused a restart loop. This initialization prevented a server exit when there was an <code>ON DELETE CASCADE</code> statement in the parent table and the child table had virtual columns. (Upstream #105290)</p> </li> <li> <p>PS-5654: On a view, the query digest for each SELECT statement is now based on the SELECT statement and not the view definition, which was the case for earlier versions (Upstream #89559)</p> </li> <li> <p>PS-7975: Fix to allow test main.mtr_unit_tests to complete successfully (Thanks to Thomas Deutschmann for reporting this issue)</p> </li> <li> <p>PS-7873: Fix for when the log_status table reported an incorrect executed_gtid (Thanks to zhujzhuo for reporting this issue) (Upstream #102175)</p> </li> <li> <p>PS-5168 Fix for when the Slow Query Log reports <code>tmp_table_size:0</code>.</p> </li> <li> <p>Normalized the <code>zenfs</code> utility backup and restore requirements for the <code>--path</code> command line option, the <code>--backup_path</code> command-lne option, and the <code>restore_path</code> command-line option. For more information, see Installing and configuring Percona Server for MySQL with ZenFS support.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.27-18.html#packaging-notes","title":"Packaging notes","text":"<ul> <li>Red Hat Enterprise Linux 6 (and derivative Linux distributions) are no longer supported.</li> </ul>"},{"location":"release-notes/Percona-Server-8.0.27-18.html#known-issues","title":"Known issues","text":"<p>The RPM packages for Red Hat Enterprise Linux 7 (and compatible derivatives) do not support TLSv1.3, as it requires OpenSSL 1.1.1, which is currently not available on this platform.</p>"},{"location":"release-notes/Percona-Server-8.0.27-18.html#contact-us","title":"Contact us","text":"<p>The Documentation Contribution Guide describes the methods available to contribute to the Percona Server for MySQL documentation.</p> <p>For free technical help, visit the Percona Community Forum.</p> <p>To report bugs or submit feature requests, open a JIRA ticket.</p> <p>For paid support and managed services or consulting services, contact Percona Sales.</p>"},{"location":"release-notes/Percona-Server-8.0.28-19.html","title":"Percona Server for MySQL 8.0.28-19 (2022-05-12)","text":"<p>Percona Server for MySQL 8.0.28-19 includes all the features and bug fixes available in the MySQL 8.0.28 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a free, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers more value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups, and increased visibility. Commercial support contracts are available.</p>"},{"location":"release-notes/Percona-Server-8.0.28-19.html#release-highlights","title":"Release highlights","text":"<p>Improvements and bug fixes introduced by Oracle for MySQL 8.0.28 and included in Percona Server for MySQL are the following:</p> <ul> <li> <p>The <code>ASCII</code> shortcut for <code>CHARACTER SET latin1</code> and <code>UNICODE</code> shortcut for <code>CHARACTER SET ucs2</code> are deprecated and raise a warning to use <code>CHARACTER SET</code> instead. The shortcuts will be removed in a future version.</p> </li> <li> <p>A stored function and a loadable function with the same name can share the same namespace. Add the schema name when invoking a stored function in the shared namespace. The server generates a warning when function names collide.</p> </li> <li> <p>InnoDB supports <code>ALTER TABLE ... RENAME COLUMN</code> operations when using <code>ALGORITHM=INSTANT</code>.</p> </li> <li> <p>The limit for <code>innodb_open_files</code> now includes temporary tablespace files. The temporary tablespace files were not counted in the <code>innodb_open_files</code> in previous versions.</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.28 Release Notes.</p>"},{"location":"release-notes/Percona-Server-8.0.28-19.html#deprecation-and-removal","title":"Deprecation and removal","text":"<p>Starting with Percona Server for MySQL 8.0.28-19, the TokuDB storage engine is no longer supported. We have removed the storage engine from the installation packages and the storage engine is disabled in our binary builds.</p>"},{"location":"release-notes/Percona-Server-8.0.28-19.html#improvement","title":"Improvement","text":"<ul> <li> <p>PS-7871: Using the <code>SET_VAR</code> syntax, MyRocks variables can be set dynamically.</p> </li> <li> <p>PS-8064: The ability to change log file locations dynamically is restricted.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.28-19.html#bugs-fixed","title":"Bugs fixed","text":"<ul> <li> <p>PS-7999: The <code>FEDERATED</code> storage engine would not reconnect when a <code>wait_timeout</code> was exceeded. (Thanks to Sami Ahlroos for reporting this issue) (Upstream #105878)</p> </li> <li> <p>PS-7856: Fixed for a sever exit caused by an update query on a partition tables.</p> </li> <li> <p>PS-8032: An Inplace index build with <code>lock=exclusive</code> did not generate an <code>MLOG_ADD_INDEX</code> redo.</p> </li> <li> <p>PS-8050: An upgrade from Percona Server for MySQL 5.7 to MySQL 8.0.26, caused a server exit with an assertion failure.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.28-19.html#useful-links","title":"Useful links","text":"<ul> <li> <p>The Percona Server for MySQL installation instructions</p> </li> <li> <p>Download Percona Server for MySQL 8.0</p> </li> <li> <p>The Percona Server for MySQL GitHub location</p> </li> <li> <p>To contribute to the documentation, review the Documentation Contribution Guide</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.28-20.html","title":"Percona Server for MySQL 8.0.28-20 (2022-06-20)","text":"<p>Percona Server for MySQL 8.0.28-20 includes all the features and bug fixes available in the MySQL 8.0.28 Community Edition in addition to enterprise-grade features developed by Percona.</p> <p>Percona Server for MySQL is a free, fully compatible, enhanced, and open source drop-in replacement for any MySQL database. It provides superior performance, scalability, and instrumentation.</p> <p>Percona Server for MySQL is trusted by thousands of enterprises to provide better performance and concurrency for their most demanding workloads. It delivers more value to MySQL server users with optimized performance, greater performance scalability and availability, enhanced backups, and increased visibility. Commercial support contracts are available.</p>"},{"location":"release-notes/Percona-Server-8.0.28-20.html#release-highlights","title":"Release highlights","text":"<p>New features and improvements introduced in Percona Server for MySQL 8.0.28-20:</p> <ul> <li> <p>Percona Server for MySQL implements encryption functions and variables to manage the encryption range. The functions may take an algorithm argument. Encryption converts plaintext into ciphertext using a key and an encryption algorithm. You can also use the user-defined functions with the PEM format keys generated externally by the OpenSSL utility.</p> </li> <li> <p>Percona Server for MySQL adds support for the Amazon Key Management Service (AWS KMS) component.</p> </li> <li> <p>ZenFS file system plugin for RocksDB is updated to version 2.1.0.</p> </li> <li> <p>Memory leak and error detectors (Valgrind or AddressSanitizer) provide detailed stack traces from dynamic libraries (plugins and components). The detailed stack traces make it easier to identify and fix the issues.</p> </li> </ul> <p>Other improvements and bug fixes introduced by Oracle for MySQL 8.0.28 and included in Percona Server for MySQL are the following:</p> <ul> <li> <p>The <code>ASCII</code> shortcut for <code>CHARACTER SET latin1</code> and <code>UNICODE</code> shortcut for <code>CHARACTER SET ucs2</code> are deprecated and raise a warning to use <code>CHARACTER SET</code> instead. The shortcuts will be removed in a future version.</p> </li> <li> <p>A stored function and a loadable function with the same name can share the same namespace. Add the schema name when invoking a stored function in the shared namespace. The server generates a warning when function names collide.</p> </li> <li> <p>InnoDB supports <code>ALTER TABLE ... RENAME COLUMN</code> operations when using <code>ALGORITHM=INSTANT</code>.</p> </li> <li> <p>The limit for <code>innodb_open_files</code> now includes temporary tablespace files. The temporary tablespace files were not counted in the <code>innodb_open_files</code> in previous versions.</p> </li> </ul> <p>Find the full list of bug fixes and changes in the MySQL 8.0.28 Release Notes.</p>"},{"location":"release-notes/Percona-Server-8.0.28-20.html#new-features","title":"New features","text":"<ul> <li> <p>PS-7044: Implements support for encryption user-defined functions (UDFs) for OpenSSL.</p> </li> <li> <p>PS-7672: Implements support for the Amazon Key Management Service component in Percona Server for MySQL.</p> </li> <li> <p>PS-7748: Implements the ability to log error messages to a memory buffer.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.28-20.html#improvements","title":"Improvements","text":"<ul> <li> <p>PS-8103: Memory leak and error detectors (Valgrind or AddressSanitizer) provide detailed stack traces from dynamic libraries (plugins and components). The detailed stack traces make it easier to identify and fix the issues.</p> </li> <li> <p>ZenFS file system plugin for RocksDB is updated to version 2.1.0.</p> </li> </ul>"},{"location":"release-notes/Percona-Server-8.0.28-20.html#bugs-fixed","title":"Bugs fixed","text":"<ul> <li> <p>PS-6029: Data masking <code>gen_rnd_us_phone()</code> function had a different format compared to MySQL upstream version.</p> </li> <li> <p>PS-8136: <code>LOCK TABLES FOR BACKUP</code> did not prevent InnoDB key rotation. Due to this behavior, Percona Xtrabackup couldn\u2019t fetch the key in case the key was rotated after starting the backup.</p> </li> <li> <p>PS-8143: Fixed the memory leak in <code>File_query_log::set_rotated_name()</code>.</p> </li> <li> <p>PS-7894: When a query to the MyRocks table was interrupted due to the <code>MAX_EXECUTION time</code> option, an incorrect error message was received. (Thanks to user hagrid-the-developer for reporting this issue.)</p> </li> <li> <p>PS-8158: There was access to possibly not initialized memory. (Thanks to Rinat Ibragimov for reporting this issue.)</p> </li> <li> <p>PS-5008: Fixed the memory leak in <code>sync_latch_meta_init()</code> after mysqld shutdown.</p> </li> <li> <p>zenfs utility failed when a user tried to restore a single file into a specified ZenFS path.</p> </li> <li> <p>RocksDB in ZenFS mode ignored OPTIONS- files after the restart. <li> <p>RocksDB in ZenFS mode always created PersistentCache on the POSIX file system instead of creating it on ZenFS.</p> </li>"},{"location":"release-notes/Percona-Server-8.0.28-20.html#useful-links","title":"Useful links","text":"<ul> <li> <p>The Percona Server for MySQL installation instructions</p> </li> <li> <p>Download Percona Server for MySQL 8.0</p> </li> <li> <p>The Percona Server for MySQL GitHub location</p> </li> <li> <p>To contribute to the documentation, review the Documentation Contribution Guide</p> </li> </ul>"},{"location":"release-notes/release-notes_index.html","title":"Percona Server for MySQL 8.0 release notes index","text":"<ul> <li> <p>Percona Server for MySQL 8.0.34-26 (2023-09-26)</p> </li> <li> <p>Percona Server for MySQL 8.0.33-25 Update (2023-08-02)</p> </li> <li> <p>Percona Server for MySQL 8.0.33-25 (2023-06-15)</p> </li> <li> <p>Percona Server for MySQL 8.0.32-24 (2023-03-20)</p> </li> <li> <p>Percona Server for MySQL 8.0.31-23 (2023-02-09)</p> </li> <li> <p>Percona Server for MySQL 8.0.30-22 Update (2022-11-21)</p> </li> <li> <p>Percona Server for MySQL 8.0.30-22 (2022-11-21)</p> </li> <li> <p>Percona Server for MySQL 8.0.29-21 (2022-08-08)</p> </li> <li> <p>Percona Server for MySQL 8.0.28-20 (2022-06-20)</p> </li> <li> <p>Percona Server for MySQL 8.0.28-19 (2022-05-12)</p> </li> <li> <p>Percona Server for MySQL 8.0.27-18 (2022-03-02)</p> </li> <li> <p>Percona Server for MySQL 8.0.26-17 (2022-01-26)</p> </li> <li> <p>Percona Server for MySQL 8.0.26-16 (2021-10-20)</p> </li> <li> <p>Percona Server for MySQL 8.0.25-15 (2021-07-13)</p> </li> <li> <p>Percona Server for MySQL 8.0.23-14 (2021-05-12)</p> </li> <li> <p>Percona Server for MySQL 8.0.22-13 (2020-12-14)</p> </li> <li> <p>Percona Server for MySQL 8.0.21-12 (2020-10-13)</p> </li> <li> <p>Percona Server for MySQL 8.0.20-11 (2020-07-21)</p> </li> <li> <p>Percona Server for MySQL 8.0.19-10 (2020-03-23)</p> </li> <li> <p>Percona Server for MySQL 8.0.18-9 (2019-12-11)</p> </li> <li> <p>Percona Server for MySQL 8.0.17-8 (2019-10-30)</p> </li> <li> <p>Percona Server for MySQL 8.0.16-7 (2019-08-15)</p> </li> <li> <p>Percona Server for MySQL 8.0.15-6 (2019-05-07)</p> </li> <li> <p>Percona Server for MySQL 8.0.15-5 (2019-03-15)</p> </li> <li> <p>Percona Server for MySQL 8.0.14</p> </li> <li> <p>Percona Server for MySQL 8.0.13-4 (2019-01-17)</p> </li> <li> <p>Percona Server for MySQL 8.0.13-3 (2018-12-21)</p> </li> <li> <p>Percona Server for MySQL 8.0.12-2rc1 (2018-10-31)</p> </li> </ul>"}]}